import{l as X0,_ as rw,d as iw,r as nw,m as ow,o as aw,c as sw,e as uw}from"./index.3f3ae0c4.js";var Z0={exports:{}};(function(n,t){(function(e,i){n.exports=i()})(X0,function(){var e,i,o;function u(s,y){if(!e)e=y;else if(!i)i=y;else{var v="var sharedChunk = {}; ("+e+")(sharedChunk); ("+i+")(sharedChunk);",S={};e(S),o=y(S),typeof window!="undefined"&&(o.workerUrl=window.URL.createObjectURL(new Blob([v],{type:"text/javascript"})))}}return u(["exports"],function(s){function y(r,a){return r(a={exports:{}},a.exports),a.exports}var v=S;function S(r,a,l,f){this.cx=3*r,this.bx=3*(l-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(f-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=f,this.p2x=l,this.p2y=f}S.prototype.sampleCurveX=function(r){return((this.ax*r+this.bx)*r+this.cx)*r},S.prototype.sampleCurveY=function(r){return((this.ay*r+this.by)*r+this.cy)*r},S.prototype.sampleCurveDerivativeX=function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},S.prototype.solveCurveX=function(r,a){var l,f,g,m,x;for(a===void 0&&(a=1e-6),g=r,x=0;x<8;x++){if(m=this.sampleCurveX(g)-r,Math.abs(m)<a)return g;var E=this.sampleCurveDerivativeX(g);if(Math.abs(E)<1e-6)break;g-=m/E}if((g=r)<(l=0))return l;if(g>(f=1))return f;for(;l<f;){if(m=this.sampleCurveX(g),Math.abs(m-r)<a)return g;r>m?l=g:f=g,g=.5*(f-l)+l}return g},S.prototype.solve=function(r,a){return this.sampleCurveY(this.solveCurveX(r,a))};var L=k;function k(r,a){this.x=r,this.y=a}k.prototype={clone:function(){return new k(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,a){return this.clone()._rotateAround(r,a)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var a=r.x-this.x,l=r.y-this.y;return a*a+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,a){return Math.atan2(this.x*a-this.y*r,this.x*r+this.y*a)},_matMult:function(r){var a=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=a,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var a=Math.cos(r),l=Math.sin(r),f=l*this.x+a*this.y;return this.x=a*this.x-l*this.y,this.y=f,this},_rotateAround:function(r,a){var l=Math.cos(r),f=Math.sin(r),g=a.y+f*(this.x-a.x)+l*(this.y-a.y);return this.x=a.x+l*(this.x-a.x)-f*(this.y-a.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},k.convert=function(r){return r instanceof k?r:Array.isArray(r)?new k(r[0],r[1]):r};var N=typeof self!="undefined"?self:{},Q=Math.pow(2,53)-1;function tt(r,a,l,f){var g=new v(r,a,l,f);return function(m){return g.solve(m)}}var xt=tt(.25,.1,.25,1);function mt(r,a,l){return Math.min(l,Math.max(a,r))}function Ct(r,a,l){var f=l-a,g=((r-a)%f+f)%f+a;return g===a?l:g}function ut(r){for(var a=[],l=arguments.length-1;l-- >0;)a[l]=arguments[l+1];for(var f=0,g=a;f<g.length;f+=1){var m=g[f];for(var x in m)r[x]=m[x]}return r}var Pt=1;function Ft(){return Pt++}function ie(){return function r(a){return a?(a^16*Math.random()>>a/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function ne(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function ae(r,a){r.forEach(function(l){a[l]&&(a[l]=a[l].bind(a))})}function de(r,a){return r.indexOf(a,r.length-a.length)!==-1}function $t(r,a,l){var f={};for(var g in r)f[g]=a.call(l||this,r[g],g,r);return f}function Be(r,a,l){var f={};for(var g in r)a.call(l||this,r[g],g,r)&&(f[g]=r[g]);return f}function Ce(r){return Array.isArray(r)?r.map(Ce):typeof r=="object"&&r?$t(r,Ce):r}var er={};function Le(r){er[r]||(typeof console!="undefined"&&console.warn(r),er[r]=!0)}function Ut(r,a,l){return(l.y-r.y)*(a.x-r.x)>(a.y-r.y)*(l.x-r.x)}function Fe(r){for(var a=0,l=0,f=r.length,g=f-1,m=void 0,x=void 0;l<f;g=l++)a+=((x=r[g]).x-(m=r[l]).x)*(m.y+x.y);return a}function ye(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Ar(r){var a={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(f,g,m,x){var E=m||x;return a[g]=!E||E.toLowerCase(),""}),a["max-age"]){var l=parseInt(a["max-age"],10);isNaN(l)?delete a["max-age"]:a["max-age"]=l}return a}var mr=null;function or(r){if(mr==null){var a=r.navigator?r.navigator.userAgent:null;mr=!!r.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return mr}function cn(r){try{var a=N[r];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch{return!1}}var $r,Li,ar,wr,Dr=N.performance&&N.performance.now?N.performance.now.bind(N.performance):Date.now.bind(Date),So=N.requestAnimationFrame||N.mozRequestAnimationFrame||N.webkitRequestAnimationFrame||N.msRequestAnimationFrame,Yr=N.cancelAnimationFrame||N.mozCancelAnimationFrame||N.webkitCancelAnimationFrame||N.msCancelAnimationFrame,Yo={now:Dr,frame:function(r){var a=So(r);return{cancel:function(){return Yr(a)}}},getImageData:function(r,a){a===void 0&&(a=0);var l=N.document.createElement("canvas"),f=l.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return l.width=r.width,l.height=r.height,f.drawImage(r,0,0,r.width,r.height),f.getImageData(-a,-a,r.width+2*a,r.height+2*a)},resolveURL:function(r){return $r||($r=N.document.createElement("a")),$r.href=r,$r.href},hardwareConcurrency:N.navigator&&N.navigator.hardwareConcurrency||4,get devicePixelRatio(){return N.devicePixelRatio},get prefersReducedMotion(){return!!N.matchMedia&&(Li==null&&(Li=N.matchMedia("(prefers-reduced-motion: reduce)")),Li.matches)}},_r={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Io={supported:!1,testSupport:function(r){!ps&&wr&&(co?qe(r):ar=r)}},ps=!1,co=!1;function qe(r){var a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,wr),r.isContextLost())return;Io.supported=!0}catch{}r.deleteTexture(a),ps=!0}N.document&&((wr=N.document.createElement("img")).onload=function(){ar&&qe(ar),ar=null,co=!0},wr.onerror=function(){ps=!0,ar=null},wr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ga="01",hn=function(r,a){this._transformRequestFn=r,this._customAccessToken=a,this._createSkuToken()};function Co(r){return r.indexOf("mapbox:")===0}hn.prototype._createSkuToken=function(){var r=function(){for(var a="",l=0;l<10;l++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ga,a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt},hn.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},hn.prototype.transformRequest=function(r,a){return this._transformRequestFn&&this._transformRequestFn(r,a)||{url:r}},hn.prototype.normalizeStyleURL=function(r,a){if(!Co(r))return r;var l=Lo(r);return l.path="/styles/v1"+l.path,this._makeAPIURL(l,this._customAccessToken||a)},hn.prototype.normalizeGlyphsURL=function(r,a){if(!Co(r))return r;var l=Lo(r);return l.path="/fonts/v1"+l.path,this._makeAPIURL(l,this._customAccessToken||a)},hn.prototype.normalizeSourceURL=function(r,a){if(!Co(r))return r;var l=Lo(r);return l.path="/v4/"+l.authority+".json",l.params.push("secure"),this._makeAPIURL(l,this._customAccessToken||a)},hn.prototype.normalizeSpriteURL=function(r,a,l,f){var g=Lo(r);return Co(r)?(g.path="/styles/v1"+g.path+"/sprite"+a+l,this._makeAPIURL(g,this._customAccessToken||f)):(g.path+=""+a+l,Qs(g))},hn.prototype.normalizeTileURL=function(r,a){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!Co(r))return r;var l=Lo(r);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Yo.devicePixelRatio>=2||a===512?"@2x":"")+(Io.supported?".webp":"$1")),l.path=l.path.replace(/^.+\/v4\//,"/"),l.path="/v4"+l.path;var f=this._customAccessToken||function(g){for(var m=0,x=g;m<x.length;m+=1){var E=x[m].match(/^access_token=(.*)$/);if(E)return E[1]}return null}(l.params)||_r.ACCESS_TOKEN;return _r.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&l.params.push("sku="+this._skuToken),this._makeAPIURL(l,f)},hn.prototype.canonicalizeTileURL=function(r,a){var l=Lo(r);if(!l.path.match(/(^\/v4\/)/)||!l.path.match(/\.[\w]+$/))return r;var f="mapbox://tiles/";f+=l.path.replace("/v4/","");var g=l.params;return a&&(g=g.filter(function(m){return!m.match(/^access_token=/)})),g.length&&(f+="?"+g.join("&")),f},hn.prototype.canonicalizeTileset=function(r,a){for(var l=!!a&&Co(a),f=[],g=0,m=r.tiles||[];g<m.length;g+=1){var x=m[g];Wo(x)?f.push(this.canonicalizeTileURL(x,l)):f.push(x)}return f},hn.prototype._makeAPIURL=function(r,a){var l="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",f=Lo(_r.API_URL);if(r.protocol=f.protocol,r.authority=f.authority,r.protocol==="http"){var g=r.params.indexOf("secure");g>=0&&r.params.splice(g,1)}if(f.path!=="/"&&(r.path=""+f.path+r.path),!_r.REQUIRE_ACCESS_TOKEN)return Qs(r);if(!(a=a||_r.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+l);if(a[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+l);return r.params=r.params.filter(function(m){return m.indexOf("access_token")===-1}),r.params.push("access_token="+a),Qs(r)};var gp=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Wo(r){return gp.test(r)}var Cl=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Lo(r){var a=r.match(Cl);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function Qs(r){var a=r.params.length?"?"+r.params.join("&"):"";return r.protocol+"://"+r.authority+r.path+a}function Vu(r){if(!r)return null;var a=r.split(".");if(!a||a.length!==3)return null;try{return JSON.parse(decodeURIComponent(N.atob(a[1]).split("").map(function(l){return"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Po=function(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Po.prototype.getStorageKey=function(r){var a,l=Vu(_r.ACCESS_TOKEN);return a=l&&l.u?N.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,function(f,g){return String.fromCharCode(Number("0x"+g))})):_r.ACCESS_TOKEN||"",r?"mapbox.eventData."+r+":"+a:"mapbox.eventData:"+a},Po.prototype.fetchEventData=function(){var r=cn("localStorage"),a=this.getStorageKey(),l=this.getStorageKey("uuid");if(r)try{var f=N.localStorage.getItem(a);f&&(this.eventData=JSON.parse(f));var g=N.localStorage.getItem(l);g&&(this.anonId=g)}catch{Le("Unable to read from LocalStorage")}},Po.prototype.saveEventData=function(){var r=cn("localStorage"),a=this.getStorageKey(),l=this.getStorageKey("uuid");if(r)try{N.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&N.localStorage.setItem(a,JSON.stringify(this.eventData))}catch{Le("Unable to write to LocalStorage")}},Po.prototype.processRequests=function(r){},Po.prototype.postEvent=function(r,a,l,f){var g=this;if(_r.EVENTS_URL){var m=Lo(_r.EVENTS_URL);m.params.push("access_token="+(f||_r.ACCESS_TOKEN||""));var x={event:this.type,created:new Date(r).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:ga,userId:this.anonId},E=a?ut(x,a):x,C={url:Qs(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=si(C,function(P){g.pendingRequest=null,l(P),g.saveEventData(),g.processRequests(f)})}},Po.prototype.queueRequest=function(r,a){this.queue.push(r),this.processRequests(a)};var To,$s,Ko=function(r){function a(){r.call(this,"map.load"),this.success={},this.skuToken=""}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.postMapLoadEvent=function(l,f,g,m){this.skuToken=g;var x=!(!m&&!_r.ACCESS_TOKEN),E=Array.isArray(l)&&l.some(function(C){return Co(C)||Wo(C)});_r.EVENTS_URL&&x&&E&&this.queueRequest({id:f,timestamp:Date.now()},m)},a.prototype.processRequests=function(l){var f=this;if(!this.pendingRequest&&this.queue.length!==0){var g=this.queue.shift(),m=g.id,x=g.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),ne(this.anonId)||(this.anonId=ie()),this.postEvent(x,{skuToken:this.skuToken},function(E){E||m&&(f.success[m]=!0)},l))}},a}(Po),Oc=new(function(r){function a(l){r.call(this,"appUserTurnstile"),this._customAccessToken=l}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.postTurnstileEvent=function(l,f){_r.EVENTS_URL&&_r.ACCESS_TOKEN&&Array.isArray(l)&&l.some(function(g){return Co(g)||Wo(g)})&&this.queueRequest(Date.now(),f)},a.prototype.processRequests=function(l){var f=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var g=Vu(_r.ACCESS_TOKEN),m=g?g.u:_r.ACCESS_TOKEN,x=m!==this.eventData.tokenU;ne(this.anonId)||(this.anonId=ie(),x=!0);var E=this.queue.shift();if(this.eventData.lastSuccess){var C=new Date(this.eventData.lastSuccess),P=new Date(E),M=(E-this.eventData.lastSuccess)/864e5;x=x||M>=1||M<-1||C.getDate()!==P.getDate()}else x=!0;if(!x)return this.processRequests();this.postEvent(E,{"enabled.telemetry":!1},function(A){A||(f.eventData.lastSuccess=E,f.eventData.tokenU=m)},l)}},a}(Po)),kc=Oc.postTurnstileEvent.bind(Oc),Ll=new Ko,Pl=Ll.postMapLoadEvent.bind(Ll),Uu=500,Nc=50;function qu(){N.caches&&!To&&(To=N.caches.open("mapbox-tiles"))}function Tl(r){var a=r.indexOf("?");return a<0?r:r.slice(0,a)}var tu,Ml=1/0;function Al(){return tu==null&&(tu=N.OffscreenCanvas&&new N.OffscreenCanvas(1,1).getContext("2d")&&typeof N.createImageBitmap=="function"),tu}var Rc={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Rc);var Fc=function(r){function a(l,f,g){f===401&&Wo(g)&&(l+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),r.call(this,l),this.status=f,this.url=g,this.name=this.constructor.name,this.message=l}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},a}(Error),eu=ye()?function(){return self.worker&&self.worker.referrer}:function(){return(N.location.protocol==="blob:"?N.parent:N).location.href},Ua,qa,ju=function(r,a){if(!(/^file:/.test(l=r.url)||/^file:/.test(eu())&&!/^\w+:/.test(l))){if(N.fetch&&N.Request&&N.AbortController&&N.Request.prototype.hasOwnProperty("signal"))return function(f,g){var m,x=new N.AbortController,E=new N.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:eu(),signal:x.signal}),C=!1,P=!1,M=(m=E.url).indexOf("sku=")>0&&Wo(m);f.type==="json"&&E.headers.set("Accept","application/json");var A=function(B,X,Z){if(!P){if(B&&B.message!=="SecurityError"&&Le(B),X&&Z)return F(X);var it=Date.now();N.fetch(E).then(function($){if($.ok){var lt=M?$.clone():null;return F($,lt,it)}return g(new Fc($.statusText,$.status,f.url))}).catch(function($){$.code!==20&&g(new Error($.message))})}},F=function(B,X,Z){(f.type==="arrayBuffer"?B.arrayBuffer():f.type==="json"?B.json():B.text()).then(function(it){P||(X&&Z&&function($,lt,pt){if(qu(),To){var gt={status:lt.status,statusText:lt.statusText,headers:new N.Headers};lt.headers.forEach(function(It,Dt){return gt.headers.set(Dt,It)});var _t=Ar(lt.headers.get("Cache-Control")||"");_t["no-store"]||(_t["max-age"]&&gt.headers.set("Expires",new Date(pt+1e3*_t["max-age"]).toUTCString()),new Date(gt.headers.get("Expires")).getTime()-pt<42e4||function(It,Dt){if($s===void 0)try{new Response(new ReadableStream),$s=!0}catch{$s=!1}$s?Dt(It.body):It.blob().then(Dt)}(lt,function(It){var Dt=new N.Response(It,gt);qu(),To&&To.then(function(Rt){return Rt.put(Tl($.url),Dt)}).catch(function(Rt){return Le(Rt.message)})}))}}(E,X,Z),C=!0,g(null,it,B.headers.get("Cache-Control"),B.headers.get("Expires")))}).catch(function(it){P||g(new Error(it.message))})};return M?function(B,X){if(qu(),!To)return X(null);var Z=Tl(B.url);To.then(function(it){it.match(Z).then(function($){var lt=function(pt){if(!pt)return!1;var gt=new Date(pt.headers.get("Expires")||0),_t=Ar(pt.headers.get("Cache-Control")||"");return gt>Date.now()&&!_t["no-cache"]}($);it.delete(Z),lt&&it.put(Z,$.clone()),X(null,$,lt)}).catch(X)}).catch(X)}(E,A):A(null,null),{cancel:function(){P=!0,C||x.abort()}}}(r,a);if(ye()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,a,void 0,!0)}var l;return function(f,g){var m=new N.XMLHttpRequest;for(var x in m.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(m.responseType="arraybuffer"),f.headers)m.setRequestHeader(x,f.headers[x]);return f.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=f.credentials==="include",m.onerror=function(){g(new Error(m.statusText))},m.onload=function(){if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){var E=m.response;if(f.type==="json")try{E=JSON.parse(m.response)}catch(C){return g(C)}g(null,E,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else g(new Fc(m.statusText,m.status,f.url))},m.send(f.body),{cancel:function(){return m.abort()}}}(r,a)},Dl=function(r,a){return ju(ut(r,{type:"arrayBuffer"}),a)},si=function(r,a){return ju(ut(r,{method:"POST"}),a)},D="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Ua=[],qa=0;var R=function(r,a){if(Io.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),qa>=_r.MAX_PARALLEL_IMAGE_REQUESTS){var l={requestParameters:r,callback:a,cancelled:!1,cancel:function(){this.cancelled=!0}};return Ua.push(l),l}qa++;var f=!1,g=function(){if(!f)for(f=!0,qa--;Ua.length&&qa<_r.MAX_PARALLEL_IMAGE_REQUESTS;){var x=Ua.shift();x.cancelled||(x.cancel=R(x.requestParameters,x.callback).cancel)}},m=Dl(r,function(x,E,C,P){g(),x?a(x):E&&(Al()?function(M,A){var F=new N.Blob([new Uint8Array(M)],{type:"image/png"});N.createImageBitmap(F).then(function(B){A(null,B)}).catch(function(B){A(new Error("Could not load image because of "+B.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(E,a):function(M,A,F,B){var X=new N.Image,Z=N.URL;X.onload=function(){A(null,X),Z.revokeObjectURL(X.src),X.onload=null,N.requestAnimationFrame(function(){X.src=D})},X.onerror=function(){return A(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var it=new N.Blob([new Uint8Array(M)],{type:"image/png"});X.cacheControl=F,X.expires=B,X.src=M.byteLength?Z.createObjectURL(it):D}(E,a,C,P))});return{cancel:function(){m.cancel(),g()}}};function z(r,a,l){l[r]&&l[r].indexOf(a)!==-1||(l[r]=l[r]||[],l[r].push(a))}function G(r,a,l){if(l&&l[r]){var f=l[r].indexOf(a);f!==-1&&l[r].splice(f,1)}}var W=function(r,a){a===void 0&&(a={}),ut(this,a),this.type=r},ot=function(r){function a(l,f){f===void 0&&(f={}),r.call(this,"error",ut({error:l},f))}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a}(W),st=function(){};st.prototype.on=function(r,a){return this._listeners=this._listeners||{},z(r,a,this._listeners),this},st.prototype.off=function(r,a){return G(r,a,this._listeners),G(r,a,this._oneTimeListeners),this},st.prototype.once=function(r,a){return this._oneTimeListeners=this._oneTimeListeners||{},z(r,a,this._oneTimeListeners),this},st.prototype.fire=function(r,a){typeof r=="string"&&(r=new W(r,a||{}));var l=r.type;if(this.listens(l)){r.target=this;for(var f=0,g=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];f<g.length;f+=1)g[f].call(this,r);for(var m=0,x=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];m<x.length;m+=1){var E=x[m];G(l,E,this._oneTimeListeners),E.call(this,r)}var C=this._eventedParent;C&&(ut(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),C.fire(r))}else r instanceof ot&&console.error(r.error);return this},st.prototype.listens=function(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)},st.prototype.setEventedParent=function(r,a){return this._eventedParent=r,this._eventedParentData=a,this};var U={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},J=function(r,a,l,f){this.message=(r?r+": ":"")+l,f&&(this.identifier=f),a!=null&&a.__line__&&(this.line=a.__line__)};function ht(r){var a=r.value;return a?[new J(r.key,a,"constants have been deprecated as of v8")]:[]}function Tt(r){for(var a=[],l=arguments.length-1;l-- >0;)a[l]=arguments[l+1];for(var f=0,g=a;f<g.length;f+=1){var m=g[f];for(var x in m)r[x]=m[x]}return r}function At(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function wt(r){if(Array.isArray(r))return r.map(wt);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){var a={};for(var l in r)a[l]=wt(r[l]);return a}return At(r)}var Mt=function(r){function a(l,f){r.call(this,f),this.message=f,this.key=l}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a}(Error),te=function(r,a){a===void 0&&(a=[]),this.parent=r,this.bindings={};for(var l=0,f=a;l<f.length;l+=1){var g=f[l];this.bindings[g[0]]=g[1]}};te.prototype.concat=function(r){return new te(this,r)},te.prototype.get=function(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(r+" not found in scope.")},te.prototype.has=function(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)};var Jt={kind:"null"},St={kind:"number"},Xt={kind:"string"},zt={kind:"boolean"},Vt={kind:"color"},Ne={kind:"object"},Gt={kind:"value"},Ze={kind:"collator"},Cr={kind:"formatted"},Ve={kind:"resolvedImage"};function sr(r,a){return{kind:"array",itemType:r,N:a}}function We(r){if(r.kind==="array"){var a=We(r.itemType);return typeof r.N=="number"?"array<"+a+", "+r.N+">":r.itemType.kind==="value"?"array":"array<"+a+">"}return r.kind}var vn=[Jt,St,Xt,zt,Vt,Cr,Ne,sr(Gt),Ve];function dr(r,a){if(a.kind==="error")return null;if(r.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!dr(r.itemType,a.itemType))&&(typeof r.N!="number"||r.N===a.N))return null}else{if(r.kind===a.kind)return null;if(r.kind==="value"){for(var l=0,f=vn;l<f.length;l+=1)if(!dr(f[l],a))return null}}return"Expected "+We(r)+" but found "+We(a)+" instead."}function ui(r,a){return a.some(function(l){return l.kind===r.kind})}function Er(r,a){return a.some(function(l){return l==="null"?r===null:l==="array"?Array.isArray(r):l==="object"?r&&!Array.isArray(r)&&typeof r=="object":l===typeof r})}var Ge=y(function(r,a){var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function f(E){return(E=Math.round(E))<0?0:E>255?255:E}function g(E){return f(E[E.length-1]==="%"?parseFloat(E)/100*255:parseInt(E))}function m(E){return(C=E[E.length-1]==="%"?parseFloat(E)/100:parseFloat(E))<0?0:C>1?1:C;var C}function x(E,C,P){return P<0?P+=1:P>1&&(P-=1),6*P<1?E+(C-E)*P*6:2*P<1?C:3*P<2?E+(C-E)*(2/3-P)*6:E}try{a.parseCSSColor=function(E){var C,P=E.replace(/ /g,"").toLowerCase();if(P in l)return l[P].slice();if(P[0]==="#")return P.length===4?(C=parseInt(P.substr(1),16))>=0&&C<=4095?[(3840&C)>>4|(3840&C)>>8,240&C|(240&C)>>4,15&C|(15&C)<<4,1]:null:P.length===7&&(C=parseInt(P.substr(1),16))>=0&&C<=16777215?[(16711680&C)>>16,(65280&C)>>8,255&C,1]:null;var M=P.indexOf("("),A=P.indexOf(")");if(M!==-1&&A+1===P.length){var F=P.substr(0,M),B=P.substr(M+1,A-(M+1)).split(","),X=1;switch(F){case"rgba":if(B.length!==4)return null;X=m(B.pop());case"rgb":return B.length!==3?null:[g(B[0]),g(B[1]),g(B[2]),X];case"hsla":if(B.length!==4)return null;X=m(B.pop());case"hsl":if(B.length!==3)return null;var Z=(parseFloat(B[0])%360+360)%360/360,it=m(B[1]),$=m(B[2]),lt=$<=.5?$*(it+1):$+it-$*it,pt=2*$-lt;return[f(255*x(pt,lt,Z+1/3)),f(255*x(pt,lt,Z)),f(255*x(pt,lt,Z-1/3)),X];default:return null}}return null}}catch{}}).parseCSSColor,ur=function(r,a,l,f){f===void 0&&(f=1),this.r=r,this.g=a,this.b=l,this.a=f};ur.parse=function(r){if(r){if(r instanceof ur)return r;if(typeof r=="string"){var a=Ge(r);if(a)return new ur(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3])}}},ur.prototype.toString=function(){var r=this.toArray(),a=r[1],l=r[2],f=r[3];return"rgba("+Math.round(r[0])+","+Math.round(a)+","+Math.round(l)+","+f+")"},ur.prototype.toArray=function(){var r=this.a;return r===0?[0,0,0,0]:[255*this.r/r,255*this.g/r,255*this.b/r,r]},ur.black=new ur(0,0,0,1),ur.white=new ur(1,1,1,1),ur.transparent=new ur(0,0,0,0),ur.red=new ur(1,0,0,1);var Bn=function(r,a,l){this.sensitivity=r?a?"variant":"case":a?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Bn.prototype.compare=function(r,a){return this.collator.compare(r,a)},Bn.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Ol=function(r,a,l,f,g){this.text=r,this.image=a,this.scale=l,this.fontStack=f,this.textColor=g},Ui=function(r){this.sections=r};Ui.fromString=function(r){return new Ui([new Ol(r,null,null,null,null)])},Ui.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(r){return r.text.length!==0||r.image&&r.image.name.length!==0})},Ui.factory=function(r){return r instanceof Ui?r:Ui.fromString(r)},Ui.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(r){return r.text}).join("")},Ui.prototype.serialize=function(){for(var r=["format"],a=0,l=this.sections;a<l.length;a+=1){var f=l[a];if(f.image)r.push(["image",f.image.name]);else{r.push(f.text);var g={};f.fontStack&&(g["text-font"]=["literal",f.fontStack.split(",")]),f.scale&&(g["font-scale"]=f.scale),f.textColor&&(g["text-color"]=["rgba"].concat(f.textColor.toArray())),r.push(g)}}return r};var Vn=function(r){this.name=r.name,this.available=r.available};function yp(r,a,l,f){return typeof r=="number"&&r>=0&&r<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof l=="number"&&l>=0&&l<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:"Invalid rgba value ["+[r,a,l,f].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof f=="number"?[r,a,l,f]:[r,a,l]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function kl(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof ur||r instanceof Bn||r instanceof Ui||r instanceof Vn)return!0;if(Array.isArray(r)){for(var a=0,l=r;a<l.length;a+=1)if(!kl(l[a]))return!1;return!0}if(typeof r=="object"){for(var f in r)if(!kl(r[f]))return!1;return!0}return!1}function li(r){if(r===null)return Jt;if(typeof r=="string")return Xt;if(typeof r=="boolean")return zt;if(typeof r=="number")return St;if(r instanceof ur)return Vt;if(r instanceof Bn)return Ze;if(r instanceof Ui)return Cr;if(r instanceof Vn)return Ve;if(Array.isArray(r)){for(var a,l=r.length,f=0,g=r;f<g.length;f+=1){var m=li(g[f]);if(a){if(a===m)continue;a=Gt;break}a=m}return sr(a||Gt,l)}return Ne}function Nl(r){var a=typeof r;return r===null?"":a==="string"||a==="number"||a==="boolean"?String(r):r instanceof ur||r instanceof Ui||r instanceof Vn?r.toString():JSON.stringify(r)}Vn.prototype.toString=function(){return this.name},Vn.fromString=function(r){return r?new Vn({name:r,available:!1}):null},Vn.prototype.serialize=function(){return["image",this.name]};var xn=function(r,a){this.type=r,this.value=a};xn.parse=function(r,a){if(r.length!==2)return a.error("'literal' expression requires exactly one argument, but found "+(r.length-1)+" instead.");if(!kl(r[1]))return a.error("invalid value");var l=r[1],f=li(l),g=a.expectedType;return f.kind!=="array"||f.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(f=g),new xn(f,l)},xn.prototype.evaluate=function(){return this.value},xn.prototype.eachChild=function(){},xn.prototype.outputDefined=function(){return!0},xn.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ur?["rgba"].concat(this.value.toArray()):this.value instanceof Ui?this.value.serialize():this.value};var qi=function(r){this.name="ExpressionEvaluationError",this.message=r};qi.prototype.toJSON=function(){return this.message};var Mo={string:Xt,number:St,boolean:zt,object:Ne},Vr=function(r,a){this.type=r,this.args=a};Vr.parse=function(r,a){if(r.length<2)return a.error("Expected at least one argument.");var l,f=1,g=r[0];if(g==="array"){var m,x;if(r.length>2){var E=r[1];if(typeof E!="string"||!(E in Mo)||E==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);m=Mo[E],f++}else m=Gt;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return a.error('The length argument to "array" must be a positive integer literal',2);x=r[2],f++}l=sr(m,x)}else l=Mo[g];for(var C=[];f<r.length;f++){var P=a.parse(r[f],f,Gt);if(!P)return null;C.push(P)}return new Vr(l,C)},Vr.prototype.evaluate=function(r){for(var a=0;a<this.args.length;a++){var l=this.args[a].evaluate(r);if(!dr(this.type,li(l)))return l;if(a===this.args.length-1)throw new qi("Expected value to be of type "+We(this.type)+", but found "+We(li(l))+" instead.")}return null},Vr.prototype.eachChild=function(r){this.args.forEach(r)},Vr.prototype.outputDefined=function(){return this.args.every(function(r){return r.outputDefined()})},Vr.prototype.serialize=function(){var r=this.type,a=[r.kind];if(r.kind==="array"){var l=r.itemType;if(l.kind==="string"||l.kind==="number"||l.kind==="boolean"){a.push(l.kind);var f=r.N;(typeof f=="number"||this.args.length>1)&&a.push(f)}}return a.concat(this.args.map(function(g){return g.serialize()}))};var Jo=function(r){this.type=Cr,this.sections=r};Jo.parse=function(r,a){if(r.length<2)return a.error("Expected at least one argument.");var l=r[1];if(!Array.isArray(l)&&typeof l=="object")return a.error("First argument must be an image or text section.");for(var f=[],g=!1,m=1;m<=r.length-1;++m){var x=r[m];if(g&&typeof x=="object"&&!Array.isArray(x)){g=!1;var E=null;if(x["font-scale"]&&!(E=a.parse(x["font-scale"],1,St)))return null;var C=null;if(x["text-font"]&&!(C=a.parse(x["text-font"],1,sr(Xt))))return null;var P=null;if(x["text-color"]&&!(P=a.parse(x["text-color"],1,Vt)))return null;var M=f[f.length-1];M.scale=E,M.font=C,M.textColor=P}else{var A=a.parse(r[m],1,Gt);if(!A)return null;var F=A.type.kind;if(F!=="string"&&F!=="value"&&F!=="null"&&F!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,f.push({content:A,scale:null,font:null,textColor:null})}}return new Jo(f)},Jo.prototype.evaluate=function(r){return new Ui(this.sections.map(function(a){var l=a.content.evaluate(r);return li(l)===Ve?new Ol("",l,null,null,null):new Ol(Nl(l),null,a.scale?a.scale.evaluate(r):null,a.font?a.font.evaluate(r).join(","):null,a.textColor?a.textColor.evaluate(r):null)}))},Jo.prototype.eachChild=function(r){for(var a=0,l=this.sections;a<l.length;a+=1){var f=l[a];r(f.content),f.scale&&r(f.scale),f.font&&r(f.font),f.textColor&&r(f.textColor)}},Jo.prototype.outputDefined=function(){return!1},Jo.prototype.serialize=function(){for(var r=["format"],a=0,l=this.sections;a<l.length;a+=1){var f=l[a];r.push(f.content.serialize());var g={};f.scale&&(g["font-scale"]=f.scale.serialize()),f.font&&(g["text-font"]=f.font.serialize()),f.textColor&&(g["text-color"]=f.textColor.serialize()),r.push(g)}return r};var ho=function(r){this.type=Ve,this.input=r};ho.parse=function(r,a){if(r.length!==2)return a.error("Expected two arguments.");var l=a.parse(r[1],1,Xt);return l?new ho(l):a.error("No image name provided.")},ho.prototype.evaluate=function(r){var a=this.input.evaluate(r),l=Vn.fromString(a);return l&&r.availableImages&&(l.available=r.availableImages.indexOf(a)>-1),l},ho.prototype.eachChild=function(r){r(this.input)},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){return["image",this.input.serialize()]};var $f={"to-boolean":zt,"to-color":Vt,"to-number":St,"to-string":Xt},Ao=function(r,a){this.type=r,this.args=a};Ao.parse=function(r,a){if(r.length<2)return a.error("Expected at least one argument.");var l=r[0];if((l==="to-boolean"||l==="to-string")&&r.length!==2)return a.error("Expected one argument.");for(var f=$f[l],g=[],m=1;m<r.length;m++){var x=a.parse(r[m],m,Gt);if(!x)return null;g.push(x)}return new Ao(f,g)},Ao.prototype.evaluate=function(r){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(r));if(this.type.kind==="color"){for(var a,l,f=0,g=this.args;f<g.length;f+=1){if(l=null,(a=g[f].evaluate(r))instanceof ur)return a;if(typeof a=="string"){var m=r.parseColor(a);if(m)return m}else if(Array.isArray(a)&&!(l=a.length<3||a.length>4?"Invalid rbga value "+JSON.stringify(a)+": expected an array containing either three or four numeric values.":yp(a[0],a[1],a[2],a[3])))return new ur(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new qi(l||"Could not parse color from value '"+(typeof a=="string"?a:String(JSON.stringify(a)))+"'")}if(this.type.kind==="number"){for(var x=null,E=0,C=this.args;E<C.length;E+=1){if((x=C[E].evaluate(r))===null)return 0;var P=Number(x);if(!isNaN(P))return P}throw new qi("Could not convert "+JSON.stringify(x)+" to number.")}return this.type.kind==="formatted"?Ui.fromString(Nl(this.args[0].evaluate(r))):this.type.kind==="resolvedImage"?Vn.fromString(Nl(this.args[0].evaluate(r))):Nl(this.args[0].evaluate(r))},Ao.prototype.eachChild=function(r){this.args.forEach(r)},Ao.prototype.outputDefined=function(){return this.args.every(function(r){return r.outputDefined()})},Ao.prototype.serialize=function(){if(this.type.kind==="formatted")return new Jo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ho(this.args[0]).serialize();var r=["to-"+this.type.kind];return this.eachChild(function(a){r.push(a.serialize())}),r};var cy=["Unknown","Point","LineString","Polygon"],ja=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ja.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ja.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?cy[this.feature.type]:this.feature.type:null},ja.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ja.prototype.canonicalID=function(){return this.canonical},ja.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ja.prototype.parseColor=function(r){var a=this._parseColorCache[r];return a||(a=this._parseColorCache[r]=ur.parse(r)),a};var Qi=function(r,a,l,f){this.name=r,this.type=a,this._evaluate=l,this.args=f};Qi.prototype.evaluate=function(r){return this._evaluate(r,this.args)},Qi.prototype.eachChild=function(r){this.args.forEach(r)},Qi.prototype.outputDefined=function(){return!1},Qi.prototype.serialize=function(){return[this.name].concat(this.args.map(function(r){return r.serialize()}))},Qi.parse=function(r,a){var l,f=r[0],g=Qi.definitions[f];if(!g)return a.error('Unknown expression "'+f+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(g)?g[0]:g.type,x=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,E=x.filter(function(le){var Ht=le[0];return!Array.isArray(Ht)||Ht.length===r.length-1}),C=null,P=0,M=E;P<M.length;P+=1){var A=M[P],F=A[0],B=A[1];C=new ys(a.registry,a.path,null,a.scope);for(var X=[],Z=!1,it=1;it<r.length;it++){var $=r[it],lt=Array.isArray(F)?F[it-1]:F.type,pt=C.parse($,1+X.length,lt);if(!pt){Z=!0;break}X.push(pt)}if(!Z)if(Array.isArray(F)&&F.length!==X.length)C.error("Expected "+F.length+" arguments, but found "+X.length+" instead.");else{for(var gt=0;gt<X.length;gt++){var _t=Array.isArray(F)?F[gt]:F.type,It=X[gt];C.concat(gt+1).checkSubtype(_t,It.type)}if(C.errors.length===0)return new Qi(f,m,B,X)}}if(E.length===1)(l=a.errors).push.apply(l,C.errors);else{for(var Dt=(E.length?E:x).map(function(le){var Ht;return Ht=le[0],Array.isArray(Ht)?"("+Ht.map(We).join(", ")+")":"("+We(Ht.type)+"...)"}).join(" | "),Rt=[],oe=1;oe<r.length;oe++){var jt=a.parse(r[oe],1+Rt.length);if(!jt)return null;Rt.push(We(jt.type))}a.error("Expected arguments of type "+Dt+", but found ("+Rt.join(", ")+") instead.")}return null},Qi.register=function(r,a){for(var l in Qi.definitions=a,a)r[l]=Qi};var ya=function(r,a,l){this.type=Ze,this.locale=l,this.caseSensitive=r,this.diacriticSensitive=a};function bn(r,a){r[0]=Math.min(r[0],a[0]),r[1]=Math.min(r[1],a[1]),r[2]=Math.max(r[2],a[0]),r[3]=Math.max(r[3],a[1])}function ru(r,a){return!(r[0]<=a[0]||r[2]>=a[2]||r[1]<=a[1]||r[3]>=a[3])}function hy(r,a){var l=(180+r[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,g=Math.pow(2,a.z);return[Math.round(l*g*8192),Math.round(f*g*8192)]}function py(r,a,l){return a[1]>r[1]!=l[1]>r[1]&&r[0]<(l[0]-a[0])*(r[1]-a[1])/(l[1]-a[1])+a[0]}function mp(r,a){for(var l,f,g,m,x,E,C,P=!1,M=0,A=a.length;M<A;M++)for(var F=a[M],B=0,X=F.length;B<X-1;B++){if((m=(l=r)[0]-(f=F[B])[0])*(C=l[1]-(g=F[B+1])[1])-(E=l[0]-g[0])*(x=l[1]-f[1])==0&&m*E<=0&&x*C<=0)return!1;py(r,F[B],F[B+1])&&(P=!P)}return P}function fy(r,a){for(var l=0;l<a.length;l++)if(mp(r,a[l]))return!0;return!1}function td(r,a,l,f){var g=f[0]-l[0],m=f[1]-l[1],x=(r[0]-l[0])*m-g*(r[1]-l[1]),E=(a[0]-l[0])*m-g*(a[1]-l[1]);return x>0&&E<0||x<0&&E>0}function dy(r,a,l){for(var f=0,g=l;f<g.length;f+=1)for(var m=g[f],x=0;x<m.length-1;++x)if((A=[(M=m[x+1])[0]-(P=m[x])[0],M[1]-P[1]])[0]*(F=[(C=a)[0]-(E=r)[0],C[1]-E[1]])[1]-A[1]*F[0]!=0&&td(E,C,P,M)&&td(P,M,E,C))return!0;var E,C,P,M,A,F;return!1}function ed(r,a){for(var l=0;l<r.length;++l)if(!mp(r[l],a))return!1;for(var f=0;f<r.length-1;++f)if(dy(r[f],r[f+1],a))return!1;return!0}function rd(r,a){for(var l=0;l<a.length;l++)if(ed(r,a[l]))return!0;return!1}function Gu(r,a,l){for(var f=[],g=0;g<r.length;g++){for(var m=[],x=0;x<r[g].length;x++){var E=hy(r[g][x],l);bn(a,E),m.push(E)}f.push(m)}return f}function _p(r,a,l){for(var f=[],g=0;g<r.length;g++){var m=Gu(r[g],a,l);f.push(m)}return f}function Rl(r,a,l,f){if(r[0]<l[0]||r[0]>l[2]){var g=.5*f,m=r[0]-l[0]>g?-f:l[0]-r[0]>g?f:0;m===0&&(m=r[0]-l[2]>g?-f:l[2]-r[0]>g?f:0),r[0]+=m}bn(a,r)}function id(r,a,l,f){for(var g=8192*Math.pow(2,f.z),m=[8192*f.x,8192*f.y],x=[],E=0,C=r;E<C.length;E+=1)for(var P=0,M=C[E];P<M.length;P+=1){var A=M[P],F=[A.x+m[0],A.y+m[1]];Rl(F,a,l,g),x.push(F)}return x}function zc(r,a,l,f){for(var g,m=8192*Math.pow(2,f.z),x=[8192*f.x,8192*f.y],E=[],C=0,P=r;C<P.length;C+=1){for(var M=[],A=0,F=P[C];A<F.length;A+=1){var B=F[A],X=[B.x+x[0],B.y+x[1]];bn(a,X),M.push(X)}E.push(M)}if(a[2]-a[0]<=m/2){(g=a)[0]=g[1]=1/0,g[2]=g[3]=-1/0;for(var Z=0,it=E;Z<it.length;Z+=1)for(var $=0,lt=it[Z];$<lt.length;$+=1)Rl(lt[$],a,l,m)}return E}ya.parse=function(r,a){if(r.length!==2)return a.error("Expected one argument.");var l=r[1];if(typeof l!="object"||Array.isArray(l))return a.error("Collator options argument must be an object.");var f=a.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,zt);if(!f)return null;var g=a.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,zt);if(!g)return null;var m=null;return l.locale&&!(m=a.parse(l.locale,1,Xt))?null:new ya(f,g,m)},ya.prototype.evaluate=function(r){return new Bn(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)},ya.prototype.eachChild=function(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)},ya.prototype.outputDefined=function(){return!1},ya.prototype.serialize=function(){var r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]};var Do=function(r,a){this.type=zt,this.geojson=r,this.geometries=a};function fs(r){if(r instanceof Qi&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Do)return!1;var a=!0;return r.eachChild(function(l){a&&!fs(l)&&(a=!1)}),a}function ds(r){if(r instanceof Qi&&r.name==="feature-state")return!1;var a=!0;return r.eachChild(function(l){a&&!ds(l)&&(a=!1)}),a}function iu(r,a){if(r instanceof Qi&&a.indexOf(r.name)>=0)return!1;var l=!0;return r.eachChild(function(f){l&&!iu(f,a)&&(l=!1)}),l}Do.parse=function(r,a){if(r.length!==2)return a.error("'within' expression requires exactly one argument, but found "+(r.length-1)+" instead.");if(kl(r[1])){var l=r[1];if(l.type==="FeatureCollection")for(var f=0;f<l.features.length;++f){var g=l.features[f].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Do(l,l.features[f].geometry)}else if(l.type==="Feature"){var m=l.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Do(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Do(l,l)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Do.prototype.evaluate=function(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(a,l){var f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],m=a.canonicalID();if(l.type==="Polygon"){var x=Gu(l.coordinates,g,m),E=id(a.geometry(),f,g,m);if(!ru(f,g))return!1;for(var C=0,P=E;C<P.length;C+=1)if(!mp(P[C],x))return!1}if(l.type==="MultiPolygon"){var M=_p(l.coordinates,g,m),A=id(a.geometry(),f,g,m);if(!ru(f,g))return!1;for(var F=0,B=A;F<B.length;F+=1)if(!fy(B[F],M))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(a,l){var f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],m=a.canonicalID();if(l.type==="Polygon"){var x=Gu(l.coordinates,g,m),E=zc(a.geometry(),f,g,m);if(!ru(f,g))return!1;for(var C=0,P=E;C<P.length;C+=1)if(!ed(P[C],x))return!1}if(l.type==="MultiPolygon"){var M=_p(l.coordinates,g,m),A=zc(a.geometry(),f,g,m);if(!ru(f,g))return!1;for(var F=0,B=A;F<B.length;F+=1)if(!rd(B[F],M))return!1}return!0}(r,this.geometries)}return!1},Do.prototype.eachChild=function(){},Do.prototype.outputDefined=function(){return!0},Do.prototype.serialize=function(){return["within",this.geojson]};var gs=function(r,a){this.type=a.type,this.name=r,this.boundExpression=a};gs.parse=function(r,a){if(r.length!==2||typeof r[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");var l=r[1];return a.scope.has(l)?new gs(l,a.scope.get(l)):a.error('Unknown variable "'+l+'". Make sure "'+l+'" has been bound in an enclosing "let" expression before using it.',1)},gs.prototype.evaluate=function(r){return this.boundExpression.evaluate(r)},gs.prototype.eachChild=function(){},gs.prototype.outputDefined=function(){return!1},gs.prototype.serialize=function(){return["var",this.name]};var ys=function(r,a,l,f,g){a===void 0&&(a=[]),f===void 0&&(f=new te),g===void 0&&(g=[]),this.registry=r,this.path=a,this.key=a.map(function(m){return"["+m+"]"}).join(""),this.scope=f,this.errors=g,this.expectedType=l};function Bc(r,a){for(var l,f=r.length-1,g=0,m=f,x=0;g<=m;)if((l=r[x=Math.floor((g+m)/2)])<=a){if(x===f||a<r[x+1])return x;g=x+1}else{if(!(l>a))throw new qi("Input is not a number.");m=x-1}return 0}ys.prototype.parse=function(r,a,l,f,g){return g===void 0&&(g={}),a?this.concat(a,l,f)._parse(r,g):this._parse(r,g)},ys.prototype._parse=function(r,a){function l(P,M,A){return A==="assert"?new Vr(M,[P]):A==="coerce"?new Ao(M,[P]):P}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var f=r[0];if(typeof f!="string")return this.error("Expression name must be a string, but found "+typeof f+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var g=this.registry[f];if(g){var m=g.parse(r,this);if(!m)return null;if(this.expectedType){var x=this.expectedType,E=m.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||E.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(x,E))return null}else m=l(m,x,a.typeAnnotation||"coerce");else m=l(m,x,a.typeAnnotation||"assert")}if(!(m instanceof xn)&&m.type.kind!=="resolvedImage"&&function P(M){if(M instanceof gs)return P(M.boundExpression);if(M instanceof Qi&&M.name==="error"||M instanceof ya||M instanceof Do)return!1;var A=M instanceof Ao||M instanceof Vr,F=!0;return M.eachChild(function(B){F=A?F&&P(B):F&&B instanceof xn}),!!F&&fs(M)&&iu(M,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var C=new ja;try{m=new xn(m.type,m.evaluate(C))}catch(P){return this.error(P.message),null}}return m}return this.error('Unknown expression "'+f+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof r+" instead.")},ys.prototype.concat=function(r,a,l){var f=typeof r=="number"?this.path.concat(r):this.path,g=l?this.scope.concat(l):this.scope;return new ys(this.registry,f,a||null,g,this.errors)},ys.prototype.error=function(r){for(var a=[],l=arguments.length-1;l-- >0;)a[l]=arguments[l+1];var f=""+this.key+a.map(function(g){return"["+g+"]"}).join("");this.errors.push(new Mt(f,r))},ys.prototype.checkSubtype=function(r,a){var l=dr(r,a);return l&&this.error(l),l};var Kn=function(r,a,l){this.type=r,this.input=a,this.labels=[],this.outputs=[];for(var f=0,g=l;f<g.length;f+=1){var m=g[f],x=m[1];this.labels.push(m[0]),this.outputs.push(x)}};function xi(r,a,l){return r*(1-l)+a*l}Kn.parse=function(r,a){if(r.length-1<4)return a.error("Expected at least 4 arguments, but found only "+(r.length-1)+".");if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");var l=a.parse(r[1],1,St);if(!l)return null;var f=[],g=null;a.expectedType&&a.expectedType.kind!=="value"&&(g=a.expectedType);for(var m=1;m<r.length;m+=2){var x=m===1?-1/0:r[m],E=r[m+1],C=m,P=m+1;if(typeof x!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(f.length&&f[f.length-1][0]>=x)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);var M=a.parse(E,P,g);if(!M)return null;g=g||M.type,f.push([x,M])}return new Kn(g,l,f)},Kn.prototype.evaluate=function(r){var a=this.labels,l=this.outputs;if(a.length===1)return l[0].evaluate(r);var f=this.input.evaluate(r);if(f<=a[0])return l[0].evaluate(r);var g=a.length;return f>=a[g-1]?l[g-1].evaluate(r):l[Bc(a,f)].evaluate(r)},Kn.prototype.eachChild=function(r){r(this.input);for(var a=0,l=this.outputs;a<l.length;a+=1)r(l[a])},Kn.prototype.outputDefined=function(){return this.outputs.every(function(r){return r.outputDefined()})},Kn.prototype.serialize=function(){for(var r=["step",this.input.serialize()],a=0;a<this.labels.length;a++)a>0&&r.push(this.labels[a]),r.push(this.outputs[a].serialize());return r};var Hu=Object.freeze({__proto__:null,number:xi,color:function(r,a,l){return new ur(xi(r.r,a.r,l),xi(r.g,a.g,l),xi(r.b,a.b,l),xi(r.a,a.a,l))},array:function(r,a,l){return r.map(function(f,g){return xi(f,a[g],l)})}}),nd=6/29*3*(6/29),gy=Math.PI/180,yy=180/Math.PI;function vp(r){return r>.008856451679035631?Math.pow(r,1/3):r/nd+4/29}function xp(r){return r>6/29?r*r*r:nd*(r-4/29)}function bp(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function wp(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function od(r){var a=wp(r.r),l=wp(r.g),f=wp(r.b),g=vp((.4124564*a+.3575761*l+.1804375*f)/.95047),m=vp((.2126729*a+.7151522*l+.072175*f)/1);return{l:116*m-16,a:500*(g-m),b:200*(m-vp((.0193339*a+.119192*l+.9503041*f)/1.08883)),alpha:r.a}}function ad(r){var a=(r.l+16)/116,l=isNaN(r.a)?a:a+r.a/500,f=isNaN(r.b)?a:a-r.b/200;return a=1*xp(a),l=.95047*xp(l),f=1.08883*xp(f),new ur(bp(3.2404542*l-1.5371385*a-.4985314*f),bp(-.969266*l+1.8760108*a+.041556*f),bp(.0556434*l-.2040259*a+1.0572252*f),r.alpha)}function my(r,a,l){var f=a-r;return r+l*(f>180||f<-180?f-360*Math.round(f/360):f)}var Fl={forward:od,reverse:ad,interpolate:function(r,a,l){return{l:xi(r.l,a.l,l),a:xi(r.a,a.a,l),b:xi(r.b,a.b,l),alpha:xi(r.alpha,a.alpha,l)}}},zl={forward:function(r){var a=od(r),l=a.l,f=a.a,g=a.b,m=Math.atan2(g,f)*yy;return{h:m<0?m+360:m,c:Math.sqrt(f*f+g*g),l,alpha:r.a}},reverse:function(r){var a=r.h*gy,l=r.c;return ad({l:r.l,a:Math.cos(a)*l,b:Math.sin(a)*l,alpha:r.alpha})},interpolate:function(r,a,l){return{h:my(r.h,a.h,l),c:xi(r.c,a.c,l),l:xi(r.l,a.l,l),alpha:xi(r.alpha,a.alpha,l)}}},sd=Object.freeze({__proto__:null,lab:Fl,hcl:zl}),$i=function(r,a,l,f,g){this.type=r,this.operator=a,this.interpolation=l,this.input=f,this.labels=[],this.outputs=[];for(var m=0,x=g;m<x.length;m+=1){var E=x[m],C=E[1];this.labels.push(E[0]),this.outputs.push(C)}};function Ep(r,a,l,f){var g=f-l,m=r-l;return g===0?0:a===1?m/g:(Math.pow(a,m)-1)/(Math.pow(a,g)-1)}$i.interpolationFactor=function(r,a,l,f){var g=0;if(r.name==="exponential")g=Ep(a,r.base,l,f);else if(r.name==="linear")g=Ep(a,1,l,f);else if(r.name==="cubic-bezier"){var m=r.controlPoints;g=new v(m[0],m[1],m[2],m[3]).solve(Ep(a,1,l,f))}return g},$i.parse=function(r,a){var l=r[0],f=r[1],g=r[2],m=r.slice(3);if(!Array.isArray(f)||f.length===0)return a.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){var x=f[1];if(typeof x!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:x}}else{if(f[0]!=="cubic-bezier")return a.error("Unknown interpolation type "+String(f[0]),1,0);var E=f.slice(1);if(E.length!==4||E.some(function(it){return typeof it!="number"||it<0||it>1}))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:E}}if(r.length-1<4)return a.error("Expected at least 4 arguments, but found only "+(r.length-1)+".");if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(!(g=a.parse(g,2,St)))return null;var C=[],P=null;l==="interpolate-hcl"||l==="interpolate-lab"?P=Vt:a.expectedType&&a.expectedType.kind!=="value"&&(P=a.expectedType);for(var M=0;M<m.length;M+=2){var A=m[M],F=m[M+1],B=M+3,X=M+4;if(typeof A!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(C.length&&C[C.length-1][0]>=A)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);var Z=a.parse(F,X,P);if(!Z)return null;P=P||Z.type,C.push([A,Z])}return P.kind==="number"||P.kind==="color"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new $i(P,l,f,g,C):a.error("Type "+We(P)+" is not interpolatable.")},$i.prototype.evaluate=function(r){var a=this.labels,l=this.outputs;if(a.length===1)return l[0].evaluate(r);var f=this.input.evaluate(r);if(f<=a[0])return l[0].evaluate(r);var g=a.length;if(f>=a[g-1])return l[g-1].evaluate(r);var m=Bc(a,f),x=$i.interpolationFactor(this.interpolation,f,a[m],a[m+1]),E=l[m].evaluate(r),C=l[m+1].evaluate(r);return this.operator==="interpolate"?Hu[this.type.kind.toLowerCase()](E,C,x):this.operator==="interpolate-hcl"?zl.reverse(zl.interpolate(zl.forward(E),zl.forward(C),x)):Fl.reverse(Fl.interpolate(Fl.forward(E),Fl.forward(C),x))},$i.prototype.eachChild=function(r){r(this.input);for(var a=0,l=this.outputs;a<l.length;a+=1)r(l[a])},$i.prototype.outputDefined=function(){return this.outputs.every(function(r){return r.outputDefined()})},$i.prototype.serialize=function(){var r;r=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var a=[this.operator,r,this.input.serialize()],l=0;l<this.labels.length;l++)a.push(this.labels[l],this.outputs[l].serialize());return a};var ms=function(r,a){this.type=r,this.args=a};ms.parse=function(r,a){if(r.length<2)return a.error("Expectected at least one argument.");var l=null,f=a.expectedType;f&&f.kind!=="value"&&(l=f);for(var g=[],m=0,x=r.slice(1);m<x.length;m+=1){var E=a.parse(x[m],1+g.length,l,void 0,{typeAnnotation:"omit"});if(!E)return null;l=l||E.type,g.push(E)}var C=f&&g.some(function(P){return dr(f,P.type)});return new ms(C?Gt:l,g)},ms.prototype.evaluate=function(r){for(var a,l=null,f=0,g=0,m=this.args;g<m.length&&(f++,(l=m[g].evaluate(r))&&l instanceof Vn&&!l.available&&(a||(a=l.name),l=null,f===this.args.length&&(l=a)),l===null);g+=1);return l},ms.prototype.eachChild=function(r){this.args.forEach(r)},ms.prototype.outputDefined=function(){return this.args.every(function(r){return r.outputDefined()})},ms.prototype.serialize=function(){var r=["coalesce"];return this.eachChild(function(a){r.push(a.serialize())}),r};var _s=function(r,a){this.type=a.type,this.bindings=[].concat(r),this.result=a};_s.prototype.evaluate=function(r){return this.result.evaluate(r)},_s.prototype.eachChild=function(r){for(var a=0,l=this.bindings;a<l.length;a+=1)r(l[a][1]);r(this.result)},_s.parse=function(r,a){if(r.length<4)return a.error("Expected at least 3 arguments, but found "+(r.length-1)+" instead.");for(var l=[],f=1;f<r.length-1;f+=2){var g=r[f];if(typeof g!="string")return a.error("Expected string, but found "+typeof g+" instead.",f);if(/[^a-zA-Z0-9_]/.test(g))return a.error("Variable names must contain only alphanumeric characters or '_'.",f);var m=a.parse(r[f+1],f+1);if(!m)return null;l.push([g,m])}var x=a.parse(r[r.length-1],r.length-1,a.expectedType,l);return x?new _s(l,x):null},_s.prototype.outputDefined=function(){return this.result.outputDefined()},_s.prototype.serialize=function(){for(var r=["let"],a=0,l=this.bindings;a<l.length;a+=1){var f=l[a];r.push(f[0],f[1].serialize())}return r.push(this.result.serialize()),r};var nu=function(r,a,l){this.type=r,this.index=a,this.input=l};nu.parse=function(r,a){if(r.length!==3)return a.error("Expected 2 arguments, but found "+(r.length-1)+" instead.");var l=a.parse(r[1],1,St),f=a.parse(r[2],2,sr(a.expectedType||Gt));return l&&f?new nu(f.type.itemType,l,f):null},nu.prototype.evaluate=function(r){var a=this.index.evaluate(r),l=this.input.evaluate(r);if(a<0)throw new qi("Array index out of bounds: "+a+" < 0.");if(a>=l.length)throw new qi("Array index out of bounds: "+a+" > "+(l.length-1)+".");if(a!==Math.floor(a))throw new qi("Array index must be an integer, but found "+a+" instead.");return l[a]},nu.prototype.eachChild=function(r){r(this.index),r(this.input)},nu.prototype.outputDefined=function(){return!1},nu.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ou=function(r,a){this.type=zt,this.needle=r,this.haystack=a};ou.parse=function(r,a){if(r.length!==3)return a.error("Expected 2 arguments, but found "+(r.length-1)+" instead.");var l=a.parse(r[1],1,Gt),f=a.parse(r[2],2,Gt);return l&&f?ui(l.type,[zt,Xt,St,Jt,Gt])?new ou(l,f):a.error("Expected first argument to be of type boolean, string, number or null, but found "+We(l.type)+" instead"):null},ou.prototype.evaluate=function(r){var a=this.needle.evaluate(r),l=this.haystack.evaluate(r);if(!l)return!1;if(!Er(a,["boolean","string","number","null"]))throw new qi("Expected first argument to be of type boolean, string, number or null, but found "+We(li(a))+" instead.");if(!Er(l,["string","array"]))throw new qi("Expected second argument to be of type array or string, but found "+We(li(l))+" instead.");return l.indexOf(a)>=0},ou.prototype.eachChild=function(r){r(this.needle),r(this.haystack)},ou.prototype.outputDefined=function(){return!0},ou.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var vs=function(r,a,l){this.type=St,this.needle=r,this.haystack=a,this.fromIndex=l};vs.parse=function(r,a){if(r.length<=2||r.length>=5)return a.error("Expected 3 or 4 arguments, but found "+(r.length-1)+" instead.");var l=a.parse(r[1],1,Gt),f=a.parse(r[2],2,Gt);if(!l||!f)return null;if(!ui(l.type,[zt,Xt,St,Jt,Gt]))return a.error("Expected first argument to be of type boolean, string, number or null, but found "+We(l.type)+" instead");if(r.length===4){var g=a.parse(r[3],3,St);return g?new vs(l,f,g):null}return new vs(l,f)},vs.prototype.evaluate=function(r){var a=this.needle.evaluate(r),l=this.haystack.evaluate(r);if(!Er(a,["boolean","string","number","null"]))throw new qi("Expected first argument to be of type boolean, string, number or null, but found "+We(li(a))+" instead.");if(!Er(l,["string","array"]))throw new qi("Expected second argument to be of type array or string, but found "+We(li(l))+" instead.");if(this.fromIndex){var f=this.fromIndex.evaluate(r);return l.indexOf(a,f)}return l.indexOf(a)},vs.prototype.eachChild=function(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)},vs.prototype.outputDefined=function(){return!1},vs.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var au=function(r,a,l,f,g,m){this.inputType=r,this.type=a,this.input=l,this.cases=f,this.outputs=g,this.otherwise=m};au.parse=function(r,a){if(r.length<5)return a.error("Expected at least 4 arguments, but found only "+(r.length-1)+".");if(r.length%2!=1)return a.error("Expected an even number of arguments.");var l,f;a.expectedType&&a.expectedType.kind!=="value"&&(f=a.expectedType);for(var g={},m=[],x=2;x<r.length-1;x+=2){var E=r[x],C=r[x+1];Array.isArray(E)||(E=[E]);var P=a.concat(x);if(E.length===0)return P.error("Expected at least one branch label.");for(var M=0,A=E;M<A.length;M+=1){var F=A[M];if(typeof F!="number"&&typeof F!="string")return P.error("Branch labels must be numbers or strings.");if(typeof F=="number"&&Math.abs(F)>Number.MAX_SAFE_INTEGER)return P.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof F=="number"&&Math.floor(F)!==F)return P.error("Numeric branch labels must be integer values.");if(l){if(P.checkSubtype(l,li(F)))return null}else l=li(F);if(g[String(F)]!==void 0)return P.error("Branch labels must be unique.");g[String(F)]=m.length}var B=a.parse(C,x,f);if(!B)return null;f=f||B.type,m.push(B)}var X=a.parse(r[1],1,Gt);if(!X)return null;var Z=a.parse(r[r.length-1],r.length-1,f);return Z?X.type.kind!=="value"&&a.concat(1).checkSubtype(l,X.type)?null:new au(l,f,X,g,m,Z):null},au.prototype.evaluate=function(r){var a=this.input.evaluate(r);return(li(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(r)},au.prototype.eachChild=function(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)},au.prototype.outputDefined=function(){return this.outputs.every(function(r){return r.outputDefined()})&&this.otherwise.outputDefined()},au.prototype.serialize=function(){for(var r=this,a=["match",this.input.serialize()],l=[],f={},g=0,m=Object.keys(this.cases).sort();g<m.length;g+=1){var x=m[g];(A=f[this.cases[x]])===void 0?(f[this.cases[x]]=l.length,l.push([this.cases[x],[x]])):l[A][1].push(x)}for(var E=function(B){return r.inputType.kind==="number"?Number(B):B},C=0,P=l;C<P.length;C+=1){var M=P[C],A=M[0],F=M[1];a.push(F.length===1?E(F[0]):F.map(E)),a.push(this.outputs[outputIndex$1].serialize())}return a.push(this.otherwise.serialize()),a};var su=function(r,a,l){this.type=r,this.branches=a,this.otherwise=l};su.parse=function(r,a){if(r.length<4)return a.error("Expected at least 3 arguments, but found only "+(r.length-1)+".");if(r.length%2!=0)return a.error("Expected an odd number of arguments.");var l;a.expectedType&&a.expectedType.kind!=="value"&&(l=a.expectedType);for(var f=[],g=1;g<r.length-1;g+=2){var m=a.parse(r[g],g,zt);if(!m)return null;var x=a.parse(r[g+1],g+1,l);if(!x)return null;f.push([m,x]),l=l||x.type}var E=a.parse(r[r.length-1],r.length-1,l);return E?new su(l,f,E):null},su.prototype.evaluate=function(r){for(var a=0,l=this.branches;a<l.length;a+=1){var f=l[a],g=f[1];if(f[0].evaluate(r))return g.evaluate(r)}return this.otherwise.evaluate(r)},su.prototype.eachChild=function(r){for(var a=0,l=this.branches;a<l.length;a+=1){var f=l[a],g=f[1];r(f[0]),r(g)}r(this.otherwise)},su.prototype.outputDefined=function(){return this.branches.every(function(r){return r[1].outputDefined()})&&this.otherwise.outputDefined()},su.prototype.serialize=function(){var r=["case"];return this.eachChild(function(a){r.push(a.serialize())}),r};var xs=function(r,a,l,f){this.type=r,this.input=a,this.beginIndex=l,this.endIndex=f};function ud(r,a){return r==="=="||r==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function ld(r,a,l,f){return f.compare(a,l)===0}function Lr(r,a,l){var f=r!=="=="&&r!=="!=";return function(){function g(m,x,E){this.type=zt,this.lhs=m,this.rhs=x,this.collator=E,this.hasUntypedArgument=m.type.kind==="value"||x.type.kind==="value"}return g.parse=function(m,x){if(m.length!==3&&m.length!==4)return x.error("Expected two or three arguments.");var E=m[0],C=x.parse(m[1],1,Gt);if(!C)return null;if(!ud(E,C.type))return x.concat(1).error('"'+E+`" comparisons are not supported for type '`+We(C.type)+"'.");var P=x.parse(m[2],2,Gt);if(!P)return null;if(!ud(E,P.type))return x.concat(2).error('"'+E+`" comparisons are not supported for type '`+We(P.type)+"'.");if(C.type.kind!==P.type.kind&&C.type.kind!=="value"&&P.type.kind!=="value")return x.error("Cannot compare types '"+We(C.type)+"' and '"+We(P.type)+"'.");f&&(C.type.kind==="value"&&P.type.kind!=="value"?C=new Vr(P.type,[C]):C.type.kind!=="value"&&P.type.kind==="value"&&(P=new Vr(C.type,[P])));var M=null;if(m.length===4){if(C.type.kind!=="string"&&P.type.kind!=="string"&&C.type.kind!=="value"&&P.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(!(M=x.parse(m[3],3,Ze)))return null}return new g(C,P,M)},g.prototype.evaluate=function(m){var x=this.lhs.evaluate(m),E=this.rhs.evaluate(m);if(f&&this.hasUntypedArgument){var C=li(x),P=li(E);if(C.kind!==P.kind||C.kind!=="string"&&C.kind!=="number")throw new qi('Expected arguments for "'+r+'" to be (string, string) or (number, number), but found ('+C.kind+", "+P.kind+") instead.")}if(this.collator&&!f&&this.hasUntypedArgument){var M=li(x),A=li(E);if(M.kind!=="string"||A.kind!=="string")return a(m,x,E)}return this.collator?l(m,x,E,this.collator.evaluate(m)):a(m,x,E)},g.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},g.prototype.outputDefined=function(){return!0},g.prototype.serialize=function(){var m=[r];return this.eachChild(function(x){m.push(x.serialize())}),m},g}()}xs.parse=function(r,a){if(r.length<=2||r.length>=5)return a.error("Expected 3 or 4 arguments, but found "+(r.length-1)+" instead.");var l=a.parse(r[1],1,Gt),f=a.parse(r[2],2,St);if(!l||!f)return null;if(!ui(l.type,[sr(Gt),Xt,Gt]))return a.error("Expected first argument to be of type array or string, but found "+We(l.type)+" instead");if(r.length===4){var g=a.parse(r[3],3,St);return g?new xs(l.type,l,f,g):null}return new xs(l.type,l,f)},xs.prototype.evaluate=function(r){var a=this.input.evaluate(r),l=this.beginIndex.evaluate(r);if(!Er(a,["string","array"]))throw new qi("Expected first argument to be of type array or string, but found "+We(li(a))+" instead.");if(this.endIndex){var f=this.endIndex.evaluate(r);return a.slice(l,f)}return a.slice(l)},xs.prototype.eachChild=function(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)},xs.prototype.outputDefined=function(){return!1},xs.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var _y=Lr("==",function(r,a,l){return a===l},ld),Vc=Lr("!=",function(r,a,l){return a!==l},function(r,a,l,f){return!ld(0,a,l,f)}),cd=Lr("<",function(r,a,l){return a<l},function(r,a,l,f){return f.compare(a,l)<0}),hd=Lr(">",function(r,a,l){return a>l},function(r,a,l,f){return f.compare(a,l)>0}),pd=Lr("<=",function(r,a,l){return a<=l},function(r,a,l,f){return f.compare(a,l)<=0}),fd=Lr(">=",function(r,a,l){return a>=l},function(r,a,l,f){return f.compare(a,l)>=0}),uu=function(r,a,l,f,g){this.type=Xt,this.number=r,this.locale=a,this.currency=l,this.minFractionDigits=f,this.maxFractionDigits=g};uu.parse=function(r,a){if(r.length!==3)return a.error("Expected two arguments.");var l=a.parse(r[1],1,St);if(!l)return null;var f=r[2];if(typeof f!="object"||Array.isArray(f))return a.error("NumberFormat options argument must be an object.");var g=null;if(f.locale&&!(g=a.parse(f.locale,1,Xt)))return null;var m=null;if(f.currency&&!(m=a.parse(f.currency,1,Xt)))return null;var x=null;if(f["min-fraction-digits"]&&!(x=a.parse(f["min-fraction-digits"],1,St)))return null;var E=null;return f["max-fraction-digits"]&&!(E=a.parse(f["max-fraction-digits"],1,St))?null:new uu(l,g,m,x,E)},uu.prototype.evaluate=function(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))},uu.prototype.eachChild=function(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)},uu.prototype.outputDefined=function(){return!1},uu.prototype.serialize=function(){var r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]};var bs=function(r){this.type=St,this.input=r};bs.parse=function(r,a){if(r.length!==2)return a.error("Expected 1 argument, but found "+(r.length-1)+" instead.");var l=a.parse(r[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?a.error("Expected argument of type string or array, but found "+We(l.type)+" instead."):new bs(l):null},bs.prototype.evaluate=function(r){var a=this.input.evaluate(r);if(typeof a=="string"||Array.isArray(a))return a.length;throw new qi("Expected value to be of type string or array, but found "+We(li(a))+" instead.")},bs.prototype.eachChild=function(r){r(this.input)},bs.prototype.outputDefined=function(){return!1},bs.prototype.serialize=function(){var r=["length"];return this.eachChild(function(a){r.push(a.serialize())}),r};var lu={"==":_y,"!=":Vc,">":hd,"<":cd,">=":fd,"<=":pd,array:Vr,at:nu,boolean:Vr,case:su,coalesce:ms,collator:ya,format:Jo,image:ho,in:ou,"index-of":vs,interpolate:$i,"interpolate-hcl":$i,"interpolate-lab":$i,length:bs,let:_s,literal:xn,match:au,number:Vr,"number-format":uu,object:Vr,slice:xs,step:Kn,string:Vr,"to-boolean":Ao,"to-color":Ao,"to-number":Ao,"to-string":Ao,var:gs,within:Do};function dd(r,a){var l=a[0],f=a[1],g=a[2],m=a[3];l=l.evaluate(r),f=f.evaluate(r),g=g.evaluate(r);var x=m?m.evaluate(r):1,E=yp(l,f,g,x);if(E)throw new qi(E);return new ur(l/255*x,f/255*x,g/255*x,x)}function gd(r,a){return r in a}function Sp(r,a){var l=a[r];return l===void 0?null:l}function cu(r){return{type:r}}function yd(r){return{result:"success",value:r}}function hu(r){return{result:"error",value:r}}function pu(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function md(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Bl(r){return!!r.expression&&r.expression.interpolated}function Or(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Uc(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function vy(r){return r}function Xu(r,a,l){return r!==void 0?r:a!==void 0?a:l!==void 0?l:void 0}function _d(r,a,l,f,g){return Xu(typeof l===g?f[l]:void 0,r.default,a.default)}function xy(r,a,l){if(Or(l)!=="number")return Xu(r.default,a.default);var f=r.stops.length;if(f===1||l<=r.stops[0][0])return r.stops[0][1];if(l>=r.stops[f-1][0])return r.stops[f-1][1];var g=Bc(r.stops.map(function(m){return m[0]}),l);return r.stops[g][1]}function vd(r,a,l){var f=r.base!==void 0?r.base:1;if(Or(l)!=="number")return Xu(r.default,a.default);var g=r.stops.length;if(g===1||l<=r.stops[0][0])return r.stops[0][1];if(l>=r.stops[g-1][0])return r.stops[g-1][1];var m=Bc(r.stops.map(function(A){return A[0]}),l),x=function(A,F,B,X){var Z=X-B,it=A-B;return Z===0?0:F===1?it/Z:(Math.pow(F,it)-1)/(Math.pow(F,Z)-1)}(l,f,r.stops[m][0],r.stops[m+1][0]),E=r.stops[m][1],C=r.stops[m+1][1],P=Hu[a.type]||vy;if(r.colorSpace&&r.colorSpace!=="rgb"){var M=sd[r.colorSpace];P=function(A,F){return M.reverse(M.interpolate(M.forward(A),M.forward(F),x))}}return typeof E.evaluate=="function"?{evaluate:function(){for(var A=[],F=arguments.length;F--;)A[F]=arguments[F];var B=E.evaluate.apply(void 0,A),X=C.evaluate.apply(void 0,A);if(B!==void 0&&X!==void 0)return P(B,X,x)}}:P(E,C,x)}function qc(r,a,l){return a.type==="color"?l=ur.parse(l):a.type==="formatted"?l=Ui.fromString(l.toString()):a.type==="resolvedImage"?l=Vn.fromString(l.toString()):Or(l)===a.type||a.type==="enum"&&a.values[l]||(l=void 0),Xu(l,r.default,a.default)}Qi.register(lu,{error:[{kind:"error"},[Xt],function(r,a){throw new qi(a[0].evaluate(r))}],typeof:[Xt,[Gt],function(r,a){return We(li(a[0].evaluate(r)))}],"to-rgba":[sr(St,4),[Vt],function(r,a){return a[0].evaluate(r).toArray()}],rgb:[Vt,[St,St,St],dd],rgba:[Vt,[St,St,St,St],dd],has:{type:zt,overloads:[[[Xt],function(r,a){return gd(a[0].evaluate(r),r.properties())}],[[Xt,Ne],function(r,a){var l=a[1];return gd(a[0].evaluate(r),l.evaluate(r))}]]},get:{type:Gt,overloads:[[[Xt],function(r,a){return Sp(a[0].evaluate(r),r.properties())}],[[Xt,Ne],function(r,a){var l=a[1];return Sp(a[0].evaluate(r),l.evaluate(r))}]]},"feature-state":[Gt,[Xt],function(r,a){return Sp(a[0].evaluate(r),r.featureState||{})}],properties:[Ne,[],function(r){return r.properties()}],"geometry-type":[Xt,[],function(r){return r.geometryType()}],id:[Gt,[],function(r){return r.id()}],zoom:[St,[],function(r){return r.globals.zoom}],"heatmap-density":[St,[],function(r){return r.globals.heatmapDensity||0}],"line-progress":[St,[],function(r){return r.globals.lineProgress||0}],accumulated:[Gt,[],function(r){return r.globals.accumulated===void 0?null:r.globals.accumulated}],"+":[St,cu(St),function(r,a){for(var l=0,f=0,g=a;f<g.length;f+=1)l+=g[f].evaluate(r);return l}],"*":[St,cu(St),function(r,a){for(var l=1,f=0,g=a;f<g.length;f+=1)l*=g[f].evaluate(r);return l}],"-":{type:St,overloads:[[[St,St],function(r,a){var l=a[1];return a[0].evaluate(r)-l.evaluate(r)}],[[St],function(r,a){return-a[0].evaluate(r)}]]},"/":[St,[St,St],function(r,a){var l=a[1];return a[0].evaluate(r)/l.evaluate(r)}],"%":[St,[St,St],function(r,a){var l=a[1];return a[0].evaluate(r)%l.evaluate(r)}],ln2:[St,[],function(){return Math.LN2}],pi:[St,[],function(){return Math.PI}],e:[St,[],function(){return Math.E}],"^":[St,[St,St],function(r,a){var l=a[1];return Math.pow(a[0].evaluate(r),l.evaluate(r))}],sqrt:[St,[St],function(r,a){return Math.sqrt(a[0].evaluate(r))}],log10:[St,[St],function(r,a){return Math.log(a[0].evaluate(r))/Math.LN10}],ln:[St,[St],function(r,a){return Math.log(a[0].evaluate(r))}],log2:[St,[St],function(r,a){return Math.log(a[0].evaluate(r))/Math.LN2}],sin:[St,[St],function(r,a){return Math.sin(a[0].evaluate(r))}],cos:[St,[St],function(r,a){return Math.cos(a[0].evaluate(r))}],tan:[St,[St],function(r,a){return Math.tan(a[0].evaluate(r))}],asin:[St,[St],function(r,a){return Math.asin(a[0].evaluate(r))}],acos:[St,[St],function(r,a){return Math.acos(a[0].evaluate(r))}],atan:[St,[St],function(r,a){return Math.atan(a[0].evaluate(r))}],min:[St,cu(St),function(r,a){return Math.min.apply(Math,a.map(function(l){return l.evaluate(r)}))}],max:[St,cu(St),function(r,a){return Math.max.apply(Math,a.map(function(l){return l.evaluate(r)}))}],abs:[St,[St],function(r,a){return Math.abs(a[0].evaluate(r))}],round:[St,[St],function(r,a){var l=a[0].evaluate(r);return l<0?-Math.round(-l):Math.round(l)}],floor:[St,[St],function(r,a){return Math.floor(a[0].evaluate(r))}],ceil:[St,[St],function(r,a){return Math.ceil(a[0].evaluate(r))}],"filter-==":[zt,[Xt,Gt],function(r,a){var l=a[0],f=a[1];return r.properties()[l.value]===f.value}],"filter-id-==":[zt,[Gt],function(r,a){var l=a[0];return r.id()===l.value}],"filter-type-==":[zt,[Xt],function(r,a){var l=a[0];return r.geometryType()===l.value}],"filter-<":[zt,[Xt,Gt],function(r,a){var l=a[0],f=a[1],g=r.properties()[l.value],m=f.value;return typeof g==typeof m&&g<m}],"filter-id-<":[zt,[Gt],function(r,a){var l=a[0],f=r.id(),g=l.value;return typeof f==typeof g&&f<g}],"filter->":[zt,[Xt,Gt],function(r,a){var l=a[0],f=a[1],g=r.properties()[l.value],m=f.value;return typeof g==typeof m&&g>m}],"filter-id->":[zt,[Gt],function(r,a){var l=a[0],f=r.id(),g=l.value;return typeof f==typeof g&&f>g}],"filter-<=":[zt,[Xt,Gt],function(r,a){var l=a[0],f=a[1],g=r.properties()[l.value],m=f.value;return typeof g==typeof m&&g<=m}],"filter-id-<=":[zt,[Gt],function(r,a){var l=a[0],f=r.id(),g=l.value;return typeof f==typeof g&&f<=g}],"filter->=":[zt,[Xt,Gt],function(r,a){var l=a[0],f=a[1],g=r.properties()[l.value],m=f.value;return typeof g==typeof m&&g>=m}],"filter-id->=":[zt,[Gt],function(r,a){var l=a[0],f=r.id(),g=l.value;return typeof f==typeof g&&f>=g}],"filter-has":[zt,[Gt],function(r,a){return a[0].value in r.properties()}],"filter-has-id":[zt,[],function(r){return r.id()!==null&&r.id()!==void 0}],"filter-type-in":[zt,[sr(Xt)],function(r,a){return a[0].value.indexOf(r.geometryType())>=0}],"filter-id-in":[zt,[sr(Gt)],function(r,a){return a[0].value.indexOf(r.id())>=0}],"filter-in-small":[zt,[Xt,sr(Gt)],function(r,a){var l=a[0];return a[1].value.indexOf(r.properties()[l.value])>=0}],"filter-in-large":[zt,[Xt,sr(Gt)],function(r,a){var l=a[0],f=a[1];return function(g,m,x,E){for(;x<=E;){var C=x+E>>1;if(m[C]===g)return!0;m[C]>g?E=C-1:x=C+1}return!1}(r.properties()[l.value],f.value,0,f.value.length-1)}],all:{type:zt,overloads:[[[zt,zt],function(r,a){var l=a[1];return a[0].evaluate(r)&&l.evaluate(r)}],[cu(zt),function(r,a){for(var l=0,f=a;l<f.length;l+=1)if(!f[l].evaluate(r))return!1;return!0}]]},any:{type:zt,overloads:[[[zt,zt],function(r,a){var l=a[1];return a[0].evaluate(r)||l.evaluate(r)}],[cu(zt),function(r,a){for(var l=0,f=a;l<f.length;l+=1)if(f[l].evaluate(r))return!0;return!1}]]},"!":[zt,[zt],function(r,a){return!a[0].evaluate(r)}],"is-supported-script":[zt,[Xt],function(r,a){var l=r.globals&&r.globals.isSupportedScript;return!l||l(a[0].evaluate(r))}],upcase:[Xt,[Xt],function(r,a){return a[0].evaluate(r).toUpperCase()}],downcase:[Xt,[Xt],function(r,a){return a[0].evaluate(r).toLowerCase()}],concat:[Xt,cu(Gt),function(r,a){return a.map(function(l){return Nl(l.evaluate(r))}).join("")}],"resolved-locale":[Xt,[Ze],function(r,a){return a[0].evaluate(r).resolvedLocale()}]});var Zu=function(r,a){this.expression=r,this._warningHistory={},this._evaluator=new ja,this._defaultValue=a?function(l){return l.type==="color"&&Uc(l.default)?new ur(0,0,0,0):l.type==="color"?ur.parse(l.default)||null:l.default===void 0?null:l.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null};function Vl(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in lu}function jc(r,a){var l=new ys(lu,[],a?function(g){var m={color:Vt,string:Xt,number:St,enum:Xt,boolean:zt,formatted:Cr,resolvedImage:Ve};return g.type==="array"?sr(m[g.value]||Gt,g.length):m[g.type]}(a):void 0),f=l.parse(r,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?yd(new Zu(f,a)):hu(l.errors)}Zu.prototype.evaluateWithoutErrorHandling=function(r,a,l,f,g,m){return this._evaluator.globals=r,this._evaluator.feature=a,this._evaluator.featureState=l,this._evaluator.canonical=f,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},Zu.prototype.evaluate=function(r,a,l,f,g,m){this._evaluator.globals=r,this._evaluator.feature=a||null,this._evaluator.featureState=l||null,this._evaluator.canonical=f,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=m||null;try{var x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new qi("Expected value to be one of "+Object.keys(this._enumValues).map(function(E){return JSON.stringify(E)}).join(", ")+", but found "+JSON.stringify(x)+" instead.");return x}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console!="undefined"&&console.warn(E.message)),this._defaultValue}};var Ul=function(r,a){this.kind=r,this._styleExpression=a,this.isStateDependent=r!=="constant"&&!ds(a.expression)};Ul.prototype.evaluateWithoutErrorHandling=function(r,a,l,f,g,m){return this._styleExpression.evaluateWithoutErrorHandling(r,a,l,f,g,m)},Ul.prototype.evaluate=function(r,a,l,f,g,m){return this._styleExpression.evaluate(r,a,l,f,g,m)};var Yu=function(r,a,l,f){this.kind=r,this.zoomStops=l,this._styleExpression=a,this.isStateDependent=r!=="camera"&&!ds(a.expression),this.interpolationType=f};function xd(r,a){if((r=jc(r,a)).result==="error")return r;var l=r.value.expression,f=fs(l);if(!f&&!pu(a))return hu([new Mt("","data expressions not supported")]);var g=iu(l,["zoom"]);if(!g&&!md(a))return hu([new Mt("","zoom expressions not supported")]);var m=function x(E){var C=null;if(E instanceof _s)C=x(E.result);else if(E instanceof ms)for(var P=0,M=E.args;P<M.length&&!(C=x(M[P]));P+=1);else(E instanceof Kn||E instanceof $i)&&E.input instanceof Qi&&E.input.name==="zoom"&&(C=E);return C instanceof Mt||E.eachChild(function(A){var F=x(A);F instanceof Mt?C=F:!C&&F?C=new Mt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):C&&F&&C!==F&&(C=new Mt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),C}(l);return m||g?m instanceof Mt?hu([m]):m instanceof $i&&!Bl(a)?hu([new Mt("",'"interpolate" expressions cannot be used with this property')]):yd(m?new Yu(f?"camera":"composite",r.value,m.labels,m instanceof $i?m.interpolation:void 0):new Ul(f?"constant":"source",r.value)):hu([new Mt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Yu.prototype.evaluateWithoutErrorHandling=function(r,a,l,f,g,m){return this._styleExpression.evaluateWithoutErrorHandling(r,a,l,f,g,m)},Yu.prototype.evaluate=function(r,a,l,f,g,m){return this._styleExpression.evaluate(r,a,l,f,g,m)},Yu.prototype.interpolationFactor=function(r,a,l){return this.interpolationType?$i.interpolationFactor(this.interpolationType,r,a,l):0};var Wu=function(r,a){this._parameters=r,this._specification=a,Tt(this,function l(f,g){var m,x,E,C=g.type==="color",P=f.stops&&typeof f.stops[0][0]=="object",M=P||!(P||f.property!==void 0),A=f.type||(Bl(g)?"exponential":"interval");if(C&&((f=Tt({},f)).stops&&(f.stops=f.stops.map(function(jt){return[jt[0],ur.parse(jt[1])]})),f.default=ur.parse(f.default?f.default:g.default)),f.colorSpace&&f.colorSpace!=="rgb"&&!sd[f.colorSpace])throw new Error("Unknown color space: "+f.colorSpace);if(A==="exponential")m=vd;else if(A==="interval")m=xy;else if(A==="categorical"){m=_d,x=Object.create(null);for(var F=0,B=f.stops;F<B.length;F+=1){var X=B[F];x[X[0]]=X[1]}E=typeof f.stops[0][0]}else{if(A!=="identity")throw new Error('Unknown function type "'+A+'"');m=qc}if(P){for(var Z={},it=[],$=0;$<f.stops.length;$++){var lt=f.stops[$],pt=lt[0].zoom;Z[pt]===void 0&&(Z[pt]={zoom:pt,type:f.type,property:f.property,default:f.default,stops:[]},it.push(pt)),Z[pt].stops.push([lt[0].value,lt[1]])}for(var gt=[],_t=0,It=it;_t<It.length;_t+=1){var Dt=It[_t];gt.push([Z[Dt].zoom,l(Z[Dt],g)])}var Rt={name:"linear"};return{kind:"composite",interpolationType:Rt,interpolationFactor:$i.interpolationFactor.bind(void 0,Rt),zoomStops:gt.map(function(jt){return jt[0]}),evaluate:function(jt,le){var Ht=jt.zoom;return vd({stops:gt,base:f.base},g,Ht).evaluate(Ht,le)}}}if(M){var oe=A==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:oe,interpolationFactor:$i.interpolationFactor.bind(void 0,oe),zoomStops:f.stops.map(function(jt){return jt[0]}),evaluate:function(jt){return m(f,g,jt.zoom,x,E)}}}return{kind:"source",evaluate:function(jt,le){var Ht=le&&le.properties?le.properties[f.property]:void 0;return Ht===void 0?Xu(f.default,g.default):m(f,g,Ht,x,E)}}}(this._parameters,this._specification))};function Qo(r){var a=r.key,l=r.value,f=r.valueSpec||{},g=r.objectElementValidators||{},m=r.style,x=r.styleSpec,E=[],C=Or(l);if(C!=="object")return[new J(a,l,"object expected, "+C+" found")];for(var P in l){var M=P.split(".")[0],A=f[M]||f["*"],F=void 0;if(g[M])F=g[M];else if(f[M])F=Ye;else if(g["*"])F=g["*"];else{if(!f["*"]){E.push(new J(a,l[P],'unknown property "'+P+'"'));continue}F=Ye}E=E.concat(F({key:(a&&a+".")+P,value:l[P],valueSpec:A,style:m,styleSpec:x,object:l,objectKey:P},l))}for(var B in f)g[B]||f[B].required&&f[B].default===void 0&&l[B]===void 0&&E.push(new J(a,l,'missing required property "'+B+'"'));return E}function bd(r){var a=r.value,l=r.valueSpec,f=r.style,g=r.styleSpec,m=r.key,x=r.arrayElementValidator||Ye;if(Or(a)!=="array")return[new J(m,a,"array expected, "+Or(a)+" found")];if(l.length&&a.length!==l.length)return[new J(m,a,"array length "+l.length+" expected, length "+a.length+" found")];if(l["min-length"]&&a.length<l["min-length"])return[new J(m,a,"array length at least "+l["min-length"]+" expected, length "+a.length+" found")];var E={type:l.value,values:l.values};g.$version<7&&(E.function=l.function),Or(l.value)==="object"&&(E=l.value);for(var C=[],P=0;P<a.length;P++)C=C.concat(x({array:a,arrayIndex:P,value:a[P],valueSpec:E,style:f,styleSpec:g,key:m+"["+P+"]"}));return C}function wd(r){var a=r.key,l=r.value,f=r.valueSpec,g=Or(l);return g==="number"&&l!=l&&(g="NaN"),g!=="number"?[new J(a,l,"number expected, "+g+" found")]:"minimum"in f&&l<f.minimum?[new J(a,l,l+" is less than the minimum value "+f.minimum)]:"maximum"in f&&l>f.maximum?[new J(a,l,l+" is greater than the maximum value "+f.maximum)]:[]}function Ed(r){var a,l,f,g=r.valueSpec,m=At(r.value.type),x={},E=m!=="categorical"&&r.value.property===void 0,C=!E,P=Or(r.value.stops)==="array"&&Or(r.value.stops[0])==="array"&&Or(r.value.stops[0][0])==="object",M=Qo({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(B){if(m==="identity")return[new J(B.key,B.value,'identity function may not have a "stops" property')];var X=[],Z=B.value;return X=X.concat(bd({key:B.key,value:Z,valueSpec:B.valueSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:A})),Or(Z)==="array"&&Z.length===0&&X.push(new J(B.key,Z,"array must have at least one stop")),X},default:function(B){return Ye({key:B.key,value:B.value,valueSpec:g,style:B.style,styleSpec:B.styleSpec})}}});return m==="identity"&&E&&M.push(new J(r.key,r.value,'missing required property "property"')),m==="identity"||r.value.stops||M.push(new J(r.key,r.value,'missing required property "stops"')),m==="exponential"&&r.valueSpec.expression&&!Bl(r.valueSpec)&&M.push(new J(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(C&&!pu(r.valueSpec)?M.push(new J(r.key,r.value,"property functions not supported")):E&&!md(r.valueSpec)&&M.push(new J(r.key,r.value,"zoom functions not supported"))),m!=="categorical"&&!P||r.value.property!==void 0||M.push(new J(r.key,r.value,'"property" property is required')),M;function A(B){var X=[],Z=B.value,it=B.key;if(Or(Z)!=="array")return[new J(it,Z,"array expected, "+Or(Z)+" found")];if(Z.length!==2)return[new J(it,Z,"array length 2 expected, length "+Z.length+" found")];if(P){if(Or(Z[0])!=="object")return[new J(it,Z,"object expected, "+Or(Z[0])+" found")];if(Z[0].zoom===void 0)return[new J(it,Z,"object stop key must have zoom")];if(Z[0].value===void 0)return[new J(it,Z,"object stop key must have value")];if(f&&f>At(Z[0].zoom))return[new J(it,Z[0].zoom,"stop zoom values must appear in ascending order")];At(Z[0].zoom)!==f&&(f=At(Z[0].zoom),l=void 0,x={}),X=X.concat(Qo({key:it+"[0]",value:Z[0],valueSpec:{zoom:{}},style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:wd,value:F}}))}else X=X.concat(F({key:it+"[0]",value:Z[0],valueSpec:{},style:B.style,styleSpec:B.styleSpec},Z));return Vl(wt(Z[1]))?X.concat([new J(it+"[1]",Z[1],"expressions are not allowed in function stops.")]):X.concat(Ye({key:it+"[1]",value:Z[1],valueSpec:g,style:B.style,styleSpec:B.styleSpec}))}function F(B,X){var Z=Or(B.value),it=At(B.value),$=B.value!==null?B.value:X;if(a){if(Z!==a)return[new J(B.key,$,Z+" stop domain type must match previous stop domain type "+a)]}else a=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean")return[new J(B.key,$,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&m!=="categorical"){var lt="number expected, "+Z+" found";return pu(g)&&m===void 0&&(lt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new J(B.key,$,lt)]}return m!=="categorical"||Z!=="number"||isFinite(it)&&Math.floor(it)===it?m!=="categorical"&&Z==="number"&&l!==void 0&&it<l?[new J(B.key,$,"stop domain values must appear in ascending order")]:(l=it,m==="categorical"&&it in x?[new J(B.key,$,"stop domain values must be unique")]:(x[it]=!0,[])):[new J(B.key,$,"integer expected, found "+it)]}}function fu(r){var a=(r.expressionContext==="property"?xd:jc)(wt(r.value),r.valueSpec);if(a.result==="error")return a.value.map(function(f){return new J(""+r.key+f.key,r.value,f.message)});var l=a.value.expression||a.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!l.outputDefined())return[new J(r.key,r.value,'Invalid data expression for "'+r.propertyKey+'". Output values must be contained as literals within the expression.')];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!ds(l))return[new J(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!ds(l))return[new J(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!iu(l,["zoom","feature-state"]))return[new J(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!fs(l))return[new J(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ql(r){var a=r.key,l=r.value,f=r.valueSpec,g=[];return Array.isArray(f.values)?f.values.indexOf(At(l))===-1&&g.push(new J(a,l,"expected one of ["+f.values.join(", ")+"], "+JSON.stringify(l)+" found")):Object.keys(f.values).indexOf(At(l))===-1&&g.push(new J(a,l,"expected one of ["+Object.keys(f.values).join(", ")+"], "+JSON.stringify(l)+" found")),g}function Gc(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(var a=0,l=r.slice(1);a<l.length;a+=1){var f=l[a];if(!Gc(f)&&typeof f!="boolean")return!1}return!0;default:return!0}}Wu.deserialize=function(r){return new Wu(r._parameters,r._specification)},Wu.serialize=function(r){return{_parameters:r._parameters,_specification:r._specification}};var Ip={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Hc(r){if(r==null)return{filter:function(){return!0},needGeometry:!1};Gc(r)||(r=Xc(r));var a=jc(r,Ip);if(a.result==="error")throw new Error(a.value.map(function(l){return l.key+": "+l.message}).join(", "));return{filter:function(l,f,g){return a.value.evaluate(l,f,{},g)},needGeometry:function l(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(var g=1;g<f.length;g++)if(l(f[g]))return!0;return!1}(r)}}function by(r,a){return r<a?-1:r>a?1:0}function Xc(r){if(!r)return!0;var a,l=r[0];return r.length<=1?l!=="any":l==="=="?Cp(r[1],r[2],"=="):l==="!="?Zc(Cp(r[1],r[2],"==")):l==="<"||l===">"||l==="<="||l===">="?Cp(r[1],r[2],l):l==="any"?(a=r.slice(1),["any"].concat(a.map(Xc))):l==="all"?["all"].concat(r.slice(1).map(Xc)):l==="none"?["all"].concat(r.slice(1).map(Xc).map(Zc)):l==="in"?Sd(r[1],r.slice(2)):l==="!in"?Zc(Sd(r[1],r.slice(2))):l==="has"?Id(r[1]):l==="!has"?Zc(Id(r[1])):l!=="within"||r}function Cp(r,a,l){switch(r){case"$type":return["filter-type-"+l,a];case"$id":return["filter-id-"+l,a];default:return["filter-"+l,r,a]}}function Sd(r,a){if(a.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(function(l){return typeof l!=typeof a[0]})?["filter-in-large",r,["literal",a.sort(by)]]:["filter-in-small",r,["literal",a]]}}function Id(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Zc(r){return["!",r]}function Lp(r){return Gc(wt(r.value))?fu(Tt({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function a(l){var f=l.value,g=l.key;if(Or(f)!=="array")return[new J(g,f,"array expected, "+Or(f)+" found")];var m,x=l.styleSpec,E=[];if(f.length<1)return[new J(g,f,"filter array must have at least 1 element")];switch(E=E.concat(ql({key:g+"[0]",value:f[0],valueSpec:x.filter_operator,style:l.style,styleSpec:l.styleSpec})),At(f[0])){case"<":case"<=":case">":case">=":f.length>=2&&At(f[1])==="$type"&&E.push(new J(g,f,'"$type" cannot be use with operator "'+f[0]+'"'));case"==":case"!=":f.length!==3&&E.push(new J(g,f,'filter array for operator "'+f[0]+'" must have 3 elements'));case"in":case"!in":f.length>=2&&(m=Or(f[1]))!=="string"&&E.push(new J(g+"[1]",f[1],"string expected, "+m+" found"));for(var C=2;C<f.length;C++)m=Or(f[C]),At(f[1])==="$type"?E=E.concat(ql({key:g+"["+C+"]",value:f[C],valueSpec:x.geometry_type,style:l.style,styleSpec:l.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&E.push(new J(g+"["+C+"]",f[C],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var P=1;P<f.length;P++)E=E.concat(a({key:g+"["+P+"]",value:f[P],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":m=Or(f[1]),f.length!==2?E.push(new J(g,f,'filter array for "'+f[0]+'" operator must have 2 elements')):m!=="string"&&E.push(new J(g+"[1]",f[1],"string expected, "+m+" found"));break;case"within":m=Or(f[1]),f.length!==2?E.push(new J(g,f,'filter array for "'+f[0]+'" operator must have 2 elements')):m!=="object"&&E.push(new J(g+"[1]",f[1],"object expected, "+m+" found"))}return E}(r)}function Pp(r,a){var l=r.key,f=r.style,g=r.styleSpec,m=r.value,x=r.objectKey,E=g[a+"_"+r.layerType];if(!E)return[];var C=x.match(/^(.*)-transition$/);if(a==="paint"&&C&&E[C[1]]&&E[C[1]].transition)return Ye({key:l,value:m,valueSpec:g.transition,style:f,styleSpec:g});var P,M=r.valueSpec||E[x];if(!M)return[new J(l,m,'unknown property "'+x+'"')];if(Or(m)==="string"&&pu(M)&&!M.tokens&&(P=/^{([^}]+)}$/.exec(m)))return[new J(l,m,'"'+x+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(P[1])+" }`.")];var A=[];return r.layerType==="symbol"&&(x==="text-field"&&f&&!f.glyphs&&A.push(new J(l,m,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&Uc(wt(m))&&At(m.type)==="identity"&&A.push(new J(l,m,'"text-font" does not support identity functions'))),A.concat(Ye({key:r.key,value:m,valueSpec:M,style:f,styleSpec:g,expressionContext:"property",propertyType:a,propertyKey:x}))}function Tp(r){return Pp(r,"paint")}function jl(r){return Pp(r,"layout")}function Cd(r){var a=[],l=r.value,f=r.key,g=r.style,m=r.styleSpec;l.type||l.ref||a.push(new J(f,l,'either "type" or "ref" is required'));var x,E=At(l.type),C=At(l.ref);if(l.id)for(var P=At(l.id),M=0;M<r.arrayIndex;M++){var A=g.layers[M];At(A.id)===P&&a.push(new J(f,l.id,'duplicate layer id "'+l.id+'", previously used at line '+A.id.__line__))}if("ref"in l)["type","source","source-layer","filter","layout"].forEach(function(X){X in l&&a.push(new J(f,l[X],'"'+X+'" is prohibited for ref layers'))}),g.layers.forEach(function(X){At(X.id)===C&&(x=X)}),x?x.ref?a.push(new J(f,l.ref,"ref cannot reference another ref layer")):E=At(x.type):a.push(new J(f,l.ref,'ref layer "'+C+'" not found'));else if(E!=="background")if(l.source){var F=g.sources&&g.sources[l.source],B=F&&At(F.type);F?B==="vector"&&E==="raster"?a.push(new J(f,l.source,'layer "'+l.id+'" requires a raster source')):B==="raster"&&E!=="raster"?a.push(new J(f,l.source,'layer "'+l.id+'" requires a vector source')):B!=="vector"||l["source-layer"]?B==="raster-dem"&&E!=="hillshade"?a.push(new J(f,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!l.paint||!l.paint["line-gradient"]||B==="geojson"&&F.lineMetrics||a.push(new J(f,l,'layer "'+l.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):a.push(new J(f,l,'layer "'+l.id+'" must specify a "source-layer"')):a.push(new J(f,l.source,'source "'+l.source+'" not found'))}else a.push(new J(f,l,'missing required property "source"'));return a=a.concat(Qo({key:f,value:l,valueSpec:m.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ye({key:f+".type",value:l.type,valueSpec:m.layer.type,style:r.style,styleSpec:r.styleSpec,object:l,objectKey:"type"})},filter:Lp,layout:function(X){return Qo({layer:l,key:X.key,value:X.value,style:X.style,styleSpec:X.styleSpec,objectElementValidators:{"*":function(Z){return jl(Tt({layerType:E},Z))}}})},paint:function(X){return Qo({layer:l,key:X.key,value:X.value,style:X.style,styleSpec:X.styleSpec,objectElementValidators:{"*":function(Z){return Tp(Tt({layerType:E},Z))}}})}}}))}function du(r){var a=r.value,l=r.key,f=Or(a);return f!=="string"?[new J(l,a,"string expected, "+f+" found")]:[]}var Ur={promoteId:function(r){var a=r.key,l=r.value;if(Or(l)==="string")return du({key:a,value:l});var f=[];for(var g in l)f.push.apply(f,du({key:a+"."+g,value:l[g]}));return f}};function Yc(r){var a=r.value,l=r.key,f=r.styleSpec,g=r.style;if(!a.type)return[new J(l,a,'"type" is required')];var m,x=At(a.type);switch(x){case"vector":case"raster":case"raster-dem":return Qo({key:l,value:a,valueSpec:f["source_"+x.replace("-","_")],style:r.style,styleSpec:f,objectElementValidators:Ur});case"geojson":if(m=Qo({key:l,value:a,valueSpec:f.source_geojson,style:g,styleSpec:f,objectElementValidators:Ur}),a.cluster)for(var E in a.clusterProperties){var C=a.clusterProperties[E],P=C[0],M=typeof P=="string"?[P,["accumulated"],["get",E]]:P;m.push.apply(m,fu({key:l+"."+E+".map",value:C[1],expressionContext:"cluster-map"})),m.push.apply(m,fu({key:l+"."+E+".reduce",value:M,expressionContext:"cluster-reduce"}))}return m;case"video":return Qo({key:l,value:a,valueSpec:f.source_video,style:g,styleSpec:f});case"image":return Qo({key:l,value:a,valueSpec:f.source_image,style:g,styleSpec:f});case"canvas":return[new J(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ql({key:l+".type",value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,styleSpec:f})}}function gu(r){var a=r.value,l=r.styleSpec,f=l.light,g=r.style,m=[],x=Or(a);if(a===void 0)return m;if(x!=="object")return m.concat([new J("light",a,"object expected, "+x+" found")]);for(var E in a){var C=E.match(/^(.*)-transition$/);m=m.concat(C&&f[C[1]]&&f[C[1]].transition?Ye({key:E,value:a[E],valueSpec:l.transition,style:g,styleSpec:l}):f[E]?Ye({key:E,value:a[E],valueSpec:f[E],style:g,styleSpec:l}):[new J(E,a[E],'unknown property "'+E+'"')])}return m}var ws={"*":function(){return[]},array:bd,boolean:function(r){var a=r.value,l=r.key,f=Or(a);return f!=="boolean"?[new J(l,a,"boolean expected, "+f+" found")]:[]},number:wd,color:function(r){var a=r.key,l=r.value,f=Or(l);return f!=="string"?[new J(a,l,"color expected, "+f+" found")]:Ge(l)===null?[new J(a,l,'color expected, "'+l+'" found')]:[]},constants:ht,enum:ql,filter:Lp,function:Ed,layer:Cd,object:Qo,source:Yc,light:gu,string:du,formatted:function(r){return du(r).length===0?[]:fu(r)},resolvedImage:function(r){return du(r).length===0?[]:fu(r)}};function Ye(r){var a=r.value,l=r.valueSpec,f=r.styleSpec;return l.expression&&Uc(At(a))?Ed(r):l.expression&&Vl(wt(a))?fu(r):l.type&&ws[l.type]?ws[l.type](r):Qo(Tt({},r,{valueSpec:l.type?f[l.type]:l}))}function kr(r){var a=r.value,l=r.key,f=du(r);return f.length||(a.indexOf("{fontstack}")===-1&&f.push(new J(l,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&f.push(new J(l,a,'"glyphs" url must include a "{range}" token'))),f}function po(r,a){a===void 0&&(a=U);var l=[];return l=l.concat(Ye({key:"",value:r,valueSpec:a.$root,styleSpec:a,style:r,objectElementValidators:{glyphs:kr,"*":function(){return[]}}})),r.constants&&(l=l.concat(ht({key:"constants",value:r.constants,style:r,styleSpec:a}))),Gl(l)}function Gl(r){return[].concat(r).sort(function(a,l){return a.line-l.line})}function Ku(r){return function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];return Gl(r.apply(this,a))}}po.source=Ku(Yc),po.light=Ku(gu),po.layer=Ku(Cd),po.filter=Ku(Lp),po.paintProperty=Ku(Tp),po.layoutProperty=Ku(jl);var Hl=po,wy=Hl.light,Ey=Hl.paintProperty,Xl=Hl.layoutProperty;function Zl(r,a){var l=!1;if(a&&a.length)for(var f=0,g=a;f<g.length;f+=1)r.fire(new ot(new Error(g[f].message))),l=!0;return l}var Ga=Pi;function Pi(r,a,l){var f=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var g=new Int32Array(this.arrayBuffer);r=g[0],this.d=(a=g[1])+2*(l=g[2]);for(var m=0;m<this.d*this.d;m++){var x=g[3+m],E=g[3+m+1];f.push(x===E?null:g.subarray(x,E))}var C=g[3+f.length+1];this.keys=g.subarray(g[3+f.length],C),this.bboxes=g.subarray(C),this.insert=this._insertReadonly}else{this.d=a+2*l;for(var P=0;P<this.d*this.d;P++)f.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=r,this.padding=l,this.scale=a/r,this.uid=0;var M=l/a*r;this.min=-M,this.max=r+M}Pi.prototype.insert=function(r,a,l,f,g){this._forEachCell(a,l,f,g,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(a),this.bboxes.push(l),this.bboxes.push(f),this.bboxes.push(g)},Pi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Pi.prototype._insertCell=function(r,a,l,f,g,m){this.cells[g].push(m)},Pi.prototype.query=function(r,a,l,f,g){var m=this.min,x=this.max;if(r<=m&&a<=m&&x<=l&&x<=f&&!g)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(r,a,l,f,this._queryCell,E,{},g),E},Pi.prototype._queryCell=function(r,a,l,f,g,m,x,E){var C=this.cells[g];if(C!==null)for(var P=this.keys,M=this.bboxes,A=0;A<C.length;A++){var F=C[A];if(x[F]===void 0){var B=4*F;(E?E(M[B+0],M[B+1],M[B+2],M[B+3]):r<=M[B+2]&&a<=M[B+3]&&l>=M[B+0]&&f>=M[B+1])?(x[F]=!0,m.push(P[F])):x[F]=!1}}},Pi.prototype._forEachCell=function(r,a,l,f,g,m,x,E){for(var C=this._convertToCellCoord(r),P=this._convertToCellCoord(a),M=this._convertToCellCoord(l),A=this._convertToCellCoord(f),F=C;F<=M;F++)for(var B=P;B<=A;B++){var X=this.d*B+F;if((!E||E(this._convertFromCellCoord(F),this._convertFromCellCoord(B),this._convertFromCellCoord(F+1),this._convertFromCellCoord(B+1)))&&g.call(this,r,a,l,f,X,m,x,E))return}},Pi.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},Pi.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},Pi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,a=3+this.cells.length+1+1,l=0,f=0;f<this.cells.length;f++)l+=this.cells[f].length;var g=new Int32Array(a+l+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var m=a,x=0;x<r.length;x++){var E=r[x];g[3+x]=m,g.set(E,m),m+=E.length}return g[3+r.length]=m,g.set(this.keys,m),g[3+r.length+1]=m+=this.keys.length,g.set(this.bboxes,m),m+=this.bboxes.length,g.buffer};var Yl=N.ImageData,Ld=N.ImageBitmap,bi={};function Qt(r,a,l){l===void 0&&(l={}),Object.defineProperty(a,"_classRegistryKey",{value:r,writeable:!1}),bi[r]={klass:a,omit:l.omit||[],shallow:l.shallow||[]}}for(var Jn in Qt("Object",Object),Ga.serialize=function(r,a){var l=r.toArrayBuffer();return a&&a.push(l),{buffer:l}},Ga.deserialize=function(r){return new Ga(r.buffer)},Qt("Grid",Ga),Qt("Color",ur),Qt("Error",Error),Qt("ResolvedImage",Vn),Qt("StylePropertyFunction",Wu),Qt("StyleExpression",Zu,{omit:["_evaluator"]}),Qt("ZoomDependentExpression",Yu),Qt("ZoomConstantExpression",Ul),Qt("CompoundExpression",Qi,{omit:["_evaluate"]}),lu)lu[Jn]._classRegistryKey||Qt("Expression_"+Jn,lu[Jn]);function Wc(r){return r&&typeof ArrayBuffer!="undefined"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Ju(r){return Ld&&r instanceof Ld}function $o(r,a){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(Wc(r)||Ju(r))return a&&a.push(r),r;if(ArrayBuffer.isView(r)){var l=r;return a&&a.push(l.buffer),l}if(r instanceof Yl)return a&&a.push(r.data.buffer),r;if(Array.isArray(r)){for(var f=[],g=0,m=r;g<m.length;g+=1)f.push($o(m[g],a));return f}if(typeof r=="object"){var x=r.constructor,E=x._classRegistryKey;if(!E)throw new Error("can't serialize object of unregistered class");var C=x.serialize?x.serialize(r,a):{};if(!x.serialize){for(var P in r)if(r.hasOwnProperty(P)&&!(bi[E].omit.indexOf(P)>=0)){var M=r[P];C[P]=bi[E].shallow.indexOf(P)>=0?M:$o(M,a)}r instanceof Error&&(C.message=r.message)}if(C.$name)throw new Error("$name property is reserved for worker serialization logic.");return E!=="Object"&&(C.$name=E),C}throw new Error("can't serialize object of type "+typeof r)}function Qn(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||Wc(r)||Ju(r)||ArrayBuffer.isView(r)||r instanceof Yl)return r;if(Array.isArray(r))return r.map(Qn);if(typeof r=="object"){var a=r.$name||"Object",l=bi[a].klass;if(!l)throw new Error("can't deserialize unregistered class "+a);if(l.deserialize)return l.deserialize(r);for(var f=Object.create(l.prototype),g=0,m=Object.keys(r);g<m.length;g+=1){var x=m[g];if(x!=="$name"){var E=r[x];f[x]=bi[a].shallow.indexOf(x)>=0?E:Qn(E)}}return f}throw new Error("can't deserialize object of type "+typeof r)}var Mp=function(){this.first=!0};Mp.prototype.update=function(r,a){var l=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=a),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=l,!0))};var Bt={"Latin-1 Supplement":function(r){return r>=128&&r<=255},Arabic:function(r){return r>=1536&&r<=1791},"Arabic Supplement":function(r){return r>=1872&&r<=1919},"Arabic Extended-A":function(r){return r>=2208&&r<=2303},"Hangul Jamo":function(r){return r>=4352&&r<=4607},"Unified Canadian Aboriginal Syllabics":function(r){return r>=5120&&r<=5759},Khmer:function(r){return r>=6016&&r<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(r){return r>=6320&&r<=6399},"General Punctuation":function(r){return r>=8192&&r<=8303},"Letterlike Symbols":function(r){return r>=8448&&r<=8527},"Number Forms":function(r){return r>=8528&&r<=8591},"Miscellaneous Technical":function(r){return r>=8960&&r<=9215},"Control Pictures":function(r){return r>=9216&&r<=9279},"Optical Character Recognition":function(r){return r>=9280&&r<=9311},"Enclosed Alphanumerics":function(r){return r>=9312&&r<=9471},"Geometric Shapes":function(r){return r>=9632&&r<=9727},"Miscellaneous Symbols":function(r){return r>=9728&&r<=9983},"Miscellaneous Symbols and Arrows":function(r){return r>=11008&&r<=11263},"CJK Radicals Supplement":function(r){return r>=11904&&r<=12031},"Kangxi Radicals":function(r){return r>=12032&&r<=12255},"Ideographic Description Characters":function(r){return r>=12272&&r<=12287},"CJK Symbols and Punctuation":function(r){return r>=12288&&r<=12351},Hiragana:function(r){return r>=12352&&r<=12447},Katakana:function(r){return r>=12448&&r<=12543},Bopomofo:function(r){return r>=12544&&r<=12591},"Hangul Compatibility Jamo":function(r){return r>=12592&&r<=12687},Kanbun:function(r){return r>=12688&&r<=12703},"Bopomofo Extended":function(r){return r>=12704&&r<=12735},"CJK Strokes":function(r){return r>=12736&&r<=12783},"Katakana Phonetic Extensions":function(r){return r>=12784&&r<=12799},"Enclosed CJK Letters and Months":function(r){return r>=12800&&r<=13055},"CJK Compatibility":function(r){return r>=13056&&r<=13311},"CJK Unified Ideographs Extension A":function(r){return r>=13312&&r<=19903},"Yijing Hexagram Symbols":function(r){return r>=19904&&r<=19967},"CJK Unified Ideographs":function(r){return r>=19968&&r<=40959},"Yi Syllables":function(r){return r>=40960&&r<=42127},"Yi Radicals":function(r){return r>=42128&&r<=42191},"Hangul Jamo Extended-A":function(r){return r>=43360&&r<=43391},"Hangul Syllables":function(r){return r>=44032&&r<=55215},"Hangul Jamo Extended-B":function(r){return r>=55216&&r<=55295},"Private Use Area":function(r){return r>=57344&&r<=63743},"CJK Compatibility Ideographs":function(r){return r>=63744&&r<=64255},"Arabic Presentation Forms-A":function(r){return r>=64336&&r<=65023},"Vertical Forms":function(r){return r>=65040&&r<=65055},"CJK Compatibility Forms":function(r){return r>=65072&&r<=65103},"Small Form Variants":function(r){return r>=65104&&r<=65135},"Arabic Presentation Forms-B":function(r){return r>=65136&&r<=65279},"Halfwidth and Fullwidth Forms":function(r){return r>=65280&&r<=65519}};function Ap(r){for(var a=0,l=r;a<l.length;a+=1)if(Kc(l[a].charCodeAt(0)))return!0;return!1}function Kc(r){return!(r!==746&&r!==747&&(r<4352||!(Bt["Bopomofo Extended"](r)||Bt.Bopomofo(r)||Bt["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||Bt["CJK Compatibility Ideographs"](r)||Bt["CJK Compatibility"](r)||Bt["CJK Radicals Supplement"](r)||Bt["CJK Strokes"](r)||!(!Bt["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Bt["CJK Unified Ideographs Extension A"](r)||Bt["CJK Unified Ideographs"](r)||Bt["Enclosed CJK Letters and Months"](r)||Bt["Hangul Compatibility Jamo"](r)||Bt["Hangul Jamo Extended-A"](r)||Bt["Hangul Jamo Extended-B"](r)||Bt["Hangul Jamo"](r)||Bt["Hangul Syllables"](r)||Bt.Hiragana(r)||Bt["Ideographic Description Characters"](r)||Bt.Kanbun(r)||Bt["Kangxi Radicals"](r)||Bt["Katakana Phonetic Extensions"](r)||Bt.Katakana(r)&&r!==12540||!(!Bt["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!Bt["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||Bt["Unified Canadian Aboriginal Syllabics"](r)||Bt["Unified Canadian Aboriginal Syllabics Extended"](r)||Bt["Vertical Forms"](r)||Bt["Yijing Hexagram Symbols"](r)||Bt["Yi Syllables"](r)||Bt["Yi Radicals"](r))))}function Dp(r){return!(Kc(r)||function(a){return!!(Bt["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||Bt["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||Bt["Letterlike Symbols"](a)||Bt["Number Forms"](a)||Bt["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||Bt["Control Pictures"](a)&&a!==9251||Bt["Optical Character Recognition"](a)||Bt["Enclosed Alphanumerics"](a)||Bt["Geometric Shapes"](a)||Bt["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||Bt["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||Bt["CJK Symbols and Punctuation"](a)||Bt.Katakana(a)||Bt["Private Use Area"](a)||Bt["CJK Compatibility Forms"](a)||Bt["Small Form Variants"](a)||Bt["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(r))}function Oo(r){return r>=1424&&r<=2303||Bt["Arabic Presentation Forms-A"](r)||Bt["Arabic Presentation Forms-B"](r)}function $n(r,a){return!(!a&&Oo(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||Bt.Khmer(r))}function Jc(r){for(var a=0,l=r;a<l.length;a+=1)if(Oo(l[a].charCodeAt(0)))return!0;return!1}var Qc=null,to="unavailable",Ha=null,Pd=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(to="error"),Qc&&Qc(r)};function Wl(){Op.fire(new W("pluginStateChange",{pluginStatus:to,pluginURL:Ha}))}var Op=new st,kp=function(){return to},ta=function(){if(to!=="deferred"||!Ha)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");to="loading",Wl(),Ha&&Dl({url:Ha},function(r){r?Pd(r):(to="loaded",Wl())})},fo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return to==="loaded"||fo.applyArabicShaping!=null},isLoading:function(){return to==="loading"},setState:function(r){to=r.pluginStatus,Ha=r.pluginURL},isParsed:function(){return fo.applyArabicShaping!=null&&fo.processBidirectionalText!=null&&fo.processStyledBidirectionalText!=null},getPluginURL:function(){return Ha}},Ue=function(r,a){this.zoom=r,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Mp,this.transition={})};Ue.prototype.isSupportedScript=function(r){return function(a,l){for(var f=0,g=a;f<g.length;f+=1)if(!$n(g[f].charCodeAt(0),l))return!1;return!0}(r,fo.isLoaded())},Ue.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Ue.prototype.getCrossfadeParameters=function(){var r=this.zoom,a=r-Math.floor(r),l=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*a}};var ma=function(r,a){this.property=r,this.value=a,this.expression=function(l,f){if(Uc(l))return new Wu(l,f);if(Vl(l)){var g=xd(l,f);if(g.result==="error")throw new Error(g.value.map(function(x){return x.key+": "+x.message}).join(", "));return g.value}var m=l;return typeof l=="string"&&f.type==="color"&&(m=ur.parse(l)),{kind:"constant",evaluate:function(){return m}}}(a===void 0?r.specification.default:a,r.specification)};ma.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},ma.prototype.possiblyEvaluate=function(r,a,l){return this.property.possiblyEvaluate(this,r,a,l)};var ko=function(r){this.property=r,this.value=new ma(r,void 0)};ko.prototype.transitioned=function(r,a){return new yu(this.property,this.value,a,ut({},r.transition,this.transition),r.now)},ko.prototype.untransitioned=function(){return new yu(this.property,this.value,null,{},0)};var tn=function(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)};tn.prototype.getValue=function(r){return Ce(this._values[r].value.value)},tn.prototype.setValue=function(r,a){this._values.hasOwnProperty(r)||(this._values[r]=new ko(this._values[r].property)),this._values[r].value=new ma(this._values[r].property,a===null?void 0:Ce(a))},tn.prototype.getTransition=function(r){return Ce(this._values[r].transition)},tn.prototype.setTransition=function(r,a){this._values.hasOwnProperty(r)||(this._values[r]=new ko(this._values[r].property)),this._values[r].transition=Ce(a)||void 0},tn.prototype.serialize=function(){for(var r={},a=0,l=Object.keys(this._values);a<l.length;a+=1){var f=l[a],g=this.getValue(f);g!==void 0&&(r[f]=g);var m=this.getTransition(f);m!==void 0&&(r[f+"-transition"]=m)}return r},tn.prototype.transitioned=function(r,a){for(var l=new Es(this._properties),f=0,g=Object.keys(this._values);f<g.length;f+=1){var m=g[f];l._values[m]=this._values[m].transitioned(r,a._values[m])}return l},tn.prototype.untransitioned=function(){for(var r=new Es(this._properties),a=0,l=Object.keys(this._values);a<l.length;a+=1){var f=l[a];r._values[f]=this._values[f].untransitioned()}return r};var yu=function(r,a,l,f,g){this.property=r,this.value=a,this.begin=g+f.delay||0,this.end=this.begin+f.duration||0,r.specification.transition&&(f.delay||f.duration)&&(this.prior=l)};yu.prototype.possiblyEvaluate=function(r,a,l){var f=r.now||0,g=this.value.possiblyEvaluate(r,a,l),m=this.prior;if(m){if(f>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(f<this.begin)return m.possiblyEvaluate(r,a,l);var x=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(r,a,l),g,function(E){if(E<=0)return 0;if(E>=1)return 1;var C=E*E,P=C*E;return 4*(E<.5?P:3*(E-C)+P-.75)}(x))}return g};var Es=function(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)};Es.prototype.possiblyEvaluate=function(r,a,l){for(var f=new Kl(this._properties),g=0,m=Object.keys(this._values);g<m.length;g+=1){var x=m[g];f._values[x]=this._values[x].possiblyEvaluate(r,a,l)}return f},Es.prototype.hasTransition=function(){for(var r=0,a=Object.keys(this._values);r<a.length;r+=1)if(this._values[a[r]].prior)return!0;return!1};var ea=function(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)};ea.prototype.getValue=function(r){return Ce(this._values[r].value)},ea.prototype.setValue=function(r,a){this._values[r]=new ma(this._values[r].property,a===null?void 0:Ce(a))},ea.prototype.serialize=function(){for(var r={},a=0,l=Object.keys(this._values);a<l.length;a+=1){var f=l[a],g=this.getValue(f);g!==void 0&&(r[f]=g)}return r},ea.prototype.possiblyEvaluate=function(r,a,l){for(var f=new Kl(this._properties),g=0,m=Object.keys(this._values);g<m.length;g+=1){var x=m[g];f._values[x]=this._values[x].possiblyEvaluate(r,a,l)}return f};var wn=function(r,a,l){this.property=r,this.value=a,this.parameters=l};wn.prototype.isConstant=function(){return this.value.kind==="constant"},wn.prototype.constantOr=function(r){return this.value.kind==="constant"?this.value.value:r},wn.prototype.evaluate=function(r,a,l,f){return this.property.evaluate(this.value,this.parameters,r,a,l,f)};var Kl=function(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)};Kl.prototype.get=function(r){return this._values[r]};var se=function(r){this.specification=r};se.prototype.possiblyEvaluate=function(r,a){return r.expression.evaluate(a)},se.prototype.interpolate=function(r,a,l){var f=Hu[this.specification.type];return f?f(r,a,l):r};var ee=function(r,a){this.specification=r,this.overrides=a};ee.prototype.possiblyEvaluate=function(r,a,l,f){return new wn(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(a,null,{},l,f)}:r.expression,a)},ee.prototype.interpolate=function(r,a,l){if(r.value.kind!=="constant"||a.value.kind!=="constant")return r;if(r.value.value===void 0||a.value.value===void 0)return new wn(this,{kind:"constant",value:void 0},r.parameters);var f=Hu[this.specification.type];return f?new wn(this,{kind:"constant",value:f(r.value.value,a.value.value,l)},r.parameters):r},ee.prototype.evaluate=function(r,a,l,f,g,m){return r.kind==="constant"?r.value:r.evaluate(a,l,f,g,m)};var $c=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.possiblyEvaluate=function(l,f,g,m){if(l.value===void 0)return new wn(this,{kind:"constant",value:void 0},f);if(l.expression.kind==="constant"){var x=l.expression.evaluate(f,null,{},g,m),E=l.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,C=this._calculate(E,E,E,f);return new wn(this,{kind:"constant",value:C},f)}if(l.expression.kind==="camera"){var P=this._calculate(l.expression.evaluate({zoom:f.zoom-1}),l.expression.evaluate({zoom:f.zoom}),l.expression.evaluate({zoom:f.zoom+1}),f);return new wn(this,{kind:"constant",value:P},f)}return new wn(this,l.expression,f)},a.prototype.evaluate=function(l,f,g,m,x,E){if(l.kind==="source"){var C=l.evaluate(f,g,m,x,E);return this._calculate(C,C,C,f)}return l.kind==="composite"?this._calculate(l.evaluate({zoom:Math.floor(f.zoom)-1},g,m),l.evaluate({zoom:Math.floor(f.zoom)},g,m),l.evaluate({zoom:Math.floor(f.zoom)+1},g,m),f):l.value},a.prototype._calculate=function(l,f,g,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:l,to:f}:{from:g,to:f}},a.prototype.interpolate=function(l){return l},a}(ee),En=function(r){this.specification=r};En.prototype.possiblyEvaluate=function(r,a,l,f){if(r.value!==void 0){if(r.expression.kind==="constant"){var g=r.expression.evaluate(a,null,{},l,f);return this._calculate(g,g,g,a)}return this._calculate(r.expression.evaluate(new Ue(Math.floor(a.zoom-1),a)),r.expression.evaluate(new Ue(Math.floor(a.zoom),a)),r.expression.evaluate(new Ue(Math.floor(a.zoom+1),a)),a)}},En.prototype._calculate=function(r,a,l,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:r,to:a}:{from:l,to:a}},En.prototype.interpolate=function(r){return r};var ra=function(r){this.specification=r};ra.prototype.possiblyEvaluate=function(r,a,l,f){return!!r.expression.evaluate(a,null,{},l,f)},ra.prototype.interpolate=function(){return!1};var en=function(r){for(var a in this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],r){var l=r[a];l.specification.overridable&&this.overridableProperties.push(a);var f=this.defaultPropertyValues[a]=new ma(l,void 0),g=this.defaultTransitionablePropertyValues[a]=new ko(l);this.defaultTransitioningPropertyValues[a]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=f.possiblyEvaluate({})}};Qt("DataDrivenProperty",ee),Qt("DataConstantProperty",se),Qt("CrossFadedDataDrivenProperty",$c),Qt("CrossFadedProperty",En),Qt("ColorRampProperty",ra);var _a=function(r){function a(l,f){if(r.call(this),this.id=l.id,this.type=l.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},l.type!=="custom"&&(this.metadata=(l=l).metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter),f.layout&&(this._unevaluatedLayout=new ea(f.layout)),f.paint)){for(var g in this._transitionablePaint=new tn(f.paint),l.paint)this.setPaintProperty(g,l.paint[g],{validate:!1});for(var m in l.layout)this.setLayoutProperty(m,l.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Kl(f.paint)}}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},a.prototype.getLayoutProperty=function(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)},a.prototype.setLayoutProperty=function(l,f,g){g===void 0&&(g={}),f!=null&&this._validate(Xl,"layers."+this.id+".layout."+l,l,f,g)||(l!=="visibility"?this._unevaluatedLayout.setValue(l,f):this.visibility=f)},a.prototype.getPaintProperty=function(l){return de(l,"-transition")?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)},a.prototype.setPaintProperty=function(l,f,g){if(g===void 0&&(g={}),f!=null&&this._validate(Ey,"layers."+this.id+".paint."+l,l,f,g))return!1;if(de(l,"-transition"))return this._transitionablePaint.setTransition(l.slice(0,-11),f||void 0),!1;var m=this._transitionablePaint._values[l],x=m.property.specification["property-type"]==="cross-faded-data-driven",E=m.value.isDataDriven(),C=m.value;this._transitionablePaint.setValue(l,f),this._handleSpecialPaintPropertyUpdate(l);var P=this._transitionablePaint._values[l].value;return P.isDataDriven()||E||x||this._handleOverridablePaintPropertyUpdate(l,C,P)},a.prototype._handleSpecialPaintPropertyUpdate=function(l){},a.prototype._handleOverridablePaintPropertyUpdate=function(l,f,g){return!1},a.prototype.isHidden=function(l){return!!(this.minzoom&&l<this.minzoom)||!!(this.maxzoom&&l>=this.maxzoom)||this.visibility==="none"},a.prototype.updateTransitions=function(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)},a.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},a.prototype.recalculate=function(l,f){l.getCrossfadeParameters&&(this._crossfadeParameters=l.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,f)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,f)},a.prototype.serialize=function(){var l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),Be(l,function(f,g){return!(f===void 0||g==="layout"&&!Object.keys(f).length||g==="paint"&&!Object.keys(f).length)})},a.prototype._validate=function(l,f,g,m,x){return x===void 0&&(x={}),(!x||x.validate!==!1)&&Zl(this,l.call(Hl,{key:f,layerType:this.type,objectKey:g,value:m,styleSpec:U,style:{glyphs:!0,sprite:!0}}))},a.prototype.is3D=function(){return!1},a.prototype.isTileClipped=function(){return!1},a.prototype.hasOffscreenPass=function(){return!1},a.prototype.resize=function(){},a.prototype.isStateDependent=function(){for(var l in this.paint._values){var f=this.paint.get(l);if(f instanceof wn&&pu(f.property.specification)&&(f.value.kind==="source"||f.value.kind==="composite")&&f.value.isStateDependent)return!0}return!1},a}(st),Np={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},th=function(r,a){this._structArray=r,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},gr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function ji(r,a){a===void 0&&(a=1);var l=0,f=0;return{members:r.map(function(g){var m=Np[g.type].BYTES_PER_ELEMENT,x=l=Td(l,Math.max(a,m)),E=g.components||1;return f=Math.max(f,m),l+=m*E,{name:g.name,type:g.type,components:E,offset:x}}),size:Td(l,Math.max(f,a)),alignment:a}}function Td(r,a){return Math.ceil(r/a)*a}gr.serialize=function(r,a){return r._trim(),a&&(r.isTransferred=!0,a.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}},gr.deserialize=function(r){var a=Object.create(this.prototype);return a.arrayBuffer=r.arrayBuffer,a.length=r.length,a.capacity=r.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a},gr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},gr.prototype.clear=function(){this.length=0},gr.prototype.resize=function(r){this.reserve(r),this.length=r},gr.prototype.reserve=function(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}},gr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var mu=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f){var g=this.length;return this.resize(g+1),this.emplace(g,l,f)},a.prototype.emplace=function(l,f,g){var m=2*l;return this.int16[m+0]=f,this.int16[m+1]=g,l},a}(gr);mu.prototype.bytesPerElement=4,Qt("StructArrayLayout2i4",mu);var Rp=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g,m){var x=this.length;return this.resize(x+1),this.emplace(x,l,f,g,m)},a.prototype.emplace=function(l,f,g,m,x){var E=4*l;return this.int16[E+0]=f,this.int16[E+1]=g,this.int16[E+2]=m,this.int16[E+3]=x,l},a}(gr);Rp.prototype.bytesPerElement=8,Qt("StructArrayLayout4i8",Rp);var Xa=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g,m,x,E){var C=this.length;return this.resize(C+1),this.emplace(C,l,f,g,m,x,E)},a.prototype.emplace=function(l,f,g,m,x,E,C){var P=6*l;return this.int16[P+0]=f,this.int16[P+1]=g,this.int16[P+2]=m,this.int16[P+3]=x,this.int16[P+4]=E,this.int16[P+5]=C,l},a}(gr);Xa.prototype.bytesPerElement=12,Qt("StructArrayLayout2i4i12",Xa);var eo=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g,m,x,E){var C=this.length;return this.resize(C+1),this.emplace(C,l,f,g,m,x,E)},a.prototype.emplace=function(l,f,g,m,x,E,C){var P=4*l,M=8*l;return this.int16[P+0]=f,this.int16[P+1]=g,this.uint8[M+4]=m,this.uint8[M+5]=x,this.uint8[M+6]=E,this.uint8[M+7]=C,l},a}(gr);eo.prototype.bytesPerElement=8,Qt("StructArrayLayout2i4ub8",eo);var Qu=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f){var g=this.length;return this.resize(g+1),this.emplace(g,l,f)},a.prototype.emplace=function(l,f,g){var m=2*l;return this.float32[m+0]=f,this.float32[m+1]=g,l},a}(gr);Qu.prototype.bytesPerElement=8,Qt("StructArrayLayout2f8",Qu);var va=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g,m,x,E,C,P,M,A){var F=this.length;return this.resize(F+1),this.emplace(F,l,f,g,m,x,E,C,P,M,A)},a.prototype.emplace=function(l,f,g,m,x,E,C,P,M,A,F){var B=10*l;return this.uint16[B+0]=f,this.uint16[B+1]=g,this.uint16[B+2]=m,this.uint16[B+3]=x,this.uint16[B+4]=E,this.uint16[B+5]=C,this.uint16[B+6]=P,this.uint16[B+7]=M,this.uint16[B+8]=A,this.uint16[B+9]=F,l},a}(gr);va.prototype.bytesPerElement=20,Qt("StructArrayLayout10ui20",va);var eh=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g,m,x,E,C,P,M,A,F,B){var X=this.length;return this.resize(X+1),this.emplace(X,l,f,g,m,x,E,C,P,M,A,F,B)},a.prototype.emplace=function(l,f,g,m,x,E,C,P,M,A,F,B,X){var Z=12*l;return this.int16[Z+0]=f,this.int16[Z+1]=g,this.int16[Z+2]=m,this.int16[Z+3]=x,this.uint16[Z+4]=E,this.uint16[Z+5]=C,this.uint16[Z+6]=P,this.uint16[Z+7]=M,this.int16[Z+8]=A,this.int16[Z+9]=F,this.int16[Z+10]=B,this.int16[Z+11]=X,l},a}(gr);eh.prototype.bytesPerElement=24,Qt("StructArrayLayout4i4ui4i24",eh);var $u=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g){var m=this.length;return this.resize(m+1),this.emplace(m,l,f,g)},a.prototype.emplace=function(l,f,g,m){var x=3*l;return this.float32[x+0]=f,this.float32[x+1]=g,this.float32[x+2]=m,l},a}(gr);$u.prototype.bytesPerElement=12,Qt("StructArrayLayout3f12",$u);var Jl=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l){var f=this.length;return this.resize(f+1),this.emplace(f,l)},a.prototype.emplace=function(l,f){return this.uint32[1*l+0]=f,l},a}(gr);Jl.prototype.bytesPerElement=4,Qt("StructArrayLayout1ul4",Jl);var Fp=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g,m,x,E,C,P,M){var A=this.length;return this.resize(A+1),this.emplace(A,l,f,g,m,x,E,C,P,M)},a.prototype.emplace=function(l,f,g,m,x,E,C,P,M,A){var F=10*l,B=5*l;return this.int16[F+0]=f,this.int16[F+1]=g,this.int16[F+2]=m,this.int16[F+3]=x,this.int16[F+4]=E,this.int16[F+5]=C,this.uint32[B+3]=P,this.uint16[F+8]=M,this.uint16[F+9]=A,l},a}(gr);Fp.prototype.bytesPerElement=20,Qt("StructArrayLayout6i1ul2ui20",Fp);var tl=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g,m,x,E){var C=this.length;return this.resize(C+1),this.emplace(C,l,f,g,m,x,E)},a.prototype.emplace=function(l,f,g,m,x,E,C){var P=6*l;return this.int16[P+0]=f,this.int16[P+1]=g,this.int16[P+2]=m,this.int16[P+3]=x,this.int16[P+4]=E,this.int16[P+5]=C,l},a}(gr);tl.prototype.bytesPerElement=12,Qt("StructArrayLayout2i2i2i12",tl);var _u=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g,m,x){var E=this.length;return this.resize(E+1),this.emplace(E,l,f,g,m,x)},a.prototype.emplace=function(l,f,g,m,x,E){var C=4*l,P=8*l;return this.float32[C+0]=f,this.float32[C+1]=g,this.float32[C+2]=m,this.int16[P+6]=x,this.int16[P+7]=E,l},a}(gr);_u.prototype.bytesPerElement=16,Qt("StructArrayLayout2f1f2i16",_u);var zp=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g,m){var x=this.length;return this.resize(x+1),this.emplace(x,l,f,g,m)},a.prototype.emplace=function(l,f,g,m,x){var E=12*l,C=3*l;return this.uint8[E+0]=f,this.uint8[E+1]=g,this.float32[C+1]=m,this.float32[C+2]=x,l},a}(gr);zp.prototype.bytesPerElement=12,Qt("StructArrayLayout2ub2f12",zp);var Ss=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g){var m=this.length;return this.resize(m+1),this.emplace(m,l,f,g)},a.prototype.emplace=function(l,f,g,m){var x=3*l;return this.uint16[x+0]=f,this.uint16[x+1]=g,this.uint16[x+2]=m,l},a}(gr);Ss.prototype.bytesPerElement=6,Qt("StructArrayLayout3ui6",Ss);var Is=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g,m,x,E,C,P,M,A,F,B,X,Z,it,$,lt){var pt=this.length;return this.resize(pt+1),this.emplace(pt,l,f,g,m,x,E,C,P,M,A,F,B,X,Z,it,$,lt)},a.prototype.emplace=function(l,f,g,m,x,E,C,P,M,A,F,B,X,Z,it,$,lt,pt){var gt=24*l,_t=12*l,It=48*l;return this.int16[gt+0]=f,this.int16[gt+1]=g,this.uint16[gt+2]=m,this.uint16[gt+3]=x,this.uint32[_t+2]=E,this.uint32[_t+3]=C,this.uint32[_t+4]=P,this.uint16[gt+10]=M,this.uint16[gt+11]=A,this.uint16[gt+12]=F,this.float32[_t+7]=B,this.float32[_t+8]=X,this.uint8[It+36]=Z,this.uint8[It+37]=it,this.uint8[It+38]=$,this.uint32[_t+10]=lt,this.int16[gt+22]=pt,l},a}(gr);Is.prototype.bytesPerElement=48,Qt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Is);var rh=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g,m,x,E,C,P,M,A,F,B,X,Z,it,$,lt,pt,gt,_t,It,Dt,Rt,oe,jt,le,Ht,Oe){var _e=this.length;return this.resize(_e+1),this.emplace(_e,l,f,g,m,x,E,C,P,M,A,F,B,X,Z,it,$,lt,pt,gt,_t,It,Dt,Rt,oe,jt,le,Ht,Oe)},a.prototype.emplace=function(l,f,g,m,x,E,C,P,M,A,F,B,X,Z,it,$,lt,pt,gt,_t,It,Dt,Rt,oe,jt,le,Ht,Oe,_e){var re=34*l,ze=17*l;return this.int16[re+0]=f,this.int16[re+1]=g,this.int16[re+2]=m,this.int16[re+3]=x,this.int16[re+4]=E,this.int16[re+5]=C,this.int16[re+6]=P,this.int16[re+7]=M,this.uint16[re+8]=A,this.uint16[re+9]=F,this.uint16[re+10]=B,this.uint16[re+11]=X,this.uint16[re+12]=Z,this.uint16[re+13]=it,this.uint16[re+14]=$,this.uint16[re+15]=lt,this.uint16[re+16]=pt,this.uint16[re+17]=gt,this.uint16[re+18]=_t,this.uint16[re+19]=It,this.uint16[re+20]=Dt,this.uint16[re+21]=Rt,this.uint16[re+22]=oe,this.uint32[ze+12]=jt,this.float32[ze+13]=le,this.float32[ze+14]=Ht,this.float32[ze+15]=Oe,this.float32[ze+16]=_e,l},a}(gr);rh.prototype.bytesPerElement=68,Qt("StructArrayLayout8i15ui1ul4f68",rh);var Cs=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l){var f=this.length;return this.resize(f+1),this.emplace(f,l)},a.prototype.emplace=function(l,f){return this.float32[1*l+0]=f,l},a}(gr);Cs.prototype.bytesPerElement=4,Qt("StructArrayLayout1f4",Cs);var No=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g){var m=this.length;return this.resize(m+1),this.emplace(m,l,f,g)},a.prototype.emplace=function(l,f,g,m){var x=3*l;return this.int16[x+0]=f,this.int16[x+1]=g,this.int16[x+2]=m,l},a}(gr);No.prototype.bytesPerElement=6,Qt("StructArrayLayout3i6",No);var Bp=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g){var m=this.length;return this.resize(m+1),this.emplace(m,l,f,g)},a.prototype.emplace=function(l,f,g,m){var x=4*l;return this.uint32[2*l+0]=f,this.uint16[x+2]=g,this.uint16[x+3]=m,l},a}(gr);Bp.prototype.bytesPerElement=8,Qt("StructArrayLayout1ul2ui8",Bp);var Ql=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f){var g=this.length;return this.resize(g+1),this.emplace(g,l,f)},a.prototype.emplace=function(l,f,g){var m=2*l;return this.uint16[m+0]=f,this.uint16[m+1]=g,l},a}(gr);Ql.prototype.bytesPerElement=4,Qt("StructArrayLayout2ui4",Ql);var Vp=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l){var f=this.length;return this.resize(f+1),this.emplace(f,l)},a.prototype.emplace=function(l,f){return this.uint16[1*l+0]=f,l},a}(gr);Vp.prototype.bytesPerElement=2,Qt("StructArrayLayout1ui2",Vp);var ih=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(l,f,g,m){var x=this.length;return this.resize(x+1),this.emplace(x,l,f,g,m)},a.prototype.emplace=function(l,f,g,m,x){var E=4*l;return this.float32[E+0]=f,this.float32[E+1]=g,this.float32[E+2]=m,this.float32[E+3]=x,l},a}(gr);ih.prototype.bytesPerElement=16,Qt("StructArrayLayout4f16",ih);var c=function(r){function a(){r.apply(this,arguments)}r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a;var l={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return l.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},l.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},l.x1.get=function(){return this._structArray.int16[this._pos2+2]},l.y1.get=function(){return this._structArray.int16[this._pos2+3]},l.x2.get=function(){return this._structArray.int16[this._pos2+4]},l.y2.get=function(){return this._structArray.int16[this._pos2+5]},l.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},l.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},l.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},l.anchorPoint.get=function(){return new L(this.anchorPointX,this.anchorPointY)},Object.defineProperties(a.prototype,l),a}(th);c.prototype.size=20;var p=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.get=function(l){return new c(this,l)},a}(Fp);Qt("CollisionBoxArray",p);var h=function(r){function a(){r.apply(this,arguments)}r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a;var l={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return l.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},l.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},l.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},l.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},l.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},l.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},l.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},l.segment.get=function(){return this._structArray.uint16[this._pos2+10]},l.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},l.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},l.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},l.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},l.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},l.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},l.placedOrientation.set=function(f){this._structArray.uint8[this._pos1+37]=f},l.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},l.hidden.set=function(f){this._structArray.uint8[this._pos1+38]=f},l.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},l.crossTileID.set=function(f){this._structArray.uint32[this._pos4+10]=f},l.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(a.prototype,l),a}(th);h.prototype.size=48;var d=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.get=function(l){return new h(this,l)},a}(Is);Qt("PlacedSymbolArray",d);var _=function(r){function a(){r.apply(this,arguments)}r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a;var l={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return l.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},l.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},l.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},l.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},l.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},l.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},l.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},l.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},l.key.get=function(){return this._structArray.uint16[this._pos2+8]},l.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},l.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},l.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},l.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},l.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},l.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},l.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},l.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},l.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},l.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},l.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},l.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},l.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},l.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},l.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},l.crossTileID.set=function(f){this._structArray.uint32[this._pos4+12]=f},l.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},l.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},l.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},l.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(a.prototype,l),a}(th);_.prototype.size=68;var b=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.get=function(l){return new _(this,l)},a}(rh);Qt("SymbolInstanceArray",b);var w=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.getoffsetX=function(l){return this.float32[1*l+0]},a}(Cs);Qt("GlyphOffsetArray",w);var I=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.getx=function(l){return this.int16[3*l+0]},a.prototype.gety=function(l){return this.int16[3*l+1]},a.prototype.gettileUnitDistanceFromAnchor=function(l){return this.int16[3*l+2]},a}(No);Qt("SymbolLineVertexArray",I);var T=function(r){function a(){r.apply(this,arguments)}r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a;var l={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return l.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},l.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},l.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(a.prototype,l),a}(th);T.prototype.size=8;var O=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.get=function(l){return new T(this,l)},a}(Bp);Qt("FeatureIndexArray",O);var V=ji([{name:"a_pos",components:2,type:"Int16"}],4).members,q=function(r){r===void 0&&(r=[]),this.segments=r};function j(r,a){return 256*(r=mt(Math.floor(r),0,255))+mt(Math.floor(a),0,255)}q.prototype.prepareSegment=function(r,a,l,f){var g=this.segments[this.segments.length-1];return r>q.MAX_VERTEX_ARRAY_LENGTH&&Le("Max vertices per segment is "+q.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+r),(!g||g.vertexLength+r>q.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==f)&&(g={vertexOffset:a.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},f!==void 0&&(g.sortKey=f),this.segments.push(g)),g},q.prototype.get=function(){return this.segments},q.prototype.destroy=function(){for(var r=0,a=this.segments;r<a.length;r+=1){var l=a[r];for(var f in l.vaos)l.vaos[f].destroy()}},q.simpleSegment=function(r,a,l,f){return new q([{vertexOffset:r,primitiveOffset:a,vertexLength:l,primitiveLength:f,vaos:{},sortKey:0}])},q.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Qt("SegmentVector",q);var K=ji([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Y=y(function(r){r.exports=function(a,l){var f,g,m,x,E,C,P,M;for(g=a.length-(f=3&a.length),m=l,E=3432918353,C=461845907,M=0;M<g;)P=255&a.charCodeAt(M)|(255&a.charCodeAt(++M))<<8|(255&a.charCodeAt(++M))<<16|(255&a.charCodeAt(++M))<<24,++M,m=27492+(65535&(x=5*(65535&(m=(m^=P=(65535&(P=(P=(65535&P)*E+(((P>>>16)*E&65535)<<16)&4294967295)<<15|P>>>17))*C+(((P>>>16)*C&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(P=0,f){case 3:P^=(255&a.charCodeAt(M+2))<<16;case 2:P^=(255&a.charCodeAt(M+1))<<8;case 1:m^=P=(65535&(P=(P=(65535&(P^=255&a.charCodeAt(M)))*E+(((P>>>16)*E&65535)<<16)&4294967295)<<15|P>>>17))*C+(((P>>>16)*C&65535)<<16)&4294967295}return m^=a.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),rt=y(function(r){r.exports=function(a,l){for(var f,g=a.length,m=l^g,x=0;g>=4;)f=1540483477*(65535&(f=255&a.charCodeAt(x)|(255&a.charCodeAt(++x))<<8|(255&a.charCodeAt(++x))<<16|(255&a.charCodeAt(++x))<<24))+((1540483477*(f>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),g-=4,++x;switch(g){case 3:m^=(255&a.charCodeAt(x+2))<<16;case 2:m^=(255&a.charCodeAt(x+1))<<8;case 1:m=1540483477*(65535&(m^=255&a.charCodeAt(x)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),H=Y,et=rt;H.murmur3=Y,H.murmur2=et;var at=function(){this.ids=[],this.positions=[],this.indexed=!1};at.prototype.add=function(r,a,l,f){this.ids.push(vt(r)),this.positions.push(a,l,f)},at.prototype.getPositions=function(r){for(var a=vt(r),l=0,f=this.ids.length-1;l<f;){var g=l+f>>1;this.ids[g]>=a?f=g:l=g+1}for(var m=[];this.ids[l]===a;)m.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return m},at.serialize=function(r,a){var l=new Float64Array(r.ids),f=new Uint32Array(r.positions);return function g(m,x,E,C){for(;E<C;){for(var P=m[E+C>>1],M=E-1,A=C+1;;){do M++;while(m[M]<P);do A--;while(m[A]>P);if(M>=A)break;yt(m,M,A),yt(x,3*M,3*A),yt(x,3*M+1,3*A+1),yt(x,3*M+2,3*A+2)}A-E<C-A?(g(m,x,E,A),E=A+1):(g(m,x,A+1,C),C=A)}}(l,f,0,l.length-1),a&&a.push(l.buffer,f.buffer),{ids:l,positions:f}},at.deserialize=function(r){var a=new at;return a.ids=r.ids,a.positions=r.positions,a.indexed=!0,a};var ct=Math.pow(2,53)-1;function vt(r){var a=+r;return!isNaN(a)&&a<=ct?a:H(String(r))}function yt(r,a,l){var f=r[a];r[a]=r[l],r[l]=f}Qt("FeaturePositionMap",at);var bt=function(r,a){this.gl=r.gl,this.location=a},Lt=function(r){function a(l,f){r.call(this,l,f),this.current=0}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.set=function(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))},a}(bt),kt=function(r){function a(l,f){r.call(this,l,f),this.current=0}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.set=function(l){this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))},a}(bt),Ot=function(r){function a(l,f){r.call(this,l,f),this.current=[0,0]}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.set=function(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))},a}(bt),Zt=function(r){function a(l,f){r.call(this,l,f),this.current=[0,0,0]}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.set=function(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))},a}(bt),ue=function(r){function a(l,f){r.call(this,l,f),this.current=[0,0,0,0]}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.set=function(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3]))},a}(bt),pe=function(r){function a(l,f){r.call(this,l,f),this.current=ur.transparent}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.set=function(l){l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a))},a}(bt),he=new Float32Array(16),Je=function(r){function a(l,f){r.call(this,l,f),this.current=he}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.set=function(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(var f=1;f<16;f++)if(l[f]!==this.current[f]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}},a}(bt);function Wt(r){return[j(255*r.r,255*r.g),j(255*r.b,255*r.a)]}var Ee=function(r,a,l){this.value=r,this.uniformNames=a.map(function(f){return"u_"+f}),this.type=l};Ee.prototype.setUniform=function(r,a,l){r.set(l.constantOr(this.value))},Ee.prototype.getBinding=function(r,a,l){return this.type==="color"?new pe(r,a):new kt(r,a)};var De=function(r,a){this.uniformNames=a.map(function(l){return"u_"+l}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};De.prototype.setConstantPatternPositions=function(r,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=r.tlbr},De.prototype.setUniform=function(r,a,l,f){var g=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&r.set(g)},De.prototype.getBinding=function(r,a,l){return l.substr(0,9)==="u_pattern"?new ue(r,a):new kt(r,a)};var we=function(r,a,l,f){this.expression=r,this.type=l,this.maxValue=0,this.paintVertexAttributes=a.map(function(g){return{name:"a_"+g,type:"Float32",components:l==="color"?2:1,offset:0}}),this.paintVertexArray=new f};we.prototype.populatePaintArray=function(r,a,l,f,g){var m=this.paintVertexArray.length,x=this.expression.evaluate(new Ue(0),a,{},f,[],g);this.paintVertexArray.resize(r),this._setPaintValue(m,r,x)},we.prototype.updatePaintArray=function(r,a,l,f){var g=this.expression.evaluate({zoom:0},l,f);this._setPaintValue(r,a,g)},we.prototype._setPaintValue=function(r,a,l){if(this.type==="color")for(var f=Wt(l),g=r;g<a;g++)this.paintVertexArray.emplace(g,f[0],f[1]);else{for(var m=r;m<a;m++)this.paintVertexArray.emplace(m,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}},we.prototype.upload=function(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},we.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var xe=function(r,a,l,f,g,m){this.expression=r,this.uniformNames=a.map(function(x){return"u_"+x+"_t"}),this.type=l,this.useIntegerZoom=f,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=a.map(function(x){return{name:"a_"+x,type:"Float32",components:l==="color"?4:2,offset:0}}),this.paintVertexArray=new m};xe.prototype.populatePaintArray=function(r,a,l,f,g){var m=this.expression.evaluate(new Ue(this.zoom),a,{},f,[],g),x=this.expression.evaluate(new Ue(this.zoom+1),a,{},f,[],g),E=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(E,r,m,x)},xe.prototype.updatePaintArray=function(r,a,l,f){var g=this.expression.evaluate({zoom:this.zoom},l,f),m=this.expression.evaluate({zoom:this.zoom+1},l,f);this._setPaintValue(r,a,g,m)},xe.prototype._setPaintValue=function(r,a,l,f){if(this.type==="color")for(var g=Wt(l),m=Wt(f),x=r;x<a;x++)this.paintVertexArray.emplace(x,g[0],g[1],m[0],m[1]);else{for(var E=r;E<a;E++)this.paintVertexArray.emplace(E,l,f);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(f))}},xe.prototype.upload=function(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},xe.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},xe.prototype.setUniform=function(r,a){var l=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,f=mt(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);r.set(f)},xe.prototype.getBinding=function(r,a,l){return new kt(r,a)};var Te=function(r,a,l,f,g,m){this.expression=r,this.type=a,this.useIntegerZoom=l,this.zoom=f,this.layerId=m,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g};Te.prototype.populatePaintArray=function(r,a,l){var f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(f,r,a.patterns&&a.patterns[this.layerId],l)},Te.prototype.updatePaintArray=function(r,a,l,f,g){this._setPaintValues(r,a,l.patterns&&l.patterns[this.layerId],g)},Te.prototype._setPaintValues=function(r,a,l,f){if(f&&l){var g=f[l.min],m=f[l.mid],x=f[l.max];if(g&&m&&x)for(var E=r;E<a;E++)this.zoomInPaintVertexArray.emplace(E,m.tl[0],m.tl[1],m.br[0],m.br[1],g.tl[0],g.tl[1],g.br[0],g.br[1],m.pixelRatio,g.pixelRatio),this.zoomOutPaintVertexArray.emplace(E,m.tl[0],m.tl[1],m.br[0],m.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],m.pixelRatio,x.pixelRatio)}},Te.prototype.upload=function(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,K.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,K.members,this.expression.isStateDependent))},Te.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ve=function(r,a,l){this.binders={},this._buffers=[];var f=[];for(var g in r.paint._values)if(l(g)){var m=r.paint.get(g);if(m instanceof wn&&pu(m.property.specification)){var x=Fi(g,r.type),E=m.value,C=m.property.specification.type,P=m.property.useIntegerZoom,M=m.property.specification["property-type"],A=M==="cross-faded"||M==="cross-faded-data-driven";if(E.kind==="constant")this.binders[g]=A?new De(E.value,x):new Ee(E.value,x,C),f.push("/u_"+g);else if(E.kind==="source"||A){var F=ti(g,C,"source");this.binders[g]=A?new Te(E,C,P,a,F,r.id):new we(E,x,C,F),f.push("/a_"+g)}else{var B=ti(g,C,"composite");this.binders[g]=new xe(E,x,C,P,a,B),f.push("/z_"+g)}}}this.cacheKey=f.sort().join("")};ve.prototype.getMaxValue=function(r){var a=this.binders[r];return a instanceof we||a instanceof xe?a.maxValue:0},ve.prototype.populatePaintArrays=function(r,a,l,f,g){for(var m in this.binders){var x=this.binders[m];(x instanceof we||x instanceof xe||x instanceof Te)&&x.populatePaintArray(r,a,l,f,g)}},ve.prototype.setConstantPatternPositions=function(r,a){for(var l in this.binders){var f=this.binders[l];f instanceof De&&f.setConstantPatternPositions(r,a)}},ve.prototype.updatePaintArrays=function(r,a,l,f,g){var m=!1;for(var x in r)for(var E=0,C=a.getPositions(x);E<C.length;E+=1){var P=C[E],M=l.feature(P.index);for(var A in this.binders){var F=this.binders[A];if((F instanceof we||F instanceof xe||F instanceof Te)&&F.expression.isStateDependent===!0){var B=f.paint.get(A);F.expression=B.value,F.updatePaintArray(P.start,P.end,M,r[x],g),m=!0}}}return m},ve.prototype.defines=function(){var r=[];for(var a in this.binders){var l=this.binders[a];(l instanceof Ee||l instanceof De)&&r.push.apply(r,l.uniformNames.map(function(f){return"#define HAS_UNIFORM_"+f}))}return r},ve.prototype.getBinderAttributes=function(){var r=[];for(var a in this.binders){var l=this.binders[a];if(l instanceof we||l instanceof xe)for(var f=0;f<l.paintVertexAttributes.length;f++)r.push(l.paintVertexAttributes[f].name);else if(l instanceof Te)for(var g=0;g<K.members.length;g++)r.push(K.members[g].name)}return r},ve.prototype.getBinderUniforms=function(){var r=[];for(var a in this.binders){var l=this.binders[a];if(l instanceof Ee||l instanceof De||l instanceof xe)for(var f=0,g=l.uniformNames;f<g.length;f+=1)r.push(g[f])}return r},ve.prototype.getPaintVertexBuffers=function(){return this._buffers},ve.prototype.getUniforms=function(r,a){var l=[];for(var f in this.binders){var g=this.binders[f];if(g instanceof Ee||g instanceof De||g instanceof xe)for(var m=0,x=g.uniformNames;m<x.length;m+=1){var E=x[m];if(a[E]){var C=g.getBinding(r,a[E],E);l.push({name:E,property:f,binding:C})}}}return l},ve.prototype.setUniforms=function(r,a,l,f){for(var g=0,m=a;g<m.length;g+=1){var x=m[g],E=x.name,C=x.property;this.binders[C].setUniform(x.binding,f,l.get(C),E)}},ve.prototype.updatePaintBuffers=function(r){for(var a in this._buffers=[],this.binders){var l=this.binders[a];if(r&&l instanceof Te){var f=r.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(l instanceof we||l instanceof xe)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}},ve.prototype.upload=function(r){for(var a in this.binders){var l=this.binders[a];(l instanceof we||l instanceof xe||l instanceof Te)&&l.upload(r)}this.updatePaintBuffers()},ve.prototype.destroy=function(){for(var r in this.binders){var a=this.binders[r];(a instanceof we||a instanceof xe||a instanceof Te)&&a.destroy()}};var me=function(r,a,l){l===void 0&&(l=function(){return!0}),this.programConfigurations={};for(var f=0,g=r;f<g.length;f+=1){var m=g[f];this.programConfigurations[m.id]=new ve(m,a,l)}this.needsUpload=!1,this._featureMap=new at,this._bufferOffset=0};function Fi(r,a){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(a+"-","").replace(/-/g,"_")]}function ti(r,a,l){var f={color:{source:Qu,composite:ih},number:{source:Cs,composite:Qu}},g=function(m){return{"line-pattern":{source:va,composite:va},"fill-pattern":{source:va,composite:va},"fill-extrusion-pattern":{source:va,composite:va}}[m]}(r);return g&&g[l]||f[a][l]}me.prototype.populatePaintArrays=function(r,a,l,f,g,m){for(var x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(r,a,f,g,m);a.id!==void 0&&this._featureMap.add(a.id,l,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0},me.prototype.updatePaintArrays=function(r,a,l,f){for(var g=0,m=l;g<m.length;g+=1){var x=m[g];this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(r,this._featureMap,a,x,f)||this.needsUpload}},me.prototype.get=function(r){return this.programConfigurations[r]},me.prototype.upload=function(r){if(this.needsUpload){for(var a in this.programConfigurations)this.programConfigurations[a].upload(r);this.needsUpload=!1}},me.prototype.destroy=function(){for(var r in this.programConfigurations)this.programConfigurations[r].destroy()},Qt("ConstantBinder",Ee),Qt("CrossFadedConstantBinder",De),Qt("SourceExpressionBinder",we),Qt("CrossFadedCompositeBinder",Te),Qt("CompositeExpressionBinder",xe),Qt("ProgramConfiguration",ve,{omit:["_buffers"]}),Qt("ProgramConfigurationSet",me);var pn=Math.pow(2,14)-1,Gi=-pn-1;function Wr(r){for(var a=8192/r.extent,l=r.loadGeometry(),f=0;f<l.length;f++)for(var g=l[f],m=0;m<g.length;m++){var x=g[m],E=Math.round(x.x*a),C=Math.round(x.y*a);x.x=mt(E,Gi,pn),x.y=mt(C,Gi,pn),(E<x.x||E>x.x+1||C<x.y||C>x.y+1)&&Le("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return l}function ci(r,a){return{type:r.type,id:r.id,properties:r.properties,geometry:a?Wr(r):[]}}function ro(r,a,l,f,g){r.emplaceBack(2*a+(f+1)/2,2*l+(g+1)/2)}var Sn=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new mu,this.indexArray=new Ss,this.segments=new q,this.programConfigurations=new me(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};function Ls(r,a){for(var l=0;l<r.length;l++)if(xa(a,r[l]))return!0;for(var f=0;f<a.length;f++)if(xa(r,a[f]))return!0;return!!$l(r,a)}function Un(r,a,l){return!!xa(r,a)||!!Ps(a,r,l)}function ia(r,a){if(r.length===1)return tc(a,r[0]);for(var l=0;l<a.length;l++)for(var f=a[l],g=0;g<f.length;g++)if(xa(r,f[g]))return!0;for(var m=0;m<r.length;m++)if(tc(a,r[m]))return!0;for(var x=0;x<a.length;x++)if($l(r,a[x]))return!0;return!1}function Ro(r,a,l){if(r.length>1){if($l(r,a))return!0;for(var f=0;f<a.length;f++)if(Ps(a[f],r,l))return!0}for(var g=0;g<r.length;g++)if(Ps(r[g],a,l))return!0;return!1}function $l(r,a){if(r.length===0||a.length===0)return!1;for(var l=0;l<r.length-1;l++)for(var f=r[l],g=r[l+1],m=0;m<a.length-1;m++)if(el(f,g,a[m],a[m+1]))return!0;return!1}function el(r,a,l,f){return Ut(r,l,f)!==Ut(a,l,f)&&Ut(r,a,l)!==Ut(r,a,f)}function Ps(r,a,l){var f=l*l;if(a.length===1)return r.distSqr(a[0])<f;for(var g=1;g<a.length;g++)if(rl(r,a[g-1],a[g])<f)return!0;return!1}function rl(r,a,l){var f=a.distSqr(l);if(f===0)return r.distSqr(a);var g=((r.x-a.x)*(l.x-a.x)+(r.y-a.y)*(l.y-a.y))/f;return r.distSqr(g<0?a:g>1?l:l.sub(a)._mult(g)._add(a))}function tc(r,a){for(var l,f,g,m=!1,x=0;x<r.length;x++)for(var E=0,C=(l=r[x]).length-1;E<l.length;C=E++)(f=l[E]).y>a.y!=(g=l[C]).y>a.y&&a.x<(g.x-f.x)*(a.y-f.y)/(g.y-f.y)+f.x&&(m=!m);return m}function xa(r,a){for(var l=!1,f=0,g=r.length-1;f<r.length;g=f++){var m=r[f],x=r[g];m.y>a.y!=x.y>a.y&&a.x<(x.x-m.x)*(a.y-m.y)/(x.y-m.y)+m.x&&(l=!l)}return l}function ec(r,a,l){var f=l[0],g=l[2];if(r.x<f.x&&a.x<f.x||r.x>g.x&&a.x>g.x||r.y<f.y&&a.y<f.y||r.y>g.y&&a.y>g.y)return!1;var m=Ut(r,a,l[0]);return m!==Ut(r,a,l[1])||m!==Ut(r,a,l[2])||m!==Ut(r,a,l[3])}function ba(r,a,l){var f=a.paint.get(r).value;return f.kind==="constant"?f.value:l.programConfigurations.get(a.id).getMaxValue(r)}function zi(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Za(r,a,l,f,g){if(!a[0]&&!a[1])return r;var m=L.convert(a)._mult(g);l==="viewport"&&m._rotate(-f);for(var x=[],E=0;E<r.length;E++)x.push(r[E].sub(m));return x}Sn.prototype.populate=function(r,a,l){var f=this.layers[0],g=[],m=null;f.type==="circle"&&(m=f.layout.get("circle-sort-key"));for(var x=0,E=r;x<E.length;x+=1){var C=E[x],P=C.feature,M=C.id,A=C.index,F=C.sourceLayerIndex,B=this.layers[0]._featureFilter.needGeometry,X=ci(P,B);if(this.layers[0]._featureFilter.filter(new Ue(this.zoom),X,l)){var Z=m?m.evaluate(X,{},l):void 0,it={id:M,properties:P.properties,type:P.type,sourceLayerIndex:F,index:A,geometry:B?X.geometry:Wr(P),patterns:{},sortKey:Z};g.push(it)}}m&&g.sort(function(Rt,oe){return Rt.sortKey-oe.sortKey});for(var $=0,lt=g;$<lt.length;$+=1){var pt=lt[$],gt=pt.geometry,_t=pt.index,It=pt.sourceLayerIndex,Dt=r[_t].feature;this.addFeature(pt,gt,_t,l),a.featureIndex.insert(Dt,gt,_t,It,this.index)}},Sn.prototype.update=function(r,a,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,l)},Sn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Sn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Sn.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,V),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0},Sn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Sn.prototype.addFeature=function(r,a,l,f){for(var g=0,m=a;g<m.length;g+=1)for(var x=0,E=m[g];x<E.length;x+=1){var C=E[x],P=C.x,M=C.y;if(!(P<0||P>=8192||M<0||M>=8192)){var A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),F=A.vertexLength;ro(this.layoutVertexArray,P,M,-1,-1),ro(this.layoutVertexArray,P,M,1,-1),ro(this.layoutVertexArray,P,M,1,1),ro(this.layoutVertexArray,P,M,-1,1),this.indexArray.emplaceBack(F,F+1,F+2),this.indexArray.emplaceBack(F,F+3,F+2),A.vertexLength+=4,A.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,{},f)},Qt("CircleBucket",Sn,{omit:["layers"]});var Ts=new en({"circle-sort-key":new ee(U.layout_circle["circle-sort-key"])}),vu={paint:new en({"circle-radius":new ee(U.paint_circle["circle-radius"]),"circle-color":new ee(U.paint_circle["circle-color"]),"circle-blur":new ee(U.paint_circle["circle-blur"]),"circle-opacity":new ee(U.paint_circle["circle-opacity"]),"circle-translate":new se(U.paint_circle["circle-translate"]),"circle-translate-anchor":new se(U.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new se(U.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new se(U.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ee(U.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ee(U.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ee(U.paint_circle["circle-stroke-opacity"])}),layout:Ts},lr=typeof Float32Array!="undefined"?Float32Array:Array;function go(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function qn(r,a,l){var f=a[0],g=a[1],m=a[2],x=a[3],E=a[4],C=a[5],P=a[6],M=a[7],A=a[8],F=a[9],B=a[10],X=a[11],Z=a[12],it=a[13],$=a[14],lt=a[15],pt=l[0],gt=l[1],_t=l[2],It=l[3];return r[0]=pt*f+gt*E+_t*A+It*Z,r[1]=pt*g+gt*C+_t*F+It*it,r[2]=pt*m+gt*P+_t*B+It*$,r[3]=pt*x+gt*M+_t*X+It*lt,r[4]=(pt=l[4])*f+(gt=l[5])*E+(_t=l[6])*A+(It=l[7])*Z,r[5]=pt*g+gt*C+_t*F+It*it,r[6]=pt*m+gt*P+_t*B+It*$,r[7]=pt*x+gt*M+_t*X+It*lt,r[8]=(pt=l[8])*f+(gt=l[9])*E+(_t=l[10])*A+(It=l[11])*Z,r[9]=pt*g+gt*C+_t*F+It*it,r[10]=pt*m+gt*P+_t*B+It*$,r[11]=pt*x+gt*M+_t*X+It*lt,r[12]=(pt=l[12])*f+(gt=l[13])*E+(_t=l[14])*A+(It=l[15])*Z,r[13]=pt*g+gt*C+_t*F+It*it,r[14]=pt*m+gt*P+_t*B+It*$,r[15]=pt*x+gt*M+_t*X+It*lt,r}Math.hypot||(Math.hypot=function(){for(var r=arguments,a=0,l=arguments.length;l--;)a+=r[l]*r[l];return Math.sqrt(a)});var xu,Sy=qn;function nh(r,a,l){var f=a[0],g=a[1],m=a[2],x=a[3];return r[0]=l[0]*f+l[4]*g+l[8]*m+l[12]*x,r[1]=l[1]*f+l[5]*g+l[9]*m+l[13]*x,r[2]=l[2]*f+l[6]*g+l[10]*m+l[14]*x,r[3]=l[3]*f+l[7]*g+l[11]*m+l[15]*x,r}xu=new lr(3),lr!=Float32Array&&(xu[0]=0,xu[1]=0,xu[2]=0),function(){var r=new lr(4);lr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0)}();var Iy=(function(){var r=new lr(2);lr!=Float32Array&&(r[0]=0,r[1]=0)}(),function(r){function a(l){r.call(this,l,vu)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.createBucket=function(l){return new Sn(l)},a.prototype.queryRadius=function(l){var f=l;return ba("circle-radius",this,f)+ba("circle-stroke-width",this,f)+zi(this.paint.get("circle-translate"))},a.prototype.queryIntersectsFeature=function(l,f,g,m,x,E,C,P){for(var M=Za(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),E.angle,C),A=this.paint.get("circle-radius").evaluate(f,g)+this.paint.get("circle-stroke-width").evaluate(f,g),F=this.paint.get("circle-pitch-alignment")==="map",B=F?M:function(Dt,Rt){return Dt.map(function(oe){return rc(oe,Rt)})}(M,P),X=F?A*C:A,Z=0,it=m;Z<it.length;Z+=1)for(var $=0,lt=it[Z];$<lt.length;$+=1){var pt=lt[$],gt=F?pt:rc(pt,P),_t=X,It=nh([],[pt.x,pt.y,0,1],P);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?_t*=It[3]/E.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(_t*=E.cameraToCenterDistance/It[3]),Un(B,gt,_t))return!0}return!1},a}(_a));function rc(r,a){var l=nh([],[r.x,r.y,0,1],a);return new L(l[0]/l[3],l[1]/l[3])}var Md=function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a}(Sn);function il(r,a,l,f){var g=a.width,m=a.height;if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==g*m*l)throw new RangeError("mismatched image size")}else f=new Uint8Array(g*m*l);return r.width=g,r.height=m,r.data=f,r}function oh(r,a,l){var f=a.width,g=a.height;if(f!==r.width||g!==r.height){var m=il({},{width:f,height:g},l);Cy(r,m,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,f),height:Math.min(r.height,g)},l),r.width=f,r.height=g,r.data=m.data}}function Cy(r,a,l,f,g,m){if(g.width===0||g.height===0)return a;if(g.width>r.width||g.height>r.height||l.x>r.width-g.width||l.y>r.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>a.width||g.height>a.height||f.x>a.width-g.width||f.y>a.height-g.height)throw new RangeError("out of range destination coordinates for image copy");for(var x=r.data,E=a.data,C=0;C<g.height;C++)for(var P=((l.y+C)*r.width+l.x)*m,M=((f.y+C)*a.width+f.x)*m,A=0;A<g.width*m;A++)E[M+A]=x[P+A];return a}Qt("HeatmapBucket",Md,{omit:["layers"]});var ic=function(r,a){il(this,r,1,a)};ic.prototype.resize=function(r){oh(this,r,1)},ic.prototype.clone=function(){return new ic({width:this.width,height:this.height},new Uint8Array(this.data))},ic.copy=function(r,a,l,f,g){Cy(r,a,l,f,g,1)};var io=function(r,a){il(this,r,4,a)};io.prototype.resize=function(r){oh(this,r,4)},io.prototype.replace=function(r,a){a?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r},io.prototype.clone=function(){return new io({width:this.width,height:this.height},new Uint8Array(this.data))},io.copy=function(r,a,l,f,g){Cy(r,a,l,f,g,4)},Qt("AlphaImage",ic),Qt("RGBAImage",io);var S1={paint:new en({"heatmap-radius":new ee(U.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ee(U.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new se(U.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ra(U.paint_heatmap["heatmap-color"]),"heatmap-opacity":new se(U.paint_heatmap["heatmap-opacity"])})};function o_(r){var a={},l=r.resolution||256,f=r.clips?r.clips.length:1,g=r.image||new io({width:l,height:f}),m=function(X,Z,it){a[r.evaluationKey]=it;var $=r.expression.evaluate(a);g.data[X+Z+0]=Math.floor(255*$.r/$.a),g.data[X+Z+1]=Math.floor(255*$.g/$.a),g.data[X+Z+2]=Math.floor(255*$.b/$.a),g.data[X+Z+3]=Math.floor(255*$.a)};if(r.clips)for(var x=0,E=0;x<f;++x,E+=4*l)for(var C=0,P=0;C<l;C++,P+=4){var M=C/(l-1),A=r.clips[x];m(E,P,A.start*(1-M)+A.end*M)}else for(var F=0,B=0;F<l;F++,B+=4)m(0,B,F/(l-1));return g}var I1=function(r){function a(l){r.call(this,l,S1),this._updateColorRamp()}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.createBucket=function(l){return new Md(l)},a.prototype._handleSpecialPaintPropertyUpdate=function(l){l==="heatmap-color"&&this._updateColorRamp()},a.prototype._updateColorRamp=function(){this.colorRamp=o_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},a.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},a.prototype.queryRadius=function(){return 0},a.prototype.queryIntersectsFeature=function(){return!1},a.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},a}(_a),C1={paint:new en({"hillshade-illumination-direction":new se(U.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new se(U.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new se(U.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new se(U.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new se(U.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new se(U.paint_hillshade["hillshade-accent-color"])})},L1=function(r){function a(l){r.call(this,l,C1)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},a}(_a),P1=ji([{name:"a_pos",components:2,type:"Int16"}],4).members,Ly=Ad,T1=Ad;function Ad(r,a,l){l=l||2;var f,g,m,x,E,C,P,M=a&&a.length,A=M?a[0]*l:r.length,F=a_(r,0,A,l,!0),B=[];if(!F||F.next===F.prev)return B;if(M&&(F=function(Z,it,$,lt){var pt,gt,_t,It=[];for(pt=0,gt=it.length;pt<gt;pt++)(_t=a_(Z,it[pt]*lt,pt<gt-1?it[pt+1]*lt:Z.length,lt,!1))===_t.next&&(_t.steiner=!0),It.push(F1(_t));for(It.sort(k1),pt=0;pt<It.length;pt++)N1(It[pt],$),$=nl($,$.next);return $}(r,a,F,l)),r.length>80*l){f=m=r[0],g=x=r[1];for(var X=l;X<A;X+=l)(E=r[X])<f&&(f=E),(C=r[X+1])<g&&(g=C),E>m&&(m=E),C>x&&(x=C);P=(P=Math.max(m-f,x-g))!==0?1/P:0}return Up(F,B,l,f,g,P),B}function a_(r,a,l,f,g){var m,x;if(g===My(r,a,l,f)>0)for(m=a;m<l;m+=f)x=l_(m,r[m],r[m+1],x);else for(m=l-f;m>=a;m-=f)x=l_(m,r[m],r[m+1],x);return x&&Dd(x,x.next)&&(jp(x),x=x.next),x}function nl(r,a){if(!r)return r;a||(a=r);var l,f=r;do if(l=!1,f.steiner||!Dd(f,f.next)&&Ti(f.prev,f,f.next)!==0)f=f.next;else{if(jp(f),(f=a=f.prev)===f.next)break;l=!0}while(l||f!==a);return a}function Up(r,a,l,f,g,m,x){if(r){!x&&m&&function(M,A,F,B){var X=M;do X.z===null&&(X.z=Py(X.x,X.y,A,F,B)),X.prevZ=X.prev,X.nextZ=X.next,X=X.next;while(X!==M);X.prevZ.nextZ=null,X.prevZ=null,function(Z){var it,$,lt,pt,gt,_t,It,Dt,Rt=1;do{for($=Z,Z=null,gt=null,_t=0;$;){for(_t++,lt=$,It=0,it=0;it<Rt&&(It++,lt=lt.nextZ);it++);for(Dt=Rt;It>0||Dt>0&&lt;)It!==0&&(Dt===0||!lt||$.z<=lt.z)?(pt=$,$=$.nextZ,It--):(pt=lt,lt=lt.nextZ,Dt--),gt?gt.nextZ=pt:Z=pt,pt.prevZ=gt,gt=pt;$=lt}gt.nextZ=null,Rt*=2}while(_t>1)}(X)}(r,f,g,m);for(var E,C,P=r;r.prev!==r.next;)if(E=r.prev,C=r.next,m?A1(r,f,g,m):M1(r))a.push(E.i/l),a.push(r.i/l),a.push(C.i/l),jp(r),r=C.next,P=C.next;else if((r=C)===P){x?x===1?Up(r=D1(nl(r),a,l),a,l,f,g,m,2):x===2&&O1(r,a,l,f,g,m):Up(nl(r),a,l,f,g,m,1);break}}}function M1(r){var a=r.prev,l=r,f=r.next;if(Ti(a,l,f)>=0)return!1;for(var g=r.next.next;g!==r.prev;){if(ah(a.x,a.y,l.x,l.y,f.x,f.y,g.x,g.y)&&Ti(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function A1(r,a,l,f){var g=r.prev,m=r,x=r.next;if(Ti(g,m,x)>=0)return!1;for(var E=g.x>m.x?g.x>x.x?g.x:x.x:m.x>x.x?m.x:x.x,C=g.y>m.y?g.y>x.y?g.y:x.y:m.y>x.y?m.y:x.y,P=Py(g.x<m.x?g.x<x.x?g.x:x.x:m.x<x.x?m.x:x.x,g.y<m.y?g.y<x.y?g.y:x.y:m.y<x.y?m.y:x.y,a,l,f),M=Py(E,C,a,l,f),A=r.prevZ,F=r.nextZ;A&&A.z>=P&&F&&F.z<=M;){if(A!==r.prev&&A!==r.next&&ah(g.x,g.y,m.x,m.y,x.x,x.y,A.x,A.y)&&Ti(A.prev,A,A.next)>=0||(A=A.prevZ,F!==r.prev&&F!==r.next&&ah(g.x,g.y,m.x,m.y,x.x,x.y,F.x,F.y)&&Ti(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;A&&A.z>=P;){if(A!==r.prev&&A!==r.next&&ah(g.x,g.y,m.x,m.y,x.x,x.y,A.x,A.y)&&Ti(A.prev,A,A.next)>=0)return!1;A=A.prevZ}for(;F&&F.z<=M;){if(F!==r.prev&&F!==r.next&&ah(g.x,g.y,m.x,m.y,x.x,x.y,F.x,F.y)&&Ti(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function D1(r,a,l){var f=r;do{var g=f.prev,m=f.next.next;!Dd(g,m)&&s_(g,f,f.next,m)&&qp(g,m)&&qp(m,g)&&(a.push(g.i/l),a.push(f.i/l),a.push(m.i/l),jp(f),jp(f.next),f=r=m),f=f.next}while(f!==r);return nl(f)}function O1(r,a,l,f,g,m){var x=r;do{for(var E=x.next.next;E!==x.prev;){if(x.i!==E.i&&z1(x,E)){var C=u_(x,E);return x=nl(x,x.next),C=nl(C,C.next),Up(x,a,l,f,g,m),void Up(C,a,l,f,g,m)}E=E.next}x=x.next}while(x!==r)}function k1(r,a){return r.x-a.x}function N1(r,a){if(a=function(f,g){var m,x=g,E=f.x,C=f.y,P=-1/0;do{if(C<=x.y&&C>=x.next.y&&x.next.y!==x.y){var M=x.x+(C-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(M<=E&&M>P){if(P=M,M===E){if(C===x.y)return x;if(C===x.next.y)return x.next}m=x.x<x.next.x?x:x.next}}x=x.next}while(x!==g);if(!m)return null;if(E===P)return m;var A,F=m,B=m.x,X=m.y,Z=1/0;x=m;do E>=x.x&&x.x>=B&&E!==x.x&&ah(C<X?E:P,C,B,X,C<X?P:E,C,x.x,x.y)&&(A=Math.abs(C-x.y)/(E-x.x),qp(x,f)&&(A<Z||A===Z&&(x.x>m.x||x.x===m.x&&R1(m,x)))&&(m=x,Z=A)),x=x.next;while(x!==F);return m}(r,a)){var l=u_(a,r);nl(a,a.next),nl(l,l.next)}}function R1(r,a){return Ti(r.prev,r,a.prev)<0&&Ti(a.next,r,r.next)<0}function Py(r,a,l,f,g){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-l)*g)|r<<8))|r<<4))|r<<2))|r<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-f)*g)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function F1(r){var a=r,l=r;do(a.x<l.x||a.x===l.x&&a.y<l.y)&&(l=a),a=a.next;while(a!==r);return l}function ah(r,a,l,f,g,m,x,E){return(g-x)*(a-E)-(r-x)*(m-E)>=0&&(r-x)*(f-E)-(l-x)*(a-E)>=0&&(l-x)*(m-E)-(g-x)*(f-E)>=0}function z1(r,a){return r.next.i!==a.i&&r.prev.i!==a.i&&!function(l,f){var g=l;do{if(g.i!==l.i&&g.next.i!==l.i&&g.i!==f.i&&g.next.i!==f.i&&s_(g,g.next,l,f))return!0;g=g.next}while(g!==l);return!1}(r,a)&&(qp(r,a)&&qp(a,r)&&function(l,f){var g=l,m=!1,x=(l.x+f.x)/2,E=(l.y+f.y)/2;do g.y>E!=g.next.y>E&&g.next.y!==g.y&&x<(g.next.x-g.x)*(E-g.y)/(g.next.y-g.y)+g.x&&(m=!m),g=g.next;while(g!==l);return m}(r,a)&&(Ti(r.prev,r,a.prev)||Ti(r,a.prev,a))||Dd(r,a)&&Ti(r.prev,r,r.next)>0&&Ti(a.prev,a,a.next)>0)}function Ti(r,a,l){return(a.y-r.y)*(l.x-a.x)-(a.x-r.x)*(l.y-a.y)}function Dd(r,a){return r.x===a.x&&r.y===a.y}function s_(r,a,l,f){var g=kd(Ti(r,a,l)),m=kd(Ti(r,a,f)),x=kd(Ti(l,f,r)),E=kd(Ti(l,f,a));return g!==m&&x!==E||!(g!==0||!Od(r,l,a))||!(m!==0||!Od(r,f,a))||!(x!==0||!Od(l,r,f))||!(E!==0||!Od(l,a,f))}function Od(r,a,l){return a.x<=Math.max(r.x,l.x)&&a.x>=Math.min(r.x,l.x)&&a.y<=Math.max(r.y,l.y)&&a.y>=Math.min(r.y,l.y)}function kd(r){return r>0?1:r<0?-1:0}function qp(r,a){return Ti(r.prev,r,r.next)<0?Ti(r,a,r.next)>=0&&Ti(r,r.prev,a)>=0:Ti(r,a,r.prev)<0||Ti(r,r.next,a)<0}function u_(r,a){var l=new Ty(r.i,r.x,r.y),f=new Ty(a.i,a.x,a.y),g=r.next,m=a.prev;return r.next=a,a.prev=r,l.next=g,g.prev=l,f.next=l,l.prev=f,m.next=f,f.prev=m,f}function l_(r,a,l,f){var g=new Ty(r,a,l);return f?(g.next=f.next,g.prev=f,f.next.prev=g,f.next=g):(g.prev=g,g.next=g),g}function jp(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Ty(r,a,l){this.i=r,this.x=a,this.y=l,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function My(r,a,l,f){for(var g=0,m=a,x=l-f;m<l;m+=f)g+=(r[x]-r[m])*(r[m+1]+r[x+1]),x=m;return g}function B1(r,a,l,f,g){(function m(x,E,C,P,M){for(;P>C;){if(P-C>600){var A=P-C+1,F=E-C+1,B=Math.log(A),X=.5*Math.exp(2*B/3),Z=.5*Math.sqrt(B*X*(A-X)/A)*(F-A/2<0?-1:1);m(x,E,Math.max(C,Math.floor(E-F*X/A+Z)),Math.min(P,Math.floor(E+(A-F)*X/A+Z)),M)}var it=x[E],$=C,lt=P;for(Gp(x,C,E),M(x[P],it)>0&&Gp(x,C,P);$<lt;){for(Gp(x,$,lt),$++,lt--;M(x[$],it)<0;)$++;for(;M(x[lt],it)>0;)lt--}M(x[C],it)===0?Gp(x,C,lt):Gp(x,++lt,P),lt<=E&&(C=lt+1),E<=lt&&(P=lt-1)}})(r,a,l||0,f||r.length-1,g||V1)}function Gp(r,a,l){var f=r[a];r[a]=r[l],r[l]=f}function V1(r,a){return r<a?-1:r>a?1:0}function Ay(r,a){var l=r.length;if(l<=1)return[r];for(var f,g,m=[],x=0;x<l;x++){var E=Fe(r[x]);E!==0&&(r[x].area=Math.abs(E),g===void 0&&(g=E<0),g===E<0?(f&&m.push(f),f=[r[x]]):f.push(r[x]))}if(f&&m.push(f),a>1)for(var C=0;C<m.length;C++)m[C].length<=a||(B1(m[C],a,1,m[C].length-1,U1),m[C]=m[C].slice(0,a));return m}function U1(r,a){return a.area-r.area}function Dy(r,a,l){for(var f=l.patternDependencies,g=!1,m=0,x=a;m<x.length;m+=1){var E=x[m].paint.get(r+"-pattern");E.isConstant()||(g=!0);var C=E.constantOr(null);C&&(g=!0,f[C.to]=!0,f[C.from]=!0)}return g}function Oy(r,a,l,f,g){for(var m=g.patternDependencies,x=0,E=a;x<E.length;x+=1){var C=E[x],P=C.paint.get(r+"-pattern").value;if(P.kind!=="constant"){var M=P.evaluate({zoom:f-1},l,{},g.availableImages),A=P.evaluate({zoom:f},l,{},g.availableImages),F=P.evaluate({zoom:f+1},l,{},g.availableImages);A=A&&A.name?A.name:A,F=F&&F.name?F.name:F,m[M=M&&M.name?M.name:M]=!0,m[A]=!0,m[F]=!0,l.patterns[C.id]={min:M,mid:A,max:F}}}return l}Ad.deviation=function(r,a,l,f){var g=a&&a.length,m=Math.abs(My(r,0,g?a[0]*l:r.length,l));if(g)for(var x=0,E=a.length;x<E;x++)m-=Math.abs(My(r,a[x]*l,x<E-1?a[x+1]*l:r.length,l));var C=0;for(x=0;x<f.length;x+=3){var P=f[x]*l,M=f[x+1]*l,A=f[x+2]*l;C+=Math.abs((r[P]-r[A])*(r[M+1]-r[P+1])-(r[P]-r[M])*(r[A+1]-r[P+1]))}return m===0&&C===0?0:Math.abs((C-m)/m)},Ad.flatten=function(r){for(var a=r[0][0].length,l={vertices:[],holes:[],dimensions:a},f=0,g=0;g<r.length;g++){for(var m=0;m<r[g].length;m++)for(var x=0;x<a;x++)l.vertices.push(r[g][m][x]);g>0&&l.holes.push(f+=r[g-1].length)}return l},Ly.default=T1;var Ya=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new mu,this.indexArray=new Ss,this.indexArray2=new Ql,this.programConfigurations=new me(r.layers,r.zoom),this.segments=new q,this.segments2=new q,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};Ya.prototype.populate=function(r,a,l){this.hasPattern=Dy("fill",this.layers,a);for(var f=this.layers[0].layout.get("fill-sort-key"),g=[],m=0,x=r;m<x.length;m+=1){var E=x[m],C=E.feature,P=E.id,M=E.index,A=E.sourceLayerIndex,F=this.layers[0]._featureFilter.needGeometry,B=ci(C,F);if(this.layers[0]._featureFilter.filter(new Ue(this.zoom),B,l)){var X=f?f.evaluate(B,{},l,a.availableImages):void 0,Z={id:P,properties:C.properties,type:C.type,sourceLayerIndex:A,index:M,geometry:F?B.geometry:Wr(C),patterns:{},sortKey:X};g.push(Z)}}f&&g.sort(function(Dt,Rt){return Dt.sortKey-Rt.sortKey});for(var it=0,$=g;it<$.length;it+=1){var lt=$[it],pt=lt.geometry,gt=lt.index,_t=lt.sourceLayerIndex;if(this.hasPattern){var It=Oy("fill",this.layers,lt,this.zoom,a);this.patternFeatures.push(It)}else this.addFeature(lt,pt,gt,l,{});a.featureIndex.insert(r[gt].feature,pt,gt,_t,this.index)}},Ya.prototype.update=function(r,a,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,l)},Ya.prototype.addFeatures=function(r,a,l){for(var f=0,g=this.patternFeatures;f<g.length;f+=1){var m=g[f];this.addFeature(m,m.geometry,m.index,a,l)}},Ya.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ya.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ya.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,P1),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0},Ya.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ya.prototype.addFeature=function(r,a,l,f,g){for(var m=0,x=Ay(a,500);m<x.length;m+=1){for(var E=x[m],C=0,P=0,M=E;P<M.length;P+=1)C+=M[P].length;for(var A=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),F=A.vertexLength,B=[],X=[],Z=0,it=E;Z<it.length;Z+=1){var $=it[Z];if($.length!==0){$!==E[0]&&X.push(B.length/2);var lt=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),pt=lt.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(pt+$.length-1,pt),B.push($[0].x),B.push($[0].y);for(var gt=1;gt<$.length;gt++)this.layoutVertexArray.emplaceBack($[gt].x,$[gt].y),this.indexArray2.emplaceBack(pt+gt-1,pt+gt),B.push($[gt].x),B.push($[gt].y);lt.vertexLength+=$.length,lt.primitiveLength+=$.length}}for(var _t=Ly(B,X),It=0;It<_t.length;It+=3)this.indexArray.emplaceBack(F+_t[It],F+_t[It+1],F+_t[It+2]);A.vertexLength+=C,A.primitiveLength+=_t.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,g,f)},Qt("FillBucket",Ya,{omit:["layers","patternFeatures"]});var q1=new en({"fill-sort-key":new ee(U.layout_fill["fill-sort-key"])}),j1={paint:new en({"fill-antialias":new se(U.paint_fill["fill-antialias"]),"fill-opacity":new ee(U.paint_fill["fill-opacity"]),"fill-color":new ee(U.paint_fill["fill-color"]),"fill-outline-color":new ee(U.paint_fill["fill-outline-color"]),"fill-translate":new se(U.paint_fill["fill-translate"]),"fill-translate-anchor":new se(U.paint_fill["fill-translate-anchor"]),"fill-pattern":new $c(U.paint_fill["fill-pattern"])}),layout:q1},G1=function(r){function a(l){r.call(this,l,j1)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.recalculate=function(l,f){r.prototype.recalculate.call(this,l,f);var g=this.paint._values["fill-outline-color"];g.value.kind==="constant"&&g.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},a.prototype.createBucket=function(l){return new Ya(l)},a.prototype.queryRadius=function(){return zi(this.paint.get("fill-translate"))},a.prototype.queryIntersectsFeature=function(l,f,g,m,x,E,C){return ia(Za(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),E.angle,C),m)},a.prototype.isTileClipped=function(){return!0},a}(_a),H1=ji([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,c_=sh;function sh(r,a,l,f,g){this.properties={},this.extent=l,this.type=0,this._pbf=r,this._geometry=-1,this._keys=f,this._values=g,r.readFields(X1,this,a)}function X1(r,a,l){r==1?a.id=l.readVarint():r==2?function(f,g){for(var m=f.readVarint()+f.pos;f.pos<m;){var x=g._keys[f.readVarint()],E=g._values[f.readVarint()];g.properties[x]=E}}(l,a):r==3?a.type=l.readVarint():r==4&&(a._geometry=l.pos)}function Z1(r){for(var a,l,f=0,g=0,m=r.length,x=m-1;g<m;x=g++)f+=((l=r[x]).x-(a=r[g]).x)*(a.y+l.y);return f}sh.types=["Unknown","Point","LineString","Polygon"],sh.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var a,l=r.readVarint()+r.pos,f=1,g=0,m=0,x=0,E=[];r.pos<l;){if(g<=0){var C=r.readVarint();f=7&C,g=C>>3}if(g--,f===1||f===2)m+=r.readSVarint(),x+=r.readSVarint(),f===1&&(a&&E.push(a),a=[]),a.push(new L(m,x));else{if(f!==7)throw new Error("unknown command "+f);a&&a.push(a[0].clone())}}return a&&E.push(a),E},sh.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var a=r.readVarint()+r.pos,l=1,f=0,g=0,m=0,x=1/0,E=-1/0,C=1/0,P=-1/0;r.pos<a;){if(f<=0){var M=r.readVarint();l=7&M,f=M>>3}if(f--,l===1||l===2)(g+=r.readSVarint())<x&&(x=g),g>E&&(E=g),(m+=r.readSVarint())<C&&(C=m),m>P&&(P=m);else if(l!==7)throw new Error("unknown command "+l)}return[x,C,E,P]},sh.prototype.toGeoJSON=function(r,a,l){var f,g,m=this.extent*Math.pow(2,l),x=this.extent*r,E=this.extent*a,C=this.loadGeometry(),P=sh.types[this.type];function M(B){for(var X=0;X<B.length;X++){var Z=B[X];B[X]=[360*(Z.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(Z.y+E)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var A=[];for(f=0;f<C.length;f++)A[f]=C[f][0];M(C=A);break;case 2:for(f=0;f<C.length;f++)M(C[f]);break;case 3:for(C=function(B){var X=B.length;if(X<=1)return[B];for(var Z,it,$=[],lt=0;lt<X;lt++){var pt=Z1(B[lt]);pt!==0&&(it===void 0&&(it=pt<0),it===pt<0?(Z&&$.push(Z),Z=[B[lt]]):Z.push(B[lt]))}return Z&&$.push(Z),$}(C),f=0;f<C.length;f++)for(g=0;g<C[f].length;g++)M(C[f][g])}C.length===1?C=C[0]:P="Multi"+P;var F={type:"Feature",geometry:{type:P,coordinates:C},properties:this.properties};return"id"in this&&(F.id=this.id),F};var h_=p_;function p_(r,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(Y1,this,a),this.length=this._features.length}function Y1(r,a,l){r===15?a.version=l.readVarint():r===1?a.name=l.readString():r===5?a.extent=l.readVarint():r===2?a._features.push(l.pos):r===3?a._keys.push(l.readString()):r===4&&a._values.push(function(f){for(var g=null,m=f.readVarint()+f.pos;f.pos<m;){var x=f.readVarint()>>3;g=x===1?f.readString():x===2?f.readFloat():x===3?f.readDouble():x===4?f.readVarint64():x===5?f.readVarint():x===6?f.readSVarint():x===7?f.readBoolean():null}return g}(l))}function W1(r,a,l){if(r===3){var f=new h_(l,l.readVarint()+l.pos);f.length&&(a[f.name]=f)}}p_.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var a=this._pbf.readVarint()+this._pbf.pos;return new c_(this._pbf,a,this.extent,this._keys,this._values)};var uh={VectorTile:function(r,a){this.layers=r.readFields(W1,{},a)},VectorTileFeature:c_,VectorTileLayer:h_},K1=uh.VectorTileFeature.types,ky=Math.pow(2,13);function Hp(r,a,l,f,g,m,x,E){r.emplaceBack(a,l,2*Math.floor(f*ky)+x,g*ky*2,m*ky*2,Math.round(E))}var Wa=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Xa,this.indexArray=new Ss,this.programConfigurations=new me(r.layers,r.zoom),this.segments=new q,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};function J1(r,a){return r.x===a.x&&(r.x<0||r.x>8192)||r.y===a.y&&(r.y<0||r.y>8192)}Wa.prototype.populate=function(r,a,l){this.features=[],this.hasPattern=Dy("fill-extrusion",this.layers,a);for(var f=0,g=r;f<g.length;f+=1){var m=g[f],x=m.feature,E=m.id,C=m.index,P=m.sourceLayerIndex,M=this.layers[0]._featureFilter.needGeometry,A=ci(x,M);if(this.layers[0]._featureFilter.filter(new Ue(this.zoom),A,l)){var F={id:E,sourceLayerIndex:P,index:C,geometry:M?A.geometry:Wr(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(Oy("fill-extrusion",this.layers,F,this.zoom,a)):this.addFeature(F,F.geometry,C,l,{}),a.featureIndex.insert(x,F.geometry,C,P,this.index,!0)}}},Wa.prototype.addFeatures=function(r,a,l){for(var f=0,g=this.features;f<g.length;f+=1){var m=g[f];this.addFeature(m,m.geometry,m.index,a,l)}},Wa.prototype.update=function(r,a,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,l)},Wa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Wa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Wa.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,H1),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0},Wa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Wa.prototype.addFeature=function(r,a,l,f,g){for(var m=0,x=Ay(a,500);m<x.length;m+=1){for(var E=x[m],C=0,P=0,M=E;P<M.length;P+=1)C+=M[P].length;for(var A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),F=0,B=E;F<B.length;F+=1){var X=B[F];if(X.length!==0&&!((ze=X).every(function(Pe){return Pe.x<0})||ze.every(function(Pe){return Pe.x>8192})||ze.every(function(Pe){return Pe.y<0})||ze.every(function(Pe){return Pe.y>8192})))for(var Z=0,it=0;it<X.length;it++){var $=X[it];if(it>=1){var lt=X[it-1];if(!J1($,lt)){A.vertexLength+4>q.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var pt=$.sub(lt)._perp()._unit(),gt=lt.dist($);Z+gt>32768&&(Z=0),Hp(this.layoutVertexArray,$.x,$.y,pt.x,pt.y,0,0,Z),Hp(this.layoutVertexArray,$.x,$.y,pt.x,pt.y,0,1,Z),Hp(this.layoutVertexArray,lt.x,lt.y,pt.x,pt.y,0,0,Z+=gt),Hp(this.layoutVertexArray,lt.x,lt.y,pt.x,pt.y,0,1,Z);var _t=A.vertexLength;this.indexArray.emplaceBack(_t,_t+2,_t+1),this.indexArray.emplaceBack(_t+1,_t+2,_t+3),A.vertexLength+=4,A.primitiveLength+=2}}}}if(A.vertexLength+C>q.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray)),K1[r.type]==="Polygon"){for(var It=[],Dt=[],Rt=A.vertexLength,oe=0,jt=E;oe<jt.length;oe+=1){var le=jt[oe];if(le.length!==0){le!==E[0]&&Dt.push(It.length/2);for(var Ht=0;Ht<le.length;Ht++){var Oe=le[Ht];Hp(this.layoutVertexArray,Oe.x,Oe.y,0,0,1,1,0),It.push(Oe.x),It.push(Oe.y)}}}for(var _e=Ly(It,Dt),re=0;re<_e.length;re+=3)this.indexArray.emplaceBack(Rt+_e[re],Rt+_e[re+2],Rt+_e[re+1]);A.primitiveLength+=_e.length/3,A.vertexLength+=C}}var ze;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,g,f)},Qt("FillExtrusionBucket",Wa,{omit:["layers","features"]});var Q1={paint:new en({"fill-extrusion-opacity":new se(U["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ee(U["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new se(U["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new se(U["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $c(U["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ee(U["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ee(U["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new se(U["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},$1=function(r){function a(l){r.call(this,l,Q1)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.createBucket=function(l){return new Wa(l)},a.prototype.queryRadius=function(){return zi(this.paint.get("fill-extrusion-translate"))},a.prototype.is3D=function(){return!0},a.prototype.queryIntersectsFeature=function(l,f,g,m,x,E,C,P){var M=Za(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),E.angle,C),A=this.paint.get("fill-extrusion-height").evaluate(f,g),F=this.paint.get("fill-extrusion-base").evaluate(f,g),B=function(Z,it,$,lt){for(var pt=[],gt=0,_t=Z;gt<_t.length;gt+=1){var It=_t[gt],Dt=[It.x,It.y,0,1];nh(Dt,Dt,it),pt.push(new L(Dt[0]/Dt[3],Dt[1]/Dt[3]))}return pt}(M,P),X=function(Z,it,$,lt){for(var pt=[],gt=[],_t=lt[8]*it,It=lt[9]*it,Dt=lt[10]*it,Rt=lt[11]*it,oe=lt[8]*$,jt=lt[9]*$,le=lt[10]*$,Ht=lt[11]*$,Oe=0,_e=Z;Oe<_e.length;Oe+=1){for(var re=[],ze=[],Pe=0,Ke=_e[Oe];Pe<Ke.length;Pe+=1){var ce=Ke[Pe],ir=ce.x,jr=ce.y,ei=lt[0]*ir+lt[4]*jr+lt[12],Kr=lt[1]*ir+lt[5]*jr+lt[13],Gr=lt[2]*ir+lt[6]*jr+lt[14],ri=lt[3]*ir+lt[7]*jr+lt[15],Bi=Gr+Dt,Vi=ri+Rt,Cn=ei+oe,Xi=Kr+jt,Ln=Gr+le,hi=ri+Ht,Zi=new L((ei+_t)/Vi,(Kr+It)/Vi);Zi.z=Bi/Vi,re.push(Zi);var je=new L(Cn/hi,Xi/hi);je.z=Ln/hi,ze.push(je)}pt.push(re),gt.push(ze)}return[pt,gt]}(m,F,A,P);return function(Z,it,$){var lt=1/0;ia($,it)&&(lt=f_($,it[0]));for(var pt=0;pt<it.length;pt++)for(var gt=it[pt],_t=Z[pt],It=0;It<gt.length-1;It++){var Dt=gt[It],Rt=[Dt,gt[It+1],_t[It+1],_t[It],Dt];Ls($,Rt)&&(lt=Math.min(lt,f_($,Rt)))}return lt!==1/0&&lt}(X[0],X[1],B)},a}(_a);function Xp(r,a){return r.x*a.x+r.y*a.y}function f_(r,a){if(r.length===1){for(var l,f=0,g=a[f++];!l||g.equals(l);)if(!(l=a[f++]))return 1/0;for(;f<a.length;f++){var m=a[f],x=r[0],E=l.sub(g),C=m.sub(g),P=x.sub(g),M=Xp(E,E),A=Xp(E,C),F=Xp(C,C),B=Xp(P,E),X=Xp(P,C),Z=M*F-A*A,it=(F*B-A*X)/Z,$=(M*X-A*B)/Z,lt=g.z*(1-it-$)+l.z*it+m.z*$;if(isFinite(lt))return lt}return 1/0}for(var pt=1/0,gt=0,_t=a;gt<_t.length;gt+=1)pt=Math.min(pt,_t[gt].z);return pt}var tb=ji([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,eb=ji([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,rb=uh.VectorTileFeature.types,ib=Math.cos(Math.PI/180*37.5),d_=Math.pow(2,14)/.5,jn=function(r){var a=this;this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(l){a.gradients[l.id]={}}),this.layoutVertexArray=new eo,this.layoutVertexArray2=new Qu,this.indexArray=new Ss,this.programConfigurations=new me(r.layers,r.zoom),this.segments=new q,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};jn.prototype.populate=function(r,a,l){this.hasPattern=Dy("line",this.layers,a);for(var f=this.layers[0].layout.get("line-sort-key"),g=[],m=0,x=r;m<x.length;m+=1){var E=x[m],C=E.feature,P=E.id,M=E.index,A=E.sourceLayerIndex,F=this.layers[0]._featureFilter.needGeometry,B=ci(C,F);if(this.layers[0]._featureFilter.filter(new Ue(this.zoom),B,l)){var X=f?f.evaluate(B,{},l):void 0,Z={id:P,properties:C.properties,type:C.type,sourceLayerIndex:A,index:M,geometry:F?B.geometry:Wr(C),patterns:{},sortKey:X};g.push(Z)}}f&&g.sort(function(Dt,Rt){return Dt.sortKey-Rt.sortKey});for(var it=0,$=g;it<$.length;it+=1){var lt=$[it],pt=lt.geometry,gt=lt.index,_t=lt.sourceLayerIndex;if(this.hasPattern){var It=Oy("line",this.layers,lt,this.zoom,a);this.patternFeatures.push(It)}else this.addFeature(lt,pt,gt,l,{});a.featureIndex.insert(r[gt].feature,pt,gt,_t,this.index)}},jn.prototype.update=function(r,a,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,l)},jn.prototype.addFeatures=function(r,a,l){for(var f=0,g=this.patternFeatures;f<g.length;f+=1){var m=g[f];this.addFeature(m,m.geometry,m.index,a,l)}},jn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},jn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},jn.prototype.upload=function(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,eb)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,tb),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0},jn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},jn.prototype.lineFeatureClips=function(r){if(r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}},jn.prototype.addFeature=function(r,a,l,f,g){var m=this.layers[0].layout,x=m.get("line-join").evaluate(r,{}),E=m.get("line-cap"),C=m.get("line-miter-limit"),P=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(var M=0,A=a;M<A.length;M+=1)this.addLine(A[M],r,x,E,C,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,g,f)},jn.prototype.addLine=function(r,a,l,f,g,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var x=0;x<r.length-1;x++)this.totalDistance+=r[x].dist(r[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var E=rb[a.type]==="Polygon",C=r.length;C>=2&&r[C-1].equals(r[C-2]);)C--;for(var P=0;P<C-1&&r[P].equals(r[P+1]);)P++;if(!(C<(E?3:2))){l==="bevel"&&(g=1.05);var M,A=this.overscaling<=16?122880/(512*this.overscaling):0,F=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray),B=void 0,X=void 0,Z=void 0,it=void 0;this.e1=this.e2=-1,E&&(it=r[P].sub(M=r[C-2])._unit()._perp());for(var $=P;$<C;$++)if(!(X=$===C-1?E?r[P+1]:void 0:r[$+1])||!r[$].equals(X)){it&&(Z=it),M&&(B=M),M=r[$],it=X?X.sub(M)._unit()._perp():Z;var lt=(Z=Z||it).add(it);lt.x===0&&lt.y===0||lt._unit();var pt=Z.x*it.x+Z.y*it.y,gt=lt.x*it.x+lt.y*it.y,_t=gt!==0?1/gt:1/0,It=2*Math.sqrt(2-2*gt),Dt=gt<ib&&B&&X,Rt=Z.x*it.y-Z.y*it.x>0;if(Dt&&$>P){var oe=M.dist(B);if(oe>2*A){var jt=M.sub(M.sub(B)._mult(A/oe)._round());this.updateDistance(B,jt),this.addCurrentVertex(jt,Z,0,0,F),B=jt}}var le=B&&X,Ht=le?l:E?"butt":f;if(le&&Ht==="round"&&(_t<m?Ht="miter":_t<=2&&(Ht="fakeround")),Ht==="miter"&&_t>g&&(Ht="bevel"),Ht==="bevel"&&(_t>2&&(Ht="flipbevel"),_t<g&&(Ht="miter")),B&&this.updateDistance(B,M),Ht==="miter")lt._mult(_t),this.addCurrentVertex(M,lt,0,0,F);else if(Ht==="flipbevel"){if(_t>100)lt=it.mult(-1);else{var Oe=_t*Z.add(it).mag()/Z.sub(it).mag();lt._perp()._mult(Oe*(Rt?-1:1))}this.addCurrentVertex(M,lt,0,0,F),this.addCurrentVertex(M,lt.mult(-1),0,0,F)}else if(Ht==="bevel"||Ht==="fakeround"){var _e=-Math.sqrt(_t*_t-1),re=Rt?_e:0,ze=Rt?0:_e;if(B&&this.addCurrentVertex(M,Z,re,ze,F),Ht==="fakeround")for(var Pe=Math.round(180*It/Math.PI/20),Ke=1;Ke<Pe;Ke++){var ce=Ke/Pe;if(ce!==.5){var ir=ce-.5;ce+=ce*ir*(ce-1)*((1.0904+pt*(pt*(3.55645-1.43519*pt)-3.2452))*ir*ir+(.848013+pt*(.215638*pt-1.06021)))}var jr=it.sub(Z)._mult(ce)._add(Z)._unit()._mult(Rt?-1:1);this.addHalfVertex(M,jr.x,jr.y,!1,Rt,0,F)}X&&this.addCurrentVertex(M,it,-re,-ze,F)}else if(Ht==="butt")this.addCurrentVertex(M,lt,0,0,F);else if(Ht==="square"){var ei=B?1:-1;this.addCurrentVertex(M,lt,ei,ei,F)}else Ht==="round"&&(B&&(this.addCurrentVertex(M,Z,0,0,F),this.addCurrentVertex(M,Z,1,1,F,!0)),X&&(this.addCurrentVertex(M,it,-1,-1,F,!0),this.addCurrentVertex(M,it,0,0,F)));if(Dt&&$<C-1){var Kr=M.dist(X);if(Kr>2*A){var Gr=M.add(X.sub(M)._mult(A/Kr)._round());this.updateDistance(M,Gr),this.addCurrentVertex(Gr,it,0,0,F),M=Gr}}}}},jn.prototype.addCurrentVertex=function(r,a,l,f,g,m){m===void 0&&(m=!1);var x=a.y*f-a.x,E=-a.y-a.x*f;this.addHalfVertex(r,a.x+a.y*l,a.y-a.x*l,m,!1,l,g),this.addHalfVertex(r,x,E,m,!0,-f,g),this.distance>d_/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(r,a,l,f,g,m))},jn.prototype.addHalfVertex=function(r,a,l,f,g,m,x){var E=.5*(this.lineClips?this.scaledDistance*(d_-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r.x<<1)+(f?1:0),(r.y<<1)+(g?1:0),Math.round(63*a)+128,Math.round(63*l)+128,1+(m===0?0:m<0?-1:1)|(63&E)<<2,E>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var C=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),x.primitiveLength++),g?this.e2=C:this.e1=C},jn.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},jn.prototype.updateDistance=function(r,a){this.distance+=r.dist(a),this.updateScaledDistance()},Qt("LineBucket",jn,{omit:["layers","patternFeatures"]});var nb=new en({"line-cap":new se(U.layout_line["line-cap"]),"line-join":new ee(U.layout_line["line-join"]),"line-miter-limit":new se(U.layout_line["line-miter-limit"]),"line-round-limit":new se(U.layout_line["line-round-limit"]),"line-sort-key":new ee(U.layout_line["line-sort-key"])}),g_={paint:new en({"line-opacity":new ee(U.paint_line["line-opacity"]),"line-color":new ee(U.paint_line["line-color"]),"line-translate":new se(U.paint_line["line-translate"]),"line-translate-anchor":new se(U.paint_line["line-translate-anchor"]),"line-width":new ee(U.paint_line["line-width"]),"line-gap-width":new ee(U.paint_line["line-gap-width"]),"line-offset":new ee(U.paint_line["line-offset"]),"line-blur":new ee(U.paint_line["line-blur"]),"line-dasharray":new En(U.paint_line["line-dasharray"]),"line-pattern":new $c(U.paint_line["line-pattern"]),"line-gradient":new ra(U.paint_line["line-gradient"])}),layout:nb},y_=new(function(r){function a(){r.apply(this,arguments)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.possiblyEvaluate=function(l,f){return f=new Ue(Math.floor(f.zoom),{now:f.now,fadeDuration:f.fadeDuration,zoomHistory:f.zoomHistory,transition:f.transition}),r.prototype.possiblyEvaluate.call(this,l,f)},a.prototype.evaluate=function(l,f,g,m){return f=ut({},f,{zoom:Math.floor(f.zoom)}),r.prototype.evaluate.call(this,l,f,g,m)},a}(ee))(g_.paint.properties["line-width"].specification);y_.useIntegerZoom=!0;var ob=function(r){function a(l){r.call(this,l,g_),this.gradientVersion=0}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype._handleSpecialPaintPropertyUpdate=function(l){l==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Kn,this.gradientVersion=(this.gradientVersion+1)%Q)},a.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},a.prototype.recalculate=function(l,f){r.prototype.recalculate.call(this,l,f),this.paint._values["line-floorwidth"]=y_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)},a.prototype.createBucket=function(l){return new jn(l)},a.prototype.queryRadius=function(l){var f=l,g=m_(ba("line-width",this,f),ba("line-gap-width",this,f)),m=ba("line-offset",this,f);return g/2+Math.abs(m)+zi(this.paint.get("line-translate"))},a.prototype.queryIntersectsFeature=function(l,f,g,m,x,E,C){var P=Za(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),E.angle,C),M=C/2*m_(this.paint.get("line-width").evaluate(f,g),this.paint.get("line-gap-width").evaluate(f,g)),A=this.paint.get("line-offset").evaluate(f,g);return A&&(m=function(F,B){for(var X=[],Z=new L(0,0),it=0;it<F.length;it++){for(var $=F[it],lt=[],pt=0;pt<$.length;pt++){var gt=$[pt],_t=$[pt+1],It=pt===0?Z:gt.sub($[pt-1])._unit()._perp(),Dt=pt===$.length-1?Z:_t.sub(gt)._unit()._perp(),Rt=It._add(Dt)._unit();Rt._mult(1/(Rt.x*Dt.x+Rt.y*Dt.y)),lt.push(Rt._mult(B)._add(gt))}X.push(lt)}return X}(m,A*C)),function(F,B,X){for(var Z=0;Z<B.length;Z++){var it=B[Z];if(F.length>=3){for(var $=0;$<it.length;$++)if(xa(F,it[$]))return!0}if(Ro(F,it,X))return!0}return!1}(P,m,M)},a.prototype.isTileClipped=function(){return!0},a}(_a);function m_(r,a){return a>0?a+2*r:r}var ab=ji([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),sb=ji([{name:"a_projected_pos",components:3,type:"Float32"}],4),ub=(ji([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ji([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),__=(ji([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),ji([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),lb=ji([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function cb(r,a,l){return r.sections.forEach(function(f){f.text=function(g,m,x){var E=m.layout.get("text-transform").evaluate(x,{});return E==="uppercase"?g=g.toLocaleUpperCase():E==="lowercase"&&(g=g.toLocaleLowerCase()),fo.applyArabicShaping&&(g=fo.applyArabicShaping(g)),g}(f.text,a,l)}),r}ji([{name:"triangle",components:3,type:"Uint16"}]),ji([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ji([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ji([{type:"Float32",name:"offsetX"}]),ji([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Zp={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},v_=function(r,a,l,f,g){var m,x,E=8*g-f-1,C=(1<<E)-1,P=C>>1,M=-7,A=l?g-1:0,F=l?-1:1,B=r[a+A];for(A+=F,m=B&(1<<-M)-1,B>>=-M,M+=E;M>0;m=256*m+r[a+A],A+=F,M-=8);for(x=m&(1<<-M)-1,m>>=-M,M+=f;M>0;x=256*x+r[a+A],A+=F,M-=8);if(m===0)m=1-P;else{if(m===C)return x?NaN:1/0*(B?-1:1);x+=Math.pow(2,f),m-=P}return(B?-1:1)*x*Math.pow(2,m-f)},x_=function(r,a,l,f,g,m){var x,E,C,P=8*m-g-1,M=(1<<P)-1,A=M>>1,F=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=f?0:m-1,X=f?1:-1,Z=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(E=isNaN(a)?1:0,x=M):(x=Math.floor(Math.log(a)/Math.LN2),a*(C=Math.pow(2,-x))<1&&(x--,C*=2),(a+=x+A>=1?F/C:F*Math.pow(2,1-A))*C>=2&&(x++,C/=2),x+A>=M?(E=0,x=M):x+A>=1?(E=(a*C-1)*Math.pow(2,g),x+=A):(E=a*Math.pow(2,A-1)*Math.pow(2,g),x=0));g>=8;r[l+B]=255&E,B+=X,E/=256,g-=8);for(x=x<<g|E,P+=g;P>0;r[l+B]=255&x,B+=X,x/=256,P-=8);r[l+B-X]|=128*Z},Nd=Nr;function Nr(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Nr.Varint=0,Nr.Fixed64=1,Nr.Bytes=2,Nr.Fixed32=5;var b_=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function bu(r){return r.type===Nr.Bytes?r.readVarint()+r.pos:r.pos+1}function lh(r,a,l){return l?4294967296*a+(r>>>0):4294967296*(a>>>0)+(r>>>0)}function w_(r,a,l){var f=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));l.realloc(f);for(var g=l.pos-1;g>=r;g--)l.buf[g+f]=l.buf[g]}function hb(r,a){for(var l=0;l<r.length;l++)a.writeVarint(r[l])}function pb(r,a){for(var l=0;l<r.length;l++)a.writeSVarint(r[l])}function fb(r,a){for(var l=0;l<r.length;l++)a.writeFloat(r[l])}function db(r,a){for(var l=0;l<r.length;l++)a.writeDouble(r[l])}function gb(r,a){for(var l=0;l<r.length;l++)a.writeBoolean(r[l])}function yb(r,a){for(var l=0;l<r.length;l++)a.writeFixed32(r[l])}function mb(r,a){for(var l=0;l<r.length;l++)a.writeSFixed32(r[l])}function _b(r,a){for(var l=0;l<r.length;l++)a.writeFixed64(r[l])}function vb(r,a){for(var l=0;l<r.length;l++)a.writeSFixed64(r[l])}function Rd(r,a){return(r[a]|r[a+1]<<8|r[a+2]<<16)+16777216*r[a+3]}function ch(r,a,l){r[l]=a,r[l+1]=a>>>8,r[l+2]=a>>>16,r[l+3]=a>>>24}function E_(r,a){return(r[a]|r[a+1]<<8|r[a+2]<<16)+(r[a+3]<<24)}function xb(r,a,l){r===1&&l.readMessage(bb,a)}function bb(r,a,l){if(r===3){var f=l.readMessage(wb,{}),g=f.width,m=f.height,x=f.left,E=f.top,C=f.advance;a.push({id:f.id,bitmap:new ic({width:g+6,height:m+6},f.bitmap),metrics:{width:g,height:m,left:x,top:E,advance:C}})}}function wb(r,a,l){r===1?a.id=l.readVarint():r===2?a.bitmap=l.readBytes():r===3?a.width=l.readVarint():r===4?a.height=l.readVarint():r===5?a.left=l.readSVarint():r===6?a.top=l.readSVarint():r===7&&(a.advance=l.readVarint())}function S_(r){for(var a=0,l=0,f=0,g=r;f<g.length;f+=1){var m=g[f];a+=m.w*m.h,l=Math.max(l,m.w)}r.sort(function(Z,it){return it.h-Z.h});for(var x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),l),h:1/0}],E=0,C=0,P=0,M=r;P<M.length;P+=1)for(var A=M[P],F=x.length-1;F>=0;F--){var B=x[F];if(!(A.w>B.w||A.h>B.h)){if(A.x=B.x,A.y=B.y,C=Math.max(C,A.y+A.h),E=Math.max(E,A.x+A.w),A.w===B.w&&A.h===B.h){var X=x.pop();F<x.length&&(x[F]=X)}else A.h===B.h?(B.x+=A.w,B.w-=A.w):A.w===B.w?(B.y+=A.h,B.h-=A.h):(x.push({x:B.x+A.w,y:B.y,w:B.w-A.w,h:A.h}),B.y+=A.h,B.h-=A.h);break}}return{w:E,h:C,fill:a/(E*C)||0}}Nr.prototype={destroy:function(){this.buf=null},readFields:function(r,a,l){for(l=l||this.length;this.pos<l;){var f=this.readVarint(),g=f>>3,m=this.pos;this.type=7&f,r(g,a,this),this.pos===m&&this.skip(f)}return a},readMessage:function(r,a){return this.readFields(r,a,this.readVarint()+this.pos)},readFixed32:function(){var r=Rd(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=E_(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Rd(this.buf,this.pos)+4294967296*Rd(this.buf,this.pos+4);return this.pos+=8,r},readSFixed64:function(){var r=Rd(this.buf,this.pos)+4294967296*E_(this.buf,this.pos+4);return this.pos+=8,r},readFloat:function(){var r=v_(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=v_(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var a,l,f=this.buf;return a=127&(l=f[this.pos++]),l<128?a:(a|=(127&(l=f[this.pos++]))<<7,l<128?a:(a|=(127&(l=f[this.pos++]))<<14,l<128?a:(a|=(127&(l=f[this.pos++]))<<21,l<128?a:function(g,m,x){var E,C,P=x.buf;if(E=(112&(C=P[x.pos++]))>>4,C<128||(E|=(127&(C=P[x.pos++]))<<3,C<128)||(E|=(127&(C=P[x.pos++]))<<10,C<128)||(E|=(127&(C=P[x.pos++]))<<17,C<128)||(E|=(127&(C=P[x.pos++]))<<24,C<128)||(E|=(1&(C=P[x.pos++]))<<31,C<128))return lh(g,E,m);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(l=f[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r=this.readVarint()+this.pos,a=this.pos;return this.pos=r,r-a>=12&&b_?function(l,f,g){return b_.decode(l.subarray(f,g))}(this.buf,a,r):function(l,f,g){for(var m="",x=f;x<g;){var E,C,P,M=l[x],A=null,F=M>239?4:M>223?3:M>191?2:1;if(x+F>g)break;F===1?M<128&&(A=M):F===2?(192&(E=l[x+1]))==128&&(A=(31&M)<<6|63&E)<=127&&(A=null):F===3?(C=l[x+2],(192&(E=l[x+1]))==128&&(192&C)==128&&((A=(15&M)<<12|(63&E)<<6|63&C)<=2047||A>=55296&&A<=57343)&&(A=null)):F===4&&(C=l[x+2],P=l[x+3],(192&(E=l[x+1]))==128&&(192&C)==128&&(192&P)==128&&((A=(15&M)<<18|(63&E)<<12|(63&C)<<6|63&P)<=65535||A>=1114112)&&(A=null)),A===null?(A=65533,F=1):A>65535&&(A-=65536,m+=String.fromCharCode(A>>>10&1023|55296),A=56320|1023&A),m+=String.fromCharCode(A),x+=F}return m}(this.buf,a,r)},readBytes:function(){var r=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,r);return this.pos=r,a},readPackedVarint:function(r,a){if(this.type!==Nr.Bytes)return r.push(this.readVarint(a));var l=bu(this);for(r=r||[];this.pos<l;)r.push(this.readVarint(a));return r},readPackedSVarint:function(r){if(this.type!==Nr.Bytes)return r.push(this.readSVarint());var a=bu(this);for(r=r||[];this.pos<a;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Nr.Bytes)return r.push(this.readBoolean());var a=bu(this);for(r=r||[];this.pos<a;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Nr.Bytes)return r.push(this.readFloat());var a=bu(this);for(r=r||[];this.pos<a;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Nr.Bytes)return r.push(this.readDouble());var a=bu(this);for(r=r||[];this.pos<a;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Nr.Bytes)return r.push(this.readFixed32());var a=bu(this);for(r=r||[];this.pos<a;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Nr.Bytes)return r.push(this.readSFixed32());var a=bu(this);for(r=r||[];this.pos<a;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Nr.Bytes)return r.push(this.readFixed64());var a=bu(this);for(r=r||[];this.pos<a;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Nr.Bytes)return r.push(this.readSFixed64());var a=bu(this);for(r=r||[];this.pos<a;)r.push(this.readSFixed64());return r},skip:function(r){var a=7&r;if(a===Nr.Varint)for(;this.buf[this.pos++]>127;);else if(a===Nr.Bytes)this.pos=this.readVarint()+this.pos;else if(a===Nr.Fixed32)this.pos+=4;else{if(a!==Nr.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(r,a){this.writeVarint(r<<3|a)},realloc:function(r){for(var a=this.length||16;a<this.pos+r;)a*=2;if(a!==this.length){var l=new Uint8Array(a);l.set(this.buf),this.buf=l,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),ch(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),ch(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),ch(this.buf,-1&r,this.pos),ch(this.buf,Math.floor(r*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),ch(this.buf,-1&r,this.pos),ch(this.buf,Math.floor(r*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(a,l){var f,g;if(a>=0?(f=a%4294967296|0,g=a/4294967296|0):(g=~(-a/4294967296),4294967295^(f=~(-a%4294967296))?f=f+1|0:(f=0,g=g+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(m,x,E){E.buf[E.pos++]=127&m|128,m>>>=7,E.buf[E.pos++]=127&m|128,m>>>=7,E.buf[E.pos++]=127&m|128,m>>>=7,E.buf[E.pos++]=127&m|128,E.buf[E.pos]=127&(m>>>=7)}(f,0,l),function(m,x){var E=(7&m)<<4;x.buf[x.pos++]|=E|((m>>>=3)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m|((m>>>=7)?128:0),m&&(x.buf[x.pos++]=127&m)))))}(g,l)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var a=this.pos;this.pos=function(f,g,m){for(var x,E,C=0;C<g.length;C++){if((x=g.charCodeAt(C))>55295&&x<57344){if(!E){x>56319||C+1===g.length?(f[m++]=239,f[m++]=191,f[m++]=189):E=x;continue}if(x<56320){f[m++]=239,f[m++]=191,f[m++]=189,E=x;continue}x=E-55296<<10|x-56320|65536,E=null}else E&&(f[m++]=239,f[m++]=191,f[m++]=189,E=null);x<128?f[m++]=x:(x<2048?f[m++]=x>>6|192:(x<65536?f[m++]=x>>12|224:(f[m++]=x>>18|240,f[m++]=x>>12&63|128),f[m++]=x>>6&63|128),f[m++]=63&x|128)}return m}(this.buf,r,this.pos);var l=this.pos-a;l>=128&&w_(a,l,this),this.pos=a-1,this.writeVarint(l),this.pos+=l},writeFloat:function(r){this.realloc(4),x_(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),x_(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var a=r.length;this.writeVarint(a),this.realloc(a);for(var l=0;l<a;l++)this.buf[this.pos++]=r[l]},writeRawMessage:function(r,a){this.pos++;var l=this.pos;r(a,this);var f=this.pos-l;f>=128&&w_(l,f,this),this.pos=l-1,this.writeVarint(f),this.pos+=f},writeMessage:function(r,a,l){this.writeTag(r,Nr.Bytes),this.writeRawMessage(a,l)},writePackedVarint:function(r,a){a.length&&this.writeMessage(r,hb,a)},writePackedSVarint:function(r,a){a.length&&this.writeMessage(r,pb,a)},writePackedBoolean:function(r,a){a.length&&this.writeMessage(r,gb,a)},writePackedFloat:function(r,a){a.length&&this.writeMessage(r,fb,a)},writePackedDouble:function(r,a){a.length&&this.writeMessage(r,db,a)},writePackedFixed32:function(r,a){a.length&&this.writeMessage(r,yb,a)},writePackedSFixed32:function(r,a){a.length&&this.writeMessage(r,mb,a)},writePackedFixed64:function(r,a){a.length&&this.writeMessage(r,_b,a)},writePackedSFixed64:function(r,a){a.length&&this.writeMessage(r,vb,a)},writeBytesField:function(r,a){this.writeTag(r,Nr.Bytes),this.writeBytes(a)},writeFixed32Field:function(r,a){this.writeTag(r,Nr.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(r,a){this.writeTag(r,Nr.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(r,a){this.writeTag(r,Nr.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(r,a){this.writeTag(r,Nr.Fixed64),this.writeSFixed64(a)},writeVarintField:function(r,a){this.writeTag(r,Nr.Varint),this.writeVarint(a)},writeSVarintField:function(r,a){this.writeTag(r,Nr.Varint),this.writeSVarint(a)},writeStringField:function(r,a){this.writeTag(r,Nr.Bytes),this.writeString(a)},writeFloatField:function(r,a){this.writeTag(r,Nr.Fixed32),this.writeFloat(a)},writeDoubleField:function(r,a){this.writeTag(r,Nr.Fixed64),this.writeDouble(a)},writeBooleanField:function(r,a){this.writeVarintField(r,Boolean(a))}};var Fd=function(r,a){var l=a.pixelRatio,f=a.version,g=a.stretchX,m=a.stretchY,x=a.content;this.paddedRect=r,this.pixelRatio=l,this.stretchX=g,this.stretchY=m,this.content=x,this.version=f},Yp={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Yp.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Yp.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Yp.tlbr.get=function(){return this.tl.concat(this.br)},Yp.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Fd.prototype,Yp);var Wp=function(r,a){var l={},f={};this.haveRenderCallbacks=[];var g=[];this.addImages(r,l,g),this.addImages(a,f,g);var m=S_(g),x=new io({width:m.w||1,height:m.h||1});for(var E in r){var C=r[E],P=l[E].paddedRect;io.copy(C.data,x,{x:0,y:0},{x:P.x+1,y:P.y+1},C.data)}for(var M in a){var A=a[M],F=f[M].paddedRect,B=F.x+1,X=F.y+1,Z=A.data.width,it=A.data.height;io.copy(A.data,x,{x:0,y:0},{x:B,y:X},A.data),io.copy(A.data,x,{x:0,y:it-1},{x:B,y:X-1},{width:Z,height:1}),io.copy(A.data,x,{x:0,y:0},{x:B,y:X+it},{width:Z,height:1}),io.copy(A.data,x,{x:Z-1,y:0},{x:B-1,y:X},{width:1,height:it}),io.copy(A.data,x,{x:0,y:0},{x:B+Z,y:X},{width:1,height:it})}this.image=x,this.iconPositions=l,this.patternPositions=f};Wp.prototype.addImages=function(r,a,l){for(var f in r){var g=r[f],m={x:0,y:0,w:g.data.width+2,h:g.data.height+2};l.push(m),a[f]=new Fd(m,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(f)}},Wp.prototype.patchUpdatedImages=function(r,a){for(var l in r.dispatchRenderCallbacks(this.haveRenderCallbacks),r.updatedImages)this.patchUpdatedImage(this.iconPositions[l],r.getImage(l),a),this.patchUpdatedImage(this.patternPositions[l],r.getImage(l),a)},Wp.prototype.patchUpdatedImage=function(r,a,l){if(r&&a&&r.version!==a.version){r.version=a.version;var f=r.tl;l.update(a.data,void 0,{x:f[0],y:f[1]})}},Qt("ImagePosition",Fd),Qt("ImageAtlas",Wp);var Fo={horizontal:1,vertical:2,horizontalOnly:3},hh=function(){this.scale=1,this.fontStack="",this.imageName=null};hh.forText=function(r,a){var l=new hh;return l.scale=r||1,l.fontStack=a,l},hh.forImage=function(r){var a=new hh;return a.imageName=r,a};var In=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function zd(r,a,l,f,g,m,x,E,C,P,M,A,F,B,X,Z){var it,$=In.fromFeature(r,g);A===Fo.vertical&&$.verticalizePunctuation();var lt=fo.processBidirectionalText,pt=fo.processStyledBidirectionalText;if(lt&&$.sections.length===1){it=[];for(var gt=0,_t=lt($.toString(),Ny($,P,m,a,f,B,X));gt<_t.length;gt+=1){var It=_t[gt],Dt=new In;Dt.text=It,Dt.sections=$.sections;for(var Rt=0;Rt<It.length;Rt++)Dt.sectionIndex.push(0);it.push(Dt)}}else if(pt){it=[];for(var oe=0,jt=pt($.text,$.sectionIndex,Ny($,P,m,a,f,B,X));oe<jt.length;oe+=1){var le=jt[oe],Ht=new In;Ht.text=le[0],Ht.sectionIndex=le[1],Ht.sections=$.sections,it.push(Ht)}}else it=function(re,ze){for(var Pe=[],Ke=re.text,ce=0,ir=0,jr=ze;ir<jr.length;ir+=1){var ei=jr[ir];Pe.push(re.substring(ce,ei)),ce=ei}return ce<Ke.length&&Pe.push(re.substring(ce,Ke.length)),Pe}($,Ny($,P,m,a,f,B,X));var Oe=[],_e={positionedLines:Oe,text:$.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:A,iconsInText:!1,verticalizable:!1};return function(re,ze,Pe,Ke,ce,ir,jr,ei,Kr,Gr,ri,Bi){for(var Vi=0,Cn=-17,Xi=0,Ln=0,hi=ei==="right"?1:ei==="left"?0:.5,Zi=0,je=0,Pr=ce;je<Pr.length;je+=1){var vr=Pr[je];vr.trim();var Qe=vr.getMaxScale(),Gn=24*(Qe-1),fn={positionedGlyphs:[],lineOffset:0};re.positionedLines[Zi]=fn;var Br=fn.positionedGlyphs,wi=0;if(vr.length()){for(var dn=0;dn<vr.length();dn++){var nr=vr.getSection(dn),Ms=vr.getSectionIndex(dn),zo=vr.getCharCode(dn),As=0,pi=null,Ds=null,wa=null,vh=24,sc=!(Kr===Fo.horizontal||!ri&&!Kc(zo)||ri&&(Bd[zo]||(Iu=zo,Bt.Arabic(Iu)||Bt["Arabic Supplement"](Iu)||Bt["Arabic Extended-A"](Iu)||Bt["Arabic Presentation Forms-A"](Iu)||Bt["Arabic Presentation Forms-B"](Iu))));if(nr.imageName){var xh=Ke[nr.imageName];if(!xh)continue;wa=nr.imageName,re.iconsInText=re.iconsInText||!0,Ds=xh.paddedRect;var Su=xh.displaySize;nr.scale=24*nr.scale/Bi,As=Gn+(24-Su[1]*nr.scale),vh=(pi={width:Su[0],height:Su[1],left:1,top:-3,advance:sc?Su[1]:Su[0]}).advance;var bh=sc?Su[0]*nr.scale-24*Qe:Su[1]*nr.scale-24*Qe;bh>0&&bh>wi&&(wi=bh)}else{var Yd=Pe[nr.fontStack],wh=Yd&&Yd[zo];if(wh&&wh.rect)Ds=wh.rect,pi=wh.metrics;else{var Qp=ze[nr.fontStack],Wd=Qp&&Qp[zo];if(!Wd)continue;pi=Wd.metrics}As=24*(Qe-nr.scale)}sc?(re.verticalizable=!0,Br.push({glyph:zo,imageName:wa,x:Vi,y:Cn+As,vertical:sc,scale:nr.scale,fontStack:nr.fontStack,sectionIndex:Ms,metrics:pi,rect:Ds}),Vi+=vh*nr.scale+Gr):(Br.push({glyph:zo,imageName:wa,x:Vi,y:Cn+As,vertical:sc,scale:nr.scale,fontStack:nr.fontStack,sectionIndex:Ms,metrics:pi,rect:Ds}),Vi+=pi.advance*nr.scale+Gr)}Br.length!==0&&(Xi=Math.max(Vi-Gr,Xi),Sb(Br,0,Br.length-1,hi,wi)),Vi=0;var Kd=ir*Qe+wi;fn.lineOffset=Math.max(wi,Gn),Cn+=Kd,Ln=Math.max(Kd,Ln),++Zi}else Cn+=ir,++Zi}var Iu,$p=Cn- -17,Eh=Ry(jr),al=Eh.horizontalAlign,Sh=Eh.verticalAlign;(function(Jd,Qd,tf,ef,$d,rf,nf,of,tg){var Ih,eg=(Qd-tf)*$d;Ih=rf!==nf?-of*ef- -17:(-ef*tg+.5)*nf;for(var Ch=0,af=Jd;Ch<af.length;Ch+=1)for(var uc=0,sf=af[Ch].positionedGlyphs;uc<sf.length;uc+=1){var Lh=sf[uc];Lh.x+=eg,Lh.y+=Ih}})(re.positionedLines,hi,al,Sh,Xi,Ln,ir,$p,ce.length),re.top+=-Sh*$p,re.bottom=re.top+$p,re.left+=-al*Xi,re.right=re.left+Xi}(_e,a,l,f,it,x,E,C,A,P,F,Z),!function(re){for(var ze=0,Pe=re;ze<Pe.length;ze+=1)if(Pe[ze].positionedGlyphs.length!==0)return!1;return!0}(Oe)&&_e}In.fromFeature=function(r,a){for(var l=new In,f=0;f<r.sections.length;f++){var g=r.sections[f];g.image?l.addImageSection(g):l.addTextSection(g,a)}return l},In.prototype.length=function(){return this.text.length},In.prototype.getSection=function(r){return this.sections[this.sectionIndex[r]]},In.prototype.getSectionIndex=function(r){return this.sectionIndex[r]},In.prototype.getCharCode=function(r){return this.text.charCodeAt(r)},In.prototype.verticalizePunctuation=function(){this.text=function(r){for(var a="",l=0;l<r.length;l++){var f=r.charCodeAt(l+1)||null,g=r.charCodeAt(l-1)||null;a+=f&&Dp(f)&&!Zp[r[l+1]]||g&&Dp(g)&&!Zp[r[l-1]]||!Zp[r[l]]?r[l]:Zp[r[l]]}return a}(this.text)},In.prototype.trim=function(){for(var r=0,a=0;a<this.text.length&&Bd[this.text.charCodeAt(a)];a++)r++;for(var l=this.text.length,f=this.text.length-1;f>=0&&f>=r&&Bd[this.text.charCodeAt(f)];f--)l--;this.text=this.text.substring(r,l),this.sectionIndex=this.sectionIndex.slice(r,l)},In.prototype.substring=function(r,a){var l=new In;return l.text=this.text.substring(r,a),l.sectionIndex=this.sectionIndex.slice(r,a),l.sections=this.sections,l},In.prototype.toString=function(){return this.text},In.prototype.getMaxScale=function(){var r=this;return this.sectionIndex.reduce(function(a,l){return Math.max(a,r.sections[l].scale)},0)},In.prototype.addTextSection=function(r,a){this.text+=r.text,this.sections.push(hh.forText(r.scale,r.fontStack||a));for(var l=this.sections.length-1,f=0;f<r.text.length;++f)this.sectionIndex.push(l)},In.prototype.addImageSection=function(r){var a=r.image?r.image.name:"";if(a.length!==0){var l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(hh.forImage(a)),this.sectionIndex.push(this.sections.length-1)):Le("Reached maximum number of images 6401")}else Le("Can't add FormattedSection with an empty image.")},In.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Bd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},yo={};function I_(r,a,l,f,g,m){if(a.imageName){var x=f[a.imageName];return x?x.displaySize[0]*a.scale*24/m+g:0}var E=l[a.fontStack],C=E&&E[r];return C?C.metrics.advance*a.scale+g:0}function C_(r,a,l,f){var g=Math.pow(r-a,2);return f?r<a?g/2:2*g:g+Math.abs(l)*l}function Eb(r,a,l){var f=0;return r===10&&(f-=1e4),l&&(f+=150),r!==40&&r!==65288||(f+=50),a!==41&&a!==65289||(f+=50),f}function L_(r,a,l,f,g,m){for(var x=null,E=C_(a,l,g,m),C=0,P=f;C<P.length;C+=1){var M=P[C],A=C_(a-M.x,l,g,m)+M.badness;A<=E&&(x=M,E=A)}return{index:r,x:a,priorBreak:x,badness:E}}function Ny(r,a,l,f,g,m,x){if(m!=="point")return[];if(!r)return[];for(var E,C=[],P=function(it,$,lt,pt,gt,_t){for(var It=0,Dt=0;Dt<it.length();Dt++){var Rt=it.getSection(Dt);It+=I_(it.getCharCode(Dt),Rt,pt,gt,$,_t)}return It/Math.max(1,Math.ceil(It/lt))}(r,a,l,f,g,x),M=r.text.indexOf("\u200B")>=0,A=0,F=0;F<r.length();F++){var B=r.getSection(F),X=r.getCharCode(F);if(Bd[X]||(A+=I_(X,B,f,g,a,x)),F<r.length()-1){var Z=!((E=X)<11904||!(Bt["Bopomofo Extended"](E)||Bt.Bopomofo(E)||Bt["CJK Compatibility Forms"](E)||Bt["CJK Compatibility Ideographs"](E)||Bt["CJK Compatibility"](E)||Bt["CJK Radicals Supplement"](E)||Bt["CJK Strokes"](E)||Bt["CJK Symbols and Punctuation"](E)||Bt["CJK Unified Ideographs Extension A"](E)||Bt["CJK Unified Ideographs"](E)||Bt["Enclosed CJK Letters and Months"](E)||Bt["Halfwidth and Fullwidth Forms"](E)||Bt.Hiragana(E)||Bt["Ideographic Description Characters"](E)||Bt["Kangxi Radicals"](E)||Bt["Katakana Phonetic Extensions"](E)||Bt.Katakana(E)||Bt["Vertical Forms"](E)||Bt["Yi Radicals"](E)||Bt["Yi Syllables"](E)));(yo[X]||Z||B.imageName)&&C.push(L_(F+1,A,P,C,Eb(X,r.getCharCode(F+1),Z&&M),!1))}}return function it($){return $?it($.priorBreak).concat($.index):[]}(L_(r.length(),A,P,C,0,!0))}function Ry(r){var a=.5,l=.5;switch(r){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:a,verticalAlign:l}}function Sb(r,a,l,f,g){if(f||g)for(var m=r[l],x=(r[l].x+m.metrics.advance*m.scale)*f,E=a;E<=l;E++)r[E].x-=x,r[E].y+=g}function P_(r,a,l,f,g,m){var x,E=r.image;if(E.content){var C=E.content,P=E.pixelRatio||1;x=[C[0]/P,C[1]/P,E.displaySize[0]-C[2]/P,E.displaySize[1]-C[3]/P]}var M,A,F,B,X=a.left*m,Z=a.right*m;l==="width"||l==="both"?(B=g[0]+X-f[3],A=g[0]+Z+f[1]):A=(B=g[0]+(X+Z-E.displaySize[0])/2)+E.displaySize[0];var it=a.top*m,$=a.bottom*m;return l==="height"||l==="both"?(M=g[1]+it-f[0],F=g[1]+$+f[2]):F=(M=g[1]+(it+$-E.displaySize[1])/2)+E.displaySize[1],{image:E,top:M,right:A,bottom:F,left:B,collisionPadding:x}}yo[10]=!0,yo[32]=!0,yo[38]=!0,yo[40]=!0,yo[41]=!0,yo[43]=!0,yo[45]=!0,yo[47]=!0,yo[173]=!0,yo[183]=!0,yo[8203]=!0,yo[8208]=!0,yo[8211]=!0,yo[8231]=!0;var ph=function(r){function a(l,f,g,m){r.call(this,l,f),this.angle=g,m!==void 0&&(this.segment=m)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.clone=function(){return new a(this.x,this.y,this.angle,this.segment)},a}(L);function Fy(r,a){var l=a.expression;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new Ue(r+1))};if(l.kind==="source")return{kind:"source"};for(var f=l.zoomStops,g=l.interpolationType,m=0;m<f.length&&f[m]<=r;)m++;for(var x=m=Math.max(0,m-1);x<f.length&&f[x]<r+1;)x++;x=Math.min(f.length-1,x);var E=f[m],C=f[x];return l.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:C,interpolationType:g}:{kind:"camera",minZoom:E,maxZoom:C,minSize:l.evaluate(new Ue(E)),maxSize:l.evaluate(new Ue(C)),interpolationType:g}}function T_(r,a,l){var f=a.uSize,g=l.lowerSize;return r.kind==="source"?g/128:r.kind==="composite"?xi(g/128,l.upperSize/128,a.uSizeT):f}function M_(r,a){var l=0,f=0;if(r.kind==="constant")f=r.layoutSize;else if(r.kind!=="source"){var g=r.interpolationType,m=g?mt($i.interpolationFactor(g,a,r.minZoom,r.maxZoom),0,1):0;r.kind==="camera"?f=xi(r.minSize,r.maxSize,m):l=m}return{uSizeT:l,uSize:f}}Qt("Anchor",ph);var Ib=Object.freeze({__proto__:null,getSizeData:Fy,evaluateSizeForFeature:T_,evaluateSizeForZoom:M_,SIZE_PACK_FACTOR:128});function A_(r,a,l,f,g){if(a.segment===void 0)return!0;for(var m=a,x=a.segment+1,E=0;E>-l/2;){if(--x<0)return!1;E-=r[x].dist(m),m=r[x]}E+=r[x].dist(r[x+1]),x++;for(var C=[],P=0;E<l/2;){var M=r[x],A=r[x+1];if(!A)return!1;var F=r[x-1].angleTo(M)-M.angleTo(A);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:E,angleDelta:F}),P+=F;E-C[0].distance>f;)P-=C.shift().angleDelta;if(P>g)return!1;x++,E+=M.dist(A)}return!0}function D_(r){for(var a=0,l=0;l<r.length-1;l++)a+=r[l].dist(r[l+1]);return a}function O_(r,a,l){return r?.6*a*l:0}function k_(r,a){return Math.max(r?r.right-r.left:0,a?a.right-a.left:0)}function Cb(r,a,l,f,g,m){for(var x=O_(l,g,m),E=k_(l,f)*m,C=0,P=D_(r)/2,M=0;M<r.length-1;M++){var A=r[M],F=r[M+1],B=A.dist(F);if(C+B>P){var X=(P-C)/B,Z=xi(A.x,F.x,X),it=xi(A.y,F.y,X),$=new ph(Z,it,F.angleTo(A),M);return $._round(),!x||A_(r,$,E,x,a)?$:void 0}C+=B}}function Lb(r,a,l,f,g,m,x,E,C){var P=O_(f,m,x),M=k_(f,g),A=M*x,F=r[0].x===0||r[0].x===C||r[0].y===0||r[0].y===C;return a-A<a/4&&(a=A+a/4),function B(X,Z,it,$,lt,pt,gt,_t,It){for(var Dt=pt/2,Rt=D_(X),oe=0,jt=Z-it,le=[],Ht=0;Ht<X.length-1;Ht++){for(var Oe=X[Ht],_e=X[Ht+1],re=Oe.dist(_e),ze=_e.angleTo(Oe);jt+it<oe+re;){var Pe=((jt+=it)-oe)/re,Ke=xi(Oe.x,_e.x,Pe),ce=xi(Oe.y,_e.y,Pe);if(Ke>=0&&Ke<It&&ce>=0&&ce<It&&jt-Dt>=0&&jt+Dt<=Rt){var ir=new ph(Ke,ce,ze,Ht);ir._round(),$&&!A_(X,ir,pt,$,lt)||le.push(ir)}}oe+=re}return _t||le.length||gt||(le=B(X,oe/2,it,$,lt,pt,gt,!0,It)),le}(r,F?a/2*E%a:(M/2+2*m)*x*E%a,a,P,l,A,F,!1,C)}function N_(r,a,l,f,g){for(var m=[],x=0;x<r.length;x++)for(var E=r[x],C=void 0,P=0;P<E.length-1;P++){var M=E[P],A=E[P+1];M.x<a&&A.x<a||(M.x<a?M=new L(a,M.y+(a-M.x)/(A.x-M.x)*(A.y-M.y))._round():A.x<a&&(A=new L(a,M.y+(a-M.x)/(A.x-M.x)*(A.y-M.y))._round()),M.y<l&&A.y<l||(M.y<l?M=new L(M.x+(l-M.y)/(A.y-M.y)*(A.x-M.x),l)._round():A.y<l&&(A=new L(M.x+(l-M.y)/(A.y-M.y)*(A.x-M.x),l)._round()),M.x>=f&&A.x>=f||(M.x>=f?M=new L(f,M.y+(f-M.x)/(A.x-M.x)*(A.y-M.y))._round():A.x>=f&&(A=new L(f,M.y+(f-M.x)/(A.x-M.x)*(A.y-M.y))._round()),M.y>=g&&A.y>=g||(M.y>=g?M=new L(M.x+(g-M.y)/(A.y-M.y)*(A.x-M.x),g)._round():A.y>=g&&(A=new L(M.x+(g-M.y)/(A.y-M.y)*(A.x-M.x),g)._round()),C&&M.equals(C[C.length-1])||m.push(C=[M]),C.push(A)))))}return m}function R_(r,a,l,f){var g=[],m=r.image,x=m.pixelRatio,E=m.paddedRect.w-2,C=m.paddedRect.h-2,P=r.right-r.left,M=r.bottom-r.top,A=m.stretchX||[[0,E]],F=m.stretchY||[[0,C]],B=function(Ke,ce){return Ke+ce[1]-ce[0]},X=A.reduce(B,0),Z=F.reduce(B,0),it=E-X,$=C-Z,lt=0,pt=X,gt=0,_t=Z,It=0,Dt=it,Rt=0,oe=$;if(m.content&&f){var jt=m.content;lt=Vd(A,0,jt[0]),gt=Vd(F,0,jt[1]),pt=Vd(A,jt[0],jt[2]),_t=Vd(F,jt[1],jt[3]),It=jt[0]-lt,Rt=jt[1]-gt,Dt=jt[2]-jt[0]-pt,oe=jt[3]-jt[1]-_t}var le=function(Ke,ce,ir,jr){var ei=Ud(Ke.stretch-lt,pt,P,r.left),Kr=qd(Ke.fixed-It,Dt,Ke.stretch,X),Gr=Ud(ce.stretch-gt,_t,M,r.top),ri=qd(ce.fixed-Rt,oe,ce.stretch,Z),Bi=Ud(ir.stretch-lt,pt,P,r.left),Vi=qd(ir.fixed-It,Dt,ir.stretch,X),Cn=Ud(jr.stretch-gt,_t,M,r.top),Xi=qd(jr.fixed-Rt,oe,jr.stretch,Z),Ln=new L(ei,Gr),hi=new L(Bi,Gr),Zi=new L(Bi,Cn),je=new L(ei,Cn),Pr=new L(Kr/x,ri/x),vr=new L(Vi/x,Xi/x),Qe=a*Math.PI/180;if(Qe){var Gn=Math.sin(Qe),fn=Math.cos(Qe),Br=[fn,-Gn,Gn,fn];Ln._matMult(Br),hi._matMult(Br),je._matMult(Br),Zi._matMult(Br)}var wi=Ke.stretch+Ke.fixed,dn=ce.stretch+ce.fixed;return{tl:Ln,tr:hi,bl:je,br:Zi,tex:{x:m.paddedRect.x+1+wi,y:m.paddedRect.y+1+dn,w:ir.stretch+ir.fixed-wi,h:jr.stretch+jr.fixed-dn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Pr,pixelOffsetBR:vr,minFontScaleX:Dt/x/P,minFontScaleY:oe/x/M,isSDF:l}};if(f&&(m.stretchX||m.stretchY))for(var Ht=F_(A,it,X),Oe=F_(F,$,Z),_e=0;_e<Ht.length-1;_e++)for(var re=Ht[_e],ze=Ht[_e+1],Pe=0;Pe<Oe.length-1;Pe++)g.push(le(re,Oe[Pe],ze,Oe[Pe+1]));else g.push(le({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:C+1}));return g}function Vd(r,a,l){for(var f=0,g=0,m=r;g<m.length;g+=1){var x=m[g];f+=Math.max(a,Math.min(l,x[1]))-Math.max(a,Math.min(l,x[0]))}return f}function F_(r,a,l){for(var f=[{fixed:-1,stretch:0}],g=0,m=r;g<m.length;g+=1){var x=m[g],E=x[0],C=x[1],P=f[f.length-1];f.push({fixed:E-P.stretch,stretch:P.stretch}),f.push({fixed:E-P.stretch,stretch:P.stretch+(C-E)})}return f.push({fixed:a+1,stretch:l}),f}function Ud(r,a,l,f){return r/a*l+f}function qd(r,a,l,f){return r-a*l/f}var jd=function(r,a,l,f,g,m,x,E,C,P){if(this.boxStartIndex=r.length,C){var M=m.top,A=m.bottom,F=m.collisionPadding;F&&(M-=F[1],A+=F[3]);var B=A-M;B>0&&(B=Math.max(10,B),this.circleDiameter=B)}else{var X=m.top*x-E,Z=m.bottom*x+E,it=m.left*x-E,$=m.right*x+E,lt=m.collisionPadding;if(lt&&(it-=lt[0]*x,X-=lt[1]*x,$+=lt[2]*x,Z+=lt[3]*x),P){var pt=new L(it,X),gt=new L($,X),_t=new L(it,Z),It=new L($,Z),Dt=P*Math.PI/180;pt._rotate(Dt),gt._rotate(Dt),_t._rotate(Dt),It._rotate(Dt),it=Math.min(pt.x,gt.x,_t.x,It.x),$=Math.max(pt.x,gt.x,_t.x,It.x),X=Math.min(pt.y,gt.y,_t.y,It.y),Z=Math.max(pt.y,gt.y,_t.y,It.y)}r.emplaceBack(a.x,a.y,it,X,$,Z,l,f,g)}this.boxEndIndex=r.length},fh=function(r,a){if(r===void 0&&(r=[]),a===void 0&&(a=Pb),this.data=r,this.length=this.data.length,this.compare=a,this.length>0)for(var l=(this.length>>1)-1;l>=0;l--)this._down(l)};function Pb(r,a){return r<a?-1:r>a?1:0}function Tb(r,a,l){a===void 0&&(a=1),l===void 0&&(l=!1);for(var f=1/0,g=1/0,m=-1/0,x=-1/0,E=r[0],C=0;C<E.length;C++){var P=E[C];(!C||P.x<f)&&(f=P.x),(!C||P.y<g)&&(g=P.y),(!C||P.x>m)&&(m=P.x),(!C||P.y>x)&&(x=P.y)}var M=Math.min(m-f,x-g),A=M/2,F=new fh([],Mb);if(M===0)return new L(f,g);for(var B=f;B<m;B+=M)for(var X=g;X<x;X+=M)F.push(new dh(B+A,X+A,A,r));for(var Z=function(lt){for(var pt=0,gt=0,_t=0,It=lt[0],Dt=0,Rt=It.length,oe=Rt-1;Dt<Rt;oe=Dt++){var jt=It[Dt],le=It[oe],Ht=jt.x*le.y-le.x*jt.y;gt+=(jt.x+le.x)*Ht,_t+=(jt.y+le.y)*Ht,pt+=3*Ht}return new dh(gt/pt,_t/pt,0,lt)}(r),it=F.length;F.length;){var $=F.pop();($.d>Z.d||!Z.d)&&(Z=$,l&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,it)),$.max-Z.d<=a||(F.push(new dh($.p.x-(A=$.h/2),$.p.y-A,A,r)),F.push(new dh($.p.x+A,$.p.y-A,A,r)),F.push(new dh($.p.x-A,$.p.y+A,A,r)),F.push(new dh($.p.x+A,$.p.y+A,A,r)),it+=4)}return l&&(console.log("num probes: "+it),console.log("best distance: "+Z.d)),Z.p}function Mb(r,a){return a.max-r.max}function dh(r,a,l,f){this.p=new L(r,a),this.h=l,this.d=function(g,m){for(var x=!1,E=1/0,C=0;C<m.length;C++)for(var P=m[C],M=0,A=P.length,F=A-1;M<A;F=M++){var B=P[M],X=P[F];B.y>g.y!=X.y>g.y&&g.x<(X.x-B.x)*(g.y-B.y)/(X.y-B.y)+B.x&&(x=!x),E=Math.min(E,rl(g,B,X))}return(x?1:-1)*Math.sqrt(E)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}fh.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},fh.prototype.pop=function(){if(this.length!==0){var r=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),r}},fh.prototype.peek=function(){return this.data[0]},fh.prototype._up=function(r){for(var a=this.data,l=this.compare,f=a[r];r>0;){var g=r-1>>1,m=a[g];if(l(f,m)>=0)break;a[r]=m,r=g}a[r]=f},fh.prototype._down=function(r){for(var a=this.data,l=this.compare,f=this.length>>1,g=a[r];r<f;){var m=1+(r<<1),x=a[m],E=m+1;if(E<this.length&&l(a[E],x)<0&&(m=E,x=a[E]),l(x,g)>=0)break;a[r]=x,r=m}a[r]=g};var zy=Number.POSITIVE_INFINITY;function z_(r,a){return a[1]!==zy?function(l,f,g){var m=0,x=0;switch(f=Math.abs(f),g=Math.abs(g),l){case"top-right":case"top-left":case"top":x=g-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-g}switch(l){case"top-right":case"bottom-right":case"right":m=-f;break;case"top-left":case"bottom-left":case"left":m=f}return[m,x]}(r,a[0],a[1]):function(l,f){var g=0,m=0;f<0&&(f=0);var x=f/Math.sqrt(2);switch(l){case"top-right":case"top-left":m=x-7;break;case"bottom-right":case"bottom-left":m=7-x;break;case"bottom":m=7-f;break;case"top":m=f-7}switch(l){case"top-right":case"bottom-right":g=-x;break;case"top-left":case"bottom-left":g=x;break;case"left":g=f;break;case"right":g=-f}return[g,m]}(r,a[0])}function By(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function B_(r,a,l,f,g,m,x,E,C,P,M,A,F,B,X){var Z=function(gt,_t,It,Dt,Rt,oe,jt,le){for(var Ht=Dt.layout.get("text-rotate").evaluate(oe,{})*Math.PI/180,Oe=[],_e=0,re=_t.positionedLines;_e<re.length;_e+=1)for(var ze=re[_e],Pe=0,Ke=ze.positionedGlyphs;Pe<Ke.length;Pe+=1){var ce=Ke[Pe];if(ce.rect){var ir=ce.rect||{},jr=4,ei=!0,Kr=1,Gr=0,ri=(Rt||le)&&ce.vertical,Bi=ce.metrics.advance*ce.scale/2;if(le&&_t.verticalizable&&(Gr=ze.lineOffset/2-(ce.imageName?-(24-ce.metrics.width*ce.scale)/2:24*(ce.scale-1))),ce.imageName){var Vi=jt[ce.imageName];ei=Vi.sdf,jr=1/(Kr=Vi.pixelRatio)}var Cn=Rt?[ce.x+Bi,ce.y]:[0,0],Xi=Rt?[0,0]:[ce.x+Bi+It[0],ce.y+It[1]-Gr],Ln=[0,0];ri&&(Ln=Xi,Xi=[0,0]);var hi=(ce.metrics.left-jr)*ce.scale-Bi+Xi[0],Zi=(-ce.metrics.top-jr)*ce.scale+Xi[1],je=hi+ir.w*ce.scale/Kr,Pr=Zi+ir.h*ce.scale/Kr,vr=new L(hi,Zi),Qe=new L(je,Zi),Gn=new L(hi,Pr),fn=new L(je,Pr);if(ri){var Br=new L(-Bi,Bi- -17),wi=-Math.PI/2,dn=12-Bi,nr=new L(22-dn,-(ce.imageName?dn:0)),Ms=new(Function.prototype.bind.apply(L,[null].concat(Ln)));vr._rotateAround(wi,Br)._add(nr)._add(Ms),Qe._rotateAround(wi,Br)._add(nr)._add(Ms),Gn._rotateAround(wi,Br)._add(nr)._add(Ms),fn._rotateAround(wi,Br)._add(nr)._add(Ms)}if(Ht){var zo=Math.sin(Ht),As=Math.cos(Ht),pi=[As,-zo,zo,As];vr._matMult(pi),Qe._matMult(pi),Gn._matMult(pi),fn._matMult(pi)}var Ds=new L(0,0),wa=new L(0,0);Oe.push({tl:vr,tr:Qe,bl:Gn,br:fn,tex:ir,writingMode:_t.writingMode,glyphOffset:Cn,sectionIndex:ce.sectionIndex,isSDF:ei,pixelOffsetTL:Ds,pixelOffsetBR:wa,minFontScaleX:0,minFontScaleY:0})}}return Oe}(0,l,E,g,m,x,f,r.allowVerticalPlacement),it=r.textSizeData,$=null;it.kind==="source"?($=[128*g.layout.get("text-size").evaluate(x,{})])[0]>32640&&Le(r.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):it.kind==="composite"&&(($=[128*B.compositeTextSizes[0].evaluate(x,{},X),128*B.compositeTextSizes[1].evaluate(x,{},X)])[0]>32640||$[1]>32640)&&Le(r.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),r.addSymbols(r.text,Z,$,E,m,x,P,a,C.lineStartIndex,C.lineLength,F,X);for(var lt=0,pt=M;lt<pt.length;lt+=1)A[pt[lt]]=r.text.placedSymbolArray.length-1;return 4*Z.length}function V_(r){for(var a in r)return r[a];return null}function Ab(r,a,l,f){var g=r.compareText;if(a in g){for(var m=g[a],x=m.length-1;x>=0;x--)if(f.dist(m[x])<l)return!0}else g[a]=[];return g[a].push(f),!1}var Db=uh.VectorTileFeature.types,Ob=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Gd(r,a,l,f,g,m,x,E,C,P,M,A,F){var B=E?Math.min(32640,Math.round(E[0])):0,X=E?Math.min(32640,Math.round(E[1])):0;r.emplaceBack(a,l,Math.round(32*f),Math.round(32*g),m,x,(B<<1)+(C?1:0),X,16*P,16*M,256*A,256*F)}function Vy(r,a,l){r.emplaceBack(a.x,a.y,l),r.emplaceBack(a.x,a.y,l),r.emplaceBack(a.x,a.y,l),r.emplaceBack(a.x,a.y,l)}function kb(r){for(var a=0,l=r.sections;a<l.length;a+=1)if(Jc(l[a].text))return!0;return!1}var gh=function(r){this.layoutVertexArray=new eh,this.indexArray=new Ss,this.programConfigurations=r,this.segments=new q,this.dynamicLayoutVertexArray=new $u,this.opacityVertexArray=new Jl,this.placedSymbolArray=new d};gh.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},gh.prototype.upload=function(r,a,l,f){this.isEmpty()||(l&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,ab.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,sb.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,Ob,!0),this.opacityVertexBuffer.itemSize=1),(l||f)&&this.programConfigurations.upload(r))},gh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Qt("SymbolBuffers",gh);var Kp=function(r,a,l){this.layoutVertexArray=new r,this.layoutAttributes=a,this.indexArray=new l,this.segments=new q,this.collisionVertexArray=new zp};Kp.prototype.upload=function(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,ub.members,!0)},Kp.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Qt("CollisionBuffers",Kp);var Sr=function(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(m){return m.id}),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=go([]),this.placementViewportMatrix=go([]);var a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Fy(this.zoom,a["text-size"]),this.iconSizeData=Fy(this.zoom,a["icon-size"]);var l=this.layers[0].layout,f=l.get("symbol-sort-key"),g=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(function(m){return Fo[m]})),this.stateDependentLayerIds=this.layers.filter(function(m){return m.isStateDependent()}).map(function(m){return m.id}),this.sourceID=r.sourceID};Sr.prototype.createArrays=function(){this.text=new gh(new me(this.layers,this.zoom,function(r){return/^text/.test(r)})),this.icon=new gh(new me(this.layers,this.zoom,function(r){return/^icon/.test(r)})),this.glyphOffsetArray=new w,this.lineVertexArray=new I,this.symbolInstances=new b},Sr.prototype.calculateGlyphDependencies=function(r,a,l,f,g){for(var m=0;m<r.length;m++)if(a[r.charCodeAt(m)]=!0,(l||f)&&g){var x=Zp[r.charAt(m)];x&&(a[x.charCodeAt(0)]=!0)}},Sr.prototype.populate=function(r,a,l){var f=this.layers[0],g=f.layout,m=g.get("text-font"),x=g.get("text-field"),E=g.get("icon-image"),C=(x.value.kind!=="constant"||x.value.value instanceof Ui&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),P=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,M=g.get("symbol-sort-key");if(this.features=[],C||P){for(var A=a.iconDependencies,F=a.glyphDependencies,B=a.availableImages,X=new Ue(this.zoom),Z=0,it=r;Z<it.length;Z+=1){var $=it[Z],lt=$.feature,pt=$.id,gt=$.index,_t=$.sourceLayerIndex,It=f._featureFilter.needGeometry,Dt=ci(lt,It);if(f._featureFilter.filter(X,Dt,l)){It||(Dt.geometry=Wr(lt));var Rt=void 0;if(C){var oe=f.getValueAndResolveTokens("text-field",Dt,l,B),jt=Ui.factory(oe);kb(jt)&&(this.hasRTLText=!0),(!this.hasRTLText||kp()==="unavailable"||this.hasRTLText&&fo.isParsed())&&(Rt=cb(jt,f,Dt))}var le=void 0;if(P){var Ht=f.getValueAndResolveTokens("icon-image",Dt,l,B);le=Ht instanceof Vn?Ht:Vn.fromString(Ht)}if(Rt||le){var Oe=this.sortFeaturesByKey?M.evaluate(Dt,{},l):void 0;if(this.features.push({id:pt,text:Rt,icon:le,index:gt,sourceLayerIndex:_t,geometry:Dt.geometry,properties:lt.properties,type:Db[lt.type],sortKey:Oe}),le&&(A[le.name]=!0),Rt){var _e=m.evaluate(Dt,{},l).join(","),re=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Fo.vertical)>=0;for(var ze=0,Pe=Rt.sections;ze<Pe.length;ze+=1){var Ke=Pe[ze];if(Ke.image)A[Ke.image.name]=!0;else{var ce=Ap(Rt.toString()),ir=Ke.fontStack||_e,jr=F[ir]=F[ir]||{};this.calculateGlyphDependencies(Ke.text,jr,re,this.allowVerticalPlacement,ce)}}}}}}g.get("symbol-placement")==="line"&&(this.features=function(ei){var Kr={},Gr={},ri=[],Bi=0;function Vi(Br){ri.push(ei[Br]),Bi++}function Cn(Br,wi,dn){var nr=Gr[Br];return delete Gr[Br],Gr[wi]=nr,ri[nr].geometry[0].pop(),ri[nr].geometry[0]=ri[nr].geometry[0].concat(dn[0]),nr}function Xi(Br,wi,dn){var nr=Kr[wi];return delete Kr[wi],Kr[Br]=nr,ri[nr].geometry[0].shift(),ri[nr].geometry[0]=dn[0].concat(ri[nr].geometry[0]),nr}function Ln(Br,wi,dn){var nr=dn?wi[0][wi[0].length-1]:wi[0][0];return Br+":"+nr.x+":"+nr.y}for(var hi=0;hi<ei.length;hi++){var Zi=ei[hi],je=Zi.geometry,Pr=Zi.text?Zi.text.toString():null;if(Pr){var vr=Ln(Pr,je),Qe=Ln(Pr,je,!0);if(vr in Gr&&Qe in Kr&&Gr[vr]!==Kr[Qe]){var Gn=Xi(vr,Qe,je),fn=Cn(vr,Qe,ri[Gn].geometry);delete Kr[vr],delete Gr[Qe],Gr[Ln(Pr,ri[fn].geometry,!0)]=fn,ri[Gn].geometry=null}else vr in Gr?Cn(vr,Qe,je):Qe in Kr?Xi(vr,Qe,je):(Vi(hi),Kr[vr]=Bi-1,Gr[Qe]=Bi-1)}else Vi(hi)}return ri.filter(function(Br){return Br.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(ei,Kr){return ei.sortKey-Kr.sortKey})}},Sr.prototype.update=function(r,a,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,a,this.layers,l),this.icon.programConfigurations.updatePaintArrays(r,a,this.layers,l))},Sr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Sr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Sr.prototype.upload=function(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Sr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Sr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Sr.prototype.addToLineVertexArray=function(r,a){var l=this.lineVertexArray.length;if(r.segment!==void 0){for(var f=r.dist(a[r.segment+1]),g=r.dist(a[r.segment]),m={},x=r.segment+1;x<a.length;x++)m[x]={x:a[x].x,y:a[x].y,tileUnitDistanceFromAnchor:f},x<a.length-1&&(f+=a[x+1].dist(a[x]));for(var E=r.segment||0;E>=0;E--)m[E]={x:a[E].x,y:a[E].y,tileUnitDistanceFromAnchor:g},E>0&&(g+=a[E-1].dist(a[E]));for(var C=0;C<a.length;C++){var P=m[C];this.lineVertexArray.emplaceBack(P.x,P.y,P.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}},Sr.prototype.addSymbols=function(r,a,l,f,g,m,x,E,C,P,M,A){for(var F=r.indexArray,B=r.layoutVertexArray,X=r.segments.prepareSegment(4*a.length,B,F,this.canOverlap?m.sortKey:void 0),Z=this.glyphOffsetArray.length,it=X.vertexLength,$=this.allowVerticalPlacement&&x===Fo.vertical?Math.PI/2:0,lt=m.text&&m.text.sections,pt=0;pt<a.length;pt++){var gt=a[pt],_t=gt.tl,It=gt.tr,Dt=gt.bl,Rt=gt.br,oe=gt.tex,jt=gt.pixelOffsetTL,le=gt.pixelOffsetBR,Ht=gt.minFontScaleX,Oe=gt.minFontScaleY,_e=gt.glyphOffset,re=gt.isSDF,ze=gt.sectionIndex,Pe=X.vertexLength,Ke=_e[1];Gd(B,E.x,E.y,_t.x,Ke+_t.y,oe.x,oe.y,l,re,jt.x,jt.y,Ht,Oe),Gd(B,E.x,E.y,It.x,Ke+It.y,oe.x+oe.w,oe.y,l,re,le.x,jt.y,Ht,Oe),Gd(B,E.x,E.y,Dt.x,Ke+Dt.y,oe.x,oe.y+oe.h,l,re,jt.x,le.y,Ht,Oe),Gd(B,E.x,E.y,Rt.x,Ke+Rt.y,oe.x+oe.w,oe.y+oe.h,l,re,le.x,le.y,Ht,Oe),Vy(r.dynamicLayoutVertexArray,E,$),F.emplaceBack(Pe,Pe+1,Pe+2),F.emplaceBack(Pe+1,Pe+2,Pe+3),X.vertexLength+=4,X.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(_e[0]),pt!==a.length-1&&ze===a[pt+1].sectionIndex||r.programConfigurations.populatePaintArrays(B.length,m,m.index,{},A,lt&&lt[ze])}r.placedSymbolArray.emplaceBack(E.x,E.y,Z,this.glyphOffsetArray.length-Z,it,C,P,E.segment,l?l[0]:0,l?l[1]:0,f[0],f[1],x,0,!1,0,M)},Sr.prototype._addCollisionDebugVertex=function(r,a,l,f,g,m){return a.emplaceBack(0,0),r.emplaceBack(l.x,l.y,f,g,Math.round(m.x),Math.round(m.y))},Sr.prototype.addCollisionDebugVertices=function(r,a,l,f,g,m,x){var E=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),C=E.vertexLength,P=g.layoutVertexArray,M=g.collisionVertexArray,A=x.anchorX,F=x.anchorY;this._addCollisionDebugVertex(P,M,m,A,F,new L(r,a)),this._addCollisionDebugVertex(P,M,m,A,F,new L(l,a)),this._addCollisionDebugVertex(P,M,m,A,F,new L(l,f)),this._addCollisionDebugVertex(P,M,m,A,F,new L(r,f)),E.vertexLength+=4;var B=g.indexArray;B.emplaceBack(C,C+1),B.emplaceBack(C+1,C+2),B.emplaceBack(C+2,C+3),B.emplaceBack(C+3,C),E.primitiveLength+=4},Sr.prototype.addDebugCollisionBoxes=function(r,a,l,f){for(var g=r;g<a;g++){var m=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,f?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,l)}},Sr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Kp(tl,__.members,Ql),this.iconCollisionBox=new Kp(tl,__.members,Ql);for(var r=0;r<this.symbolInstances.length;r++){var a=this.symbolInstances.get(r);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}},Sr.prototype._deserializeCollisionBoxesForSymbol=function(r,a,l,f,g,m,x,E,C){for(var P={},M=a;M<l;M++){var A=r.get(M);P.textBox={x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,anchorPointX:A.anchorPointX,anchorPointY:A.anchorPointY},P.textFeatureIndex=A.featureIndex;break}for(var F=f;F<g;F++){var B=r.get(F);P.verticalTextBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},P.verticalTextFeatureIndex=B.featureIndex;break}for(var X=m;X<x;X++){var Z=r.get(X);P.iconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},P.iconFeatureIndex=Z.featureIndex;break}for(var it=E;it<C;it++){var $=r.get(it);P.verticalIconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},P.verticalIconFeatureIndex=$.featureIndex;break}return P},Sr.prototype.deserializeCollisionBoxes=function(r){this.collisionArrays=[];for(var a=0;a<this.symbolInstances.length;a++){var l=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}},Sr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Sr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Sr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Sr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Sr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Sr.prototype.addIndicesForPlacedSymbol=function(r,a){for(var l=r.placedSymbolArray.get(a),f=l.vertexStartIndex+4*l.numGlyphs,g=l.vertexStartIndex;g<f;g+=4)r.indexArray.emplaceBack(g,g+1,g+2),r.indexArray.emplaceBack(g+1,g+2,g+3)},Sr.prototype.getSortedSymbolIndexes=function(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var a=Math.sin(r),l=Math.cos(r),f=[],g=[],m=[],x=0;x<this.symbolInstances.length;++x){m.push(x);var E=this.symbolInstances.get(x);f.push(0|Math.round(a*E.anchorX+l*E.anchorY)),g.push(E.featureIndex)}return m.sort(function(C,P){return f[C]-f[P]||g[P]-g[C]}),m},Sr.prototype.addToSortKeyRanges=function(r,a){var l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===a?l.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:r,symbolInstanceEnd:r+1})},Sr.prototype.sortFeatures=function(r){var a=this;if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var l=0,f=this.symbolInstanceIndexes;l<f.length;l+=1){var g=this.symbolInstances.get(f[l]);this.featureSortOrder.push(g.featureIndex),[g.rightJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.leftJustifiedTextSymbolIndex].forEach(function(m,x,E){m>=0&&E.indexOf(m)===x&&a.addIndicesForPlacedSymbol(a.text,m)}),g.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,g.verticalPlacedTextSymbolIndex),g.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.placedIconSymbolIndex),g.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Qt("SymbolBucket",Sr,{omit:["layers","collisionBoxArray","features","compareText"]}),Sr.MAX_GLYPHS=65535,Sr.addDynamicAttributes=Vy;var Nb=new en({"symbol-placement":new se(U.layout_symbol["symbol-placement"]),"symbol-spacing":new se(U.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new se(U.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ee(U.layout_symbol["symbol-sort-key"]),"symbol-z-order":new se(U.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new se(U.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new se(U.layout_symbol["icon-ignore-placement"]),"icon-optional":new se(U.layout_symbol["icon-optional"]),"icon-rotation-alignment":new se(U.layout_symbol["icon-rotation-alignment"]),"icon-size":new ee(U.layout_symbol["icon-size"]),"icon-text-fit":new se(U.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new se(U.layout_symbol["icon-text-fit-padding"]),"icon-image":new ee(U.layout_symbol["icon-image"]),"icon-rotate":new ee(U.layout_symbol["icon-rotate"]),"icon-padding":new se(U.layout_symbol["icon-padding"]),"icon-keep-upright":new se(U.layout_symbol["icon-keep-upright"]),"icon-offset":new ee(U.layout_symbol["icon-offset"]),"icon-anchor":new ee(U.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new se(U.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new se(U.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new se(U.layout_symbol["text-rotation-alignment"]),"text-field":new ee(U.layout_symbol["text-field"]),"text-font":new ee(U.layout_symbol["text-font"]),"text-size":new ee(U.layout_symbol["text-size"]),"text-max-width":new ee(U.layout_symbol["text-max-width"]),"text-line-height":new se(U.layout_symbol["text-line-height"]),"text-letter-spacing":new ee(U.layout_symbol["text-letter-spacing"]),"text-justify":new ee(U.layout_symbol["text-justify"]),"text-radial-offset":new ee(U.layout_symbol["text-radial-offset"]),"text-variable-anchor":new se(U.layout_symbol["text-variable-anchor"]),"text-anchor":new ee(U.layout_symbol["text-anchor"]),"text-max-angle":new se(U.layout_symbol["text-max-angle"]),"text-writing-mode":new se(U.layout_symbol["text-writing-mode"]),"text-rotate":new ee(U.layout_symbol["text-rotate"]),"text-padding":new se(U.layout_symbol["text-padding"]),"text-keep-upright":new se(U.layout_symbol["text-keep-upright"]),"text-transform":new ee(U.layout_symbol["text-transform"]),"text-offset":new ee(U.layout_symbol["text-offset"]),"text-allow-overlap":new se(U.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new se(U.layout_symbol["text-ignore-placement"]),"text-optional":new se(U.layout_symbol["text-optional"])}),Uy={paint:new en({"icon-opacity":new ee(U.paint_symbol["icon-opacity"]),"icon-color":new ee(U.paint_symbol["icon-color"]),"icon-halo-color":new ee(U.paint_symbol["icon-halo-color"]),"icon-halo-width":new ee(U.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ee(U.paint_symbol["icon-halo-blur"]),"icon-translate":new se(U.paint_symbol["icon-translate"]),"icon-translate-anchor":new se(U.paint_symbol["icon-translate-anchor"]),"text-opacity":new ee(U.paint_symbol["text-opacity"]),"text-color":new ee(U.paint_symbol["text-color"],{runtimeType:Vt,getOverride:function(r){return r.textColor},hasOverride:function(r){return!!r.textColor}}),"text-halo-color":new ee(U.paint_symbol["text-halo-color"]),"text-halo-width":new ee(U.paint_symbol["text-halo-width"]),"text-halo-blur":new ee(U.paint_symbol["text-halo-blur"]),"text-translate":new se(U.paint_symbol["text-translate"]),"text-translate-anchor":new se(U.paint_symbol["text-translate-anchor"])}),layout:Nb},yh=function(r){this.type=r.property.overrides?r.property.overrides.runtimeType:Jt,this.defaultValue=r};yh.prototype.evaluate=function(r){if(r.formattedSection){var a=this.defaultValue.property.overrides;if(a&&a.hasOverride(r.formattedSection))return a.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default},yh.prototype.eachChild=function(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)},yh.prototype.outputDefined=function(){return!1},yh.prototype.serialize=function(){return null},Qt("FormatSectionOverride",yh,{omit:["defaultValue"]});var Rb=function(r){function a(l){r.call(this,l,Uy)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.recalculate=function(l,f){if(r.prototype.recalculate.call(this,l,f),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var g=this.layout.get("text-writing-mode");if(g){for(var m=[],x=0,E=g;x<E.length;x+=1){var C=E[x];m.indexOf(C)<0&&m.push(C)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},a.prototype.getValueAndResolveTokens=function(l,f,g,m){var x=this.layout.get(l).evaluate(f,{},g,m),E=this._unevaluatedLayout._values[l];return E.isDataDriven()||Vl(E.value)||!x?x:function(C,P){return P.replace(/{([^{}]+)}/g,function(M,A){return A in C?String(C[A]):""})}(f.properties,x)},a.prototype.createBucket=function(l){return new Sr(l)},a.prototype.queryRadius=function(){return 0},a.prototype.queryIntersectsFeature=function(){return!1},a.prototype._setPaintOverrides=function(){for(var l=0,f=Uy.paint.overridableProperties;l<f.length;l+=1){var g=f[l];if(a.hasPaintOverride(this.layout,g)){var m,x=this.paint.get(g),E=new yh(x),C=new Zu(E,x.property.specification);m=x.value.kind==="constant"||x.value.kind==="source"?new Ul("source",C):new Yu("composite",C,x.value.zoomStops,x.value._interpolationType),this.paint._values[g]=new wn(x.property,m,x.parameters)}}},a.prototype._handleOverridablePaintPropertyUpdate=function(l,f,g){return!(!this.layout||f.isDataDriven()||g.isDataDriven())&&a.hasPaintOverride(this.layout,l)},a.hasPaintOverride=function(l,f){var g=l.get("text-field"),m=Uy.paint.properties[f],x=!1,E=function(M){for(var A=0,F=M;A<F.length;A+=1)if(m.overrides&&m.overrides.hasOverride(F[A]))return void(x=!0)};if(g.value.kind==="constant"&&g.value.value instanceof Ui)E(g.value.value.sections);else if(g.value.kind==="source"){var C=function(M){x||(M instanceof xn&&li(M.value)===Cr?E(M.value.sections):M instanceof Jo?E(M.sections):M.eachChild(C))},P=g.value;P._styleExpression&&C(P._styleExpression.expression)}return x},a}(_a),Fb={paint:new en({"background-color":new se(U.paint_background["background-color"]),"background-pattern":new En(U.paint_background["background-pattern"]),"background-opacity":new se(U.paint_background["background-opacity"])})},zb=function(r){function a(l){r.call(this,l,Fb)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a}(_a),Bb={paint:new en({"raster-opacity":new se(U.paint_raster["raster-opacity"]),"raster-hue-rotate":new se(U.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new se(U.paint_raster["raster-brightness-min"]),"raster-brightness-max":new se(U.paint_raster["raster-brightness-max"]),"raster-saturation":new se(U.paint_raster["raster-saturation"]),"raster-contrast":new se(U.paint_raster["raster-contrast"]),"raster-resampling":new se(U.paint_raster["raster-resampling"]),"raster-fade-duration":new se(U.paint_raster["raster-fade-duration"])})},Vb=function(r){function a(l){r.call(this,l,Bb)}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a}(_a),Ub=function(r){function a(l){r.call(this,l,{}),this.implementation=l}return r&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a,a.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},a.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},a.prototype.recalculate=function(){},a.prototype.updateTransitions=function(){},a.prototype.hasTransition=function(){},a.prototype.serialize=function(){},a.prototype.onAdd=function(l){this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},a.prototype.onRemove=function(l){this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},a}(_a),qb={circle:Iy,heatmap:I1,hillshade:L1,fill:G1,"fill-extrusion":$1,line:ob,symbol:Rb,background:zb,raster:Vb},U_=N.HTMLImageElement,q_=N.HTMLCanvasElement,j_=N.HTMLVideoElement,G_=N.ImageData,Hd=N.ImageBitmap,nc=function(r,a,l,f){this.context=r,this.format=l,this.texture=r.gl.createTexture(),this.update(a,f)};nc.prototype.update=function(r,a,l){var f=r.width,g=r.height,m=!(this.size&&this.size[0]===f&&this.size[1]===g||l),x=this.context,E=x.gl;if(this.useMipmap=Boolean(a&&a.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!a||a.premultiply!==!1)),m)this.size=[f,g],r instanceof U_||r instanceof q_||r instanceof j_||r instanceof G_||Hd&&r instanceof Hd?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,r):E.texImage2D(E.TEXTURE_2D,0,this.format,f,g,0,this.format,E.UNSIGNED_BYTE,r.data);else{var C=l||{x:0,y:0},P=C.x,M=C.y;r instanceof U_||r instanceof q_||r instanceof j_||r instanceof G_||Hd&&r instanceof Hd?E.texSubImage2D(E.TEXTURE_2D,0,P,M,E.RGBA,E.UNSIGNED_BYTE,r):E.texSubImage2D(E.TEXTURE_2D,0,P,M,f,g,E.RGBA,E.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)},nc.prototype.bind=function(r,a,l){var f=this.context.gl;f.bindTexture(f.TEXTURE_2D,this.texture),l!==f.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=f.LINEAR),r!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,r),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,l||r),this.filter=r),a!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,a),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,a),this.wrap=a)},nc.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},nc.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var qy=function(r){var a=this;this._callback=r,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){a._triggered=!1,a._callback()})};qy.prototype.trigger=function(){var r=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){r._triggered=!1,r._callback()},0))},qy.prototype.remove=function(){delete this._channel,this._callback=function(){}};var mh=function(r,a,l){this.target=r,this.parent=a,this.mapId=l,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ae(["receive","process"],this),this.invoker=new qy(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ye()?r:N};function H_(r,a,l){var f=2*Math.PI*6378137/256/Math.pow(2,l);return[r*f-2*Math.PI*6378137/2,a*f-2*Math.PI*6378137/2]}mh.prototype.send=function(r,a,l,f,g){var m=this;g===void 0&&(g=!1);var x=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(this.callbacks[x]=l);var E=or(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:r,hasCallback:!!l,targetMapId:f,mustQueue:g,sourceMapId:this.mapId,data:$o(a,E)},E),{cancel:function(){l&&delete m.callbacks[x],m.target.postMessage({id:x,type:"<cancel>",targetMapId:f,sourceMapId:m.mapId})}}},mh.prototype.receive=function(r){var a=r.data,l=a.id;if(l&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){delete this.tasks[l];var f=this.cancelCallbacks[l];delete this.cancelCallbacks[l],f&&f()}else ye()||a.mustQueue?(this.tasks[l]=a,this.taskQueue.push(l),this.invoker.trigger()):this.processTask(l,a)},mh.prototype.process=function(){if(this.taskQueue.length){var r=this.taskQueue.shift(),a=this.tasks[r];delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),a&&this.processTask(r,a)}},mh.prototype.processTask=function(r,a){var l=this;if(a.type==="<response>"){var f=this.callbacks[r];delete this.callbacks[r],f&&(a.error?f(Qn(a.error)):f(null,Qn(a.data)))}else{var g=!1,m=or(this.globalScope)?void 0:[],x=a.hasCallback?function(M,A){g=!0,delete l.cancelCallbacks[r],l.target.postMessage({id:r,type:"<response>",sourceMapId:l.mapId,error:M?$o(M):null,data:$o(A,m)},m)}:function(M){g=!0},E=null,C=Qn(a.data);if(this.parent[a.type])E=this.parent[a.type](a.sourceMapId,C,x);else if(this.parent.getWorkerSource){var P=a.type.split(".");E=this.parent.getWorkerSource(a.sourceMapId,P[0],C.source)[P[1]](C,x)}else x(new Error("Could not find function "+a.type));!g&&E&&E.cancel&&(this.cancelCallbacks[r]=E.cancel)}},mh.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Mi=function(r,a){r&&(a?this.setSouthWest(r).setNorthEast(a):r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))};Mi.prototype.setNorthEast=function(r){return this._ne=r instanceof qr?new qr(r.lng,r.lat):qr.convert(r),this},Mi.prototype.setSouthWest=function(r){return this._sw=r instanceof qr?new qr(r.lng,r.lat):qr.convert(r),this},Mi.prototype.extend=function(r){var a,l,f=this._sw,g=this._ne;if(r instanceof qr)a=r,l=r;else{if(!(r instanceof Mi))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(Mi.convert(r)):this.extend(qr.convert(r)):this;if(l=r._ne,!(a=r._sw)||!l)return this}return f||g?(f.lng=Math.min(a.lng,f.lng),f.lat=Math.min(a.lat,f.lat),g.lng=Math.max(l.lng,g.lng),g.lat=Math.max(l.lat,g.lat)):(this._sw=new qr(a.lng,a.lat),this._ne=new qr(l.lng,l.lat)),this},Mi.prototype.getCenter=function(){return new qr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Mi.prototype.getSouthWest=function(){return this._sw},Mi.prototype.getNorthEast=function(){return this._ne},Mi.prototype.getNorthWest=function(){return new qr(this.getWest(),this.getNorth())},Mi.prototype.getSouthEast=function(){return new qr(this.getEast(),this.getSouth())},Mi.prototype.getWest=function(){return this._sw.lng},Mi.prototype.getSouth=function(){return this._sw.lat},Mi.prototype.getEast=function(){return this._ne.lng},Mi.prototype.getNorth=function(){return this._ne.lat},Mi.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Mi.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Mi.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Mi.prototype.contains=function(r){var a=qr.convert(r),l=a.lng,f=a.lat,g=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g},Mi.convert=function(r){return!r||r instanceof Mi?r:new Mi(r)};var qr=function(r,a){if(isNaN(r)||isNaN(a))throw new Error("Invalid LngLat object: ("+r+", "+a+")");if(this.lng=+r,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};qr.prototype.wrap=function(){return new qr(Ct(this.lng,-180,180),this.lat)},qr.prototype.toArray=function(){return[this.lng,this.lat]},qr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},qr.prototype.distanceTo=function(r){var a=Math.PI/180,l=this.lat*a,f=r.lat*a,g=Math.sin(l)*Math.sin(f)+Math.cos(l)*Math.cos(f)*Math.cos((r.lng-this.lng)*a);return 63710088e-1*Math.acos(Math.min(g,1))},qr.prototype.toBounds=function(r){r===void 0&&(r=0);var a=360*r/40075017,l=a/Math.cos(Math.PI/180*this.lat);return new Mi(new qr(this.lng-l,this.lat-a),new qr(this.lng+l,this.lat+a))},qr.convert=function(r){if(r instanceof qr)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new qr(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new qr(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var X_=2*Math.PI*63710088e-1;function Z_(r){return X_*Math.cos(r*Math.PI/180)}function Y_(r){return(180+r)/360}function W_(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function K_(r,a){return r/Z_(a)}function jy(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}var oc=function(r,a,l){l===void 0&&(l=0),this.x=+r,this.y=+a,this.z=+l};oc.fromLngLat=function(r,a){a===void 0&&(a=0);var l=qr.convert(r);return new oc(Y_(l.lng),W_(l.lat),K_(a,l.lat))},oc.prototype.toLngLat=function(){return new qr(360*this.x-180,jy(this.y))},oc.prototype.toAltitude=function(){return this.z*Z_(jy(this.y))},oc.prototype.meterInMercatorCoordinateUnits=function(){return 1/X_*(r=jy(this.y),1/Math.cos(r*Math.PI/180));var r};var ac=function(r,a,l){this.z=r,this.x=a,this.y=l,this.key=Jp(0,r,r,a,l)};ac.prototype.equals=function(r){return this.z===r.z&&this.x===r.x&&this.y===r.y},ac.prototype.url=function(r,a){var l,f,g,m,x,E=(f=this.y,g=this.z,m=H_(256*(l=this.x),256*(f=Math.pow(2,g)-f-1),g),x=H_(256*(l+1),256*(f+1),g),m[0]+","+m[1]+","+x[0]+","+x[1]),C=function(P,M,A){for(var F,B="",X=P;X>0;X--)B+=(M&(F=1<<X-1)?1:0)+(A&F?2:0);return B}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",C).replace("{bbox-epsg-3857}",E)},ac.prototype.getTilePoint=function(r){var a=Math.pow(2,this.z);return new L(8192*(r.x*a-this.x),8192*(r.y*a-this.y))},ac.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var J_=function(r,a){this.wrap=r,this.canonical=a,this.key=Jp(r,a.z,a.z,a.x,a.y)},Ai=function(r,a,l,f,g){this.overscaledZ=r,this.wrap=a,this.canonical=new ac(l,+f,+g),this.key=Jp(a,r,l,f,g)};function Jp(r,a,l,f,g){(r*=2)<0&&(r=-1*r-1);var m=1<<l;return(m*m*r+m*g+f).toString(36)+l.toString(36)+a.toString(36)}Ai.prototype.equals=function(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)},Ai.prototype.scaledTo=function(r){var a=this.canonical.z-r;return r>this.canonical.z?new Ai(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ai(r,this.wrap,r,this.canonical.x>>a,this.canonical.y>>a)},Ai.prototype.calculateScaledKey=function(r,a){var l=this.canonical.z-r;return r>this.canonical.z?Jp(this.wrap*+a,r,this.canonical.z,this.canonical.x,this.canonical.y):Jp(this.wrap*+a,r,r,this.canonical.x>>l,this.canonical.y>>l)},Ai.prototype.isChildOf=function(r){if(r.wrap!==this.wrap)return!1;var a=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>a&&r.canonical.y===this.canonical.y>>a},Ai.prototype.children=function(r){if(this.overscaledZ>=r)return[new Ai(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var a=this.canonical.z+1,l=2*this.canonical.x,f=2*this.canonical.y;return[new Ai(a,this.wrap,a,l,f),new Ai(a,this.wrap,a,l+1,f),new Ai(a,this.wrap,a,l,f+1),new Ai(a,this.wrap,a,l+1,f+1)]},Ai.prototype.isLessThan=function(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))},Ai.prototype.wrapped=function(){return new Ai(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ai.prototype.unwrapTo=function(r){return new Ai(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)},Ai.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ai.prototype.toUnwrapped=function(){return new J_(this.wrap,this.canonical)},Ai.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ai.prototype.getTilePoint=function(r){return this.canonical.getTilePoint(new oc(r.x-this.wrap,r.y))},Qt("CanonicalTileID",ac),Qt("OverscaledTileID",Ai,{omit:["posMatrix"]});var wu=function(r,a,l){if(this.uid=r,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return Le('"'+l+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=a.height;var f=this.dim=a.height-2;this.data=new Uint32Array(a.data.buffer),this.encoding=l||"mapbox";for(var g=0;g<f;g++)this.data[this._idx(-1,g)]=this.data[this._idx(0,g)],this.data[this._idx(f,g)]=this.data[this._idx(f-1,g)],this.data[this._idx(g,-1)]=this.data[this._idx(g,0)],this.data[this._idx(g,f)]=this.data[this._idx(g,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)]};wu.prototype.get=function(r,a){var l=new Uint8Array(this.data.buffer),f=4*this._idx(r,a);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(l[f],l[f+1],l[f+2])},wu.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},wu.prototype._idx=function(r,a){if(r<-1||r>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(r+1)},wu.prototype._unpackMapbox=function(r,a,l){return(256*r*256+256*a+l)/10-1e4},wu.prototype._unpackTerrarium=function(r,a,l){return 256*r+a+l/256-32768},wu.prototype.getPixels=function(){return new io({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},wu.prototype.backfillBorder=function(r,a,l){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");var f=a*this.dim,g=a*this.dim+this.dim,m=l*this.dim,x=l*this.dim+this.dim;switch(a){case-1:f=g-1;break;case 1:g=f+1}switch(l){case-1:m=x-1;break;case 1:x=m+1}for(var E=-a*this.dim,C=-l*this.dim,P=m;P<x;P++)for(var M=f;M<g;M++)this.data[this._idx(M,P)]=r.data[this._idx(M+E,P+C)]},Qt("DEMData",wu);var Xd=function(r){this._stringToNumber={},this._numberToString=[];for(var a=0;a<r.length;a++){var l=r[a];this._stringToNumber[l]=a,this._numberToString[a]=l}};Xd.prototype.encode=function(r){return this._stringToNumber[r]},Xd.prototype.decode=function(r){return this._numberToString[r]};var Zd=function(r,a,l,f,g){this.type="Feature",this._vectorTileFeature=r,r._z=a,r._x=l,r._y=f,this.properties=r.properties,this.id=g},Gy={geometry:{configurable:!0}};Gy.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Gy.geometry.set=function(r){this._geometry=r},Zd.prototype.toJSON=function(){var r={geometry:this.geometry};for(var a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(r[a]=this[a]);return r},Object.defineProperties(Zd.prototype,Gy);var _h=function(){this.state={},this.stateChanges={},this.deletedStates={}};_h.prototype.updateState=function(r,a,l){var f=String(a);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][f]=this.stateChanges[r][f]||{},ut(this.stateChanges[r][f],l),this.deletedStates[r]===null)for(var g in this.deletedStates[r]={},this.state[r])g!==f&&(this.deletedStates[r][g]=null);else if(this.deletedStates[r]&&this.deletedStates[r][f]===null)for(var m in this.deletedStates[r][f]={},this.state[r][f])l[m]||(this.deletedStates[r][f][m]=null);else for(var x in l)this.deletedStates[r]&&this.deletedStates[r][f]&&this.deletedStates[r][f][x]===null&&delete this.deletedStates[r][f][x]},_h.prototype.removeFeatureState=function(r,a,l){if(this.deletedStates[r]!==null){var f=String(a);if(this.deletedStates[r]=this.deletedStates[r]||{},l&&a!==void 0)this.deletedStates[r][f]!==null&&(this.deletedStates[r][f]=this.deletedStates[r][f]||{},this.deletedStates[r][f][l]=null);else if(a!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][f])for(l in this.deletedStates[r][f]={},this.stateChanges[r][f])this.deletedStates[r][f][l]=null;else this.deletedStates[r][f]=null;else this.deletedStates[r]=null}},_h.prototype.getState=function(r,a){var l=String(a),f=ut({},(this.state[r]||{})[l],(this.stateChanges[r]||{})[l]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){var g=this.deletedStates[r][a];if(g===null)return{};for(var m in g)delete f[m]}return f},_h.prototype.initializeTileState=function(r,a){r.setFeatureState(this.state,a)},_h.prototype.coalesceChanges=function(r,a){var l={};for(var f in this.stateChanges){this.state[f]=this.state[f]||{};var g={};for(var m in this.stateChanges[f])this.state[f][m]||(this.state[f][m]={}),ut(this.state[f][m],this.stateChanges[f][m]),g[m]=this.state[f][m];l[f]=g}for(var x in this.deletedStates){this.state[x]=this.state[x]||{};var E={};if(this.deletedStates[x]===null)for(var C in this.state[x])E[C]={},this.state[x][C]={};else for(var P in this.deletedStates[x]){if(this.deletedStates[x][P]===null)this.state[x][P]={};else for(var M=0,A=Object.keys(this.deletedStates[x][P]);M<A.length;M+=1)delete this.state[x][P][A[M]];E[P]=this.state[x][P]}l[x]=l[x]||{},ut(l[x],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(var F in r)r[F].setFeatureState(l,a)};var Eu=function(r,a){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Ga(8192,16,0),this.grid3D=new Ga(8192,16,0),this.featureIndexArray=new O,this.promoteId=a};function Q_(r,a,l,f,g){return $t(r,function(m,x){var E=a instanceof Kl?a.get(x):null;return E&&E.evaluate?E.evaluate(l,f,g):E})}function $_(r){for(var a=1/0,l=1/0,f=-1/0,g=-1/0,m=0,x=r;m<x.length;m+=1){var E=x[m];a=Math.min(a,E.x),l=Math.min(l,E.y),f=Math.max(f,E.x),g=Math.max(g,E.y)}return{minX:a,minY:l,maxX:f,maxY:g}}function jb(r,a){return a-r}Eu.prototype.insert=function(r,a,l,f,g,m){var x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,f,g);for(var E=m?this.grid3D:this.grid,C=0;C<a.length;C++){for(var P=a[C],M=[1/0,1/0,-1/0,-1/0],A=0;A<P.length;A++){var F=P[A];M[0]=Math.min(M[0],F.x),M[1]=Math.min(M[1],F.y),M[2]=Math.max(M[2],F.x),M[3]=Math.max(M[3],F.y)}M[0]<8192&&M[1]<8192&&M[2]>=0&&M[3]>=0&&E.insert(x,M[0],M[1],M[2],M[3])}},Eu.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new uh.VectorTile(new Nd(this.rawTileData)).layers,this.sourceLayerCoder=new Xd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Eu.prototype.query=function(r,a,l,f){var g=this;this.loadVTLayers();for(var m=r.params||{},x=8192/r.tileSize/r.scale,E=Hc(m.filter),C=r.queryGeometry,P=r.queryPadding*x,M=$_(C),A=this.grid.query(M.minX-P,M.minY-P,M.maxX+P,M.maxY+P),F=$_(r.cameraQueryGeometry),B=this.grid3D.query(F.minX-P,F.minY-P,F.maxX+P,F.maxY+P,function(gt,_t,It,Dt){return function(Rt,oe,jt,le,Ht){for(var Oe=0,_e=Rt;Oe<_e.length;Oe+=1){var re=_e[Oe];if(oe<=re.x&&jt<=re.y&&le>=re.x&&Ht>=re.y)return!0}var ze=[new L(oe,jt),new L(oe,Ht),new L(le,Ht),new L(le,jt)];if(Rt.length>2){for(var Pe=0,Ke=ze;Pe<Ke.length;Pe+=1)if(xa(Rt,Ke[Pe]))return!0}for(var ce=0;ce<Rt.length-1;ce++)if(ec(Rt[ce],Rt[ce+1],ze))return!0;return!1}(r.cameraQueryGeometry,gt-P,_t-P,It+P,Dt+P)}),X=0,Z=B;X<Z.length;X+=1)A.push(Z[X]);A.sort(jb);for(var it,$={},lt=function(gt){var _t=A[gt];if(_t!==it){it=_t;var It=g.featureIndexArray.get(_t),Dt=null;g.loadMatchingFeature($,It.bucketIndex,It.sourceLayerIndex,It.featureIndex,E,m.layers,m.availableImages,a,l,f,function(Rt,oe,jt){return Dt||(Dt=Wr(Rt)),oe.queryIntersectsFeature(C,Rt,jt,Dt,g.z,r.transform,x,r.pixelPosMatrix)})}},pt=0;pt<A.length;pt++)lt(pt);return $},Eu.prototype.loadMatchingFeature=function(r,a,l,f,g,m,x,E,C,P,M){var A=this.bucketLayerIDs[a];if(!m||function(Rt,oe){for(var jt=0;jt<Rt.length;jt++)if(oe.indexOf(Rt[jt])>=0)return!0;return!1}(m,A)){var F=this.sourceLayerCoder.decode(l),B=this.vtLayers[F].feature(f);if(g.needGeometry){var X=ci(B,!0);if(!g.filter(new Ue(this.tileID.overscaledZ),X,this.tileID.canonical))return}else if(!g.filter(new Ue(this.tileID.overscaledZ),B))return;for(var Z=this.getId(B,F),it=0;it<A.length;it++){var $=A[it];if(!(m&&m.indexOf($)<0)){var lt=E[$];if(lt){var pt={};Z!==void 0&&P&&(pt=P.getState(lt.sourceLayer||"_geojsonTileLayer",Z));var gt=ut({},C[$]);gt.paint=Q_(gt.paint,lt.paint,B,pt,x),gt.layout=Q_(gt.layout,lt.layout,B,pt,x);var _t=!M||M(B,lt,pt);if(_t){var It=new Zd(B,this.z,this.x,this.y,Z);It.layer=gt;var Dt=r[$];Dt===void 0&&(Dt=r[$]=[]),Dt.push({featureIndex:f,feature:It,intersectionZ:_t})}}}}}},Eu.prototype.lookupSymbolFeatures=function(r,a,l,f,g,m,x,E){var C={};this.loadVTLayers();for(var P=Hc(g),M=0,A=r;M<A.length;M+=1)this.loadMatchingFeature(C,l,f,A[M],P,m,x,E,a);return C},Eu.prototype.hasLayer=function(r){for(var a=0,l=this.bucketLayerIDs;a<l.length;a+=1)for(var f=0,g=l[a];f<g.length;f+=1)if(r===g[f])return!0;return!1},Eu.prototype.getId=function(r,a){var l=r.id;return this.promoteId&&typeof(l=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]])=="boolean"&&(l=Number(l)),l},Qt("FeatureIndex",Eu,{omit:["rawTileData","sourceLayerCoder"]});var Hi=function(r,a){this.tileID=r,this.uid=Ft(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Hi.prototype.registerFadeDuration=function(r){var a=r+this.timeAdded;a<Yo.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)},Hi.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Hi.prototype.loadVectorData=function(r,a,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){for(var f in r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(P,M){var A={};if(!M)return A;for(var F=function(){var Z=X[B],it=Z.layerIds.map(function(pt){return M.getLayer(pt)}).filter(Boolean);if(it.length!==0){Z.layers=it,Z.stateDependentLayerIds&&(Z.stateDependentLayers=Z.stateDependentLayerIds.map(function(pt){return it.filter(function(gt){return gt.id===pt})[0]}));for(var $=0,lt=it;$<lt.length;$+=1)A[lt[$].id]=Z}},B=0,X=P;B<X.length;B+=1)F();return A}(r.buckets,a.style),this.hasSymbolBuckets=!1,this.buckets){var g=this.buckets[f];if(g instanceof Sr){if(this.hasSymbolBuckets=!0,!l)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var x=this.buckets[m];if(x instanceof Sr&&x.hasRTLText){this.hasRTLText=!0,fo.isLoading()||fo.isLoaded()||kp()!=="deferred"||ta();break}}for(var E in this.queryPadding=0,this.buckets){var C=this.buckets[E];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(E).queryRadius(C))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new p},Hi.prototype.unloadVectorData=function(){for(var r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Hi.prototype.getBucket=function(r){return this.buckets[r.id]},Hi.prototype.upload=function(r){for(var a in this.buckets){var l=this.buckets[a];l.uploadPending()&&l.upload(r)}var f=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new nc(r,this.imageAtlas.image,f.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new nc(r,this.glyphAtlasImage,f.ALPHA),this.glyphAtlasImage=null)},Hi.prototype.prepare=function(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)},Hi.prototype.queryRenderedFeatures=function(r,a,l,f,g,m,x,E,C,P){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:g,scale:m,tileSize:this.tileSize,pixelPosMatrix:P,transform:E,params:x,queryPadding:this.queryPadding*C},r,a,l):{}},Hi.prototype.querySourceFeatures=function(r,a){var l=this.latestFeatureIndex;if(l&&l.rawTileData){var f=l.loadVTLayers(),g=a?a.sourceLayer:"",m=f._geojsonTileLayer||f[g];if(m)for(var x=Hc(a&&a.filter),E=this.tileID.canonical,C=E.z,P=E.x,M=E.y,A={z:C,x:P,y:M},F=0;F<m.length;F++){var B=m.feature(F);if(x.needGeometry){var X=ci(B,!0);if(!x.filter(new Ue(this.tileID.overscaledZ),X,this.tileID.canonical))continue}else if(!x.filter(new Ue(this.tileID.overscaledZ),B))continue;var Z=l.getId(B,g),it=new Zd(B,C,P,M,Z);it.tile=A,r.push(it)}}},Hi.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Hi.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Hi.prototype.setExpiryData=function(r){var a=this.expirationTime;if(r.cacheControl){var l=Ar(r.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){var f=Date.now(),g=!1;if(this.expirationTime>f)g=!1;else if(a)if(this.expirationTime<a)g=!0;else{var m=this.expirationTime-a;m?this.expirationTime=f+Math.max(m,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Hi.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Hi.prototype.setFeatureState=function(r,a){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(r).length!==0){var l=this.latestFeatureIndex.loadVTLayers();for(var f in this.buckets)if(a.style.hasLayer(f)){var g=this.buckets[f],m=g.layers[0].sourceLayer||"_geojsonTileLayer",x=l[m],E=r[m];if(x&&E&&Object.keys(E).length!==0){g.update(E,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});var C=a&&a.style&&a.style.getLayer(f);C&&(this.queryPadding=Math.max(this.queryPadding,C.queryRadius(g)))}}}},Hi.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Hi.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Yo.now()},Hi.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Hi.prototype.setHoldDuration=function(r){this.symbolFadeHoldUntil=Yo.now()+r},Hi.prototype.setDependencies=function(r,a){for(var l={},f=0,g=a;f<g.length;f+=1)l[g[f]]=!0;this.dependencies[r]=l},Hi.prototype.hasDependency=function(r,a){for(var l=0,f=r;l<f.length;l+=1){var g=this.dependencies[f[l]];if(g){for(var m=0,x=a;m<x.length;m+=1)if(g[x[m]])return!0}}return!1};var ol=N.performance,tv=function(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},ol.mark(this._marks.start)};tv.prototype.finish=function(){ol.mark(this._marks.end);var r=ol.getEntriesByName(this._marks.measure);return r.length===0&&(ol.measure(this._marks.measure,this._marks.start,this._marks.end),r=ol.getEntriesByName(this._marks.measure),ol.clearMarks(this._marks.start),ol.clearMarks(this._marks.end),ol.clearMeasures(this._marks.measure)),r},s.Actor=mh,s.AlphaImage=ic,s.CanonicalTileID=ac,s.CollisionBoxArray=p,s.Color=ur,s.DEMData=wu,s.DataConstantProperty=se,s.DictionaryCoder=Xd,s.EXTENT=8192,s.ErrorEvent=ot,s.EvaluationParameters=Ue,s.Event=W,s.Evented=st,s.FeatureIndex=Eu,s.FillBucket=Ya,s.FillExtrusionBucket=Wa,s.ImageAtlas=Wp,s.ImagePosition=Fd,s.LineBucket=jn,s.LngLat=qr,s.LngLatBounds=Mi,s.MercatorCoordinate=oc,s.ONE_EM=24,s.OverscaledTileID=Ai,s.Point=L,s.Point$1=L,s.Properties=en,s.Protobuf=Nd,s.RGBAImage=io,s.RequestManager=hn,s.RequestPerformance=tv,s.ResourceType=Rc,s.SegmentVector=q,s.SourceFeatureState=_h,s.StructArrayLayout1ui2=Vp,s.StructArrayLayout2f1f2i16=_u,s.StructArrayLayout2i4=mu,s.StructArrayLayout3ui6=Ss,s.StructArrayLayout4i8=Rp,s.SymbolBucket=Sr,s.Texture=nc,s.Tile=Hi,s.Transitionable=tn,s.Uniform1f=kt,s.Uniform1i=Lt,s.Uniform2f=Ot,s.Uniform3f=Zt,s.Uniform4f=ue,s.UniformColor=pe,s.UniformMatrix4f=Je,s.UnwrappedTileID=J_,s.ValidationError=J,s.WritingMode=Fo,s.ZoomHistory=Mp,s.add=function(r,a,l){return r[0]=a[0]+l[0],r[1]=a[1]+l[1],r[2]=a[2]+l[2],r},s.addDynamicAttributes=Vy,s.asyncAll=function(r,a,l){if(!r.length)return l(null,[]);var f=r.length,g=new Array(r.length),m=null;r.forEach(function(x,E){a(x,function(C,P){C&&(m=C),g[E]=P,--f==0&&l(m,g)})})},s.bezier=tt,s.bindAll=ae,s.browser=Yo,s.cacheEntryPossiblyAdded=function(r){++Ml>Nc&&(r.getActor().send("enforceCacheSizeLimit",Uu),Ml=0)},s.clamp=mt,s.clearTileCache=function(r){var a=N.caches.delete("mapbox-tiles");r&&a.catch(r).then(function(){return r()})},s.clipLine=N_,s.clone=function(r){var a=new lr(16);return a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7],a[8]=r[8],a[9]=r[9],a[10]=r[10],a[11]=r[11],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15],a},s.clone$1=Ce,s.clone$2=function(r){var a=new lr(3);return a[0]=r[0],a[1]=r[1],a[2]=r[2],a},s.collisionCircleLayout=lb,s.config=_r,s.create=function(){var r=new lr(16);return lr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},s.create$1=function(){var r=new lr(9);return lr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r},s.create$2=function(){var r=new lr(4);return lr!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r},s.createCommonjsModule=y,s.createExpression=jc,s.createLayout=ji,s.createStyleLayer=function(r){return r.type==="custom"?new Ub(r):new qb[r.type](r)},s.cross=function(r,a,l){var f=a[0],g=a[1],m=a[2],x=l[0],E=l[1],C=l[2];return r[0]=g*C-m*E,r[1]=m*x-f*C,r[2]=f*E-g*x,r},s.deepEqual=function r(a,l){if(Array.isArray(a)){if(!Array.isArray(l)||a.length!==l.length)return!1;for(var f=0;f<a.length;f++)if(!r(a[f],l[f]))return!1;return!0}if(typeof a=="object"&&a!==null&&l!==null){if(typeof l!="object"||Object.keys(a).length!==Object.keys(l).length)return!1;for(var g in a)if(!r(a[g],l[g]))return!1;return!0}return a===l},s.dot=function(r,a){return r[0]*a[0]+r[1]*a[1]+r[2]*a[2]},s.dot$1=function(r,a){return r[0]*a[0]+r[1]*a[1]+r[2]*a[2]+r[3]*a[3]},s.ease=xt,s.emitValidationErrors=Zl,s.endsWith=de,s.enforceCacheSizeLimit=function(r){qu(),To&&To.then(function(a){a.keys().then(function(l){for(var f=0;f<l.length-r;f++)a.delete(l[f])})})},s.evaluateSizeForFeature=T_,s.evaluateSizeForZoom=M_,s.evaluateVariableOffset=z_,s.evented=Op,s.extend=ut,s.featureFilter=Hc,s.filterObject=Be,s.fromRotation=function(r,a){var l=Math.sin(a),f=Math.cos(a);return r[0]=f,r[1]=l,r[2]=0,r[3]=-l,r[4]=f,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},s.getAnchorAlignment=Ry,s.getAnchorJustification=By,s.getArrayBuffer=Dl,s.getImage=R,s.getJSON=function(r,a){return ju(ut(r,{type:"json"}),a)},s.getRTLTextPluginStatus=kp,s.getReferrer=eu,s.getVideo=function(r,a){var l,f,g=N.document.createElement("video");g.muted=!0,g.onloadstart=function(){a(null,g)};for(var m=0;m<r.length;m++){var x=N.document.createElement("source");l=r[m],f=void 0,(f=N.document.createElement("a")).href=l,(f.protocol!==N.document.location.protocol||f.host!==N.document.location.host)&&(g.crossOrigin="Anonymous"),x.src=r[m],g.appendChild(x)}return{cancel:function(){}}},s.identity=go,s.invert=function(r,a){var l=a[0],f=a[1],g=a[2],m=a[3],x=a[4],E=a[5],C=a[6],P=a[7],M=a[8],A=a[9],F=a[10],B=a[11],X=a[12],Z=a[13],it=a[14],$=a[15],lt=l*E-f*x,pt=l*C-g*x,gt=l*P-m*x,_t=f*C-g*E,It=f*P-m*E,Dt=g*P-m*C,Rt=M*Z-A*X,oe=M*it-F*X,jt=M*$-B*X,le=A*it-F*Z,Ht=A*$-B*Z,Oe=F*$-B*it,_e=lt*Oe-pt*Ht+gt*le+_t*jt-It*oe+Dt*Rt;return _e?(r[0]=(E*Oe-C*Ht+P*le)*(_e=1/_e),r[1]=(g*Ht-f*Oe-m*le)*_e,r[2]=(Z*Dt-it*It+$*_t)*_e,r[3]=(F*It-A*Dt-B*_t)*_e,r[4]=(C*jt-x*Oe-P*oe)*_e,r[5]=(l*Oe-g*jt+m*oe)*_e,r[6]=(it*gt-X*Dt-$*pt)*_e,r[7]=(M*Dt-F*gt+B*pt)*_e,r[8]=(x*Ht-E*jt+P*Rt)*_e,r[9]=(f*jt-l*Ht-m*Rt)*_e,r[10]=(X*It-Z*gt+$*lt)*_e,r[11]=(A*gt-M*It-B*lt)*_e,r[12]=(E*oe-x*le-C*Rt)*_e,r[13]=(l*le-f*oe+g*Rt)*_e,r[14]=(Z*pt-X*_t-it*lt)*_e,r[15]=(M*_t-A*pt+F*lt)*_e,r):null},s.isChar=Bt,s.isMapboxURL=Co,s.keysDifference=function(r,a){var l=[];for(var f in r)f in a||l.push(f);return l},s.makeRequest=ju,s.mapObject=$t,s.mercatorXfromLng=Y_,s.mercatorYfromLat=W_,s.mercatorZfromAltitude=K_,s.mul=Sy,s.multiply=qn,s.mvt=uh,s.nextPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},s.normalize=function(r,a){var l=a[0],f=a[1],g=a[2],m=l*l+f*f+g*g;return m>0&&(m=1/Math.sqrt(m)),r[0]=a[0]*m,r[1]=a[1]*m,r[2]=a[2]*m,r},s.number=xi,s.offscreenCanvasSupported=Al,s.ortho=function(r,a,l,f,g,m,x){var E=1/(a-l),C=1/(f-g),P=1/(m-x);return r[0]=-2*E,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*C,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*P,r[11]=0,r[12]=(a+l)*E,r[13]=(g+f)*C,r[14]=(x+m)*P,r[15]=1,r},s.parseGlyphPBF=function(r){return new Nd(r).readFields(xb,[])},s.pbf=Nd,s.performSymbolLayout=function(r,a,l,f,g,m,x){r.createArrays(),r.tilePixelRatio=8192/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;var E=r.layers[0].layout,C=r.layers[0]._unevaluatedLayout._values,P={};if(r.textSizeData.kind==="composite"){var M=r.textSizeData,A=M.maxZoom;P.compositeTextSizes=[C["text-size"].possiblyEvaluate(new Ue(M.minZoom),x),C["text-size"].possiblyEvaluate(new Ue(A),x)]}if(r.iconSizeData.kind==="composite"){var F=r.iconSizeData,B=F.maxZoom;P.compositeIconSizes=[C["icon-size"].possiblyEvaluate(new Ue(F.minZoom),x),C["icon-size"].possiblyEvaluate(new Ue(B),x)]}P.layoutTextSize=C["text-size"].possiblyEvaluate(new Ue(r.zoom+1),x),P.layoutIconSize=C["icon-size"].possiblyEvaluate(new Ue(r.zoom+1),x),P.textMaxSize=C["text-size"].possiblyEvaluate(new Ue(18));for(var X=24*E.get("text-line-height"),Z=E.get("text-rotation-alignment")==="map"&&E.get("symbol-placement")!=="point",it=E.get("text-keep-upright"),$=E.get("text-size"),lt=function(){var _t=gt[pt],It=E.get("text-font").evaluate(_t,{},x).join(","),Dt=$.evaluate(_t,{},x),Rt=P.layoutTextSize.evaluate(_t,{},x),oe=P.layoutIconSize.evaluate(_t,{},x),jt={horizontal:{},vertical:void 0},le=_t.text,Ht=[0,0];if(le){var Oe=le.toString(),_e=24*E.get("text-letter-spacing").evaluate(_t,{},x),re=function(je){for(var Pr=0,vr=je;Pr<vr.length;Pr+=1)if(Qe=vr[Pr].charCodeAt(0),Bt.Arabic(Qe)||Bt["Arabic Supplement"](Qe)||Bt["Arabic Extended-A"](Qe)||Bt["Arabic Presentation Forms-A"](Qe)||Bt["Arabic Presentation Forms-B"](Qe))return!1;var Qe;return!0}(Oe)?_e:0,ze=E.get("text-anchor").evaluate(_t,{},x),Pe=E.get("text-variable-anchor");if(!Pe){var Ke=E.get("text-radial-offset").evaluate(_t,{},x);Ht=Ke?z_(ze,[24*Ke,zy]):E.get("text-offset").evaluate(_t,{},x).map(function(je){return 24*je})}var ce=Z?"center":E.get("text-justify").evaluate(_t,{},x),ir=E.get("symbol-placement"),jr=ir==="point"?24*E.get("text-max-width").evaluate(_t,{},x):0,ei=function(){r.allowVerticalPlacement&&Ap(Oe)&&(jt.vertical=zd(le,a,l,g,It,jr,X,ze,"left",re,Ht,Fo.vertical,!0,ir,Rt,Dt))};if(!Z&&Pe){for(var Kr=ce==="auto"?Pe.map(function(je){return By(je)}):[ce],Gr=!1,ri=0;ri<Kr.length;ri++){var Bi=Kr[ri];if(!jt.horizontal[Bi])if(Gr)jt.horizontal[Bi]=jt.horizontal[0];else{var Vi=zd(le,a,l,g,It,jr,X,"center",Bi,re,Ht,Fo.horizontal,!1,ir,Rt,Dt);Vi&&(jt.horizontal[Bi]=Vi,Gr=Vi.positionedLines.length===1)}}ei()}else{ce==="auto"&&(ce=By(ze));var Cn=zd(le,a,l,g,It,jr,X,ze,ce,re,Ht,Fo.horizontal,!1,ir,Rt,Dt);Cn&&(jt.horizontal[ce]=Cn),ei(),Ap(Oe)&&Z&&it&&(jt.vertical=zd(le,a,l,g,It,jr,X,ze,ce,re,Ht,Fo.vertical,!1,ir,Rt,Dt))}}var Xi=void 0,Ln=!1;if(_t.icon&&_t.icon.name){var hi=f[_t.icon.name];hi&&(Xi=function(je,Pr,vr){var Qe=Ry(vr),Gn=Pr[0]-je.displaySize[0]*Qe.horizontalAlign,fn=Pr[1]-je.displaySize[1]*Qe.verticalAlign;return{image:je,top:fn,bottom:fn+je.displaySize[1],left:Gn,right:Gn+je.displaySize[0]}}(g[_t.icon.name],E.get("icon-offset").evaluate(_t,{},x),E.get("icon-anchor").evaluate(_t,{},x)),Ln=hi.sdf,r.sdfIcons===void 0?r.sdfIcons=hi.sdf:r.sdfIcons!==hi.sdf&&Le("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(hi.pixelRatio!==r.pixelRatio||E.get("icon-rotate").constantOr(1)!==0)&&(r.iconsNeedLinear=!0))}var Zi=V_(jt.horizontal)||jt.vertical;r.iconsInText=!!Zi&&Zi.iconsInText,(Zi||Xi)&&function(je,Pr,vr,Qe,Gn,fn,Br,wi,dn,nr,Ms){var zo=fn.textMaxSize.evaluate(Pr,{});zo===void 0&&(zo=Br);var As,pi=je.layers[0].layout,Ds=pi.get("icon-offset").evaluate(Pr,{},Ms),wa=V_(vr.horizontal),vh=Br/24,sc=je.tilePixelRatio*vh,xh=je.tilePixelRatio*zo/24,Su=je.tilePixelRatio*wi,bh=je.tilePixelRatio*pi.get("symbol-spacing"),Yd=pi.get("text-padding")*je.tilePixelRatio,wh=pi.get("icon-padding")*je.tilePixelRatio,Qp=pi.get("text-max-angle")/180*Math.PI,Wd=pi.get("text-rotation-alignment")==="map"&&pi.get("symbol-placement")!=="point",Kd=pi.get("icon-rotation-alignment")==="map"&&pi.get("symbol-placement")!=="point",Iu=pi.get("symbol-placement"),$p=bh/2,Eh=pi.get("icon-text-fit");Qe&&Eh!=="none"&&(je.allowVerticalPlacement&&vr.vertical&&(As=P_(Qe,vr.vertical,Eh,pi.get("icon-text-fit-padding"),Ds,vh)),wa&&(Qe=P_(Qe,wa,Eh,pi.get("icon-text-fit-padding"),Ds,vh)));var al=function(Gb,uf){uf.x<0||uf.x>=8192||uf.y<0||uf.y>=8192||function(fi,Ka,Hb,sl,Yy,iv,rg,Os,ig,lf,ng,og,Wy,nv,cf,ov,av,sv,uv,lv,Bo,ag,cv,ks,Xb){var hv,lc,Ph,Th,Mh,Ah=fi.addToLineVertexArray(Ka,Hb),pv=0,fv=0,dv=0,gv=0,Ky=-1,Jy=-1,Cu={},yv=H(""),Qy=0,$y=0;if(Os._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Qy=(hv=Os.layout.get("text-offset").evaluate(Bo,{},ks).map(function(pf){return 24*pf}))[0],$y=hv[1]):(Qy=24*Os.layout.get("text-radial-offset").evaluate(Bo,{},ks),$y=zy),fi.allowVerticalPlacement&&sl.vertical){var mv=Os.layout.get("text-rotate").evaluate(Bo,{},ks)+90;Th=new jd(ig,Ka,lf,ng,og,sl.vertical,Wy,nv,cf,mv),rg&&(Mh=new jd(ig,Ka,lf,ng,og,rg,av,sv,cf,mv))}if(Yy){var tm=Os.layout.get("icon-rotate").evaluate(Bo,{}),_v=Os.layout.get("icon-text-fit")!=="none",vv=R_(Yy,tm,cv,_v),em=rg?R_(rg,tm,cv,_v):void 0;Ph=new jd(ig,Ka,lf,ng,og,Yy,av,sv,!1,tm),pv=4*vv.length;var xv=fi.iconSizeData,hf=null;xv.kind==="source"?(hf=[128*Os.layout.get("icon-size").evaluate(Bo,{})])[0]>32640&&Le(fi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):xv.kind==="composite"&&((hf=[128*ag.compositeIconSizes[0].evaluate(Bo,{},ks),128*ag.compositeIconSizes[1].evaluate(Bo,{},ks)])[0]>32640||hf[1]>32640)&&Le(fi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),fi.addSymbols(fi.icon,vv,hf,lv,uv,Bo,!1,Ka,Ah.lineStartIndex,Ah.lineLength,-1,ks),Ky=fi.icon.placedSymbolArray.length-1,em&&(fv=4*em.length,fi.addSymbols(fi.icon,em,hf,lv,uv,Bo,Fo.vertical,Ka,Ah.lineStartIndex,Ah.lineLength,-1,ks),Jy=fi.icon.placedSymbolArray.length-1)}for(var bv in sl.horizontal){var sg=sl.horizontal[bv];if(!lc){yv=H(sg.text);var Zb=Os.layout.get("text-rotate").evaluate(Bo,{},ks);lc=new jd(ig,Ka,lf,ng,og,sg,Wy,nv,cf,Zb)}var wv=sg.positionedLines.length===1;if(dv+=B_(fi,Ka,sg,iv,Os,cf,Bo,ov,Ah,sl.vertical?Fo.horizontal:Fo.horizontalOnly,wv?Object.keys(sl.horizontal):[bv],Cu,Ky,ag,ks),wv)break}sl.vertical&&(gv+=B_(fi,Ka,sl.vertical,iv,Os,cf,Bo,ov,Ah,Fo.vertical,["vertical"],Cu,Jy,ag,ks));var Yb=lc?lc.boxStartIndex:fi.collisionBoxArray.length,Wb=lc?lc.boxEndIndex:fi.collisionBoxArray.length,Kb=Th?Th.boxStartIndex:fi.collisionBoxArray.length,Jb=Th?Th.boxEndIndex:fi.collisionBoxArray.length,Qb=Ph?Ph.boxStartIndex:fi.collisionBoxArray.length,$b=Ph?Ph.boxEndIndex:fi.collisionBoxArray.length,tw=Mh?Mh.boxStartIndex:fi.collisionBoxArray.length,ew=Mh?Mh.boxEndIndex:fi.collisionBoxArray.length,Ns=-1,ug=function(pf,Sv){return pf&&pf.circleDiameter?Math.max(pf.circleDiameter,Sv):Sv};Ns=ug(lc,Ns),Ns=ug(Th,Ns),Ns=ug(Ph,Ns);var Ev=(Ns=ug(Mh,Ns))>-1?1:0;Ev&&(Ns*=Xb/24),fi.glyphOffsetArray.length>=Sr.MAX_GLYPHS&&Le("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Bo.sortKey!==void 0&&fi.addToSortKeyRanges(fi.symbolInstances.length,Bo.sortKey),fi.symbolInstances.emplaceBack(Ka.x,Ka.y,Cu.right>=0?Cu.right:-1,Cu.center>=0?Cu.center:-1,Cu.left>=0?Cu.left:-1,Cu.vertical||-1,Ky,Jy,yv,Yb,Wb,Kb,Jb,Qb,$b,tw,ew,lf,dv,gv,pv,fv,Ev,0,Wy,Qy,$y,Ns)}(je,uf,Gb,vr,Qe,Gn,As,je.layers[0],je.collisionBoxArray,Pr.index,Pr.sourceLayerIndex,je.index,sc,Yd,Wd,dn,Su,wh,Kd,Ds,Pr,fn,nr,Ms,Br)};if(Iu==="line")for(var Sh=0,Jd=N_(Pr.geometry,0,0,8192,8192);Sh<Jd.length;Sh+=1)for(var Qd=Jd[Sh],tf=0,ef=Lb(Qd,bh,Qp,vr.vertical||wa,Qe,24,xh,je.overscaling,8192);tf<ef.length;tf+=1){var $d=ef[tf];wa&&Ab(je,wa.text,$p,$d)||al(Qd,$d)}else if(Iu==="line-center")for(var rf=0,nf=Pr.geometry;rf<nf.length;rf+=1){var of=nf[rf];if(of.length>1){var tg=Cb(of,Qp,vr.vertical||wa,Qe,24,xh);tg&&al(of,tg)}}else if(Pr.type==="Polygon")for(var Ih=0,eg=Ay(Pr.geometry,0);Ih<eg.length;Ih+=1){var Ch=eg[Ih],af=Tb(Ch,16);al(Ch[0],new ph(af.x,af.y,0))}else if(Pr.type==="LineString")for(var uc=0,sf=Pr.geometry;uc<sf.length;uc+=1){var Lh=sf[uc];al(Lh,new ph(Lh[0].x,Lh[0].y,0))}else if(Pr.type==="Point")for(var Hy=0,ev=Pr.geometry;Hy<ev.length;Hy+=1)for(var Xy=0,rv=ev[Hy];Xy<rv.length;Xy+=1){var Zy=rv[Xy];al([Zy],new ph(Zy.x,Zy.y,0))}}(r,_t,jt,Xi,f,P,Rt,oe,Ht,Ln,x)},pt=0,gt=r.features;pt<gt.length;pt+=1)lt();m&&r.generateCollisionDebugBuffers()},s.perspective=function(r,a,l,f,g){var m,x=1/Math.tan(a/2);return r[0]=x/l,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=x,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,g!=null&&g!==1/0?(r[10]=(g+f)*(m=1/(f-g)),r[14]=2*g*f*m):(r[10]=-1,r[14]=-2*f),r},s.pick=function(r,a){for(var l={},f=0;f<a.length;f++){var g=a[f];g in r&&(l[g]=r[g])}return l},s.plugin=fo,s.polygonIntersectsPolygon=Ls,s.postMapLoadEvent=Pl,s.postTurnstileEvent=kc,s.potpack=S_,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.register=Qt,s.registerForPluginStateChange=function(r){return r({pluginStatus:to,pluginURL:Ha}),Op.on("pluginStateChange",r),r},s.renderColorRamp=o_,s.rotate=function(r,a,l){var f=a[0],g=a[1],m=a[2],x=a[3],E=Math.sin(l),C=Math.cos(l);return r[0]=f*C+m*E,r[1]=g*C+x*E,r[2]=f*-E+m*C,r[3]=g*-E+x*C,r},s.rotateX=function(r,a,l){var f=Math.sin(l),g=Math.cos(l),m=a[4],x=a[5],E=a[6],C=a[7],P=a[8],M=a[9],A=a[10],F=a[11];return a!==r&&(r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=a[3],r[12]=a[12],r[13]=a[13],r[14]=a[14],r[15]=a[15]),r[4]=m*g+P*f,r[5]=x*g+M*f,r[6]=E*g+A*f,r[7]=C*g+F*f,r[8]=P*g-m*f,r[9]=M*g-x*f,r[10]=A*g-E*f,r[11]=F*g-C*f,r},s.rotateZ=function(r,a,l){var f=Math.sin(l),g=Math.cos(l),m=a[0],x=a[1],E=a[2],C=a[3],P=a[4],M=a[5],A=a[6],F=a[7];return a!==r&&(r[8]=a[8],r[9]=a[9],r[10]=a[10],r[11]=a[11],r[12]=a[12],r[13]=a[13],r[14]=a[14],r[15]=a[15]),r[0]=m*g+P*f,r[1]=x*g+M*f,r[2]=E*g+A*f,r[3]=C*g+F*f,r[4]=P*g-m*f,r[5]=M*g-x*f,r[6]=A*g-E*f,r[7]=F*g-C*f,r},s.scale=function(r,a,l){var f=l[0],g=l[1],m=l[2];return r[0]=a[0]*f,r[1]=a[1]*f,r[2]=a[2]*f,r[3]=a[3]*f,r[4]=a[4]*g,r[5]=a[5]*g,r[6]=a[6]*g,r[7]=a[7]*g,r[8]=a[8]*m,r[9]=a[9]*m,r[10]=a[10]*m,r[11]=a[11]*m,r[12]=a[12],r[13]=a[13],r[14]=a[14],r[15]=a[15],r},s.scale$1=function(r,a,l){return r[0]=a[0]*l,r[1]=a[1]*l,r[2]=a[2]*l,r[3]=a[3]*l,r},s.scale$2=function(r,a,l){return r[0]=a[0]*l,r[1]=a[1]*l,r[2]=a[2]*l,r},s.setCacheLimits=function(r,a){Uu=r,Nc=a},s.setRTLTextPlugin=function(r,a,l){if(l===void 0&&(l=!1),to==="deferred"||to==="loading"||to==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Ha=Yo.resolveURL(r),to="deferred",Qc=a,Wl(),l||ta()},s.sphericalToCartesian=function(r){var a=r[0],l=r[1],f=r[2];return l+=90,l*=Math.PI/180,f*=Math.PI/180,{x:a*Math.cos(l)*Math.sin(f),y:a*Math.sin(l)*Math.sin(f),z:a*Math.cos(f)}},s.sqrLen=function(r){var a=r[0],l=r[1];return a*a+l*l},s.styleSpec=U,s.sub=function(r,a,l){return r[0]=a[0]-l[0],r[1]=a[1]-l[1],r[2]=a[2]-l[2],r},s.symbolSize=Ib,s.transformMat3=function(r,a,l){var f=a[0],g=a[1],m=a[2];return r[0]=f*l[0]+g*l[3]+m*l[6],r[1]=f*l[1]+g*l[4]+m*l[7],r[2]=f*l[2]+g*l[5]+m*l[8],r},s.transformMat4=nh,s.translate=function(r,a,l){var f,g,m,x,E,C,P,M,A,F,B,X,Z=l[0],it=l[1],$=l[2];return a===r?(r[12]=a[0]*Z+a[4]*it+a[8]*$+a[12],r[13]=a[1]*Z+a[5]*it+a[9]*$+a[13],r[14]=a[2]*Z+a[6]*it+a[10]*$+a[14],r[15]=a[3]*Z+a[7]*it+a[11]*$+a[15]):(g=a[1],m=a[2],x=a[3],E=a[4],C=a[5],P=a[6],M=a[7],A=a[8],F=a[9],B=a[10],X=a[11],r[0]=f=a[0],r[1]=g,r[2]=m,r[3]=x,r[4]=E,r[5]=C,r[6]=P,r[7]=M,r[8]=A,r[9]=F,r[10]=B,r[11]=X,r[12]=f*Z+E*it+A*$+a[12],r[13]=g*Z+C*it+F*$+a[13],r[14]=m*Z+P*it+B*$+a[14],r[15]=x*Z+M*it+X*$+a[15]),r},s.triggerPluginCompletionEvent=Pd,s.uniqueId=Ft,s.validateCustomStyleLayer=function(r){var a=[],l=r.id;return l===void 0&&a.push({message:"layers."+l+': missing required property "id"'}),r.render===void 0&&a.push({message:"layers."+l+': missing required method "render"'}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&a.push({message:"layers."+l+': property "renderingMode" must be either "2d" or "3d"'}),a},s.validateLight=wy,s.validateStyle=Hl,s.values=function(r){var a=[];for(var l in r)a.push(r[l]);return a},s.vectorTile=uh,s.version="1.13.3",s.warnOnce=Le,s.webpSupported=Io,s.window=N,s.wrap=Ct}),u(["./shared"],function(s){function y(D){var R=typeof D;if(R==="number"||R==="boolean"||R==="string"||D==null)return JSON.stringify(D);if(Array.isArray(D)){for(var z="[",G=0,W=D;G<W.length;G+=1)z+=y(W[G])+",";return z+"]"}for(var ot=Object.keys(D).sort(),st="{",U=0;U<ot.length;U++)st+=JSON.stringify(ot[U])+":"+y(D[ot[U]])+",";return st+"}"}function v(D){for(var R="",z=0,G=s.refProperties;z<G.length;z+=1)R+="/"+y(D[G[z]]);return R}var S=function(D){this.keyCache={},D&&this.replace(D)};S.prototype.replace=function(D){this._layerConfigs={},this._layers={},this.update(D,[])},S.prototype.update=function(D,R){for(var z=this,G=0,W=D;G<W.length;G+=1){var ot=W[G];this._layerConfigs[ot.id]=ot;var st=this._layers[ot.id]=s.createStyleLayer(ot);st._featureFilter=s.featureFilter(st.filter),this.keyCache[ot.id]&&delete this.keyCache[ot.id]}for(var U=0,J=R;U<J.length;U+=1){var ht=J[U];delete this.keyCache[ht],delete this._layerConfigs[ht],delete this._layers[ht]}this.familiesBySource={};for(var Tt=0,At=function(zt,Vt){for(var Ne={},Gt=0;Gt<zt.length;Gt++){var Ze=Vt&&Vt[zt[Gt].id]||v(zt[Gt]);Vt&&(Vt[zt[Gt].id]=Ze);var Cr=Ne[Ze];Cr||(Cr=Ne[Ze]=[]),Cr.push(zt[Gt])}var Ve=[];for(var sr in Ne)Ve.push(Ne[sr]);return Ve}(s.values(this._layerConfigs),this.keyCache);Tt<At.length;Tt+=1){var wt=At[Tt].map(function(zt){return z._layers[zt.id]}),Mt=wt[0];if(Mt.visibility!=="none"){var te=Mt.source||"",Jt=this.familiesBySource[te];Jt||(Jt=this.familiesBySource[te]={});var St=Mt.sourceLayer||"_geojsonTileLayer",Xt=Jt[St];Xt||(Xt=Jt[St]=[]),Xt.push(wt)}}};var L=function(D){var R={},z=[];for(var G in D){var W=D[G],ot=R[G]={};for(var st in W){var U=W[+st];if(U&&U.bitmap.width!==0&&U.bitmap.height!==0){var J={x:0,y:0,w:U.bitmap.width+2,h:U.bitmap.height+2};z.push(J),ot[st]={rect:J,metrics:U.metrics}}}}var ht=s.potpack(z),Tt=new s.AlphaImage({width:ht.w||1,height:ht.h||1});for(var At in D){var wt=D[At];for(var Mt in wt){var te=wt[+Mt];if(te&&te.bitmap.width!==0&&te.bitmap.height!==0){var Jt=R[At][Mt].rect;s.AlphaImage.copy(te.bitmap,Tt,{x:0,y:0},{x:Jt.x+1,y:Jt.y+1},te.bitmap)}}}this.image=Tt,this.positions=R};s.register("GlyphAtlas",L);var k=function(D){this.tileID=new s.OverscaledTileID(D.tileID.overscaledZ,D.tileID.wrap,D.tileID.canonical.z,D.tileID.canonical.x,D.tileID.canonical.y),this.uid=D.uid,this.zoom=D.zoom,this.pixelRatio=D.pixelRatio,this.tileSize=D.tileSize,this.source=D.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=D.showCollisionBoxes,this.collectResourceTiming=!!D.collectResourceTiming,this.returnDependencies=!!D.returnDependencies,this.promoteId=D.promoteId};function N(D,R,z){for(var G=new s.EvaluationParameters(R),W=0,ot=D;W<ot.length;W+=1)ot[W].recalculate(G,z)}function Q(D,R){var z=s.getArrayBuffer(D.request,function(G,W,ot,st){G?R(G):W&&R(null,{vectorTile:new s.vectorTile.VectorTile(new s.pbf(W)),rawData:W,cacheControl:ot,expires:st})});return function(){z.cancel(),R()}}k.prototype.parse=function(D,R,z,G,W){var ot=this;this.status="parsing",this.data=D,this.collisionBoxArray=new s.CollisionBoxArray;var st=new s.DictionaryCoder(Object.keys(D.layers).sort()),U=new s.FeatureIndex(this.tileID,this.promoteId);U.bucketLayerIDs=[];var J,ht,Tt,At,wt={},Mt={featureIndex:U,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:z},te=R.familiesBySource[this.source];for(var Jt in te){var St=D.layers[Jt];if(St){St.version===1&&s.warnOnce('Vector tile source "'+this.source+'" layer "'+Jt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Xt=st.encode(Jt),zt=[],Vt=0;Vt<St.length;Vt++){var Ne=St.feature(Vt),Gt=U.getId(Ne,Jt);zt.push({feature:Ne,id:Gt,index:Vt,sourceLayerIndex:Xt})}for(var Ze=0,Cr=te[Jt];Ze<Cr.length;Ze+=1){var Ve=Cr[Ze],sr=Ve[0];sr.minzoom&&this.zoom<Math.floor(sr.minzoom)||sr.maxzoom&&this.zoom>=sr.maxzoom||sr.visibility!=="none"&&(N(Ve,this.zoom,z),(wt[sr.id]=sr.createBucket({index:U.bucketLayerIDs.length,layers:Ve,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xt,sourceID:this.source})).populate(zt,Mt,this.tileID.canonical),U.bucketLayerIDs.push(Ve.map(function(Er){return Er.id})))}}}var We=s.mapObject(Mt.glyphDependencies,function(Er){return Object.keys(Er).map(Number)});Object.keys(We).length?G.send("getGlyphs",{uid:this.uid,stacks:We},function(Er,Ge){J||(J=Er,ht=Ge,ui.call(ot))}):ht={};var vn=Object.keys(Mt.iconDependencies);vn.length?G.send("getImages",{icons:vn,source:this.source,tileID:this.tileID,type:"icons"},function(Er,Ge){J||(J=Er,Tt=Ge,ui.call(ot))}):Tt={};var dr=Object.keys(Mt.patternDependencies);function ui(){if(J)return W(J);if(ht&&Tt&&At){var Er=new L(ht),Ge=new s.ImageAtlas(Tt,At);for(var ur in wt){var Bn=wt[ur];Bn instanceof s.SymbolBucket?(N(Bn.layers,this.zoom,z),s.performSymbolLayout(Bn,ht,Er.positions,Tt,Ge.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Bn.hasPattern&&(Bn instanceof s.LineBucket||Bn instanceof s.FillBucket||Bn instanceof s.FillExtrusionBucket)&&(N(Bn.layers,this.zoom,z),Bn.addFeatures(Mt,this.tileID.canonical,Ge.patternPositions))}this.status="done",W(null,{buckets:s.values(wt).filter(function(Ol){return!Ol.isEmpty()}),featureIndex:U,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Er.image,imageAtlas:Ge,glyphMap:this.returnDependencies?ht:null,iconMap:this.returnDependencies?Tt:null,glyphPositions:this.returnDependencies?Er.positions:null})}}dr.length?G.send("getImages",{icons:dr,source:this.source,tileID:this.tileID,type:"patterns"},function(Er,Ge){J||(J=Er,At=Ge,ui.call(ot))}):At={},ui.call(this)};var tt=function(D,R,z,G){this.actor=D,this.layerIndex=R,this.availableImages=z,this.loadVectorData=G||Q,this.loading={},this.loaded={}};tt.prototype.loadTile=function(D,R){var z=this,G=D.uid;this.loading||(this.loading={});var W=!!(D&&D.request&&D.request.collectResourceTiming)&&new s.RequestPerformance(D.request),ot=this.loading[G]=new k(D);ot.abort=this.loadVectorData(D,function(st,U){if(delete z.loading[G],st||!U)return ot.status="done",z.loaded[G]=ot,R(st);var J=U.rawData,ht={};U.expires&&(ht.expires=U.expires),U.cacheControl&&(ht.cacheControl=U.cacheControl);var Tt={};if(W){var At=W.finish();At&&(Tt.resourceTiming=JSON.parse(JSON.stringify(At)))}ot.vectorTile=U.vectorTile,ot.parse(U.vectorTile,z.layerIndex,z.availableImages,z.actor,function(wt,Mt){if(wt||!Mt)return R(wt);R(null,s.extend({rawTileData:J.slice(0)},Mt,ht,Tt))}),z.loaded=z.loaded||{},z.loaded[G]=ot})},tt.prototype.reloadTile=function(D,R){var z=this,G=this.loaded,W=D.uid,ot=this;if(G&&G[W]){var st=G[W];st.showCollisionBoxes=D.showCollisionBoxes;var U=function(J,ht){var Tt=st.reloadCallback;Tt&&(delete st.reloadCallback,st.parse(st.vectorTile,ot.layerIndex,z.availableImages,ot.actor,Tt)),R(J,ht)};st.status==="parsing"?st.reloadCallback=U:st.status==="done"&&(st.vectorTile?st.parse(st.vectorTile,this.layerIndex,this.availableImages,this.actor,U):U())}},tt.prototype.abortTile=function(D,R){var z=this.loading,G=D.uid;z&&z[G]&&z[G].abort&&(z[G].abort(),delete z[G]),R()},tt.prototype.removeTile=function(D,R){var z=this.loaded,G=D.uid;z&&z[G]&&delete z[G],R()};var xt=s.window.ImageBitmap,mt=function(){this.loaded={}};function Ct(D,R){if(D.length!==0){ut(D[0],R);for(var z=1;z<D.length;z++)ut(D[z],!R)}}function ut(D,R){for(var z=0,G=0,W=0,ot=D.length,st=ot-1;W<ot;st=W++){var U=(D[W][0]-D[st][0])*(D[st][1]+D[W][1]),J=z+U;G+=Math.abs(z)>=Math.abs(U)?z-J+U:U-J+z,z=J}z+G>=0!=!!R&&D.reverse()}mt.prototype.loadTile=function(D,R){var z=D.uid,G=D.encoding,W=D.rawImageData,ot=xt&&W instanceof xt?this.getImageData(W):W,st=new s.DEMData(z,ot,G);this.loaded=this.loaded||{},this.loaded[z]=st,R(null,st)},mt.prototype.getImageData=function(D){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(D.width,D.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=D.width,this.offscreenCanvas.height=D.height,this.offscreenCanvasContext.drawImage(D,0,0,D.width,D.height);var R=this.offscreenCanvasContext.getImageData(-1,-1,D.width+2,D.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new s.RGBAImage({width:R.width,height:R.height},R.data)},mt.prototype.removeTile=function(D){var R=this.loaded,z=D.uid;R&&R[z]&&delete R[z]};var Pt=s.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ft=function(D){this._feature=D,this.extent=s.EXTENT,this.type=D.type,this.properties=D.tags,"id"in D&&!isNaN(D.id)&&(this.id=parseInt(D.id,10))};Ft.prototype.loadGeometry=function(){if(this._feature.type===1){for(var D=[],R=0,z=this._feature.geometry;R<z.length;R+=1){var G=z[R];D.push([new s.Point$1(G[0],G[1])])}return D}for(var W=[],ot=0,st=this._feature.geometry;ot<st.length;ot+=1){for(var U=[],J=0,ht=st[ot];J<ht.length;J+=1){var Tt=ht[J];U.push(new s.Point$1(Tt[0],Tt[1]))}W.push(U)}return W},Ft.prototype.toGeoJSON=function(D,R,z){return Pt.call(this,D,R,z)};var ie=function(D){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=D.length,this._features=D};ie.prototype.feature=function(D){return new Ft(this._features[D])};var ne=s.vectorTile.VectorTileFeature,ae=de;function de(D,R){this.options=R||{},this.features=D,this.length=D.length}function $t(D,R){this.id=typeof D.id=="number"?D.id:void 0,this.type=D.type,this.rawGeometry=D.type===1?[D.geometry]:D.geometry,this.properties=D.tags,this.extent=R||4096}de.prototype.feature=function(D){return new $t(this.features[D],this.options.extent)},$t.prototype.loadGeometry=function(){var D=this.rawGeometry;this.geometry=[];for(var R=0;R<D.length;R++){for(var z=D[R],G=[],W=0;W<z.length;W++)G.push(new s.Point$1(z[W][0],z[W][1]));this.geometry.push(G)}return this.geometry},$t.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var D=this.geometry,R=1/0,z=-1/0,G=1/0,W=-1/0,ot=0;ot<D.length;ot++)for(var st=D[ot],U=0;U<st.length;U++){var J=st[U];R=Math.min(R,J.x),z=Math.max(z,J.x),G=Math.min(G,J.y),W=Math.max(W,J.y)}return[R,G,z,W]},$t.prototype.toGeoJSON=ne.prototype.toGeoJSON;var Be=er,Ce=ae;function er(D){var R=new s.pbf;return function(z,G){for(var W in z.layers)G.writeMessage(3,Le,z.layers[W])}(D,R),R.finish()}function Le(D,R){var z;R.writeVarintField(15,D.version||1),R.writeStringField(1,D.name||""),R.writeVarintField(5,D.extent||4096);var G={keys:[],values:[],keycache:{},valuecache:{}};for(z=0;z<D.length;z++)G.feature=D.feature(z),R.writeMessage(2,Ut,G);var W=G.keys;for(z=0;z<W.length;z++)R.writeStringField(3,W[z]);var ot=G.values;for(z=0;z<ot.length;z++)R.writeMessage(4,or,ot[z])}function Ut(D,R){var z=D.feature;z.id!==void 0&&R.writeVarintField(1,z.id),R.writeMessage(2,Fe,D),R.writeVarintField(3,z.type),R.writeMessage(4,mr,z)}function Fe(D,R){var z=D.feature,G=D.keys,W=D.values,ot=D.keycache,st=D.valuecache;for(var U in z.properties){var J=ot[U];J===void 0&&(G.push(U),ot[U]=J=G.length-1),R.writeVarint(J);var ht=z.properties[U],Tt=typeof ht;Tt!=="string"&&Tt!=="boolean"&&Tt!=="number"&&(ht=JSON.stringify(ht));var At=Tt+":"+ht,wt=st[At];wt===void 0&&(W.push(ht),st[At]=wt=W.length-1),R.writeVarint(wt)}}function ye(D,R){return(R<<3)+(7&D)}function Ar(D){return D<<1^D>>31}function mr(D,R){for(var z=D.loadGeometry(),G=D.type,W=0,ot=0,st=z.length,U=0;U<st;U++){var J=z[U],ht=1;G===1&&(ht=J.length),R.writeVarint(ye(1,ht));for(var Tt=G===3?J.length-1:J.length,At=0;At<Tt;At++){At===1&&G!==1&&R.writeVarint(ye(2,Tt-1));var wt=J[At].x-W,Mt=J[At].y-ot;R.writeVarint(Ar(wt)),R.writeVarint(Ar(Mt)),W+=wt,ot+=Mt}G===3&&R.writeVarint(ye(7,1))}}function or(D,R){var z=typeof D;z==="string"?R.writeStringField(1,D):z==="boolean"?R.writeBooleanField(7,D):z==="number"&&(D%1!=0?R.writeDoubleField(3,D):D<0?R.writeSVarintField(6,D):R.writeVarintField(5,D))}function cn(D,R,z,G){$r(D,z,G),$r(R,2*z,2*G),$r(R,2*z+1,2*G+1)}function $r(D,R,z){var G=D[R];D[R]=D[z],D[z]=G}function Li(D,R,z,G){var W=D-z,ot=R-G;return W*W+ot*ot}Be.fromVectorTileJs=er,Be.fromGeojsonVt=function(D,R){R=R||{};var z={};for(var G in D)z[G]=new ae(D[G].features,R),z[G].name=G,z[G].version=R.version,z[G].extent=R.extent;return er({layers:z})},Be.GeoJSONWrapper=Ce;var ar=function(D){return D[0]},wr=function(D){return D[1]},Dr=function(D,R,z,G,W){R===void 0&&(R=ar),z===void 0&&(z=wr),G===void 0&&(G=64),W===void 0&&(W=Float64Array),this.nodeSize=G,this.points=D;for(var ot=D.length<65536?Uint16Array:Uint32Array,st=this.ids=new ot(D.length),U=this.coords=new W(2*D.length),J=0;J<D.length;J++)st[J]=J,U[2*J]=R(D[J]),U[2*J+1]=z(D[J]);(function ht(Tt,At,wt,Mt,te,Jt){if(!(te-Mt<=wt)){var St=Mt+te>>1;(function Xt(zt,Vt,Ne,Gt,Ze,Cr){for(;Ze>Gt;){if(Ze-Gt>600){var Ve=Ze-Gt+1,sr=Ne-Gt+1,We=Math.log(Ve),vn=.5*Math.exp(2*We/3),dr=.5*Math.sqrt(We*vn*(Ve-vn)/Ve)*(sr-Ve/2<0?-1:1);Xt(zt,Vt,Ne,Math.max(Gt,Math.floor(Ne-sr*vn/Ve+dr)),Math.min(Ze,Math.floor(Ne+(Ve-sr)*vn/Ve+dr)),Cr)}var ui=Vt[2*Ne+Cr],Er=Gt,Ge=Ze;for(cn(zt,Vt,Gt,Ne),Vt[2*Ze+Cr]>ui&&cn(zt,Vt,Gt,Ze);Er<Ge;){for(cn(zt,Vt,Er,Ge),Er++,Ge--;Vt[2*Er+Cr]<ui;)Er++;for(;Vt[2*Ge+Cr]>ui;)Ge--}Vt[2*Gt+Cr]===ui?cn(zt,Vt,Gt,Ge):cn(zt,Vt,++Ge,Ze),Ge<=Ne&&(Gt=Ge+1),Ne<=Ge&&(Ze=Ge-1)}})(Tt,At,St,Mt,te,Jt%2),ht(Tt,At,wt,Mt,St-1,Jt+1),ht(Tt,At,wt,St+1,te,Jt+1)}})(st,U,G,0,st.length-1,0)};Dr.prototype.range=function(D,R,z,G){return function(W,ot,st,U,J,ht,Tt){for(var At,wt,Mt=[0,W.length-1,0],te=[];Mt.length;){var Jt=Mt.pop(),St=Mt.pop(),Xt=Mt.pop();if(St-Xt<=Tt)for(var zt=Xt;zt<=St;zt++)wt=ot[2*zt+1],(At=ot[2*zt])>=st&&At<=J&&wt>=U&&wt<=ht&&te.push(W[zt]);else{var Vt=Math.floor((Xt+St)/2);wt=ot[2*Vt+1],(At=ot[2*Vt])>=st&&At<=J&&wt>=U&&wt<=ht&&te.push(W[Vt]);var Ne=(Jt+1)%2;(Jt===0?st<=At:U<=wt)&&(Mt.push(Xt),Mt.push(Vt-1),Mt.push(Ne)),(Jt===0?J>=At:ht>=wt)&&(Mt.push(Vt+1),Mt.push(St),Mt.push(Ne))}}return te}(this.ids,this.coords,D,R,z,G,this.nodeSize)},Dr.prototype.within=function(D,R,z){return function(G,W,ot,st,U,J){for(var ht=[0,G.length-1,0],Tt=[],At=U*U;ht.length;){var wt=ht.pop(),Mt=ht.pop(),te=ht.pop();if(Mt-te<=J)for(var Jt=te;Jt<=Mt;Jt++)Li(W[2*Jt],W[2*Jt+1],ot,st)<=At&&Tt.push(G[Jt]);else{var St=Math.floor((te+Mt)/2),Xt=W[2*St],zt=W[2*St+1];Li(Xt,zt,ot,st)<=At&&Tt.push(G[St]);var Vt=(wt+1)%2;(wt===0?ot-U<=Xt:st-U<=zt)&&(ht.push(te),ht.push(St-1),ht.push(Vt)),(wt===0?ot+U>=Xt:st+U>=zt)&&(ht.push(St+1),ht.push(Mt),ht.push(Vt))}}return Tt}(this.ids,this.coords,D,R,z,this.nodeSize)};var So={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(D){return D}},Yr=function(D){this.options=ga(Object.create(So),D),this.trees=new Array(this.options.maxZoom+1)};function Yo(D,R,z,G,W){return{x:D,y:R,zoom:1/0,id:z,parentId:-1,numPoints:G,properties:W}}function _r(D,R){var z=D.geometry.coordinates,G=z[1];return{x:co(z[0]),y:qe(G),zoom:1/0,index:R,parentId:-1}}function Io(D){return{type:"Feature",id:D.id,properties:ps(D),geometry:{type:"Point",coordinates:[(G=D.x,360*(G-.5)),(R=D.y,z=(180-360*R)*Math.PI/180,360*Math.atan(Math.exp(z))/Math.PI-90)]}};var R,z,G}function ps(D){var R=D.numPoints,z=R>=1e4?Math.round(R/1e3)+"k":R>=1e3?Math.round(R/100)/10+"k":R;return ga(ga({},D.properties),{cluster:!0,cluster_id:D.id,point_count:R,point_count_abbreviated:z})}function co(D){return D/360+.5}function qe(D){var R=Math.sin(D*Math.PI/180),z=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return z<0?0:z>1?1:z}function ga(D,R){for(var z in R)D[z]=R[z];return D}function hn(D){return D.x}function Co(D){return D.y}function gp(D,R,z,G,W,ot){var st=W-z,U=ot-G;if(st!==0||U!==0){var J=((D-z)*st+(R-G)*U)/(st*st+U*U);J>1?(z=W,G=ot):J>0&&(z+=st*J,G+=U*J)}return(st=D-z)*st+(U=R-G)*U}function Wo(D,R,z,G){var W={id:D===void 0?null:D,type:R,geometry:z,tags:G,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ot){var st=ot.geometry,U=ot.type;if(U==="Point"||U==="MultiPoint"||U==="LineString")Cl(ot,st);else if(U==="Polygon"||U==="MultiLineString")for(var J=0;J<st.length;J++)Cl(ot,st[J]);else if(U==="MultiPolygon")for(J=0;J<st.length;J++)for(var ht=0;ht<st[J].length;ht++)Cl(ot,st[J][ht])}(W),W}function Cl(D,R){for(var z=0;z<R.length;z+=3)D.minX=Math.min(D.minX,R[z]),D.minY=Math.min(D.minY,R[z+1]),D.maxX=Math.max(D.maxX,R[z]),D.maxY=Math.max(D.maxY,R[z+1])}function Lo(D,R,z,G){if(R.geometry){var W=R.geometry.coordinates,ot=R.geometry.type,st=Math.pow(z.tolerance/((1<<z.maxZoom)*z.extent),2),U=[],J=R.id;if(z.promoteId?J=R.properties[z.promoteId]:z.generateId&&(J=G||0),ot==="Point")Qs(W,U);else if(ot==="MultiPoint")for(var ht=0;ht<W.length;ht++)Qs(W[ht],U);else if(ot==="LineString")Vu(W,U,st,!1);else if(ot==="MultiLineString"){if(z.lineMetrics){for(ht=0;ht<W.length;ht++)Vu(W[ht],U=[],st,!1),D.push(Wo(J,"LineString",U,R.properties));return}Po(W,U,st,!1)}else if(ot==="Polygon")Po(W,U,st,!0);else{if(ot!=="MultiPolygon"){if(ot==="GeometryCollection"){for(ht=0;ht<R.geometry.geometries.length;ht++)Lo(D,{id:J,geometry:R.geometry.geometries[ht],properties:R.properties},z,G);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ht=0;ht<W.length;ht++){var Tt=[];Po(W[ht],Tt,st,!0),U.push(Tt)}}D.push(Wo(J,ot,U,R.properties))}}function Qs(D,R){R.push(To(D[0])),R.push($s(D[1])),R.push(0)}function Vu(D,R,z,G){for(var W,ot,st=0,U=0;U<D.length;U++){var J=To(D[U][0]),ht=$s(D[U][1]);R.push(J),R.push(ht),R.push(0),U>0&&(st+=G?(W*ht-J*ot)/2:Math.sqrt(Math.pow(J-W,2)+Math.pow(ht-ot,2))),W=J,ot=ht}var Tt=R.length-3;R[2]=1,function At(wt,Mt,te,Jt){for(var St,Xt=Jt,zt=te-Mt>>1,Vt=te-Mt,Ne=wt[Mt],Gt=wt[Mt+1],Ze=wt[te],Cr=wt[te+1],Ve=Mt+3;Ve<te;Ve+=3){var sr=gp(wt[Ve],wt[Ve+1],Ne,Gt,Ze,Cr);if(sr>Xt)St=Ve,Xt=sr;else if(sr===Xt){var We=Math.abs(Ve-zt);We<Vt&&(St=Ve,Vt=We)}}Xt>Jt&&(St-Mt>3&&At(wt,Mt,St,Jt),wt[St+2]=Xt,te-St>3&&At(wt,St,te,Jt))}(R,0,Tt,z),R[Tt+2]=1,R.size=Math.abs(st),R.start=0,R.end=R.size}function Po(D,R,z,G){for(var W=0;W<D.length;W++){var ot=[];Vu(D[W],ot,z,G),R.push(ot)}}function To(D){return D/360+.5}function $s(D){var R=Math.sin(D*Math.PI/180),z=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return z<0?0:z>1?1:z}function Ko(D,R,z,G,W,ot,st,U){if(G/=R,ot>=(z/=R)&&st<G)return D;if(st<z||ot>=G)return null;for(var J=[],ht=0;ht<D.length;ht++){var Tt=D[ht],At=Tt.geometry,wt=Tt.type,Mt=W===0?Tt.minX:Tt.minY,te=W===0?Tt.maxX:Tt.maxY;if(Mt>=z&&te<G)J.push(Tt);else if(!(te<z||Mt>=G)){var Jt=[];if(wt==="Point"||wt==="MultiPoint")Oc(At,Jt,z,G,W);else if(wt==="LineString")kc(At,Jt,z,G,W,!1,U.lineMetrics);else if(wt==="MultiLineString")Pl(At,Jt,z,G,W,!1);else if(wt==="Polygon")Pl(At,Jt,z,G,W,!0);else if(wt==="MultiPolygon")for(var St=0;St<At.length;St++){var Xt=[];Pl(At[St],Xt,z,G,W,!0),Xt.length&&Jt.push(Xt)}if(Jt.length){if(U.lineMetrics&&wt==="LineString"){for(St=0;St<Jt.length;St++)J.push(Wo(Tt.id,wt,Jt[St],Tt.tags));continue}wt!=="LineString"&&wt!=="MultiLineString"||(Jt.length===1?(wt="LineString",Jt=Jt[0]):wt="MultiLineString"),wt!=="Point"&&wt!=="MultiPoint"||(wt=Jt.length===3?"Point":"MultiPoint"),J.push(Wo(Tt.id,wt,Jt,Tt.tags))}}}return J.length?J:null}function Oc(D,R,z,G,W){for(var ot=0;ot<D.length;ot+=3){var st=D[ot+W];st>=z&&st<=G&&(R.push(D[ot]),R.push(D[ot+1]),R.push(D[ot+2]))}}function kc(D,R,z,G,W,ot,st){for(var U,J,ht=Ll(D),Tt=W===0?Nc:qu,At=D.start,wt=0;wt<D.length-3;wt+=3){var Mt=D[wt],te=D[wt+1],Jt=D[wt+2],St=D[wt+3],Xt=D[wt+4],zt=W===0?Mt:te,Vt=W===0?St:Xt,Ne=!1;st&&(U=Math.sqrt(Math.pow(Mt-St,2)+Math.pow(te-Xt,2))),zt<z?Vt>z&&(J=Tt(ht,Mt,te,St,Xt,z),st&&(ht.start=At+U*J)):zt>G?Vt<G&&(J=Tt(ht,Mt,te,St,Xt,G),st&&(ht.start=At+U*J)):Uu(ht,Mt,te,Jt),Vt<z&&zt>=z&&(J=Tt(ht,Mt,te,St,Xt,z),Ne=!0),Vt>G&&zt<=G&&(J=Tt(ht,Mt,te,St,Xt,G),Ne=!0),!ot&&Ne&&(st&&(ht.end=At+U*J),R.push(ht),ht=Ll(D)),st&&(At+=U)}var Gt=D.length-3;Mt=D[Gt],te=D[Gt+1],Jt=D[Gt+2],(zt=W===0?Mt:te)>=z&&zt<=G&&Uu(ht,Mt,te,Jt),Gt=ht.length-3,ot&&Gt>=3&&(ht[Gt]!==ht[0]||ht[Gt+1]!==ht[1])&&Uu(ht,ht[0],ht[1],ht[2]),ht.length&&R.push(ht)}function Ll(D){var R=[];return R.size=D.size,R.start=D.start,R.end=D.end,R}function Pl(D,R,z,G,W,ot){for(var st=0;st<D.length;st++)kc(D[st],R,z,G,W,ot,!1)}function Uu(D,R,z,G){D.push(R),D.push(z),D.push(G)}function Nc(D,R,z,G,W,ot){var st=(ot-R)/(G-R);return D.push(ot),D.push(z+(W-z)*st),D.push(1),st}function qu(D,R,z,G,W,ot){var st=(ot-z)/(W-z);return D.push(R+(G-R)*st),D.push(ot),D.push(1),st}function Tl(D,R){for(var z=[],G=0;G<D.length;G++){var W,ot=D[G],st=ot.type;if(st==="Point"||st==="MultiPoint"||st==="LineString")W=tu(ot.geometry,R);else if(st==="MultiLineString"||st==="Polygon"){W=[];for(var U=0;U<ot.geometry.length;U++)W.push(tu(ot.geometry[U],R))}else if(st==="MultiPolygon")for(W=[],U=0;U<ot.geometry.length;U++){for(var J=[],ht=0;ht<ot.geometry[U].length;ht++)J.push(tu(ot.geometry[U][ht],R));W.push(J)}z.push(Wo(ot.id,st,W,ot.tags))}return z}function tu(D,R){var z=[];z.size=D.size,D.start!==void 0&&(z.start=D.start,z.end=D.end);for(var G=0;G<D.length;G+=3)z.push(D[G]+R,D[G+1],D[G+2]);return z}function Ml(D,R){if(D.transformed)return D;var z,G,W,ot=1<<D.z,st=D.x,U=D.y;for(z=0;z<D.features.length;z++){var J=D.features[z],ht=J.geometry,Tt=J.type;if(J.geometry=[],Tt===1)for(G=0;G<ht.length;G+=2)J.geometry.push(Al(ht[G],ht[G+1],R,ot,st,U));else for(G=0;G<ht.length;G++){var At=[];for(W=0;W<ht[G].length;W+=2)At.push(Al(ht[G][W],ht[G][W+1],R,ot,st,U));J.geometry.push(At)}}return D.transformed=!0,D}function Al(D,R,z,G,W,ot){return[Math.round(z*(D*G-W)),Math.round(z*(R*G-ot))]}function Rc(D,R,z,G,W){for(var ot=R===W.maxZoom?0:W.tolerance/((1<<R)*W.extent),st={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:z,y:G,z:R,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},U=0;U<D.length;U++){st.numFeatures++,Fc(st,D[U],ot,W);var J=D[U].minX,ht=D[U].minY,Tt=D[U].maxX,At=D[U].maxY;J<st.minX&&(st.minX=J),ht<st.minY&&(st.minY=ht),Tt>st.maxX&&(st.maxX=Tt),At>st.maxY&&(st.maxY=At)}return st}function Fc(D,R,z,G){var W=R.geometry,ot=R.type,st=[];if(ot==="Point"||ot==="MultiPoint")for(var U=0;U<W.length;U+=3)st.push(W[U]),st.push(W[U+1]),D.numPoints++,D.numSimplified++;else if(ot==="LineString")eu(st,W,D,z,!1,!1);else if(ot==="MultiLineString"||ot==="Polygon")for(U=0;U<W.length;U++)eu(st,W[U],D,z,ot==="Polygon",U===0);else if(ot==="MultiPolygon")for(var J=0;J<W.length;J++){var ht=W[J];for(U=0;U<ht.length;U++)eu(st,ht[U],D,z,!0,U===0)}if(st.length){var Tt=R.tags||null;if(ot==="LineString"&&G.lineMetrics){for(var At in Tt={},R.tags)Tt[At]=R.tags[At];Tt.mapbox_clip_start=W.start/W.size,Tt.mapbox_clip_end=W.end/W.size}var wt={geometry:st,type:ot==="Polygon"||ot==="MultiPolygon"?3:ot==="LineString"||ot==="MultiLineString"?2:1,tags:Tt};R.id!==null&&(wt.id=R.id),D.features.push(wt)}}function eu(D,R,z,G,W,ot){var st=G*G;if(G>0&&R.size<(W?st:G))z.numPoints+=R.length/3;else{for(var U=[],J=0;J<R.length;J+=3)(G===0||R[J+2]>st)&&(z.numSimplified++,U.push(R[J]),U.push(R[J+1])),z.numPoints++;W&&function(ht,Tt){for(var At=0,wt=0,Mt=ht.length,te=Mt-2;wt<Mt;te=wt,wt+=2)At+=(ht[wt]-ht[te])*(ht[wt+1]+ht[te+1]);if(At>0===Tt)for(wt=0,Mt=ht.length;wt<Mt/2;wt+=2){var Jt=ht[wt],St=ht[wt+1];ht[wt]=ht[Mt-2-wt],ht[wt+1]=ht[Mt-1-wt],ht[Mt-2-wt]=Jt,ht[Mt-1-wt]=St}}(U,ot),D.push(U)}}function Ua(D,R){var z=(R=this.options=function(W,ot){for(var st in ot)W[st]=ot[st];return W}(Object.create(this.options),R)).debug;if(z&&console.time("preprocess data"),R.maxZoom<0||R.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(R.promoteId&&R.generateId)throw new Error("promoteId and generateId cannot be used together.");var G=function(W,ot){var st=[];if(W.type==="FeatureCollection")for(var U=0;U<W.features.length;U++)Lo(st,W.features[U],ot,U);else Lo(st,W.type==="Feature"?W:{geometry:W},ot);return st}(D,R);this.tiles={},this.tileCoords=[],z&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",R.indexMaxZoom,R.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(G=function(W,ot){var st=ot.buffer/ot.extent,U=W,J=Ko(W,1,-1-st,st,0,-1,2,ot),ht=Ko(W,1,1-st,2+st,0,-1,2,ot);return(J||ht)&&(U=Ko(W,1,-st,1+st,0,-1,2,ot)||[],J&&(U=Tl(J,1).concat(U)),ht&&(U=U.concat(Tl(ht,-1)))),U}(G,R)).length&&this.splitTile(G,0,0,0),z&&(G.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function qa(D,R,z){return 32*((1<<D)*z+R)+D}function ju(D,R){var z=D.tileID.canonical;if(!this._geoJSONIndex)return R(null,null);var G=this._geoJSONIndex.getTile(z.z,z.x,z.y);if(!G)return R(null,null);var W=new ie(G.features),ot=Be(W);ot.byteOffset===0&&ot.byteLength===ot.buffer.byteLength||(ot=new Uint8Array(ot)),R(null,{vectorTile:W,rawData:ot.buffer})}Yr.prototype.load=function(D){var R=this.options,z=R.log,G=R.minZoom,W=R.maxZoom,ot=R.nodeSize;z&&console.time("total time");var st="prepare "+D.length+" points";z&&console.time(st),this.points=D;for(var U=[],J=0;J<D.length;J++)D[J].geometry&&U.push(_r(D[J],J));this.trees[W+1]=new Dr(U,hn,Co,ot,Float32Array),z&&console.timeEnd(st);for(var ht=W;ht>=G;ht--){var Tt=+Date.now();U=this._cluster(U,ht),this.trees[ht]=new Dr(U,hn,Co,ot,Float32Array),z&&console.log("z%d: %d clusters in %dms",ht,U.length,+Date.now()-Tt)}return z&&console.timeEnd("total time"),this},Yr.prototype.getClusters=function(D,R){var z=((D[0]+180)%360+360)%360-180,G=Math.max(-90,Math.min(90,D[1])),W=D[2]===180?180:((D[2]+180)%360+360)%360-180,ot=Math.max(-90,Math.min(90,D[3]));if(D[2]-D[0]>=360)z=-180,W=180;else if(z>W){var st=this.getClusters([z,G,180,ot],R),U=this.getClusters([-180,G,W,ot],R);return st.concat(U)}for(var J=this.trees[this._limitZoom(R)],ht=[],Tt=0,At=J.range(co(z),qe(ot),co(W),qe(G));Tt<At.length;Tt+=1){var wt=J.points[At[Tt]];ht.push(wt.numPoints?Io(wt):this.points[wt.index])}return ht},Yr.prototype.getChildren=function(D){var R=this._getOriginId(D),z=this._getOriginZoom(D),G="No cluster with the specified id.",W=this.trees[z];if(!W)throw new Error(G);var ot=W.points[R];if(!ot)throw new Error(G);for(var st=this.options.radius/(this.options.extent*Math.pow(2,z-1)),U=[],J=0,ht=W.within(ot.x,ot.y,st);J<ht.length;J+=1){var Tt=W.points[ht[J]];Tt.parentId===D&&U.push(Tt.numPoints?Io(Tt):this.points[Tt.index])}if(U.length===0)throw new Error(G);return U},Yr.prototype.getLeaves=function(D,R,z){var G=[];return this._appendLeaves(G,D,R=R||10,z=z||0,0),G},Yr.prototype.getTile=function(D,R,z){var G=this.trees[this._limitZoom(D)],W=Math.pow(2,D),ot=this.options,st=ot.radius/ot.extent,U=(z-st)/W,J=(z+1+st)/W,ht={features:[]};return this._addTileFeatures(G.range((R-st)/W,U,(R+1+st)/W,J),G.points,R,z,W,ht),R===0&&this._addTileFeatures(G.range(1-st/W,U,1,J),G.points,W,z,W,ht),R===W-1&&this._addTileFeatures(G.range(0,U,st/W,J),G.points,-1,z,W,ht),ht.features.length?ht:null},Yr.prototype.getClusterExpansionZoom=function(D){for(var R=this._getOriginZoom(D)-1;R<=this.options.maxZoom;){var z=this.getChildren(D);if(R++,z.length!==1)break;D=z[0].properties.cluster_id}return R},Yr.prototype._appendLeaves=function(D,R,z,G,W){for(var ot=0,st=this.getChildren(R);ot<st.length;ot+=1){var U=st[ot],J=U.properties;if(J&&J.cluster?W+J.point_count<=G?W+=J.point_count:W=this._appendLeaves(D,J.cluster_id,z,G,W):W<G?W++:D.push(U),D.length===z)break}return W},Yr.prototype._addTileFeatures=function(D,R,z,G,W,ot){for(var st=0,U=D;st<U.length;st+=1){var J=R[U[st]],ht=J.numPoints,Tt={type:1,geometry:[[Math.round(this.options.extent*(J.x*W-z)),Math.round(this.options.extent*(J.y*W-G))]],tags:ht?ps(J):this.points[J.index].properties},At=void 0;ht?At=J.id:this.options.generateId?At=J.index:this.points[J.index].id&&(At=this.points[J.index].id),At!==void 0&&(Tt.id=At),ot.features.push(Tt)}},Yr.prototype._limitZoom=function(D){return Math.max(this.options.minZoom,Math.min(+D,this.options.maxZoom+1))},Yr.prototype._cluster=function(D,R){for(var z=[],G=this.options,W=G.reduce,ot=G.minPoints,st=G.radius/(G.extent*Math.pow(2,R)),U=0;U<D.length;U++){var J=D[U];if(!(J.zoom<=R)){J.zoom=R;for(var ht=this.trees[R+1],Tt=ht.within(J.x,J.y,st),At=J.numPoints||1,wt=At,Mt=0,te=Tt;Mt<te.length;Mt+=1){var Jt=ht.points[te[Mt]];Jt.zoom>R&&(wt+=Jt.numPoints||1)}if(wt>=ot){for(var St=J.x*At,Xt=J.y*At,zt=W&&At>1?this._map(J,!0):null,Vt=(U<<5)+(R+1)+this.points.length,Ne=0,Gt=Tt;Ne<Gt.length;Ne+=1){var Ze=ht.points[Gt[Ne]];if(!(Ze.zoom<=R)){Ze.zoom=R;var Cr=Ze.numPoints||1;St+=Ze.x*Cr,Xt+=Ze.y*Cr,Ze.parentId=Vt,W&&(zt||(zt=this._map(J,!0)),W(zt,this._map(Ze)))}}J.parentId=Vt,z.push(Yo(St/wt,Xt/wt,Vt,wt,zt))}else if(z.push(J),wt>1)for(var Ve=0,sr=Tt;Ve<sr.length;Ve+=1){var We=ht.points[sr[Ve]];We.zoom<=R||(We.zoom=R,z.push(We))}}}return z},Yr.prototype._getOriginId=function(D){return D-this.points.length>>5},Yr.prototype._getOriginZoom=function(D){return(D-this.points.length)%32},Yr.prototype._map=function(D,R){if(D.numPoints)return R?ga({},D.properties):D.properties;var z=this.points[D.index].properties,G=this.options.map(z);return R&&G===z?ga({},G):G},Ua.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ua.prototype.splitTile=function(D,R,z,G,W,ot,st){for(var U=[D,R,z,G],J=this.options,ht=J.debug;U.length;){G=U.pop(),z=U.pop(),R=U.pop(),D=U.pop();var Tt=1<<R,At=qa(R,z,G),wt=this.tiles[At];if(!wt&&(ht>1&&console.time("creation"),wt=this.tiles[At]=Rc(D,R,z,G,J),this.tileCoords.push({z:R,x:z,y:G}),ht)){ht>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",R,z,G,wt.numFeatures,wt.numPoints,wt.numSimplified),console.timeEnd("creation"));var Mt="z"+R;this.stats[Mt]=(this.stats[Mt]||0)+1,this.total++}if(wt.source=D,W){if(R===J.maxZoom||R===W)continue;var te=1<<W-R;if(z!==Math.floor(ot/te)||G!==Math.floor(st/te))continue}else if(R===J.indexMaxZoom||wt.numPoints<=J.indexMaxPoints)continue;if(wt.source=null,D.length!==0){ht>1&&console.time("clipping");var Jt,St,Xt,zt,Vt,Ne,Gt=.5*J.buffer/J.extent,Ze=.5-Gt,Cr=.5+Gt,Ve=1+Gt;Jt=St=Xt=zt=null,Vt=Ko(D,Tt,z-Gt,z+Cr,0,wt.minX,wt.maxX,J),Ne=Ko(D,Tt,z+Ze,z+Ve,0,wt.minX,wt.maxX,J),D=null,Vt&&(Jt=Ko(Vt,Tt,G-Gt,G+Cr,1,wt.minY,wt.maxY,J),St=Ko(Vt,Tt,G+Ze,G+Ve,1,wt.minY,wt.maxY,J),Vt=null),Ne&&(Xt=Ko(Ne,Tt,G-Gt,G+Cr,1,wt.minY,wt.maxY,J),zt=Ko(Ne,Tt,G+Ze,G+Ve,1,wt.minY,wt.maxY,J),Ne=null),ht>1&&console.timeEnd("clipping"),U.push(Jt||[],R+1,2*z,2*G),U.push(St||[],R+1,2*z,2*G+1),U.push(Xt||[],R+1,2*z+1,2*G),U.push(zt||[],R+1,2*z+1,2*G+1)}}},Ua.prototype.getTile=function(D,R,z){var G=this.options,W=G.extent,ot=G.debug;if(D<0||D>24)return null;var st=1<<D,U=qa(D,R=(R%st+st)%st,z);if(this.tiles[U])return Ml(this.tiles[U],W);ot>1&&console.log("drilling down to z%d-%d-%d",D,R,z);for(var J,ht=D,Tt=R,At=z;!J&&ht>0;)ht--,Tt=Math.floor(Tt/2),At=Math.floor(At/2),J=this.tiles[qa(ht,Tt,At)];return J&&J.source?(ot>1&&console.log("found parent tile z%d-%d-%d",ht,Tt,At),ot>1&&console.time("drilling down"),this.splitTile(J.source,ht,Tt,At,D,R,z),ot>1&&console.timeEnd("drilling down"),this.tiles[U]?Ml(this.tiles[U],W):null):null};var Dl=function(D){function R(z,G,W,ot){D.call(this,z,G,W,ju),ot&&(this.loadGeoJSON=ot)}return D&&(R.__proto__=D),(R.prototype=Object.create(D&&D.prototype)).constructor=R,R.prototype.loadData=function(z,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=G,this._pendingLoadDataParams=z,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},R.prototype._loadData=function(){var z=this;if(this._pendingCallback&&this._pendingLoadDataParams){var G=this._pendingCallback,W=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ot=!!(W&&W.request&&W.request.collectResourceTiming)&&new s.RequestPerformance(W.request);this.loadGeoJSON(W,function(st,U){if(st||!U)return G(st);if(typeof U!="object")return G(new Error("Input data given to '"+W.source+"' is not a valid GeoJSON object."));(function wt(Mt,te){var Jt,St=Mt&&Mt.type;if(St==="FeatureCollection")for(Jt=0;Jt<Mt.features.length;Jt++)wt(Mt.features[Jt],te);else if(St==="GeometryCollection")for(Jt=0;Jt<Mt.geometries.length;Jt++)wt(Mt.geometries[Jt],te);else if(St==="Feature")wt(Mt.geometry,te);else if(St==="Polygon")Ct(Mt.coordinates,te);else if(St==="MultiPolygon")for(Jt=0;Jt<Mt.coordinates.length;Jt++)Ct(Mt.coordinates[Jt],te);return Mt})(U,!0);try{if(W.filter){var J=s.createExpression(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(function(wt){return wt.key+": "+wt.message}).join(", "));var ht=U.features.filter(function(wt){return J.value.evaluate({zoom:0},wt)});U={type:"FeatureCollection",features:ht}}z._geoJSONIndex=W.cluster?new Yr(function(wt){var Mt=wt.superclusterOptions,te=wt.clusterProperties;if(!te||!Mt)return Mt;for(var Jt={},St={},Xt={accumulated:null,zoom:0},zt={properties:null},Vt=Object.keys(te),Ne=0,Gt=Vt;Ne<Gt.length;Ne+=1){var Ze=Gt[Ne],Cr=te[Ze],Ve=Cr[0],sr=s.createExpression(Cr[1]),We=s.createExpression(typeof Ve=="string"?[Ve,["accumulated"],["get",Ze]]:Ve);Jt[Ze]=sr.value,St[Ze]=We.value}return Mt.map=function(vn){zt.properties=vn;for(var dr={},ui=0,Er=Vt;ui<Er.length;ui+=1){var Ge=Er[ui];dr[Ge]=Jt[Ge].evaluate(Xt,zt)}return dr},Mt.reduce=function(vn,dr){zt.properties=dr;for(var ui=0,Er=Vt;ui<Er.length;ui+=1){var Ge=Er[ui];Xt.accumulated=vn[Ge],vn[Ge]=St[Ge].evaluate(Xt,zt)}},Mt}(W)).load(U.features):function(wt,Mt){return new Ua(wt,Mt)}(U,W.geojsonVtOptions)}catch(wt){return G(wt)}z.loaded={};var Tt={};if(ot){var At=ot.finish();At&&(Tt.resourceTiming={},Tt.resourceTiming[W.source]=JSON.parse(JSON.stringify(At)))}G(null,Tt)})}},R.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},R.prototype.reloadTile=function(z,G){var W=this.loaded;return W&&W[z.uid]?D.prototype.reloadTile.call(this,z,G):this.loadTile(z,G)},R.prototype.loadGeoJSON=function(z,G){if(z.request)s.getJSON(z.request,G);else{if(typeof z.data!="string")return G(new Error("Input data given to '"+z.source+"' is not a valid GeoJSON object."));try{return G(null,JSON.parse(z.data))}catch{return G(new Error("Input data given to '"+z.source+"' is not a valid GeoJSON object."))}}},R.prototype.removeSource=function(z,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),G()},R.prototype.getClusterExpansionZoom=function(z,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom(z.clusterId))}catch(W){G(W)}},R.prototype.getClusterChildren=function(z,G){try{G(null,this._geoJSONIndex.getChildren(z.clusterId))}catch(W){G(W)}},R.prototype.getClusterLeaves=function(z,G){try{G(null,this._geoJSONIndex.getLeaves(z.clusterId,z.limit,z.offset))}catch(W){G(W)}},R}(tt),si=function(D){var R=this;this.self=D,this.actor=new s.Actor(D,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:tt,geojson:Dl},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(z,G){if(R.workerSourceTypes[z])throw new Error('Worker source with name "'+z+'" already registered.');R.workerSourceTypes[z]=G},this.self.registerRTLTextPlugin=function(z){if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=z.applyArabicShaping,s.plugin.processBidirectionalText=z.processBidirectionalText,s.plugin.processStyledBidirectionalText=z.processStyledBidirectionalText}};return si.prototype.setReferrer=function(D,R){this.referrer=R},si.prototype.setImages=function(D,R,z){for(var G in this.availableImages[D]=R,this.workerSources[D]){var W=this.workerSources[D][G];for(var ot in W)W[ot].availableImages=R}z()},si.prototype.setLayers=function(D,R,z){this.getLayerIndex(D).replace(R),z()},si.prototype.updateLayers=function(D,R,z){this.getLayerIndex(D).update(R.layers,R.removedIds),z()},si.prototype.loadTile=function(D,R,z){this.getWorkerSource(D,R.type,R.source).loadTile(R,z)},si.prototype.loadDEMTile=function(D,R,z){this.getDEMWorkerSource(D,R.source).loadTile(R,z)},si.prototype.reloadTile=function(D,R,z){this.getWorkerSource(D,R.type,R.source).reloadTile(R,z)},si.prototype.abortTile=function(D,R,z){this.getWorkerSource(D,R.type,R.source).abortTile(R,z)},si.prototype.removeTile=function(D,R,z){this.getWorkerSource(D,R.type,R.source).removeTile(R,z)},si.prototype.removeDEMTile=function(D,R){this.getDEMWorkerSource(D,R.source).removeTile(R)},si.prototype.removeSource=function(D,R,z){if(this.workerSources[D]&&this.workerSources[D][R.type]&&this.workerSources[D][R.type][R.source]){var G=this.workerSources[D][R.type][R.source];delete this.workerSources[D][R.type][R.source],G.removeSource!==void 0?G.removeSource(R,z):z()}},si.prototype.loadWorkerSource=function(D,R,z){try{this.self.importScripts(R.url),z()}catch(G){z(G.toString())}},si.prototype.syncRTLPluginState=function(D,R,z){try{s.plugin.setState(R);var G=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&G!=null){this.self.importScripts(G);var W=s.plugin.isParsed();z(W?void 0:new Error("RTL Text Plugin failed to import scripts from "+G),W)}}catch(ot){z(ot.toString())}},si.prototype.getAvailableImages=function(D){var R=this.availableImages[D];return R||(R=[]),R},si.prototype.getLayerIndex=function(D){var R=this.layerIndexes[D];return R||(R=this.layerIndexes[D]=new S),R},si.prototype.getWorkerSource=function(D,R,z){var G=this;return this.workerSources[D]||(this.workerSources[D]={}),this.workerSources[D][R]||(this.workerSources[D][R]={}),this.workerSources[D][R][z]||(this.workerSources[D][R][z]=new this.workerSourceTypes[R]({send:function(W,ot,st){G.actor.send(W,ot,st,D)}},this.getLayerIndex(D),this.getAvailableImages(D))),this.workerSources[D][R][z]},si.prototype.getDEMWorkerSource=function(D,R){return this.demWorkerSources[D]||(this.demWorkerSources[D]={}),this.demWorkerSources[D][R]||(this.demWorkerSources[D][R]=new mt),this.demWorkerSources[D][R]},si.prototype.enforceCacheSizeLimit=function(D,R){s.enforceCacheSizeLimit(R)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new si(self)),si}),u(["./shared"],function(s){var y=s.createCommonjsModule(function(c){function p(_){return!h(_)}function h(_){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,I,T=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(T);try{I=new Worker(O),w=!0}catch{w=!1}return I&&I.terminate(),URL.revokeObjectURL(O),w}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var w=document.createElement("canvas");w.width=w.height=1;var I=w.getContext("2d");if(!I)return!1;var T=I.getImageData(0,0,1,1);return T&&T.width===w.width}()?(d[b=_&&_.failIfMajorPerformanceCaveat]===void 0&&(d[b]=function(w){var I=function(O){var V=document.createElement("canvas"),q=Object.create(p.webGLContextAttributes);return q.failIfMajorPerformanceCaveat=O,V.probablySupportsContext?V.probablySupportsContext("webgl",q)||V.probablySupportsContext("experimental-webgl",q):V.supportsContext?V.supportsContext("webgl",q)||V.supportsContext("experimental-webgl",q):V.getContext("webgl",q)||V.getContext("experimental-webgl",q)}(w);if(!I)return!1;var T=I.createShader(I.VERTEX_SHADER);return!(!T||I.isContextLost())&&(I.shaderSource(T,"void main() {}"),I.compileShader(T),I.getShaderParameter(T,I.COMPILE_STATUS)===!0)}(b)),d[b]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var b}c.exports?c.exports=p:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=p,window.mapboxgl.notSupportedReason=h);var d={};p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),v={create:function(c,p,h){var d=s.window.document.createElement(c);return p!==void 0&&(d.className=p),h&&h.appendChild(d),d},createNS:function(c,p){return s.window.document.createElementNS(c,p)}},S=s.window.document&&s.window.document.documentElement.style;function L(c){if(!S)return c[0];for(var p=0;p<c.length;p++)if(c[p]in S)return c[p];return c[0]}var k,N=L(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);v.disableDrag=function(){S&&N&&(k=S[N],S[N]="none")},v.enableDrag=function(){S&&N&&(S[N]=k)};var Q=L(["transform","WebkitTransform"]);v.setTransform=function(c,p){c.style[Q]=p};var tt=!1;try{var xt=Object.defineProperty({},"passive",{get:function(){tt=!0}});s.window.addEventListener("test",xt,xt),s.window.removeEventListener("test",xt,xt)}catch{tt=!1}v.addEventListener=function(c,p,h,d){d===void 0&&(d={}),c.addEventListener(p,h,"passive"in d&&tt?d:d.capture)},v.removeEventListener=function(c,p,h,d){d===void 0&&(d={}),c.removeEventListener(p,h,"passive"in d&&tt?d:d.capture)};var mt=function(c){c.preventDefault(),c.stopPropagation(),s.window.removeEventListener("click",mt,!0)};function Ct(c){var p=c.userImage;return!!(p&&p.render&&p.render())&&(c.data.replace(new Uint8Array(p.data.buffer)),!0)}v.suppressClick=function(){s.window.addEventListener("click",mt,!0),s.window.setTimeout(function(){s.window.removeEventListener("click",mt,!0)},0)},v.mousePos=function(c,p){var h=c.getBoundingClientRect();return new s.Point(p.clientX-h.left-c.clientLeft,p.clientY-h.top-c.clientTop)},v.touchPos=function(c,p){for(var h=c.getBoundingClientRect(),d=[],_=0;_<p.length;_++)d.push(new s.Point(p[_].clientX-h.left-c.clientLeft,p[_].clientY-h.top-c.clientTop));return d},v.mouseButton=function(c){return s.window.InstallTrigger!==void 0&&c.button===2&&c.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:c.button},v.remove=function(c){c.parentNode&&c.parentNode.removeChild(c)};var ut=function(c){function p(){c.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.isLoaded=function(){return this.loaded},p.prototype.setLoaded=function(h){if(this.loaded!==h&&(this.loaded=h,h)){for(var d=0,_=this.requestors;d<_.length;d+=1){var b=_[d];this._notify(b.ids,b.callback)}this.requestors=[]}},p.prototype.getImage=function(h){return this.images[h]},p.prototype.addImage=function(h,d){this._validate(h,d)&&(this.images[h]=d)},p.prototype._validate=function(h,d){var _=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new s.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchX" value'))),_=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new s.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchY" value'))),_=!1),this._validateContent(d.content,d)||(this.fire(new s.ErrorEvent(new Error('Image "'+h+'" has invalid "content" value'))),_=!1),_},p.prototype._validateStretch=function(h,d){if(!h)return!0;for(var _=0,b=0,w=h;b<w.length;b+=1){var I=w[b];if(I[0]<_||I[1]<I[0]||d<I[1])return!1;_=I[1]}return!0},p.prototype._validateContent=function(h,d){return!(h&&(h.length!==4||h[0]<0||d.data.width<h[0]||h[1]<0||d.data.height<h[1]||h[2]<0||d.data.width<h[2]||h[3]<0||d.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))},p.prototype.updateImage=function(h,d){d.version=this.images[h].version+1,this.images[h]=d,this.updatedImages[h]=!0},p.prototype.removeImage=function(h){var d=this.images[h];delete this.images[h],delete this.patterns[h],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()},p.prototype.listImages=function(){return Object.keys(this.images)},p.prototype.getImages=function(h,d){var _=!0;if(!this.isLoaded())for(var b=0,w=h;b<w.length;b+=1)this.images[w[b]]||(_=!1);this.isLoaded()||_?this._notify(h,d):this.requestors.push({ids:h,callback:d})},p.prototype._notify=function(h,d){for(var _={},b=0,w=h;b<w.length;b+=1){var I=w[b];this.images[I]||this.fire(new s.Event("styleimagemissing",{id:I}));var T=this.images[I];T?_[I]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,hasRenderCallback:Boolean(T.userImage&&T.userImage.render)}:s.warnOnce('Image "'+I+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}d(null,_)},p.prototype.getPixelSize=function(){var h=this.atlasImage;return{width:h.width,height:h.height}},p.prototype.getPattern=function(h){var d=this.patterns[h],_=this.getImage(h);if(!_)return null;if(d&&d.position.version===_.version)return d.position;if(d)d.position.version=_.version;else{var b={w:_.data.width+2,h:_.data.height+2,x:0,y:0},w=new s.ImagePosition(b,_);this.patterns[h]={bin:b,position:w}}return this._updatePatternAtlas(),this.patterns[h].position},p.prototype.bind=function(h){var d=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(h,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)},p.prototype._updatePatternAtlas=function(){var h=[];for(var d in this.patterns)h.push(this.patterns[d].bin);var _=s.potpack(h),b=_.w,w=_.h,I=this.atlasImage;for(var T in I.resize({width:b||1,height:w||1}),this.patterns){var O=this.patterns[T].bin,V=O.x+1,q=O.y+1,j=this.images[T].data,K=j.width,Y=j.height;s.RGBAImage.copy(j,I,{x:0,y:0},{x:V,y:q},{width:K,height:Y}),s.RGBAImage.copy(j,I,{x:0,y:Y-1},{x:V,y:q-1},{width:K,height:1}),s.RGBAImage.copy(j,I,{x:0,y:0},{x:V,y:q+Y},{width:K,height:1}),s.RGBAImage.copy(j,I,{x:K-1,y:0},{x:V-1,y:q},{width:1,height:Y}),s.RGBAImage.copy(j,I,{x:0,y:0},{x:V+K,y:q},{width:1,height:Y})}this.dirty=!0},p.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},p.prototype.dispatchRenderCallbacks=function(h){for(var d=0,_=h;d<_.length;d+=1){var b=_[d];if(!this.callbackDispatchedThisFrame[b]){this.callbackDispatchedThisFrame[b]=!0;var w=this.images[b];Ct(w)&&this.updateImage(b,w)}}},p}(s.Evented),Pt=ne,Ft=ne,ie=1e20;function ne(c,p,h,d,_,b){this.fontSize=c||24,this.buffer=p===void 0?3:p,this.cutoff=d||.25,this.fontFamily=_||"sans-serif",this.fontWeight=b||"normal",this.radius=h||8;var w=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=w,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.d=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Int16Array(w),this.middle=Math.round(w/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function ae(c,p,h,d,_,b,w){for(var I=0;I<p;I++){for(var T=0;T<h;T++)d[T]=c[T*p+I];for(de(d,_,b,w,h),T=0;T<h;T++)c[T*p+I]=_[T]}for(T=0;T<h;T++){for(I=0;I<p;I++)d[I]=c[T*p+I];for(de(d,_,b,w,p),I=0;I<p;I++)c[T*p+I]=Math.sqrt(_[I])}}function de(c,p,h,d,_){h[0]=0,d[0]=-ie,d[1]=+ie;for(var b=1,w=0;b<_;b++){for(var I=(c[b]+b*b-(c[h[w]]+h[w]*h[w]))/(2*b-2*h[w]);I<=d[w];)w--,I=(c[b]+b*b-(c[h[w]]+h[w]*h[w]))/(2*b-2*h[w]);h[++w]=b,d[w]=I,d[w+1]=+ie}for(b=0,w=0;b<_;b++){for(;d[w+1]<b;)w++;p[b]=(b-h[w])*(b-h[w])+c[h[w]]}}ne.prototype.draw=function(c){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(c,this.buffer,this.middle);for(var p=this.ctx.getImageData(0,0,this.size,this.size),h=new Uint8ClampedArray(this.size*this.size),d=0;d<this.size*this.size;d++){var _=p.data[4*d+3]/255;this.gridOuter[d]=_===1?0:_===0?ie:Math.pow(Math.max(0,.5-_),2),this.gridInner[d]=_===1?ie:_===0?0:Math.pow(Math.max(0,_-.5),2)}for(ae(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),ae(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),d=0;d<this.size*this.size;d++)h[d]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[d]-this.gridInner[d])/this.radius+this.cutoff))));return h},Pt.default=Ft;var $t=function(c,p){this.requestManager=c,this.localIdeographFontFamily=p,this.entries={}};$t.prototype.setURL=function(c){this.url=c},$t.prototype.getGlyphs=function(c,p){var h=this,d=[];for(var _ in c)for(var b=0,w=c[_];b<w.length;b+=1)d.push({stack:_,id:w[b]});s.asyncAll(d,function(I,T){var O=I.stack,V=I.id,q=h.entries[O];q||(q=h.entries[O]={glyphs:{},requests:{},ranges:{}});var j=q.glyphs[V];if(j===void 0){if(j=h._tinySDF(q,O,V))return q.glyphs[V]=j,void T(null,{stack:O,id:V,glyph:j});var K=Math.floor(V/256);if(256*K>65535)T(new Error("glyphs > 65535 not supported"));else if(q.ranges[K])T(null,{stack:O,id:V,glyph:j});else{var Y=q.requests[K];Y||(Y=q.requests[K]=[],$t.loadGlyphRange(O,K,h.url,h.requestManager,function(rt,H){if(H){for(var et in H)h._doesCharSupportLocalGlyph(+et)||(q.glyphs[+et]=H[+et]);q.ranges[K]=!0}for(var at=0,ct=Y;at<ct.length;at+=1)(0,ct[at])(rt,H);delete q.requests[K]})),Y.push(function(rt,H){rt?T(rt):H&&T(null,{stack:O,id:V,glyph:H[V]||null})})}}else T(null,{stack:O,id:V,glyph:j})},function(I,T){if(I)p(I);else if(T){for(var O={},V=0,q=T;V<q.length;V+=1){var j=q[V],K=j.stack,Y=j.id,rt=j.glyph;(O[K]||(O[K]={}))[Y]=rt&&{id:rt.id,bitmap:rt.bitmap.clone(),metrics:rt.metrics}}p(null,O)}})},$t.prototype._doesCharSupportLocalGlyph=function(c){return!!this.localIdeographFontFamily&&(s.isChar["CJK Unified Ideographs"](c)||s.isChar["Hangul Syllables"](c)||s.isChar.Hiragana(c)||s.isChar.Katakana(c))},$t.prototype._tinySDF=function(c,p,h){var d=this.localIdeographFontFamily;if(d&&this._doesCharSupportLocalGlyph(h)){var _=c.tinySDF;if(!_){var b="400";/bold/i.test(p)?b="900":/medium/i.test(p)?b="500":/light/i.test(p)&&(b="200"),_=c.tinySDF=new $t.TinySDF(24,3,8,.25,d,b)}return{id:h,bitmap:new s.AlphaImage({width:30,height:30},_.draw(String.fromCharCode(h))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},$t.loadGlyphRange=function(c,p,h,d,_){var b=256*p,w=b+255,I=d.transformRequest(d.normalizeGlyphsURL(h).replace("{fontstack}",c).replace("{range}",b+"-"+w),s.ResourceType.Glyphs);s.getArrayBuffer(I,function(T,O){if(T)_(T);else if(O){for(var V={},q=0,j=s.parseGlyphPBF(O);q<j.length;q+=1){var K=j[q];V[K.id]=K}_(null,V)}})},$t.TinySDF=Pt;var Be=function(){this.specification=s.styleSpec.light.position};Be.prototype.possiblyEvaluate=function(c,p){return s.sphericalToCartesian(c.expression.evaluate(p))},Be.prototype.interpolate=function(c,p,h){return{x:s.number(c.x,p.x,h),y:s.number(c.y,p.y,h),z:s.number(c.z,p.z,h)}};var Ce=new s.Properties({anchor:new s.DataConstantProperty(s.styleSpec.light.anchor),position:new Be,color:new s.DataConstantProperty(s.styleSpec.light.color),intensity:new s.DataConstantProperty(s.styleSpec.light.intensity)}),er=function(c){function p(h){c.call(this),this._transitionable=new s.Transitionable(Ce),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getLight=function(){return this._transitionable.serialize()},p.prototype.setLight=function(h,d){if(d===void 0&&(d={}),!this._validate(s.validateLight,h,d))for(var _ in h){var b=h[_];s.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),b):this._transitionable.setValue(_,b)}},p.prototype.updateTransitions=function(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)},p.prototype.hasTransition=function(){return this._transitioning.hasTransition()},p.prototype.recalculate=function(h){this.properties=this._transitioning.possiblyEvaluate(h)},p.prototype._validate=function(h,d,_){return(!_||_.validate!==!1)&&s.emitValidationErrors(this,h.call(s.validateStyle,s.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:s.styleSpec})))},p}(s.Evented),Le=function(c,p){this.width=c,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Le.prototype.getDash=function(c,p){var h=c.join(",")+String(p);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(c,p)),this.dashEntry[h]},Le.prototype.getDashRanges=function(c,p,h){var d=[],_=c.length%2==1?-c[c.length-1]*h:0,b=c[0]*h,w=!0;d.push({left:_,right:b,isDash:w,zeroLength:c[0]===0});for(var I=c[0],T=1;T<c.length;T++){var O=c[T];d.push({left:_=I*h,right:b=(I+=O)*h,isDash:w=!w,zeroLength:O===0})}return d},Le.prototype.addRoundDash=function(c,p,h){for(var d=p/2,_=-h;_<=h;_++)for(var b=this.width*(this.nextRow+h+_),w=0,I=c[w],T=0;T<this.width;T++){T/I.right>1&&(I=c[++w]);var O=Math.abs(T-I.left),V=Math.abs(T-I.right),q=Math.min(O,V),j=void 0,K=_/h*(d+1);if(I.isDash){var Y=d-Math.abs(K);j=Math.sqrt(q*q+Y*Y)}else j=d-Math.sqrt(q*q+K*K);this.data[b+T]=Math.max(0,Math.min(255,j+128))}},Le.prototype.addRegularDash=function(c){for(var p=c.length-1;p>=0;--p){var h=c[p],d=c[p+1];h.zeroLength?c.splice(p,1):d&&d.isDash===h.isDash&&(d.left=h.left,c.splice(p,1))}var _=c[0],b=c[c.length-1];_.isDash===b.isDash&&(_.left=b.left-this.width,b.right=_.right+this.width);for(var w=this.width*this.nextRow,I=0,T=c[I],O=0;O<this.width;O++){O/T.right>1&&(T=c[++I]);var V=Math.abs(O-T.left),q=Math.abs(O-T.right),j=Math.min(V,q);this.data[w+O]=Math.max(0,Math.min(255,(T.isDash?j:-j)+128))}},Le.prototype.addDash=function(c,p){var h=p?7:0,d=2*h+1;if(this.nextRow+d>this.height)return s.warnOnce("LineAtlas out of space"),null;for(var _=0,b=0;b<c.length;b++)_+=c[b];if(_!==0){var w=this.width/_,I=this.getDashRanges(c,this.width,w);p?this.addRoundDash(I,w,h):this.addRegularDash(I)}var T={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:_};return this.nextRow+=d,this.dirty=!0,T},Le.prototype.bind=function(c){var p=c.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))};var Ut=function c(p,h){this.workerPool=p,this.actors=[],this.currentActor=0,this.id=s.uniqueId();for(var d=this.workerPool.acquire(this.id),_=0;_<d.length;_++){var b=new c.Actor(d[_],h,this.id);b.name="Worker "+_,this.actors.push(b)}};function Fe(c,p,h){var d=function(_,b){if(_)return h(_);if(b){var w=s.pick(s.extend(b,c),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);b.vector_layers&&(w.vectorLayers=b.vector_layers,w.vectorLayerIds=w.vectorLayers.map(function(I){return I.id})),w.tiles=p.canonicalizeTileset(w,c.url),h(null,w)}};return c.url?s.getJSON(p.transformRequest(p.normalizeSourceURL(c.url),s.ResourceType.Source),d):s.browser.frame(function(){return d(null,c)})}Ut.prototype.broadcast=function(c,p,h){s.asyncAll(this.actors,function(d,_){d.send(c,p,_)},h=h||function(){})},Ut.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Ut.prototype.remove=function(){this.actors.forEach(function(c){c.remove()}),this.actors=[],this.workerPool.release(this.id)},Ut.Actor=s.Actor;var ye=function(c,p,h){this.bounds=s.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=p||0,this.maxzoom=h||24};ye.prototype.validateBounds=function(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]},ye.prototype.contains=function(c){var p=Math.pow(2,c.z),h=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*p),d=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*p),_=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*p),b=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*p);return c.x>=h&&c.x<_&&c.y>=d&&c.y<b};var Ar=function(c){function p(h,d,_,b){if(c.call(this),this.id=h,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(d,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Fe(this._options,this.map._requestManager,function(d,_){h._tileJSONRequest=null,h._loaded=!0,d?h.fire(new s.ErrorEvent(d)):_&&(s.extend(h,_),_.bounds&&(h.tileBounds=new ye(_.bounds,h.minzoom,h.maxzoom)),s.postTurnstileEvent(_.tiles,h.map._requestManager._customAccessToken),s.postMapLoadEvent(_.tiles,h.map._getMapId(),h.map._requestManager._skuToken,h.map._requestManager._customAccessToken),h.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})},p.prototype.loaded=function(){return this._loaded},p.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},p.prototype.onAdd=function(h){this.map=h,this.load()},p.prototype.setSourceProperty=function(h){this._tileJSONRequest&&this._tileJSONRequest.cancel(),h(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},p.prototype.setTiles=function(h){var d=this;return this.setSourceProperty(function(){d._options.tiles=h}),this},p.prototype.setUrl=function(h){var d=this;return this.setSourceProperty(function(){d.url=h,d._options.url=h}),this},p.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},p.prototype.serialize=function(){return s.extend({},this._options)},p.prototype.loadTile=function(h,d){var _=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),b={request:this.map._requestManager.transformRequest(_,s.ResourceType.Tile),uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function w(I,T){return delete h.request,h.aborted?d(null):I&&I.status!==404?d(I):(T&&T.resourceTiming&&(h.resourceTiming=T.resourceTiming),this.map._refreshExpiredTiles&&T&&h.setExpiryData(T),h.loadVectorData(T,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),d(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}b.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired"?h.state==="loading"?h.reloadCallback=d:h.request=h.actor.send("reloadTile",b,w.bind(this)):(h.actor=this.dispatcher.getActor(),h.request=h.actor.send("loadTile",b,w.bind(this)))},p.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id},void 0)},p.prototype.unloadTile=function(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id},void 0)},p.prototype.hasTransition=function(){return!1},p}(s.Evented),mr=function(c){function p(h,d,_,b){c.call(this),this.id=h,this.dispatcher=_,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},d),s.extend(this,s.pick(d,["url","scheme","tileSize"]))}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Fe(this._options,this.map._requestManager,function(d,_){h._tileJSONRequest=null,h._loaded=!0,d?h.fire(new s.ErrorEvent(d)):_&&(s.extend(h,_),_.bounds&&(h.tileBounds=new ye(_.bounds,h.minzoom,h.maxzoom)),s.postTurnstileEvent(_.tiles),s.postMapLoadEvent(_.tiles,h.map._getMapId(),h.map._requestManager._skuToken),h.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})},p.prototype.loaded=function(){return this._loaded},p.prototype.onAdd=function(h){this.map=h,this.load()},p.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},p.prototype.serialize=function(){return s.extend({},this._options)},p.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},p.prototype.loadTile=function(h,d){var _=this,b=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);h.request=s.getImage(this.map._requestManager.transformRequest(b,s.ResourceType.Tile),function(w,I){if(delete h.request,h.aborted)h.state="unloaded",d(null);else if(w)h.state="errored",d(w);else if(I){_.map._refreshExpiredTiles&&h.setExpiryData(I),delete I.cacheControl,delete I.expires;var T=_.map.painter.context,O=T.gl;h.texture=_.map.painter.getTileTexture(I.width),h.texture?h.texture.update(I,{useMipmap:!0}):(h.texture=new s.Texture(T,I,O.RGBA,{useMipmap:!0}),h.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),T.extTextureFilterAnisotropic&&O.texParameterf(O.TEXTURE_2D,T.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,T.extTextureFilterAnisotropicMax)),h.state="loaded",s.cacheEntryPossiblyAdded(_.dispatcher),d(null)}})},p.prototype.abortTile=function(h,d){h.request&&(h.request.cancel(),delete h.request),d()},p.prototype.unloadTile=function(h,d){h.texture&&this.map.painter.saveTileTexture(h.texture),d()},p.prototype.hasTransition=function(){return!1},p}(s.Evented),or=function(c){function p(h,d,_,b){c.call(this,h,d,_,b),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},p.prototype.loadTile=function(h,d){var _=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function b(w,I){w&&(h.state="errored",d(w)),I&&(h.dem=I,h.needsHillshadePrepare=!0,h.state="loaded",d(null))}h.request=s.getImage(this.map._requestManager.transformRequest(_,s.ResourceType.Tile),function(w,I){if(delete h.request,h.aborted)h.state="unloaded",d(null);else if(w)h.state="errored",d(w);else if(I){this.map._refreshExpiredTiles&&h.setExpiryData(I),delete I.cacheControl,delete I.expires;var T=s.window.ImageBitmap&&I instanceof s.window.ImageBitmap&&s.offscreenCanvasSupported()?I:s.browser.getImageData(I,1),O={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:T,encoding:this.encoding};h.actor&&h.state!=="expired"||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",O,b.bind(this)))}}.bind(this)),h.neighboringTiles=this._getNeighboringTiles(h.tileID)},p.prototype._getNeighboringTiles=function(h){var d=h.canonical,_=Math.pow(2,d.z),b=(d.x-1+_)%_,w=d.x===0?h.wrap-1:h.wrap,I=(d.x+1+_)%_,T=d.x+1===_?h.wrap+1:h.wrap,O={};return O[new s.OverscaledTileID(h.overscaledZ,w,d.z,b,d.y).key]={backfilled:!1},O[new s.OverscaledTileID(h.overscaledZ,T,d.z,I,d.y).key]={backfilled:!1},d.y>0&&(O[new s.OverscaledTileID(h.overscaledZ,w,d.z,b,d.y-1).key]={backfilled:!1},O[new s.OverscaledTileID(h.overscaledZ,h.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},O[new s.OverscaledTileID(h.overscaledZ,T,d.z,I,d.y-1).key]={backfilled:!1}),d.y+1<_&&(O[new s.OverscaledTileID(h.overscaledZ,w,d.z,b,d.y+1).key]={backfilled:!1},O[new s.OverscaledTileID(h.overscaledZ,h.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},O[new s.OverscaledTileID(h.overscaledZ,T,d.z,I,d.y+1).key]={backfilled:!1}),O},p.prototype.unloadTile=function(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded",h.actor&&h.actor.send("removeDEMTile",{uid:h.uid,source:this.id})},p}(mr),cn=function(c){function p(h,d,_,b){c.call(this),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=_.getActor(),this.setEventedParent(b),this._data=d.data,this._options=s.extend({},d),this._collectResourceTiming=d.collectResourceTiming,this._resourceTiming=[],d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;var w=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*w,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*w,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?Math.min(d.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:s.EXTENT,radius:(d.clusterRadius||50)*w,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.load=function(){var h=this;this.fire(new s.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(d){if(d)h.fire(new s.ErrorEvent(d));else{var _={dataType:"source",sourceDataType:"metadata"};h._collectResourceTiming&&h._resourceTiming&&h._resourceTiming.length>0&&(_.resourceTiming=h._resourceTiming,h._resourceTiming=[]),h.fire(new s.Event("data",_))}})},p.prototype.onAdd=function(h){this.map=h,this.load()},p.prototype.setData=function(h){var d=this;return this._data=h,this.fire(new s.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(_){if(_)d.fire(new s.ErrorEvent(_));else{var b={dataType:"source",sourceDataType:"content"};d._collectResourceTiming&&d._resourceTiming&&d._resourceTiming.length>0&&(b.resourceTiming=d._resourceTiming,d._resourceTiming=[]),d.fire(new s.Event("data",b))}}),this},p.prototype.getClusterExpansionZoom=function(h,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},d),this},p.prototype.getClusterChildren=function(h,d){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},d),this},p.prototype.getClusterLeaves=function(h,d,_,b){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:d,offset:_},b),this},p.prototype._updateWorkerData=function(h){var d=this;this._loaded=!1;var _=s.extend({},this.workerOptions),b=this._data;typeof b=="string"?(_.request=this.map._requestManager.transformRequest(s.browser.resolveURL(b),s.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(b),this.actor.send(this.type+".loadData",_,function(w,I){d._removed||I&&I.abandoned||(d._loaded=!0,I&&I.resourceTiming&&I.resourceTiming[d.id]&&(d._resourceTiming=I.resourceTiming[d.id].slice(0)),d.actor.send(d.type+".coalesce",{source:_.source},null),h(w))})},p.prototype.loaded=function(){return this._loaded},p.prototype.loadTile=function(h,d){var _=this,b=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(b,{type:this.type,uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(w,I){return delete h.request,h.unloadVectorData(),h.aborted?d(null):w?d(w):(h.loadVectorData(I,_.map.painter,b==="reloadTile"),d(null))})},p.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0},p.prototype.unloadTile=function(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})},p.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},p.prototype.serialize=function(){return s.extend({},this._options,{type:this.type,data:this._data})},p.prototype.hasTransition=function(){return!1},p}(s.Evented),$r=s.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Li=function(c){function p(h,d,_,b){c.call(this),this.id=h,this.dispatcher=_,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(b),this.options=d}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.load=function(h,d){var _=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),function(b,w){_._loaded=!0,b?_.fire(new s.ErrorEvent(b)):w&&(_.image=w,h&&(_.coordinates=h),d&&d(),_._finishLoading())})},p.prototype.loaded=function(){return this._loaded},p.prototype.updateImage=function(h){var d=this;return this.image&&h.url?(this.options.url=h.url,this.load(h.coordinates,function(){d.texture=null}),this):this},p.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))},p.prototype.onAdd=function(h){this.map=h,this.load()},p.prototype.setCoordinates=function(h){var d=this;this.coordinates=h;var _=h.map(s.MercatorCoordinate.fromLngLat);this.tileID=function(w){for(var I=1/0,T=1/0,O=-1/0,V=-1/0,q=0,j=w;q<j.length;q+=1){var K=j[q];I=Math.min(I,K.x),T=Math.min(T,K.y),O=Math.max(O,K.x),V=Math.max(V,K.y)}var Y=Math.max(O-I,V-T),rt=Math.max(0,Math.floor(-Math.log(Y)/Math.LN2)),H=Math.pow(2,rt);return new s.CanonicalTileID(rt,Math.floor((I+O)/2*H),Math.floor((T+V)/2*H))}(_),this.minzoom=this.maxzoom=this.tileID.z;var b=_.map(function(w){return d.tileID.getTilePoint(w)._round()});return this._boundsArray=new s.StructArrayLayout4i8,this._boundsArray.emplaceBack(b[0].x,b[0].y,0,0),this._boundsArray.emplaceBack(b[1].x,b[1].y,s.EXTENT,0),this._boundsArray.emplaceBack(b[3].x,b[3].y,0,s.EXTENT),this._boundsArray.emplaceBack(b[2].x,b[2].y,s.EXTENT,s.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this},p.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var h=this.map.painter.context,d=h.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,$r.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new s.Texture(h,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this.tiles){var b=this.tiles[_];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture)}}},p.prototype.loadTile=function(h,d){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},d(null)):(h.state="errored",d(null))},p.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},p.prototype.hasTransition=function(){return!1},p}(s.Evented),ar=function(c){function p(h,d,_,b){c.call(this,h,d,_,b),this.roundZoom=!0,this.type="video",this.options=d}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.load=function(){var h=this;this._loaded=!1;var d=this.options;this.urls=[];for(var _=0,b=d.urls;_<b.length;_+=1)this.urls.push(this.map._requestManager.transformRequest(b[_],s.ResourceType.Source).url);s.getVideo(this.urls,function(w,I){h._loaded=!0,w?h.fire(new s.ErrorEvent(w)):I&&(h.video=I,h.video.loop=!0,h.video.setAttribute("playsinline",""),h.video.addEventListener("playing",function(){h.map.triggerRepaint()}),h.map&&h.video.play(),h._finishLoading())})},p.prototype.pause=function(){this.video&&this.video.pause()},p.prototype.play=function(){this.video&&this.video.play()},p.prototype.seek=function(h){if(this.video){var d=this.video.seekable;h<d.start(0)||h>d.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+d.start(0)+" and "+d.end(0)+"-second mark."))):this.video.currentTime=h}},p.prototype.getVideo=function(){return this.video},p.prototype.onAdd=function(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},p.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var h=this.map.painter.context,d=h.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,$r.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(h,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this.tiles){var b=this.tiles[_];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture)}}},p.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},p.prototype.hasTransition=function(){return this.video&&!this.video.paused},p}(Li),wr=function(c){function p(h,d,_,b){c.call(this,h,d,_,b),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(function(w){return!Array.isArray(w)||w.length!==2||w.some(function(I){return typeof I!="number"})})||this.fire(new s.ErrorEvent(new s.ValidationError("sources."+h,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError("sources."+h,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError("sources."+h,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError("sources."+h,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError("sources."+h,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},p.prototype.getCanvas=function(){return this.canvas},p.prototype.onAdd=function(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()},p.prototype.onRemove=function(){this.pause()},p.prototype.prepare=function(){var h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var d=this.map.painter.context,_=d.gl;for(var b in this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,$r.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(d,this.canvas,_.RGBA,{premultiply:!0}),this.tiles){var w=this.tiles[b];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},p.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},p.prototype.hasTransition=function(){return this._playing},p.prototype._hasInvalidDimensions=function(){for(var h=0,d=[this.canvas.width,this.canvas.height];h<d.length;h+=1){var _=d[h];if(isNaN(_)||_<=0)return!0}return!1},p}(Li),Dr={vector:Ar,raster:mr,"raster-dem":or,geojson:cn,video:ar,image:Li,canvas:wr};function So(c,p){var h=s.identity([]);return s.translate(h,h,[1,1,0]),s.scale(h,h,[.5*c.width,.5*c.height,1]),s.multiply(h,h,c.calculatePosMatrix(p.toUnwrapped()))}function Yr(c,p,h,d,_,b){var w=function(rt,H,et){if(rt)for(var at=0,ct=rt;at<ct.length;at+=1){var vt=H[ct[at]];if(vt&&vt.source===et&&vt.type==="fill-extrusion")return!0}else for(var yt in H){var bt=H[yt];if(bt.source===et&&bt.type==="fill-extrusion")return!0}return!1}(_&&_.layers,p,c.id),I=b.maxPitchScaleFactor(),T=c.tilesIn(d,I,w);T.sort(Yo);for(var O=[],V=0,q=T;V<q.length;V+=1){var j=q[V];O.push({wrappedTileID:j.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(p,h,c._state,j.queryGeometry,j.cameraQueryGeometry,j.scale,_,b,I,So(c.transform,j.tileID))})}var K=function(rt){for(var H={},et={},at=0,ct=rt;at<ct.length;at+=1){var vt=ct[at],yt=vt.queryResults,bt=vt.wrappedTileID,Lt=et[bt]=et[bt]||{};for(var kt in yt)for(var Ot=yt[kt],Zt=Lt[kt]=Lt[kt]||{},ue=H[kt]=H[kt]||[],pe=0,he=Ot;pe<he.length;pe+=1){var Je=he[pe];Zt[Je.featureIndex]||(Zt[Je.featureIndex]=!0,ue.push(Je))}}return H}(O);for(var Y in K)K[Y].forEach(function(rt){var H=rt.feature,et=c.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=et});return K}function Yo(c,p){var h=c.tileID,d=p.tileID;return h.overscaledZ-d.overscaledZ||h.canonical.y-d.canonical.y||h.wrap-d.wrap||h.canonical.x-d.canonical.x}var _r=function(c,p){this.max=c,this.onRemove=p,this.reset()};_r.prototype.reset=function(){for(var c in this.data)for(var p=0,h=this.data[c];p<h.length;p+=1){var d=h[p];d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value)}return this.data={},this.order=[],this},_r.prototype.add=function(c,p,h){var d=this,_=c.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);var b={value:p,timeout:void 0};if(h!==void 0&&(b.timeout=setTimeout(function(){d.remove(c,b)},h)),this.data[_].push(b),this.order.push(_),this.order.length>this.max){var w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this},_r.prototype.has=function(c){return c.wrapped().key in this.data},_r.prototype.getAndRemove=function(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null},_r.prototype._getAndRemoveByKey=function(c){var p=this.data[c].shift();return p.timeout&&clearTimeout(p.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),p.value},_r.prototype.getByKey=function(c){var p=this.data[c];return p?p[0].value:null},_r.prototype.get=function(c){return this.has(c)?this.data[c.wrapped().key][0].value:null},_r.prototype.remove=function(c,p){if(!this.has(c))return this;var h=c.wrapped().key,d=p===void 0?0:this.data[h].indexOf(p),_=this.data[h][d];return this.data[h].splice(d,1),_.timeout&&clearTimeout(_.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(_.value),this.order.splice(this.order.indexOf(h),1),this},_r.prototype.setMaxSize=function(c){for(this.max=c;this.order.length>this.max;){var p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this},_r.prototype.filter=function(c){var p=[];for(var h in this.data)for(var d=0,_=this.data[h];d<_.length;d+=1){var b=_[d];c(b.value)||p.push(b)}for(var w=0,I=p;w<I.length;w+=1){var T=I[w];this.remove(T.value.tileID,T)}};var Io=function(c,p,h){this.context=c;var d=c.gl;this.buffer=d.createBuffer(),this.dynamicDraw=Boolean(h),this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer};Io.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Io.prototype.updateData=function(c){var p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)},Io.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ps={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},co=function(c,p,h,d){this.length=p.length,this.attributes=h,this.itemSize=p.bytesPerElement,this.dynamicDraw=d,this.context=c;var _=c.gl;this.buffer=_.createBuffer(),c.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer};co.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},co.prototype.updateData=function(c){var p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,c.arrayBuffer)},co.prototype.enableAttributes=function(c,p){for(var h=0;h<this.attributes.length;h++){var d=p.attributes[this.attributes[h].name];d!==void 0&&c.enableVertexAttribArray(d)}},co.prototype.setVertexAttribPointers=function(c,p,h){for(var d=0;d<this.attributes.length;d++){var _=this.attributes[d],b=p.attributes[_.name];b!==void 0&&c.vertexAttribPointer(b,_.components,c[ps[_.type]],!1,this.itemSize,_.offset+this.itemSize*(h||0))}},co.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var qe=function(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};qe.prototype.get=function(){return this.current},qe.prototype.set=function(c){},qe.prototype.getDefault=function(){return this.default},qe.prototype.setDefault=function(){this.set(this.default)};var ga=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return s.Color.transparent},p.prototype.set=function(h){var d=this.current;(h.r!==d.r||h.g!==d.g||h.b!==d.b||h.a!==d.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},p}(qe),hn=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return 1},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)},p}(qe),Co=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return 0},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)},p}(qe),gp=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return[!0,!0,!0,!0]},p.prototype.set=function(h){var d=this.current;(h[0]!==d[0]||h[1]!==d[1]||h[2]!==d[2]||h[3]!==d[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},p}(qe),Wo=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return!0},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)},p}(qe),Cl=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return 255},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)},p}(qe),Lo=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},p.prototype.set=function(h){var d=this.current;(h.func!==d.func||h.ref!==d.ref||h.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)},p}(qe),Qs=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){var h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]},p.prototype.set=function(h){var d=this.current;(h[0]!==d[0]||h[1]!==d[1]||h[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)},p}(qe),Vu=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;h?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=h,this.dirty=!1}},p}(qe),Po=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return[0,1]},p.prototype.set=function(h){var d=this.current;(h[0]!==d[0]||h[1]!==d[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)},p}(qe),To=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;h?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=h,this.dirty=!1}},p}(qe),$s=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.LESS},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)},p}(qe),Ko=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;h?d.enable(d.BLEND):d.disable(d.BLEND),this.current=h,this.dirty=!1}},p}(qe),Oc=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){var h=this.gl;return[h.ONE,h.ZERO]},p.prototype.set=function(h){var d=this.current;(h[0]!==d[0]||h[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)},p}(qe),kc=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return s.Color.transparent},p.prototype.set=function(h){var d=this.current;(h.r!==d.r||h.g!==d.g||h.b!==d.b||h.a!==d.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},p}(qe),Ll=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.FUNC_ADD},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)},p}(qe),Pl=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;h?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=h,this.dirty=!1}},p}(qe),Uu=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.BACK},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)},p}(qe),Nc=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.CCW},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)},p}(qe),qu=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)},p}(qe),Tl=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.TEXTURE0},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)},p}(qe),tu=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){var h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]},p.prototype.set=function(h){var d=this.current;(h[0]!==d[0]||h[1]!==d[1]||h[2]!==d[2]||h[3]!==d[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},p}(qe),Ml=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,h),this.current=h,this.dirty=!1}},p}(qe),Al=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,h),this.current=h,this.dirty=!1}},p}(qe),Rc=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.bindTexture(d.TEXTURE_2D,h),this.current=h,this.dirty=!1}},p}(qe),Fc=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}},p}(qe),eu=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){var d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1},p}(qe),Ua=function(c){function p(h){c.call(this,h),this.vao=h.extVertexArrayObject}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)},p}(qe),qa=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return 4},p.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}},p}(qe),ju=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}},p}(qe),Dl=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}},p}(qe),si=function(c){function p(h,d){c.call(this,h),this.context=h,this.parent=d}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p}(qe),D=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.setDirty=function(){this.dirty=!0},p.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}},p}(si),R=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,h),this.current=h,this.dirty=!1}},p}(si),z=function(c,p,h,d){this.context=c,this.width=p,this.height=h;var _=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new D(c,_),d&&(this.depthAttachment=new R(c,_))};z.prototype.destroy=function(){var c=this.context.gl,p=this.colorAttachment.get();if(p&&c.deleteTexture(p),this.depthAttachment){var h=this.depthAttachment.get();h&&c.deleteRenderbuffer(h)}c.deleteFramebuffer(this.framebuffer)};var G=function(c,p,h){this.func=c,this.mask=p,this.range=h};G.ReadOnly=!1,G.ReadWrite=!0,G.disabled=new G(519,G.ReadOnly,[0,1]);var W=function(c,p,h,d,_,b){this.test=c,this.ref=p,this.mask=h,this.fail=d,this.depthFail=_,this.pass=b};W.disabled=new W({func:519,mask:0},0,0,7680,7680,7680);var ot=function(c,p,h){this.blendFunction=c,this.blendColor=p,this.mask=h};ot.disabled=new ot(ot.Replace=[1,0],s.Color.transparent,[!1,!1,!1,!1]),ot.unblended=new ot(ot.Replace,s.Color.transparent,[!0,!0,!0,!0]),ot.alphaBlended=new ot([1,771],s.Color.transparent,[!0,!0,!0,!0]);var st=function(c,p,h){this.enable=c,this.mode=p,this.frontFace=h};st.disabled=new st(!1,1029,2305),st.backCCW=new st(!0,1029,2305);var U=function(c){this.gl=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ga(this),this.clearDepth=new hn(this),this.clearStencil=new Co(this),this.colorMask=new gp(this),this.depthMask=new Wo(this),this.stencilMask=new Cl(this),this.stencilFunc=new Lo(this),this.stencilOp=new Qs(this),this.stencilTest=new Vu(this),this.depthRange=new Po(this),this.depthTest=new To(this),this.depthFunc=new $s(this),this.blend=new Ko(this),this.blendFunc=new Oc(this),this.blendColor=new kc(this),this.blendEquation=new Ll(this),this.cullFace=new Pl(this),this.cullFaceSide=new Uu(this),this.frontFace=new Nc(this),this.program=new qu(this),this.activeTexture=new Tl(this),this.viewport=new tu(this),this.bindFramebuffer=new Ml(this),this.bindRenderbuffer=new Al(this),this.bindTexture=new Rc(this),this.bindVertexBuffer=new Fc(this),this.bindElementBuffer=new eu(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ua(this),this.pixelStoreUnpack=new qa(this),this.pixelStoreUnpackPremultiplyAlpha=new ju(this),this.pixelStoreUnpackFlipY=new Dl(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=c.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(c.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)};U.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},U.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},U.prototype.createIndexBuffer=function(c,p){return new Io(this,c,p)},U.prototype.createVertexBuffer=function(c,p,h){return new co(this,c,p,h)},U.prototype.createRenderbuffer=function(c,p,h){var d=this.gl,_=d.createRenderbuffer();return this.bindRenderbuffer.set(_),d.renderbufferStorage(d.RENDERBUFFER,c,p,h),this.bindRenderbuffer.set(null),_},U.prototype.createFramebuffer=function(c,p,h){return new z(this,c,p,h)},U.prototype.clear=function(c){var p=c.color,h=c.depth,d=this.gl,_=0;p&&(_|=d.COLOR_BUFFER_BIT,this.clearColor.set(p),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(_|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),d.clear(_)},U.prototype.setCullFace=function(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))},U.prototype.setDepthMode=function(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)},U.prototype.setStencilMode=function(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)},U.prototype.setColorMode=function(c){s.deepEqual(c.blendFunction,ot.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)},U.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var J=function(c){function p(h,d,_){var b=this;c.call(this),this.id=h,this.dispatcher=_,this.on("data",function(w){w.dataType==="source"&&w.sourceDataType==="metadata"&&(b._sourceLoaded=!0),b._sourceLoaded&&!b._paused&&w.dataType==="source"&&w.sourceDataType==="content"&&(b.reload(),b.transform&&b.update(b.transform))}),this.on("error",function(){b._sourceErrored=!0}),this._source=function(w,I,T,O){var V=new Dr[I.type](w,I,T,O);if(V.id!==w)throw new Error("Expected Source id to be "+w+" instead of "+V.id);return s.bindAll(["load","abort","unload","serialize","prepare"],V),V}(h,d,_,this),this._tiles={},this._cache=new _r(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new s.SourceFeatureState}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.onAdd=function(h){this.map=h,this._maxTileCacheSize=h?h._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(h)},p.prototype.onRemove=function(h){this._source&&this._source.onRemove&&this._source.onRemove(h)},p.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var h in this._tiles){var d=this._tiles[h];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0},p.prototype.getSource=function(){return this._source},p.prototype.pause=function(){this._paused=!0},p.prototype.resume=function(){if(this._paused){var h=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,h&&this.reload(),this.transform&&this.update(this.transform)}},p.prototype._loadTile=function(h,d){return this._source.loadTile(h,d)},p.prototype._unloadTile=function(h){if(this._source.unloadTile)return this._source.unloadTile(h,function(){})},p.prototype._abortTile=function(h){if(this._source.abortTile)return this._source.abortTile(h,function(){})},p.prototype.serialize=function(){return this._source.serialize()},p.prototype.prepare=function(h){for(var d in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var _=this._tiles[d];_.upload(h),_.prepare(this.map.style.imageManager)}},p.prototype.getIds=function(){return s.values(this._tiles).map(function(h){return h.tileID}).sort(ht).map(function(h){return h.key})},p.prototype.getRenderableIds=function(h){var d=this,_=[];for(var b in this._tiles)this._isIdRenderable(b,h)&&_.push(this._tiles[b]);return h?_.sort(function(w,I){var T=w.tileID,O=I.tileID,V=new s.Point(T.canonical.x,T.canonical.y)._rotate(d.transform.angle),q=new s.Point(O.canonical.x,O.canonical.y)._rotate(d.transform.angle);return T.overscaledZ-O.overscaledZ||q.y-V.y||q.x-V.x}).map(function(w){return w.tileID.key}):_.map(function(w){return w.tileID}).sort(ht).map(function(w){return w.key})},p.prototype.hasRenderableParent=function(h){var d=this.findLoadedParent(h,0);return!!d&&this._isIdRenderable(d.tileID.key)},p.prototype._isIdRenderable=function(h,d){return this._tiles[h]&&this._tiles[h].hasData()&&!this._coveredTiles[h]&&(d||!this._tiles[h].holdingForFade())},p.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var h in this._cache.reset(),this._tiles)this._tiles[h].state!=="errored"&&this._reloadTile(h,"reloading")},p.prototype._reloadTile=function(h,d){var _=this._tiles[h];_&&(_.state!=="loading"&&(_.state=d),this._loadTile(_,this._tileLoaded.bind(this,_,h,d)))},p.prototype._tileLoaded=function(h,d,_,b){if(b)return h.state="errored",void(b.status!==404?this._source.fire(new s.ErrorEvent(b,{tile:h})):this.update(this.transform));h.timeAdded=s.browser.now(),_==="expired"&&(h.refreshedUponExpiration=!0),this._setTileReloadTimer(d,h),this.getSource().type==="raster-dem"&&h.dem&&this._backfillDEM(h),this._state.initializeTileState(h,this.map?this.map.painter:null),this._source.fire(new s.Event("data",{dataType:"source",tile:h,coord:h.tileID}))},p.prototype._backfillDEM=function(h){for(var d=this.getRenderableIds(),_=0;_<d.length;_++){var b=d[_];if(h.neighboringTiles&&h.neighboringTiles[b]){var w=this.getTileByID(b);I(h,w),I(w,h)}}function I(T,O){T.needsHillshadePrepare=!0;var V=O.tileID.canonical.x-T.tileID.canonical.x,q=O.tileID.canonical.y-T.tileID.canonical.y,j=Math.pow(2,T.tileID.canonical.z),K=O.tileID.key;V===0&&q===0||Math.abs(q)>1||(Math.abs(V)>1&&(Math.abs(V+j)===1?V+=j:Math.abs(V-j)===1&&(V-=j)),O.dem&&T.dem&&(T.dem.backfillBorder(O.dem,V,q),T.neighboringTiles&&T.neighboringTiles[K]&&(T.neighboringTiles[K].backfilled=!0)))}},p.prototype.getTile=function(h){return this.getTileByID(h.key)},p.prototype.getTileByID=function(h){return this._tiles[h]},p.prototype._retainLoadedChildren=function(h,d,_,b){for(var w in this._tiles){var I=this._tiles[w];if(!(b[w]||!I.hasData()||I.tileID.overscaledZ<=d||I.tileID.overscaledZ>_)){for(var T=I.tileID;I&&I.tileID.overscaledZ>d+1;){var O=I.tileID.scaledTo(I.tileID.overscaledZ-1);(I=this._tiles[O.key])&&I.hasData()&&(T=O)}for(var V=T;V.overscaledZ>d;)if(h[(V=V.scaledTo(V.overscaledZ-1)).key]){b[T.key]=T;break}}}},p.prototype.findLoadedParent=function(h,d){if(h.key in this._loadedParentTiles){var _=this._loadedParentTiles[h.key];return _&&_.tileID.overscaledZ>=d?_:null}for(var b=h.overscaledZ-1;b>=d;b--){var w=h.scaledTo(b),I=this._getLoadedTile(w);if(I)return I}},p.prototype._getLoadedTile=function(h){var d=this._tiles[h.key];return d&&d.hasData()?d:this._cache.getByKey(h.wrapped().key)},p.prototype.updateCacheSize=function(h){var d=Math.ceil(h.width/this._source.tileSize)+1,_=Math.ceil(h.height/this._source.tileSize)+1,b=Math.floor(d*_*5),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(w)},p.prototype.handleWrapJump=function(h){var d=Math.round((h-(this._prevLng===void 0?h:this._prevLng))/360);if(this._prevLng=h,d){var _={};for(var b in this._tiles){var w=this._tiles[b];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+d),_[w.tileID.key]=w}for(var I in this._tiles=_,this._timers)clearTimeout(this._timers[I]),delete this._timers[I];for(var T in this._tiles)this._setTileReloadTimer(T,this._tiles[T])}},p.prototype.update=function(h){var d=this;if(this.transform=h,this._sourceLoaded&&!this._paused){var _;this.updateCacheSize(h),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?_=h.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Lt){return new s.OverscaledTileID(Lt.canonical.z,Lt.wrap,Lt.canonical.z,Lt.canonical.x,Lt.canonical.y)}):(_=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(_=_.filter(function(Lt){return d._source.hasTile(Lt)}))):_=[];var b=h.coveringZoomLevel(this._source),w=Math.max(b-p.maxOverzooming,this._source.minzoom),I=Math.max(b+p.maxUnderzooming,this._source.minzoom),T=this._updateRetainedTiles(_,b);if(Tt(this._source.type)){for(var O={},V={},q=0,j=Object.keys(T);q<j.length;q+=1){var K=j[q],Y=T[K],rt=this._tiles[K];if(rt&&!(rt.fadeEndTime&&rt.fadeEndTime<=s.browser.now())){var H=this.findLoadedParent(Y,w);H&&(this._addTile(H.tileID),O[H.tileID.key]=H.tileID),V[K]=Y}}for(var et in this._retainLoadedChildren(V,b,I,T),O)T[et]||(this._coveredTiles[et]=!0,T[et]=O[et])}for(var at in T)this._tiles[at].clearFadeHold();for(var ct=0,vt=s.keysDifference(this._tiles,T);ct<vt.length;ct+=1){var yt=vt[ct],bt=this._tiles[yt];bt.hasSymbolBuckets&&!bt.holdingForFade()?bt.setHoldDuration(this.map._fadeDuration):bt.hasSymbolBuckets&&!bt.symbolFadeFinished()||this._removeTile(yt)}this._updateLoadedParentTileCache()}},p.prototype.releaseSymbolFadeTiles=function(){for(var h in this._tiles)this._tiles[h].holdingForFade()&&this._removeTile(h)},p.prototype._updateRetainedTiles=function(h,d){for(var _={},b={},w=Math.max(d-p.maxOverzooming,this._source.minzoom),I=Math.max(d+p.maxUnderzooming,this._source.minzoom),T={},O=0,V=h;O<V.length;O+=1){var q=V[O],j=this._addTile(q);_[q.key]=q,j.hasData()||d<this._source.maxzoom&&(T[q.key]=q)}this._retainLoadedChildren(T,d,I,_);for(var K=0,Y=h;K<Y.length;K+=1){var rt=Y[K],H=this._tiles[rt.key];if(!H.hasData()){if(d+1>this._source.maxzoom){var et=rt.children(this._source.maxzoom)[0],at=this.getTile(et);if(at&&at.hasData()){_[et.key]=et;continue}}else{var ct=rt.children(this._source.maxzoom);if(_[ct[0].key]&&_[ct[1].key]&&_[ct[2].key]&&_[ct[3].key])continue}for(var vt=H.wasRequested(),yt=rt.overscaledZ-1;yt>=w;--yt){var bt=rt.scaledTo(yt);if(b[bt.key]||(b[bt.key]=!0,!(H=this.getTile(bt))&&vt&&(H=this._addTile(bt)),H&&(_[bt.key]=bt,vt=H.wasRequested(),H.hasData())))break}}}return _},p.prototype._updateLoadedParentTileCache=function(){for(var h in this._loadedParentTiles={},this._tiles){for(var d=[],_=void 0,b=this._tiles[h].tileID;b.overscaledZ>0;){if(b.key in this._loadedParentTiles){_=this._loadedParentTiles[b.key];break}d.push(b.key);var w=b.scaledTo(b.overscaledZ-1);if(_=this._getLoadedTile(w))break;b=w}for(var I=0,T=d;I<T.length;I+=1)this._loadedParentTiles[T[I]]=_}},p.prototype._addTile=function(h){var d=this._tiles[h.key];if(d)return d;(d=this._cache.getAndRemove(h))&&(this._setTileReloadTimer(h.key,d),d.tileID=h,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[h.key]&&(clearTimeout(this._cacheTimers[h.key]),delete this._cacheTimers[h.key],this._setTileReloadTimer(h.key,d)));var _=Boolean(d);return _||(d=new s.Tile(h,this._source.tileSize*h.overscaleFactor()),this._loadTile(d,this._tileLoaded.bind(this,d,h.key,d.state))),d?(d.uses++,this._tiles[h.key]=d,_||this._source.fire(new s.Event("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d):null},p.prototype._setTileReloadTimer=function(h,d){var _=this;h in this._timers&&(clearTimeout(this._timers[h]),delete this._timers[h]);var b=d.getExpiryTimeout();b&&(this._timers[h]=setTimeout(function(){_._reloadTile(h,"expired"),delete _._timers[h]},b))},p.prototype._removeTile=function(h){var d=this._tiles[h];d&&(d.uses--,delete this._tiles[h],this._timers[h]&&(clearTimeout(this._timers[h]),delete this._timers[h]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))},p.prototype.clearTiles=function(){for(var h in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(h);this._cache.reset()},p.prototype.tilesIn=function(h,d,_){var b=this,w=[],I=this.transform;if(!I)return w;for(var T=_?I.getCameraQueryGeometry(h):h,O=h.map(function(yt){return I.pointCoordinate(yt)}),V=T.map(function(yt){return I.pointCoordinate(yt)}),q=this.getIds(),j=1/0,K=1/0,Y=-1/0,rt=-1/0,H=0,et=V;H<et.length;H+=1){var at=et[H];j=Math.min(j,at.x),K=Math.min(K,at.y),Y=Math.max(Y,at.x),rt=Math.max(rt,at.y)}for(var ct=function(yt){var bt=b._tiles[q[yt]];if(!bt.holdingForFade()){var Lt=bt.tileID,kt=Math.pow(2,I.zoom-bt.tileID.overscaledZ),Ot=d*bt.queryPadding*s.EXTENT/bt.tileSize/kt,Zt=[Lt.getTilePoint(new s.MercatorCoordinate(j,K)),Lt.getTilePoint(new s.MercatorCoordinate(Y,rt))];if(Zt[0].x-Ot<s.EXTENT&&Zt[0].y-Ot<s.EXTENT&&Zt[1].x+Ot>=0&&Zt[1].y+Ot>=0){var ue=O.map(function(he){return Lt.getTilePoint(he)}),pe=V.map(function(he){return Lt.getTilePoint(he)});w.push({tile:bt,tileID:Lt,queryGeometry:ue,cameraQueryGeometry:pe,scale:kt})}}},vt=0;vt<q.length;vt++)ct(vt);return w},p.prototype.getVisibleCoordinates=function(h){for(var d=this,_=this.getRenderableIds(h).map(function(T){return d._tiles[T].tileID}),b=0,w=_;b<w.length;b+=1){var I=w[b];I.posMatrix=this.transform.calculatePosMatrix(I.toUnwrapped())}return _},p.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Tt(this._source.type))for(var h in this._tiles){var d=this._tiles[h];if(d.fadeEndTime!==void 0&&d.fadeEndTime>=s.browser.now())return!0}return!1},p.prototype.setFeatureState=function(h,d,_){this._state.updateState(h=h||"_geojsonTileLayer",d,_)},p.prototype.removeFeatureState=function(h,d,_){this._state.removeFeatureState(h=h||"_geojsonTileLayer",d,_)},p.prototype.getFeatureState=function(h,d){return this._state.getState(h=h||"_geojsonTileLayer",d)},p.prototype.setDependencies=function(h,d,_){var b=this._tiles[h];b&&b.setDependencies(d,_)},p.prototype.reloadTilesForDependencies=function(h,d){for(var _ in this._tiles)this._tiles[_].hasDependency(h,d)&&this._reloadTile(_,"reloading");this._cache.filter(function(b){return!b.hasDependency(h,d)})},p}(s.Evented);function ht(c,p){var h=Math.abs(2*c.wrap)-+(c.wrap<0),d=Math.abs(2*p.wrap)-+(p.wrap<0);return c.overscaledZ-p.overscaledZ||d-h||p.canonical.y-c.canonical.y||p.canonical.x-c.canonical.x}function Tt(c){return c==="raster"||c==="image"||c==="video"}function At(){return new s.window.Worker(ih.workerUrl)}J.maxOverzooming=10,J.maxUnderzooming=3;var wt="mapboxgl_preloaded_worker_pool",Mt=function(){this.active={}};Mt.prototype.acquire=function(c){if(!this.workers)for(this.workers=[];this.workers.length<Mt.workerCount;)this.workers.push(new At);return this.active[c]=!0,this.workers.slice()},Mt.prototype.release=function(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(function(p){p.terminate()}),this.workers=null)},Mt.prototype.isPreloaded=function(){return!!this.active[wt]},Mt.prototype.numActive=function(){return Object.keys(this.active).length};var te,Jt=Math.floor(s.browser.hardwareConcurrency/2);function St(){return te||(te=new Mt),te}function Xt(c,p){var h={};for(var d in c)d!=="ref"&&(h[d]=c[d]);return s.refProperties.forEach(function(_){_ in p&&(h[_]=p[_])}),h}function zt(c){c=c.slice();for(var p=Object.create(null),h=0;h<c.length;h++)p[c[h].id]=c[h];for(var d=0;d<c.length;d++)"ref"in c[d]&&(c[d]=Xt(c[d],p[c[d].ref]));return c}Mt.workerCount=Math.max(Math.min(Jt,6),1);var Vt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ne(c,p,h){h.push({command:Vt.addSource,args:[c,p[c]]})}function Gt(c,p,h){p.push({command:Vt.removeSource,args:[c]}),h[c]=!0}function Ze(c,p,h,d){Gt(c,h,d),Ne(c,p,h)}function Cr(c,p,h){var d;for(d in c[h])if(c[h].hasOwnProperty(d)&&d!=="data"&&!s.deepEqual(c[h][d],p[h][d]))return!1;for(d in p[h])if(p[h].hasOwnProperty(d)&&d!=="data"&&!s.deepEqual(c[h][d],p[h][d]))return!1;return!0}function Ve(c,p,h,d,_,b){var w;for(w in p=p||{},c=c||{})c.hasOwnProperty(w)&&(s.deepEqual(c[w],p[w])||h.push({command:b,args:[d,w,p[w],_]}));for(w in p)p.hasOwnProperty(w)&&!c.hasOwnProperty(w)&&(s.deepEqual(c[w],p[w])||h.push({command:b,args:[d,w,p[w],_]}))}function sr(c){return c.id}function We(c,p){return c[p.id]=p,c}var vn=function(c,p){this.reset(c,p)};vn.prototype.reset=function(c,p){this.points=c||[],this._distances=[0];for(var h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding},vn.prototype.lerp=function(c){if(this.points.length===1)return this.points[0];c=s.clamp(c,0,1);for(var p=1,h=this._distances[p],d=c*this.paddedLength+this.padding;h<d&&p<this._distances.length;)h=this._distances[++p];var _=p-1,b=this._distances[_],w=h-b,I=w>0?(d-b)/w:0;return this.points[_].mult(1-I).add(this.points[p].mult(I))};var dr=function(c,p,h){var d=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(c/h),this.yCellCount=Math.ceil(p/h);for(var b=0;b<this.xCellCount*this.yCellCount;b++)d.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=p,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0};function ui(c,p,h,d,_){var b=s.create();return p?(s.scale(b,b,[1/_,1/_,1]),h||s.rotateZ(b,b,d.angle)):s.multiply(b,d.labelPlaneMatrix,c),b}function Er(c,p,h,d,_){if(p){var b=s.clone(c);return s.scale(b,b,[_,_,1]),h||s.rotateZ(b,b,-d.angle),b}return d.glCoordMatrix}function Ge(c,p){var h=[c.x,c.y,0,1];qi(h,h,p);var d=h[3];return{point:new s.Point(h[0]/d,h[1]/d),signedDistanceFromCamera:d}}function ur(c,p){return .5+c/p*.5}function Bn(c,p){var h=c[0]/c[3],d=c[1]/c[3];return h>=-p[0]&&h<=p[0]&&d>=-p[1]&&d<=p[1]}function Ol(c,p,h,d,_,b,w,I){var T=d?c.textSizeData:c.iconSizeData,O=s.evaluateSizeForZoom(T,h.transform.zoom),V=[256/h.width*2+1,256/h.height*2+1],q=d?c.text.dynamicLayoutVertexArray:c.icon.dynamicLayoutVertexArray;q.clear();for(var j=c.lineVertexArray,K=d?c.text.placedSymbolArray:c.icon.placedSymbolArray,Y=h.transform.width/h.transform.height,rt=!1,H=0;H<K.length;H++){var et=K.get(H);if(et.hidden||et.writingMode===s.WritingMode.vertical&&!rt)xn(et.numGlyphs,q);else{rt=!1;var at=[et.anchorX,et.anchorY,0,1];if(s.transformMat4(at,at,p),Bn(at,V)){var ct=ur(h.transform.cameraToCenterDistance,at[3]),vt=s.evaluateSizeForFeature(T,O,et),yt=w?vt/ct:vt*ct,bt=new s.Point(et.anchorX,et.anchorY),Lt=Ge(bt,_).point,kt={},Ot=yp(et,yt,!1,I,p,_,b,c.glyphOffsetArray,j,q,Lt,bt,kt,Y);rt=Ot.useVertical,(Ot.notEnoughRoom||rt||Ot.needsFlipping&&yp(et,yt,!0,I,p,_,b,c.glyphOffsetArray,j,q,Lt,bt,kt,Y).notEnoughRoom)&&xn(et.numGlyphs,q)}else xn(et.numGlyphs,q)}}d?c.text.dynamicLayoutVertexBuffer.updateData(q):c.icon.dynamicLayoutVertexBuffer.updateData(q)}function Ui(c,p,h,d,_,b,w,I,T,O,V){var q=I.glyphStartIndex+I.numGlyphs,j=I.lineStartIndex,K=I.lineStartIndex+I.lineLength,Y=p.getoffsetX(I.glyphStartIndex),rt=p.getoffsetX(q-1),H=li(c*Y,h,d,_,b,w,I.segment,j,K,T,O,V);if(!H)return null;var et=li(c*rt,h,d,_,b,w,I.segment,j,K,T,O,V);return et?{first:H,last:et}:null}function Vn(c,p,h,d){return c===s.WritingMode.horizontal&&Math.abs(h.y-p.y)>Math.abs(h.x-p.x)*d?{useVertical:!0}:(c===s.WritingMode.vertical?p.y<h.y:p.x>h.x)?{needsFlipping:!0}:null}function yp(c,p,h,d,_,b,w,I,T,O,V,q,j,K){var Y,rt=p/24,H=c.lineOffsetX*rt,et=c.lineOffsetY*rt;if(c.numGlyphs>1){var at=c.glyphStartIndex+c.numGlyphs,ct=c.lineStartIndex,vt=c.lineStartIndex+c.lineLength,yt=Ui(rt,I,H,et,h,V,q,c,T,b,j);if(!yt)return{notEnoughRoom:!0};var bt=Ge(yt.first.point,w).point,Lt=Ge(yt.last.point,w).point;if(d&&!h){var kt=Vn(c.writingMode,bt,Lt,K);if(kt)return kt}Y=[yt.first];for(var Ot=c.glyphStartIndex+1;Ot<at-1;Ot++)Y.push(li(rt*I.getoffsetX(Ot),H,et,h,V,q,c.segment,ct,vt,T,b,j));Y.push(yt.last)}else{if(d&&!h){var Zt=Ge(q,_).point,ue=c.lineStartIndex+c.segment+1,pe=new s.Point(T.getx(ue),T.gety(ue)),he=Ge(pe,_),Je=he.signedDistanceFromCamera>0?he.point:kl(q,pe,Zt,1,_),Wt=Vn(c.writingMode,Zt,Je,K);if(Wt)return Wt}var Ee=li(rt*I.getoffsetX(c.glyphStartIndex),H,et,h,V,q,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,T,b,j);if(!Ee)return{notEnoughRoom:!0};Y=[Ee]}for(var De=0,we=Y;De<we.length;De+=1){var xe=we[De];s.addDynamicAttributes(O,xe.point,xe.angle)}return{}}function kl(c,p,h,d,_){var b=Ge(c.add(c.sub(p)._unit()),_).point,w=h.sub(b);return h.add(w._mult(d/w.mag()))}function li(c,p,h,d,_,b,w,I,T,O,V,q){var j=d?c-p:c+p,K=j>0?1:-1,Y=0;d&&(K*=-1,Y=Math.PI),K<0&&(Y+=Math.PI);for(var rt=K>0?I+w:I+w+1,H=_,et=_,at=0,ct=0,vt=Math.abs(j),yt=[];at+ct<=vt;){if((rt+=K)<I||rt>=T)return null;if(et=H,yt.push(H),(H=q[rt])===void 0){var bt=new s.Point(O.getx(rt),O.gety(rt)),Lt=Ge(bt,V);if(Lt.signedDistanceFromCamera>0)H=q[rt]=Lt.point;else{var kt=rt-K;H=kl(at===0?b:new s.Point(O.getx(kt),O.gety(kt)),bt,et,vt-at+1,V)}}at+=ct,ct=et.dist(H)}var Ot=(vt-at)/ct,Zt=H.sub(et),ue=Zt.mult(Ot)._add(et);ue._add(Zt._unit()._perp()._mult(h*K));var pe=Y+Math.atan2(H.y-et.y,H.x-et.x);return yt.push(ue),{point:ue,angle:pe,path:yt}}dr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},dr.prototype.insert=function(c,p,h,d,_){this._forEachCell(p,h,d,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(p),this.bboxes.push(h),this.bboxes.push(d),this.bboxes.push(_)},dr.prototype.insertCircle=function(c,p,h,d){this._forEachCell(p-d,h-d,p+d,h+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(p),this.circles.push(h),this.circles.push(d)},dr.prototype._insertBoxCell=function(c,p,h,d,_,b){this.boxCells[_].push(b)},dr.prototype._insertCircleCell=function(c,p,h,d,_,b){this.circleCells[_].push(b)},dr.prototype._query=function(c,p,h,d,_,b){if(h<0||c>this.width||d<0||p>this.height)return!_&&[];var w=[];if(c<=0&&p<=0&&this.width<=h&&this.height<=d){if(_)return!0;for(var I=0;I<this.boxKeys.length;I++)w.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(var T=0;T<this.circleKeys.length;T++){var O=this.circles[3*T],V=this.circles[3*T+1],q=this.circles[3*T+2];w.push({key:this.circleKeys[T],x1:O-q,y1:V-q,x2:O+q,y2:V+q})}return b?w.filter(b):w}return this._forEachCell(c,p,h,d,this._queryCell,w,{hitTest:_,seenUids:{box:{},circle:{}}},b),_?w.length>0:w},dr.prototype._queryCircle=function(c,p,h,d,_){var b=c-h,w=c+h,I=p-h,T=p+h;if(w<0||b>this.width||T<0||I>this.height)return!d&&[];var O=[];return this._forEachCell(b,I,w,T,this._queryCellCircle,O,{hitTest:d,circle:{x:c,y:p,radius:h},seenUids:{box:{},circle:{}}},_),d?O.length>0:O},dr.prototype.query=function(c,p,h,d,_){return this._query(c,p,h,d,!1,_)},dr.prototype.hitTest=function(c,p,h,d,_){return this._query(c,p,h,d,!0,_)},dr.prototype.hitTestCircle=function(c,p,h,d){return this._queryCircle(c,p,h,!0,d)},dr.prototype._queryCell=function(c,p,h,d,_,b,w,I){var T=w.seenUids,O=this.boxCells[_];if(O!==null)for(var V=this.bboxes,q=0,j=O;q<j.length;q+=1){var K=j[q];if(!T.box[K]){T.box[K]=!0;var Y=4*K;if(c<=V[Y+2]&&p<=V[Y+3]&&h>=V[Y+0]&&d>=V[Y+1]&&(!I||I(this.boxKeys[K]))){if(w.hitTest)return b.push(!0),!0;b.push({key:this.boxKeys[K],x1:V[Y],y1:V[Y+1],x2:V[Y+2],y2:V[Y+3]})}}}var rt=this.circleCells[_];if(rt!==null)for(var H=this.circles,et=0,at=rt;et<at.length;et+=1){var ct=at[et];if(!T.circle[ct]){T.circle[ct]=!0;var vt=3*ct;if(this._circleAndRectCollide(H[vt],H[vt+1],H[vt+2],c,p,h,d)&&(!I||I(this.circleKeys[ct]))){if(w.hitTest)return b.push(!0),!0;var yt=H[vt],bt=H[vt+1],Lt=H[vt+2];b.push({key:this.circleKeys[ct],x1:yt-Lt,y1:bt-Lt,x2:yt+Lt,y2:bt+Lt})}}}},dr.prototype._queryCellCircle=function(c,p,h,d,_,b,w,I){var T=w.circle,O=w.seenUids,V=this.boxCells[_];if(V!==null)for(var q=this.bboxes,j=0,K=V;j<K.length;j+=1){var Y=K[j];if(!O.box[Y]){O.box[Y]=!0;var rt=4*Y;if(this._circleAndRectCollide(T.x,T.y,T.radius,q[rt+0],q[rt+1],q[rt+2],q[rt+3])&&(!I||I(this.boxKeys[Y])))return b.push(!0),!0}}var H=this.circleCells[_];if(H!==null)for(var et=this.circles,at=0,ct=H;at<ct.length;at+=1){var vt=ct[at];if(!O.circle[vt]){O.circle[vt]=!0;var yt=3*vt;if(this._circlesCollide(et[yt],et[yt+1],et[yt+2],T.x,T.y,T.radius)&&(!I||I(this.circleKeys[vt])))return b.push(!0),!0}}},dr.prototype._forEachCell=function(c,p,h,d,_,b,w,I){for(var T=this._convertToXCellCoord(c),O=this._convertToYCellCoord(p),V=this._convertToXCellCoord(h),q=this._convertToYCellCoord(d),j=T;j<=V;j++)for(var K=O;K<=q;K++)if(_.call(this,c,p,h,d,this.xCellCount*K+j,b,w,I))return},dr.prototype._convertToXCellCoord=function(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))},dr.prototype._convertToYCellCoord=function(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))},dr.prototype._circlesCollide=function(c,p,h,d,_,b){var w=d-c,I=_-p,T=h+b;return T*T>w*w+I*I},dr.prototype._circleAndRectCollide=function(c,p,h,d,_,b,w){var I=(b-d)/2,T=Math.abs(c-(d+I));if(T>I+h)return!1;var O=(w-_)/2,V=Math.abs(p-(_+O));if(V>O+h)return!1;if(T<=I||V<=O)return!0;var q=T-I,j=V-O;return q*q+j*j<=h*h};var Nl=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function xn(c,p){for(var h=0;h<c;h++){var d=p.length;p.resize(d+4),p.float32.set(Nl,3*d)}}function qi(c,p,h){var d=p[0],_=p[1];return c[0]=h[0]*d+h[4]*_+h[12],c[1]=h[1]*d+h[5]*_+h[13],c[3]=h[3]*d+h[7]*_+h[15],c}var Mo=function(c,p,h){p===void 0&&(p=new dr(c.width+200,c.height+200,25)),h===void 0&&(h=new dr(c.width+200,c.height+200,25)),this.transform=c,this.grid=p,this.ignoredGrid=h,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+100,this.screenBottomBoundary=c.height+100,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200};function Vr(c,p,h){return p*(s.EXTENT/(c.tileSize*Math.pow(2,h-c.tileID.overscaledZ)))}Mo.prototype.placeCollisionBox=function(c,p,h,d,_){var b=this.projectAndGetPerspectiveRatio(d,c.anchorPointX,c.anchorPointY),w=h*b.perspectiveRatio,I=c.x1*w+b.point.x,T=c.y1*w+b.point.y,O=c.x2*w+b.point.x,V=c.y2*w+b.point.y;return!this.isInsideGrid(I,T,O,V)||!p&&this.grid.hitTest(I,T,O,V,_)?{box:[],offscreen:!1}:{box:[I,T,O,V],offscreen:this.isOffscreen(I,T,O,V)}},Mo.prototype.placeCollisionCircles=function(c,p,h,d,_,b,w,I,T,O,V,q,j){var K=[],Y=new s.Point(p.anchorX,p.anchorY),rt=Ge(Y,b),H=ur(this.transform.cameraToCenterDistance,rt.signedDistanceFromCamera),et=(O?_/H:_*H)/s.ONE_EM,at=Ge(Y,w).point,ct=Ui(et,d,p.lineOffsetX*et,p.lineOffsetY*et,!1,at,Y,p,h,w,{}),vt=!1,yt=!1,bt=!0;if(ct){for(var Lt=.5*q*H+j,kt=new s.Point(-100,-100),Ot=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),Zt=new vn,ue=ct.first,pe=ct.last,he=[],Je=ue.path.length-1;Je>=1;Je--)he.push(ue.path[Je]);for(var Wt=1;Wt<pe.path.length;Wt++)he.push(pe.path[Wt]);var Ee=2.5*Lt;if(I){var De=he.map(function(Ro){return Ge(Ro,I)});he=De.some(function(Ro){return Ro.signedDistanceFromCamera<=0})?[]:De.map(function(Ro){return Ro.point})}var we=[];if(he.length>0){for(var xe=he[0].clone(),Te=he[0].clone(),ve=1;ve<he.length;ve++)xe.x=Math.min(xe.x,he[ve].x),xe.y=Math.min(xe.y,he[ve].y),Te.x=Math.max(Te.x,he[ve].x),Te.y=Math.max(Te.y,he[ve].y);we=xe.x>=kt.x&&Te.x<=Ot.x&&xe.y>=kt.y&&Te.y<=Ot.y?[he]:Te.x<kt.x||xe.x>Ot.x||Te.y<kt.y||xe.y>Ot.y?[]:s.clipLine([he],kt.x,kt.y,Ot.x,Ot.y)}for(var me=0,Fi=we;me<Fi.length;me+=1){var ti;Zt.reset(Fi[me],.25*Lt),ti=Zt.length<=.5*Lt?1:Math.ceil(Zt.paddedLength/Ee)+1;for(var pn=0;pn<ti;pn++){var Gi=pn/Math.max(ti-1,1),Wr=Zt.lerp(Gi),ci=Wr.x+100,ro=Wr.y+100;K.push(ci,ro,Lt,0);var Sn=ci-Lt,Ls=ro-Lt,Un=ci+Lt,ia=ro+Lt;if(bt=bt&&this.isOffscreen(Sn,Ls,Un,ia),yt=yt||this.isInsideGrid(Sn,Ls,Un,ia),!c&&this.grid.hitTestCircle(ci,ro,Lt,V)&&(vt=!0,!T))return{circles:[],offscreen:!1,collisionDetected:vt}}}}return{circles:!T&&vt||!yt?[]:K,offscreen:bt,collisionDetected:vt}},Mo.prototype.queryRenderedSymbols=function(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var p=[],h=1/0,d=1/0,_=-1/0,b=-1/0,w=0,I=c;w<I.length;w+=1){var T=I[w],O=new s.Point(T.x+100,T.y+100);h=Math.min(h,O.x),d=Math.min(d,O.y),_=Math.max(_,O.x),b=Math.max(b,O.y),p.push(O)}for(var V={},q={},j=0,K=this.grid.query(h,d,_,b).concat(this.ignoredGrid.query(h,d,_,b));j<K.length;j+=1){var Y=K[j],rt=Y.key;if(V[rt.bucketInstanceId]===void 0&&(V[rt.bucketInstanceId]={}),!V[rt.bucketInstanceId][rt.featureIndex]){var H=[new s.Point(Y.x1,Y.y1),new s.Point(Y.x2,Y.y1),new s.Point(Y.x2,Y.y2),new s.Point(Y.x1,Y.y2)];s.polygonIntersectsPolygon(p,H)&&(V[rt.bucketInstanceId][rt.featureIndex]=!0,q[rt.bucketInstanceId]===void 0&&(q[rt.bucketInstanceId]=[]),q[rt.bucketInstanceId].push(rt.featureIndex))}}return q},Mo.prototype.insertCollisionBox=function(c,p,h,d,_){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:d,collisionGroupID:_},c[0],c[1],c[2],c[3])},Mo.prototype.insertCollisionCircles=function(c,p,h,d,_){for(var b=p?this.ignoredGrid:this.grid,w={bucketInstanceId:h,featureIndex:d,collisionGroupID:_},I=0;I<c.length;I+=4)b.insertCircle(w,c[I],c[I+1],c[I+2])},Mo.prototype.projectAndGetPerspectiveRatio=function(c,p,h){var d=[p,h,0,1];return qi(d,d,c),{point:new s.Point((d[0]/d[3]+1)/2*this.transform.width+100,(-d[1]/d[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}},Mo.prototype.isOffscreen=function(c,p,h,d){return h<100||c>=this.screenRightBoundary||d<100||p>this.screenBottomBoundary},Mo.prototype.isInsideGrid=function(c,p,h,d){return h>=0&&c<this.gridRightBoundary&&d>=0&&p<this.gridBottomBoundary},Mo.prototype.getViewportMatrix=function(){var c=s.identity([]);return s.translate(c,c,[-100,-100,0]),c};var Jo=function(c,p,h,d){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?p:-p))):d&&h?1:0,this.placed=h};Jo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var ho=function(c,p,h,d,_){this.text=new Jo(c?c.text:null,p,h,_),this.icon=new Jo(c?c.icon:null,p,d,_)};ho.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var $f=function(c,p,h){this.text=c,this.icon=p,this.skipFade=h},Ao=function(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]},cy=function(c,p,h,d,_){this.bucketInstanceId=c,this.featureIndex=p,this.sourceLayerIndex=h,this.bucketIndex=d,this.tileID=_},ja=function(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}};function Qi(c,p,h,d,_){var b=s.getAnchorAlignment(c),w=-(b.horizontalAlign-.5)*p,I=-(b.verticalAlign-.5)*h,T=s.evaluateVariableOffset(c,d);return new s.Point(w+T[0]*_,I+T[1]*_)}function ya(c,p,h,d,_,b){var w=c.x1,I=c.x2,T=c.y1,O=c.y2,V=c.anchorPointX,q=c.anchorPointY,j=new s.Point(p,h);return d&&j._rotate(_?b:-b),{x1:w+j.x,y1:T+j.y,x2:I+j.x,y2:O+j.y,anchorPointX:V,anchorPointY:q}}ja.prototype.get=function(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){var p=++this.maxGroupID;this.collisionGroups[c]={ID:p,predicate:function(h){return h.collisionGroupID===p}}}return this.collisionGroups[c]};var bn=function(c,p,h,d){this.transform=c.clone(),this.collisionIndex=new Mo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new ja(h),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}};function ru(c,p,h,d,_){c.emplaceBack(p?1:0,h?1:0,d||0,_||0),c.emplaceBack(p?1:0,h?1:0,d||0,_||0),c.emplaceBack(p?1:0,h?1:0,d||0,_||0),c.emplaceBack(p?1:0,h?1:0,d||0,_||0)}bn.prototype.getBucketParts=function(c,p,h,d){var _=h.getBucket(p),b=h.latestFeatureIndex;if(_&&b&&p.id===_.layerIds[0]){var w=h.collisionBoxArray,I=_.layers[0].layout,T=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),O=h.tileSize/s.EXTENT,V=this.transform.calculatePosMatrix(h.tileID.toUnwrapped()),q=I.get("text-pitch-alignment")==="map",j=I.get("text-rotation-alignment")==="map",K=Vr(h,1,this.transform.zoom),Y=ui(V,q,j,this.transform,K),rt=null;if(q){var H=Er(V,q,j,this.transform,K);rt=s.multiply([],this.transform.labelPlaneMatrix,H)}this.retainedQueryData[_.bucketInstanceId]=new cy(_.bucketInstanceId,b,_.sourceLayerIndex,_.index,h.tileID);var et={bucket:_,layout:I,posMatrix:V,textLabelPlaneMatrix:Y,labelToScreenMatrix:rt,scale:T,textPixelRatio:O,holdingForFade:h.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(d)for(var at=0,ct=_.sortKeyRanges;at<ct.length;at+=1){var vt=ct[at];c.push({sortKey:vt.sortKey,symbolInstanceStart:vt.symbolInstanceStart,symbolInstanceEnd:vt.symbolInstanceEnd,parameters:et})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:et})}},bn.prototype.attemptAnchorPlacement=function(c,p,h,d,_,b,w,I,T,O,V,q,j,K,Y){var rt,H=[q.textOffset0,q.textOffset1],et=Qi(c,h,d,H,_),at=this.collisionIndex.placeCollisionBox(ya(p,et.x,et.y,b,w,this.transform.angle),V,I,T,O.predicate);if(!Y||this.collisionIndex.placeCollisionBox(ya(Y,et.x,et.y,b,w,this.transform.angle),V,I,T,O.predicate).box.length!==0)return at.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID].text&&(rt=this.prevPlacement.variableOffsets[q.crossTileID].anchor),this.variableOffsets[q.crossTileID]={textOffset:H,width:h,height:d,anchor:c,textBoxScale:_,prevAnchor:rt},this.markUsedJustification(j,c,q,K),j.allowVerticalPlacement&&(this.markUsedOrientation(j,K,q),this.placedOrientations[q.crossTileID]=K),{shift:et,placedGlyphBoxes:at}):void 0},bn.prototype.placeLayerBucketPart=function(c,p,h){var d=this,_=c.parameters,b=_.bucket,w=_.layout,I=_.posMatrix,T=_.textLabelPlaneMatrix,O=_.labelToScreenMatrix,V=_.textPixelRatio,q=_.holdingForFade,j=_.collisionBoxArray,K=_.partiallyEvaluatedTextSize,Y=_.collisionGroup,rt=w.get("text-optional"),H=w.get("icon-optional"),et=w.get("text-allow-overlap"),at=w.get("icon-allow-overlap"),ct=w.get("text-rotation-alignment")==="map",vt=w.get("text-pitch-alignment")==="map",yt=w.get("icon-text-fit")!=="none",bt=w.get("symbol-z-order")==="viewport-y",Lt=et&&(at||!b.hasIconData()||H),kt=at&&(et||!b.hasTextData()||rt);!b.collisionArrays&&j&&b.deserializeCollisionBoxes(j);var Ot=function(Wt,Ee){if(!p[Wt.crossTileID])if(q)d.placements[Wt.crossTileID]=new $f(!1,!1,!1);else{var De,we=!1,xe=!1,Te=!0,ve=null,me={box:null,offscreen:null},Fi={box:null,offscreen:null},ti=null,pn=null,Gi=0,Wr=0,ci=0;Ee.textFeatureIndex?Gi=Ee.textFeatureIndex:Wt.useRuntimeCollisionCircles&&(Gi=Wt.featureIndex),Ee.verticalTextFeatureIndex&&(Wr=Ee.verticalTextFeatureIndex);var ro=Ee.textBox;if(ro){var Sn=function(lr){var go=s.WritingMode.horizontal;if(b.allowVerticalPlacement&&!lr&&d.prevPlacement){var qn=d.prevPlacement.placedOrientations[Wt.crossTileID];qn&&(d.placedOrientations[Wt.crossTileID]=qn,d.markUsedOrientation(b,go=qn,Wt))}return go},Ls=function(lr,go){if(b.allowVerticalPlacement&&Wt.numVerticalGlyphVertices>0&&Ee.verticalTextBox)for(var qn=0,xu=b.writingModes;qn<xu.length&&(xu[qn]===s.WritingMode.vertical?(me=go(),Fi=me):me=lr(),!(me&&me.box&&me.box.length));qn+=1);else me=lr()};if(w.get("text-variable-anchor")){var Un=w.get("text-variable-anchor");if(d.prevPlacement&&d.prevPlacement.variableOffsets[Wt.crossTileID]){var ia=d.prevPlacement.variableOffsets[Wt.crossTileID];Un.indexOf(ia.anchor)>0&&(Un=Un.filter(function(lr){return lr!==ia.anchor})).unshift(ia.anchor)}var Ro=function(lr,go,qn){for(var xu=lr.x2-lr.x1,Sy=lr.y2-lr.y1,nh=Wt.textBoxScale,Iy=yt&&!at?go:null,rc={box:[],offscreen:!1},Md=et?2*Un.length:Un.length,il=0;il<Md;++il){var oh=d.attemptAnchorPlacement(Un[il%Un.length],lr,xu,Sy,nh,ct,vt,V,I,Y,il>=Un.length,Wt,b,qn,Iy);if(oh&&(rc=oh.placedGlyphBoxes)&&rc.box&&rc.box.length){we=!0,ve=oh.shift;break}}return rc};Ls(function(){return Ro(ro,Ee.iconBox,s.WritingMode.horizontal)},function(){var lr=Ee.verticalTextBox;return b.allowVerticalPlacement&&!(me&&me.box&&me.box.length)&&Wt.numVerticalGlyphVertices>0&&lr?Ro(lr,Ee.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null}}),me&&(we=me.box,Te=me.offscreen);var $l=Sn(me&&me.box);if(!we&&d.prevPlacement){var el=d.prevPlacement.variableOffsets[Wt.crossTileID];el&&(d.variableOffsets[Wt.crossTileID]=el,d.markUsedJustification(b,el.anchor,Wt,$l))}}else{var Ps=function(lr,go){var qn=d.collisionIndex.placeCollisionBox(lr,et,V,I,Y.predicate);return qn&&qn.box&&qn.box.length&&(d.markUsedOrientation(b,go,Wt),d.placedOrientations[Wt.crossTileID]=go),qn};Ls(function(){return Ps(ro,s.WritingMode.horizontal)},function(){var lr=Ee.verticalTextBox;return b.allowVerticalPlacement&&Wt.numVerticalGlyphVertices>0&&lr?Ps(lr,s.WritingMode.vertical):{box:null,offscreen:null}}),Sn(me&&me.box&&me.box.length)}}if(we=(De=me)&&De.box&&De.box.length>0,Te=De&&De.offscreen,Wt.useRuntimeCollisionCircles){var rl=b.text.placedSymbolArray.get(Wt.centerJustifiedTextSymbolIndex),tc=s.evaluateSizeForFeature(b.textSizeData,K,rl),xa=w.get("text-padding");ti=d.collisionIndex.placeCollisionCircles(et,rl,b.lineVertexArray,b.glyphOffsetArray,tc,I,T,O,h,vt,Y.predicate,Wt.collisionCircleDiameter,xa),we=et||ti.circles.length>0&&!ti.collisionDetected,Te=Te&&ti.offscreen}if(Ee.iconFeatureIndex&&(ci=Ee.iconFeatureIndex),Ee.iconBox){var ec=function(lr){var go=yt&&ve?ya(lr,ve.x,ve.y,ct,vt,d.transform.angle):lr;return d.collisionIndex.placeCollisionBox(go,at,V,I,Y.predicate)};xe=Fi&&Fi.box&&Fi.box.length&&Ee.verticalIconBox?(pn=ec(Ee.verticalIconBox)).box.length>0:(pn=ec(Ee.iconBox)).box.length>0,Te=Te&&pn.offscreen}var ba=rt||Wt.numHorizontalGlyphVertices===0&&Wt.numVerticalGlyphVertices===0,zi=H||Wt.numIconVertices===0;if(ba||zi?zi?ba||(xe=xe&&we):we=xe&&we:xe=we=xe&&we,we&&De&&De.box&&d.collisionIndex.insertCollisionBox(De.box,w.get("text-ignore-placement"),b.bucketInstanceId,Fi&&Fi.box&&Wr?Wr:Gi,Y.ID),xe&&pn&&d.collisionIndex.insertCollisionBox(pn.box,w.get("icon-ignore-placement"),b.bucketInstanceId,ci,Y.ID),ti&&(we&&d.collisionIndex.insertCollisionCircles(ti.circles,w.get("text-ignore-placement"),b.bucketInstanceId,Gi,Y.ID),h)){var Za=b.bucketInstanceId,Ts=d.collisionCircleArrays[Za];Ts===void 0&&(Ts=d.collisionCircleArrays[Za]=new Ao);for(var vu=0;vu<ti.circles.length;vu+=4)Ts.circles.push(ti.circles[vu+0]),Ts.circles.push(ti.circles[vu+1]),Ts.circles.push(ti.circles[vu+2]),Ts.circles.push(ti.collisionDetected?1:0)}d.placements[Wt.crossTileID]=new $f(we||Lt,xe||kt,Te||b.justReloaded),p[Wt.crossTileID]=!0}};if(bt)for(var Zt=b.getSortedSymbolIndexes(this.transform.angle),ue=Zt.length-1;ue>=0;--ue){var pe=Zt[ue];Ot(b.symbolInstances.get(pe),b.collisionArrays[pe])}else for(var he=c.symbolInstanceStart;he<c.symbolInstanceEnd;he++)Ot(b.symbolInstances.get(he),b.collisionArrays[he]);if(h&&b.bucketInstanceId in this.collisionCircleArrays){var Je=this.collisionCircleArrays[b.bucketInstanceId];s.invert(Je.invProjMatrix,I),Je.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1},bn.prototype.markUsedJustification=function(c,p,h,d){var _;_=d===s.WritingMode.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(p)];for(var b=0,w=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];b<w.length;b+=1){var I=w[b];I>=0&&(c.text.placedSymbolArray.get(I).crossTileID=_>=0&&I!==_?0:h.crossTileID)}},bn.prototype.markUsedOrientation=function(c,p,h){for(var d=p===s.WritingMode.horizontal||p===s.WritingMode.horizontalOnly?p:0,_=p===s.WritingMode.vertical?p:0,b=0,w=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];b<w.length;b+=1)c.text.placedSymbolArray.get(w[b]).placedOrientation=d;h.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=_)},bn.prototype.commit=function(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;var p=this.prevPlacement,h=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;var d=p?p.symbolFadeChange(c):1,_=p?p.opacities:{},b=p?p.variableOffsets:{},w=p?p.placedOrientations:{};for(var I in this.placements){var T=this.placements[I],O=_[I];O?(this.opacities[I]=new ho(O,d,T.text,T.icon),h=h||T.text!==O.text.placed||T.icon!==O.icon.placed):(this.opacities[I]=new ho(null,d,T.text,T.icon,T.skipFade),h=h||T.text||T.icon)}for(var V in _){var q=_[V];if(!this.opacities[V]){var j=new ho(q,d,!1,!1);j.isHidden()||(this.opacities[V]=j,h=h||q.text.placed||q.icon.placed)}}for(var K in b)this.variableOffsets[K]||!this.opacities[K]||this.opacities[K].isHidden()||(this.variableOffsets[K]=b[K]);for(var Y in w)this.placedOrientations[Y]||!this.opacities[Y]||this.opacities[Y].isHidden()||(this.placedOrientations[Y]=w[Y]);h?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:c)},bn.prototype.updateLayerOpacities=function(c,p){for(var h={},d=0,_=p;d<_.length;d+=1){var b=_[d],w=b.getBucket(c);w&&b.latestFeatureIndex&&c.id===w.layerIds[0]&&this.updateBucketOpacities(w,h,b.collisionBoxArray)}},bn.prototype.updateBucketOpacities=function(c,p,h){var d=this;c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();var _=c.layers[0].layout,b=new ho(null,0,!1,!1,!0),w=_.get("text-allow-overlap"),I=_.get("icon-allow-overlap"),T=_.get("text-variable-anchor"),O=_.get("text-rotation-alignment")==="map",V=_.get("text-pitch-alignment")==="map",q=_.get("icon-text-fit")!=="none",j=new ho(null,0,w&&(I||!c.hasIconData()||_.get("icon-optional")),I&&(w||!c.hasTextData()||_.get("text-optional")),!0);!c.collisionArrays&&h&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(h);for(var K=function(et,at,ct){for(var vt=0;vt<at/4;vt++)et.opacityVertexArray.emplaceBack(ct)},Y=function(et){var at=c.symbolInstances.get(et),ct=at.numHorizontalGlyphVertices,vt=at.numVerticalGlyphVertices,yt=at.crossTileID,bt=d.opacities[yt];p[yt]?bt=b:bt||(d.opacities[yt]=bt=j),p[yt]=!0;var Lt=at.numIconVertices>0,kt=d.placedOrientations[at.crossTileID],Ot=kt===s.WritingMode.vertical,Zt=kt===s.WritingMode.horizontal||kt===s.WritingMode.horizontalOnly;if(ct>0||vt>0){var ue=rd(bt.text);K(c.text,ct,Ot?Gu:ue),K(c.text,vt,Zt?Gu:ue);var pe=bt.text.isHidden();[at.rightJustifiedTextSymbolIndex,at.centerJustifiedTextSymbolIndex,at.leftJustifiedTextSymbolIndex].forEach(function(me){me>=0&&(c.text.placedSymbolArray.get(me).hidden=pe||Ot?1:0)}),at.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(at.verticalPlacedTextSymbolIndex).hidden=pe||Zt?1:0);var he=d.variableOffsets[at.crossTileID];he&&d.markUsedJustification(c,he.anchor,at,kt);var Je=d.placedOrientations[at.crossTileID];Je&&(d.markUsedJustification(c,"left",at,Je),d.markUsedOrientation(c,Je,at))}if(Lt){var Wt=rd(bt.icon),Ee=!(q&&at.verticalPlacedIconSymbolIndex&&Ot);at.placedIconSymbolIndex>=0&&(K(c.icon,at.numIconVertices,Ee?Wt:Gu),c.icon.placedSymbolArray.get(at.placedIconSymbolIndex).hidden=bt.icon.isHidden()),at.verticalPlacedIconSymbolIndex>=0&&(K(c.icon,at.numVerticalIconVertices,Ee?Gu:Wt),c.icon.placedSymbolArray.get(at.verticalPlacedIconSymbolIndex).hidden=bt.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){var De=c.collisionArrays[et];if(De){var we=new s.Point(0,0);if(De.textBox||De.verticalTextBox){var xe=!0;if(T){var Te=d.variableOffsets[yt];Te?(we=Qi(Te.anchor,Te.width,Te.height,Te.textOffset,Te.textBoxScale),O&&we._rotate(V?d.transform.angle:-d.transform.angle)):xe=!1}De.textBox&&ru(c.textCollisionBox.collisionVertexArray,bt.text.placed,!xe||Ot,we.x,we.y),De.verticalTextBox&&ru(c.textCollisionBox.collisionVertexArray,bt.text.placed,!xe||Zt,we.x,we.y)}var ve=Boolean(!Zt&&De.verticalIconBox);De.iconBox&&ru(c.iconCollisionBox.collisionVertexArray,bt.icon.placed,ve,q?we.x:0,q?we.y:0),De.verticalIconBox&&ru(c.iconCollisionBox.collisionVertexArray,bt.icon.placed,!ve,q?we.x:0,q?we.y:0)}}},rt=0;rt<c.symbolInstances.length;rt++)Y(rt);if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){var H=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=H.invProjMatrix,c.placementViewportMatrix=H.viewportMatrix,c.collisionCircleArray=H.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}},bn.prototype.symbolFadeChange=function(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},bn.prototype.zoomAdjustment=function(c){return Math.max(0,(this.transform.zoom-c)/1.5)},bn.prototype.hasTransitions=function(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration},bn.prototype.stillRecent=function(c,p){var h=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*h>c},bn.prototype.setStale=function(){this.stale=!0};var hy=Math.pow(2,25),py=Math.pow(2,24),mp=Math.pow(2,17),fy=Math.pow(2,16),td=Math.pow(2,9),dy=Math.pow(2,8),ed=Math.pow(2,1);function rd(c){if(c.opacity===0&&!c.placed)return 0;if(c.opacity===1&&c.placed)return 4294967295;var p=c.placed?1:0,h=Math.floor(127*c.opacity);return h*hy+p*py+h*mp+p*fy+h*td+p*dy+h*ed+p}var Gu=0,_p=function(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&c.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};_p.prototype.continuePlacement=function(c,p,h,d,_){for(var b=this._bucketParts;this._currentTileIndex<c.length;)if(p.getBucketParts(b,d,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort(function(w,I){return w.sortKey-I.sortKey}));this._currentPartIndex<b.length;)if(p.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,_())return!0;return!1};var Rl=function(c,p,h,d,_,b,w){this.placement=new bn(c,_,b,w),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=d,this._done=!1};Rl.prototype.isDone=function(){return this._done},Rl.prototype.continuePlacement=function(c,p,h){for(var d=this,_=s.browser.now(),b=function(){var T=s.browser.now()-_;return!d._forceFullPlacement&&T>2};this._currentPlacementIndex>=0;){var w=p[c[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=I)&&(!w.maxzoom||w.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new _p(w)),this._inProgressLayer.continuePlacement(h[w.source],this.placement,this._showCollisionBoxes,w,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Rl.prototype.commit=function(c){return this.placement.commit(c),this.placement};var id=512/s.EXTENT/2,zc=function(c,p,h){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=h;for(var d=0;d<p.length;d++){var _=p.get(d),b=_.key;this.indexedSymbolInstances[b]||(this.indexedSymbolInstances[b]=[]),this.indexedSymbolInstances[b].push({crossTileID:_.crossTileID,coord:this.getScaledCoordinates(_,c)})}};zc.prototype.getScaledCoordinates=function(c,p){var h=id/Math.pow(2,p.canonical.z-this.tileID.canonical.z);return{x:Math.floor((p.canonical.x*s.EXTENT+c.anchorX)*h),y:Math.floor((p.canonical.y*s.EXTENT+c.anchorY)*h)}},zc.prototype.findMatches=function(c,p,h){for(var d=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z),_=0;_<c.length;_++){var b=c.get(_);if(!b.crossTileID){var w=this.indexedSymbolInstances[b.key];if(w)for(var I=this.getScaledCoordinates(b,p),T=0,O=w;T<O.length;T+=1){var V=O[T];if(Math.abs(V.coord.x-I.x)<=d&&Math.abs(V.coord.y-I.y)<=d&&!h[V.crossTileID]){h[V.crossTileID]=!0,b.crossTileID=V.crossTileID;break}}}}};var Do=function(){this.maxCrossTileID=0};Do.prototype.generate=function(){return++this.maxCrossTileID};var fs=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};fs.prototype.handleWrapJump=function(c){var p=Math.round((c-this.lng)/360);if(p!==0)for(var h in this.indexes){var d=this.indexes[h],_={};for(var b in d){var w=d[b];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+p),_[w.tileID.key]=w}this.indexes[h]=_}this.lng=c},fs.prototype.addBucket=function(c,p,h){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(var d=0;d<p.symbolInstances.length;d++)p.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});var _=this.usedCrossTileIDs[c.overscaledZ];for(var b in this.indexes){var w=this.indexes[b];if(Number(b)>c.overscaledZ)for(var I in w){var T=w[I];T.tileID.isChildOf(c)&&T.findMatches(p.symbolInstances,c,_)}else{var O=w[c.scaledTo(Number(b)).key];O&&O.findMatches(p.symbolInstances,c,_)}}for(var V=0;V<p.symbolInstances.length;V++){var q=p.symbolInstances.get(V);q.crossTileID||(q.crossTileID=h.generate(),_[q.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new zc(c,p.symbolInstances,p.bucketInstanceId),!0},fs.prototype.removeBucketCrossTileIDs=function(c,p){for(var h in p.indexedSymbolInstances)for(var d=0,_=p.indexedSymbolInstances[h];d<_.length;d+=1)delete this.usedCrossTileIDs[c][_[d].crossTileID]},fs.prototype.removeStaleBuckets=function(c){var p=!1;for(var h in this.indexes){var d=this.indexes[h];for(var _ in d)c[d[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,d[_]),delete d[_],p=!0)}return p};var ds=function(){this.layerIndexes={},this.crossTileIDs=new Do,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ds.prototype.addLayer=function(c,p,h){var d=this.layerIndexes[c.id];d===void 0&&(d=this.layerIndexes[c.id]=new fs);var _=!1,b={};d.handleWrapJump(h);for(var w=0,I=p;w<I.length;w+=1){var T=I[w],O=T.getBucket(c);O&&c.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(T.tileID,O,this.crossTileIDs)&&(_=!0),b[O.bucketInstanceId]=!0)}return d.removeStaleBuckets(b)&&(_=!0),_},ds.prototype.pruneUnusedLayers=function(c){var p={};for(var h in c.forEach(function(d){p[d]=!0}),this.layerIndexes)p[h]||delete this.layerIndexes[h]};var iu=function(c,p){return s.emitValidationErrors(c,p&&p.filter(function(h){return h.identifier!=="source.canvas"}))},gs=s.pick(Vt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ys=s.pick(Vt,["setCenter","setZoom","setBearing","setPitch"]),Bc=function(){var c={},p=s.styleSpec.$version;for(var h in s.styleSpec.$root){var d,_=s.styleSpec.$root[h];_.required&&(d=h==="version"?p:_.type==="array"?[]:{})!=null&&(c[h]=d)}return c}(),Kn=function(c){function p(h,d){var _=this;d===void 0&&(d={}),c.call(this),this.map=h,this.dispatcher=new Ut(St(),this),this.imageManager=new ut,this.imageManager.setEventedParent(this),this.glyphManager=new $t(h._requestManager,d.localIdeographFontFamily),this.lineAtlas=new Le(256,512),this.crossTileSymbolIndex=new ds,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());var b=this;this._rtlTextPluginCallback=p.registerForPluginStateChange(function(w){b.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},function(I,T){if(s.triggerPluginCompletionEvent(I),T&&T.every(function(V){return V}))for(var O in b.sourceCaches)b.sourceCaches[O].reload()})}),this.on("data",function(w){if(w.dataType==="source"&&w.sourceDataType==="metadata"){var I=_.sourceCaches[w.sourceId];if(I){var T=I.getSource();if(T&&T.vectorLayerIds)for(var O in _._layers){var V=_._layers[O];V.source===T.id&&_._validateLayer(V)}}}})}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.loadURL=function(h,d){var _=this;d===void 0&&(d={}),this.fire(new s.Event("dataloading",{dataType:"style"}));var b=typeof d.validate=="boolean"?d.validate:!s.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,d.accessToken);var w=this.map._requestManager.transformRequest(h,s.ResourceType.Style);this._request=s.getJSON(w,function(I,T){_._request=null,I?_.fire(new s.ErrorEvent(I)):T&&_._load(T,b)})},p.prototype.loadJSON=function(h,d){var _=this;d===void 0&&(d={}),this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.browser.frame(function(){_._request=null,_._load(h,d.validate!==!1)})},p.prototype.loadEmpty=function(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Bc,!1)},p.prototype._load=function(h,d){if(!d||!iu(this,s.validateStyle(h))){for(var _ in this._loaded=!0,this.stylesheet=h,h.sources)this.addSource(_,h.sources[_],{validate:!1});h.sprite?this._loadSprite(h.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(h.glyphs);var b=zt(this.stylesheet.layers);this._order=b.map(function(O){return O.id}),this._layers={},this._serializedLayers={};for(var w=0,I=b;w<I.length;w+=1){var T=I[w];(T=s.createStyleLayer(T)).setEventedParent(this,{layer:{id:T.id}}),this._layers[T.id]=T,this._serializedLayers[T.id]=T.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new er(this.stylesheet.light),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}},p.prototype._loadSprite=function(h){var d=this;this._spriteRequest=function(_,b,w){var I,T,O,V=s.browser.devicePixelRatio>1?"@2x":"",q=s.getJSON(b.transformRequest(b.normalizeSpriteURL(_,V,".json"),s.ResourceType.SpriteJSON),function(Y,rt){q=null,O||(O=Y,I=rt,K())}),j=s.getImage(b.transformRequest(b.normalizeSpriteURL(_,V,".png"),s.ResourceType.SpriteImage),function(Y,rt){j=null,O||(O=Y,T=rt,K())});function K(){if(O)w(O);else if(I&&T){var Y=s.browser.getImageData(T),rt={};for(var H in I){var et=I[H],at=et.width,ct=et.height,vt=et.x,yt=et.y,bt=et.sdf,Lt=et.pixelRatio,kt=et.stretchX,Ot=et.stretchY,Zt=et.content,ue=new s.RGBAImage({width:at,height:ct});s.RGBAImage.copy(Y,ue,{x:vt,y:yt},{x:0,y:0},{width:at,height:ct}),rt[H]={data:ue,pixelRatio:Lt,sdf:bt,stretchX:kt,stretchY:Ot,content:Zt}}w(null,rt)}}return{cancel:function(){q&&(q.cancel(),q=null),j&&(j.cancel(),j=null)}}}(h,this.map._requestManager,function(_,b){if(d._spriteRequest=null,_)d.fire(new s.ErrorEvent(_));else if(b)for(var w in b)d.imageManager.addImage(w,b[w]);d.imageManager.setLoaded(!0),d._availableImages=d.imageManager.listImages(),d.dispatcher.broadcast("setImages",d._availableImages),d.fire(new s.Event("data",{dataType:"style"}))})},p.prototype._validateLayer=function(h){var d=this.sourceCaches[h.source];if(d){var _=h.sourceLayer;if(_){var b=d.getSource();(b.type==="geojson"||b.vectorLayerIds&&b.vectorLayerIds.indexOf(_)===-1)&&this.fire(new s.ErrorEvent(new Error('Source layer "'+_+'" does not exist on source "'+b.id+'" as specified by style layer "'+h.id+'"')))}}},p.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var h in this.sourceCaches)if(!this.sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()},p.prototype._serializeLayers=function(h){for(var d=[],_=0,b=h;_<b.length;_+=1){var w=this._layers[b[_]];w.type!=="custom"&&d.push(w.serialize())}return d},p.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(var d in this._layers)if(this._layers[d].hasTransition())return!0;return!1},p.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},p.prototype.update=function(h){if(this._loaded){var d=this._changed;if(this._changed){var _=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);for(var w in(_.length||b.length)&&this._updateWorkerLayers(_,b),this._updatedSources){var I=this._updatedSources[w];I==="reload"?this._reloadSource(w):I==="clear"&&this._clearSource(w)}for(var T in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[T].updateTransitions(h);this.light.updateTransitions(h),this._resetUpdates()}var O={};for(var V in this.sourceCaches){var q=this.sourceCaches[V];O[V]=q.used,q.used=!1}for(var j=0,K=this._order;j<K.length;j+=1){var Y=this._layers[K[j]];Y.recalculate(h,this._availableImages),!Y.isHidden(h.zoom)&&Y.source&&(this.sourceCaches[Y.source].used=!0)}for(var rt in O){var H=this.sourceCaches[rt];O[rt]!==H.used&&H.fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:rt}))}this.light.recalculate(h),this.z=h.zoom,d&&this.fire(new s.Event("data",{dataType:"style"}))}},p.prototype._updateTilesForChangedImages=function(){var h=Object.keys(this._changedImages);if(h.length){for(var d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}},p.prototype._updateWorkerLayers=function(h,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:d})},p.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},p.prototype.setState=function(h){var d=this;if(this._checkLoaded(),iu(this,s.validateStyle(h)))return!1;(h=s.clone$1(h)).layers=zt(h.layers);var _=function(w,I){if(!w)return[{command:Vt.setStyle,args:[I]}];var T=[];try{if(!s.deepEqual(w.version,I.version))return[{command:Vt.setStyle,args:[I]}];s.deepEqual(w.center,I.center)||T.push({command:Vt.setCenter,args:[I.center]}),s.deepEqual(w.zoom,I.zoom)||T.push({command:Vt.setZoom,args:[I.zoom]}),s.deepEqual(w.bearing,I.bearing)||T.push({command:Vt.setBearing,args:[I.bearing]}),s.deepEqual(w.pitch,I.pitch)||T.push({command:Vt.setPitch,args:[I.pitch]}),s.deepEqual(w.sprite,I.sprite)||T.push({command:Vt.setSprite,args:[I.sprite]}),s.deepEqual(w.glyphs,I.glyphs)||T.push({command:Vt.setGlyphs,args:[I.glyphs]}),s.deepEqual(w.transition,I.transition)||T.push({command:Vt.setTransition,args:[I.transition]}),s.deepEqual(w.light,I.light)||T.push({command:Vt.setLight,args:[I.light]});var O={},V=[];(function(j,K,Y,rt){var H;for(H in K=K||{},j=j||{})j.hasOwnProperty(H)&&(K.hasOwnProperty(H)||Gt(H,Y,rt));for(H in K)K.hasOwnProperty(H)&&(j.hasOwnProperty(H)?s.deepEqual(j[H],K[H])||(j[H].type==="geojson"&&K[H].type==="geojson"&&Cr(j,K,H)?Y.push({command:Vt.setGeoJSONSourceData,args:[H,K[H].data]}):Ze(H,K,Y,rt)):Ne(H,K,Y))})(w.sources,I.sources,V,O);var q=[];w.layers&&w.layers.forEach(function(j){O[j.source]?T.push({command:Vt.removeLayer,args:[j.id]}):q.push(j)}),T=T.concat(V),function(j,K,Y){K=K||[];var rt,H,et,at,ct,vt,yt,bt=(j=j||[]).map(sr),Lt=K.map(sr),kt=j.reduce(We,{}),Ot=K.reduce(We,{}),Zt=bt.slice(),ue=Object.create(null);for(rt=0,H=0;rt<bt.length;rt++)Ot.hasOwnProperty(et=bt[rt])?H++:(Y.push({command:Vt.removeLayer,args:[et]}),Zt.splice(Zt.indexOf(et,H),1));for(rt=0,H=0;rt<Lt.length;rt++)Zt[Zt.length-1-rt]!==(et=Lt[Lt.length-1-rt])&&(kt.hasOwnProperty(et)?(Y.push({command:Vt.removeLayer,args:[et]}),Zt.splice(Zt.lastIndexOf(et,Zt.length-H),1)):H++,Y.push({command:Vt.addLayer,args:[Ot[et],vt=Zt[Zt.length-rt]]}),Zt.splice(Zt.length-rt,0,et),ue[et]=!0);for(rt=0;rt<Lt.length;rt++)if(at=kt[et=Lt[rt]],ct=Ot[et],!ue[et]&&!s.deepEqual(at,ct))if(s.deepEqual(at.source,ct.source)&&s.deepEqual(at["source-layer"],ct["source-layer"])&&s.deepEqual(at.type,ct.type)){for(yt in Ve(at.layout,ct.layout,Y,et,null,Vt.setLayoutProperty),Ve(at.paint,ct.paint,Y,et,null,Vt.setPaintProperty),s.deepEqual(at.filter,ct.filter)||Y.push({command:Vt.setFilter,args:[et,ct.filter]}),s.deepEqual(at.minzoom,ct.minzoom)&&s.deepEqual(at.maxzoom,ct.maxzoom)||Y.push({command:Vt.setLayerZoomRange,args:[et,ct.minzoom,ct.maxzoom]}),at)at.hasOwnProperty(yt)&&yt!=="layout"&&yt!=="paint"&&yt!=="filter"&&yt!=="metadata"&&yt!=="minzoom"&&yt!=="maxzoom"&&(yt.indexOf("paint.")===0?Ve(at[yt],ct[yt],Y,et,yt.slice(6),Vt.setPaintProperty):s.deepEqual(at[yt],ct[yt])||Y.push({command:Vt.setLayerProperty,args:[et,yt,ct[yt]]}));for(yt in ct)ct.hasOwnProperty(yt)&&!at.hasOwnProperty(yt)&&yt!=="layout"&&yt!=="paint"&&yt!=="filter"&&yt!=="metadata"&&yt!=="minzoom"&&yt!=="maxzoom"&&(yt.indexOf("paint.")===0?Ve(at[yt],ct[yt],Y,et,yt.slice(6),Vt.setPaintProperty):s.deepEqual(at[yt],ct[yt])||Y.push({command:Vt.setLayerProperty,args:[et,yt,ct[yt]]}))}else Y.push({command:Vt.removeLayer,args:[et]}),vt=Zt[Zt.lastIndexOf(et)+1],Y.push({command:Vt.addLayer,args:[ct,vt]})}(q,I.layers,T)}catch(j){console.warn("Unable to compute style diff:",j),T=[{command:Vt.setStyle,args:[I]}]}return T}(this.serialize(),h).filter(function(w){return!(w.command in ys)});if(_.length===0)return!1;var b=_.filter(function(w){return!(w.command in gs)});if(b.length>0)throw new Error("Unimplemented: "+b.map(function(w){return w.command}).join(", ")+".");return _.forEach(function(w){w.command!=="setTransition"&&d[w.command].apply(d,w.args)}),this.stylesheet=h,!0},p.prototype.addImage=function(h,d){if(this.getImage(h))return this.fire(new s.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(h,d),this._afterImageUpdated(h)},p.prototype.updateImage=function(h,d){this.imageManager.updateImage(h,d)},p.prototype.getImage=function(h){return this.imageManager.getImage(h)},p.prototype.removeImage=function(h){if(!this.getImage(h))return this.fire(new s.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(h),this._afterImageUpdated(h)},p.prototype._afterImageUpdated=function(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))},p.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},p.prototype.addSource=function(h,d,_){var b=this;if(_===void 0&&(_={}),this._checkLoaded(),this.sourceCaches[h]!==void 0)throw new Error("There is already a source with this ID");if(!d.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(d).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(s.validateStyle.source,"sources."+h,d,null,_))){this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);var w=this.sourceCaches[h]=new J(h,d,this.dispatcher);w.style=this,w.setEventedParent(this,function(){return{isSourceLoaded:b.loaded(),source:w.serialize(),sourceId:h}}),w.onAdd(this.map),this._changed=!0}},p.prototype.removeSource=function(h){if(this._checkLoaded(),this.sourceCaches[h]===void 0)throw new Error("There is no source with this ID");for(var d in this._layers)if(this._layers[d].source===h)return this.fire(new s.ErrorEvent(new Error('Source "'+h+'" cannot be removed while layer "'+d+'" is using it.')));var _=this.sourceCaches[h];delete this.sourceCaches[h],delete this._updatedSources[h],_.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:h})),_.setEventedParent(null),_.clearTiles(),_.onRemove&&_.onRemove(this.map),this._changed=!0},p.prototype.setGeoJSONSourceData=function(h,d){this._checkLoaded(),this.sourceCaches[h].getSource().setData(d),this._changed=!0},p.prototype.getSource=function(h){return this.sourceCaches[h]&&this.sourceCaches[h].getSource()},p.prototype.addLayer=function(h,d,_){_===void 0&&(_={}),this._checkLoaded();var b=h.id;if(this.getLayer(b))this.fire(new s.ErrorEvent(new Error('Layer with id "'+b+'" already exists on this map')));else{var w;if(h.type==="custom"){if(iu(this,s.validateCustomStyleLayer(h)))return;w=s.createStyleLayer(h)}else{if(typeof h.source=="object"&&(this.addSource(b,h.source),h=s.clone$1(h),h=s.extend(h,{source:b})),this._validate(s.validateStyle.layer,"layers."+b,h,{arrayIndex:-1},_))return;w=s.createStyleLayer(h),this._validateLayer(w),w.setEventedParent(this,{layer:{id:b}}),this._serializedLayers[w.id]=w.serialize()}var I=d?this._order.indexOf(d):this._order.length;if(d&&I===-1)this.fire(new s.ErrorEvent(new Error('Layer with id "'+d+'" does not exist on this map.')));else{if(this._order.splice(I,0,b),this._layerOrderChanged=!0,this._layers[b]=w,this._removedLayers[b]&&w.source&&w.type!=="custom"){var T=this._removedLayers[b];delete this._removedLayers[b],T.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}},p.prototype.moveLayer=function(h,d){if(this._checkLoaded(),this._changed=!0,this._layers[h]){if(h!==d){var _=this._order.indexOf(h);this._order.splice(_,1);var b=d?this._order.indexOf(d):this._order.length;d&&b===-1?this.fire(new s.ErrorEvent(new Error('Layer with id "'+d+'" does not exist on this map.'))):(this._order.splice(b,0,h),this._layerOrderChanged=!0)}}else this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be moved.")))},p.prototype.removeLayer=function(h){this._checkLoaded();var d=this._layers[h];if(d){d.setEventedParent(null);var _=this._order.indexOf(h);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=d,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],d.onRemove&&d.onRemove(this.map)}else this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be removed.")))},p.prototype.getLayer=function(h){return this._layers[h]},p.prototype.hasLayer=function(h){return h in this._layers},p.prototype.setLayerZoomRange=function(h,d,_){this._checkLoaded();var b=this.getLayer(h);b?b.minzoom===d&&b.maxzoom===_||(d!=null&&(b.minzoom=d),_!=null&&(b.maxzoom=_),this._updateLayer(b)):this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot have zoom extent.")))},p.prototype.setFilter=function(h,d,_){_===void 0&&(_={}),this._checkLoaded();var b=this.getLayer(h);if(b){if(!s.deepEqual(b.filter,d))return d==null?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(s.validateStyle.filter,"layers."+b.id+".filter",d,null,_)||(b.filter=s.clone$1(d),this._updateLayer(b)))}else this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be filtered.")))},p.prototype.getFilter=function(h){return s.clone$1(this.getLayer(h).filter)},p.prototype.setLayoutProperty=function(h,d,_,b){b===void 0&&(b={}),this._checkLoaded();var w=this.getLayer(h);w?s.deepEqual(w.getLayoutProperty(d),_)||(w.setLayoutProperty(d,_,b),this._updateLayer(w)):this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},p.prototype.getLayoutProperty=function(h,d){var _=this.getLayer(h);if(_)return _.getLayoutProperty(d);this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style.")))},p.prototype.setPaintProperty=function(h,d,_,b){b===void 0&&(b={}),this._checkLoaded();var w=this.getLayer(h);w?s.deepEqual(w.getPaintProperty(d),_)||(w.setPaintProperty(d,_,b)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new s.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},p.prototype.getPaintProperty=function(h,d){return this.getLayer(h).getPaintProperty(d)},p.prototype.setFeatureState=function(h,d){this._checkLoaded();var _=h.source,b=h.sourceLayer,w=this.sourceCaches[_];if(w!==void 0){var I=w.getSource().type;I==="geojson"&&b?this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):I!=="vector"||b?(h.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),w.setFeatureState(b,h.id,d)):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+_+"' does not exist in the map's style.")))},p.prototype.removeFeatureState=function(h,d){this._checkLoaded();var _=h.source,b=this.sourceCaches[_];if(b!==void 0){var w=b.getSource().type,I=w==="vector"?h.sourceLayer:void 0;w!=="vector"||I?d&&typeof h.id!="string"&&typeof h.id!="number"?this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):b.removeFeatureState(I,h.id,d):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+_+"' does not exist in the map's style.")))},p.prototype.getFeatureState=function(h){this._checkLoaded();var d=h.source,_=h.sourceLayer,b=this.sourceCaches[d];if(b!==void 0){if(b.getSource().type!=="vector"||_)return h.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),b.getFeatureState(_,h.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},p.prototype.getTransition=function(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},p.prototype.serialize=function(){return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:s.mapObject(this.sourceCaches,function(h){return h.serialize()}),layers:this._serializeLayers(this._order)},function(h){return h!==void 0})},p.prototype._updateLayer=function(h){this._updatedLayers[h.id]=!0,h.source&&!this._updatedSources[h.source]&&this.sourceCaches[h.source].getSource().type!=="raster"&&(this._updatedSources[h.source]="reload",this.sourceCaches[h.source].pause()),this._changed=!0},p.prototype._flattenAndSortRenderedFeatures=function(h){for(var d=this,_=function(kt){return d._layers[kt].type==="fill-extrusion"},b={},w=[],I=this._order.length-1;I>=0;I--){var T=this._order[I];if(_(T)){b[T]=I;for(var O=0,V=h;O<V.length;O+=1){var q=V[O][T];if(q)for(var j=0,K=q;j<K.length;j+=1)w.push(K[j])}}}w.sort(function(kt,Ot){return Ot.intersectionZ-kt.intersectionZ});for(var Y=[],rt=this._order.length-1;rt>=0;rt--){var H=this._order[rt];if(_(H))for(var et=w.length-1;et>=0;et--){var at=w[et].feature;if(b[at.layer.id]<rt)break;Y.push(at),w.pop()}else for(var ct=0,vt=h;ct<vt.length;ct+=1){var yt=vt[ct][H];if(yt)for(var bt=0,Lt=yt;bt<Lt.length;bt+=1)Y.push(Lt[bt].feature)}}return Y},p.prototype.queryRenderedFeatures=function(h,d,_){d&&d.filter&&this._validate(s.validateStyle.filter,"queryRenderedFeatures.filter",d.filter,null,d);var b={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var w=0,I=d.layers;w<I.length;w+=1){var T=I[w],O=this._layers[T];if(!O)return this.fire(new s.ErrorEvent(new Error("The layer '"+T+"' does not exist in the map's style and cannot be queried for features."))),[];b[O.source]=!0}}var V=[];for(var q in d.availableImages=this._availableImages,this.sourceCaches)d.layers&&!b[q]||V.push(Yr(this.sourceCaches[q],this._layers,this._serializedLayers,h,d,_));return this.placement&&V.push(function(j,K,Y,rt,H,et,at){for(var ct={},vt=et.queryRenderedSymbols(rt),yt=[],bt=0,Lt=Object.keys(vt).map(Number);bt<Lt.length;bt+=1)yt.push(at[Lt[bt]]);yt.sort(Yo);for(var kt=function(){var he=Zt[Ot],Je=he.featureIndex.lookupSymbolFeatures(vt[he.bucketInstanceId],K,he.bucketIndex,he.sourceLayerIndex,H.filter,H.layers,H.availableImages,j);for(var Wt in Je){var Ee=ct[Wt]=ct[Wt]||[],De=Je[Wt];De.sort(function(Te,ve){var me=he.featureSortOrder;if(me){var Fi=me.indexOf(Te.featureIndex);return me.indexOf(ve.featureIndex)-Fi}return ve.featureIndex-Te.featureIndex});for(var we=0,xe=De;we<xe.length;we+=1)Ee.push(xe[we])}},Ot=0,Zt=yt;Ot<Zt.length;Ot+=1)kt();var ue=function(he){ct[he].forEach(function(Je){var Wt=Je.feature,Ee=Y[j[he].source].getFeatureState(Wt.layer["source-layer"],Wt.id);Wt.source=Wt.layer.source,Wt.layer["source-layer"]&&(Wt.sourceLayer=Wt.layer["source-layer"]),Wt.state=Ee})};for(var pe in ct)ue(pe);return ct}(this._layers,this._serializedLayers,this.sourceCaches,h,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(V)},p.prototype.querySourceFeatures=function(h,d){d&&d.filter&&this._validate(s.validateStyle.filter,"querySourceFeatures.filter",d.filter,null,d);var _=this.sourceCaches[h];return _?function(b,w){for(var I=b.getRenderableIds().map(function(K){return b.getTileByID(K)}),T=[],O={},V=0;V<I.length;V++){var q=I[V],j=q.tileID.canonical.key;O[j]||(O[j]=!0,q.querySourceFeatures(T,w))}return T}(_,d):[]},p.prototype.addSourceType=function(h,d,_){return p.getSourceType(h)?_(new Error('A source type called "'+h+'" already exists.')):(p.setSourceType(h,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:d.workerSourceURL},_):_(null,null))},p.prototype.getLight=function(){return this.light.getLight()},p.prototype.setLight=function(h,d){d===void 0&&(d={}),this._checkLoaded();var _=this.light.getLight(),b=!1;for(var w in h)if(!s.deepEqual(h[w],_[w])){b=!0;break}if(b){var I={now:s.browser.now(),transition:s.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(h,d),this.light.updateTransitions(I)}},p.prototype._validate=function(h,d,_,b,w){return w===void 0&&(w={}),(!w||w.validate!==!1)&&iu(this,h.call(s.validateStyle,s.extend({key:d,style:this.serialize(),value:_,styleSpec:s.styleSpec},b)))},p.prototype._remove=function(){for(var h in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[h].setEventedParent(null);for(var d in this.sourceCaches)this.sourceCaches[d].clearTiles(),this.sourceCaches[d].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},p.prototype._clearSource=function(h){this.sourceCaches[h].clearTiles()},p.prototype._reloadSource=function(h){this.sourceCaches[h].resume(),this.sourceCaches[h].reload()},p.prototype._updateSources=function(h){for(var d in this.sourceCaches)this.sourceCaches[d].update(h)},p.prototype._generateCollisionBoxes=function(){for(var h in this.sourceCaches)this._reloadSource(h)},p.prototype._updatePlacement=function(h,d,_,b,w){w===void 0&&(w=!1);for(var I=!1,T=!1,O={},V=0,q=this._order;V<q.length;V+=1){var j=this._layers[q[V]];if(j.type==="symbol"){if(!O[j.source]){var K=this.sourceCaches[j.source];O[j.source]=K.getRenderableIds(!0).map(function(at){return K.getTileByID(at)}).sort(function(at,ct){return ct.tileID.overscaledZ-at.tileID.overscaledZ||(at.tileID.isLessThan(ct.tileID)?-1:1)})}var Y=this.crossTileSymbolIndex.addLayer(j,O[j.source],h.center.lng);I=I||Y}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||_===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.browser.now(),h.zoom))&&(this.pauseablePlacement=new Rl(h,this._order,w,d,_,b,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.browser.now()),T=!0),I&&this.pauseablePlacement.placement.setStale()),T||I)for(var rt=0,H=this._order;rt<H.length;rt+=1){var et=this._layers[H[rt]];et.type==="symbol"&&this.placement.updateLayerOpacities(et,O[et.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.browser.now())},p.prototype._releaseSymbolFadeTiles=function(){for(var h in this.sourceCaches)this.sourceCaches[h].releaseSymbolFadeTiles()},p.prototype.getImages=function(h,d,_){this.imageManager.getImages(d.icons,_),this._updateTilesForChangedImages();var b=this.sourceCaches[d.source];b&&b.setDependencies(d.tileID.key,d.type,d.icons)},p.prototype.getGlyphs=function(h,d,_){this.glyphManager.getGlyphs(d.stacks,_)},p.prototype.getResource=function(h,d,_){return s.makeRequest(d,_)},p}(s.Evented);Kn.getSourceType=function(c){return Dr[c]},Kn.setSourceType=function(c,p){Dr[c]=p},Kn.registerForPluginStateChange=s.registerForPluginStateChange;var xi=s.createLayout([{name:"a_pos",type:"Int16",components:2}]),Hu=Lr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),nd=Lr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),gy=Lr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),yy=Lr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),vp=Lr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),xp=Lr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),bp=Lr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),wp=Lr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),od=Lr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),ad=Lr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),my=Lr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Fl=Lr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),zl=Lr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),sd=Lr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),$i=Lr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Ep=Lr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),ms=Lr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),_s=Lr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),nu=Lr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),ou=Lr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),vs=Lr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),au=Lr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),su=Lr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),xs=Lr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),ud=Lr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),ld=Lr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Lr(c,p){var h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=p.match(/attribute ([\w]+) ([\w]+)/g),_=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=b?b.concat(_):_,I={};return{fragmentSource:c=c.replace(h,function(T,O,V,q,j){return I[j]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_`+j+`
varying `+V+" "+q+" "+j+`;
#else
uniform `+V+" "+q+" u_"+j+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+j+`
    `+V+" "+q+" "+j+" = u_"+j+`;
#endif
`}),vertexSource:p=p.replace(h,function(T,O,V,q,j){var K=q==="float"?"vec2":"vec4",Y=j.match(/color/)?"color":K;return I[j]?O==="define"?`
#ifndef HAS_UNIFORM_u_`+j+`
uniform lowp float u_`+j+`_t;
attribute `+V+" "+K+" a_"+j+`;
varying `+V+" "+q+" "+j+`;
#else
uniform `+V+" "+q+" u_"+j+`;
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_`+j+`
    `+j+" = a_"+j+`;
#else
    `+V+" "+q+" "+j+" = u_"+j+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+j+`
    `+j+" = unpack_mix_"+Y+"(a_"+j+", u_"+j+`_t);
#else
    `+V+" "+q+" "+j+" = u_"+j+`;
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_`+j+`
uniform lowp float u_`+j+`_t;
attribute `+V+" "+K+" a_"+j+`;
#else
uniform `+V+" "+q+" u_"+j+`;
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_`+j+`
    `+V+" "+q+" "+j+" = a_"+j+`;
#else
    `+V+" "+q+" "+j+" = u_"+j+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+j+`
    `+V+" "+q+" "+j+" = unpack_mix_"+Y+"(a_"+j+", u_"+j+`_t);
#else
    `+V+" "+q+" "+j+" = u_"+j+`;
#endif
`}),staticAttributes:d,staticUniforms:w}}var _y=Object.freeze({__proto__:null,prelude:Hu,background:nd,backgroundPattern:gy,circle:yy,clippingMask:vp,heatmap:xp,heatmapTexture:bp,collisionBox:wp,collisionCircle:od,debug:ad,fill:my,fillOutline:Fl,fillOutlinePattern:zl,fillPattern:sd,fillExtrusion:$i,fillExtrusionPattern:Ep,hillshadePrepare:ms,hillshade:_s,line:nu,lineGradient:ou,linePattern:vs,lineSDF:au,raster:su,symbolIcon:xs,symbolSDF:ud,symbolTextAndIcon:ld}),Vc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function cd(c){for(var p=[],h=0;h<c.length;h++)if(c[h]!==null){var d=c[h].split(" ");p.push(d.pop())}return p}Vc.prototype.bind=function(c,p,h,d,_,b,w,I){this.context=c;for(var T=this.boundPaintVertexBuffers.length!==d.length,O=0;!T&&O<d.length;O++)this.boundPaintVertexBuffers[O]!==d[O]&&(T=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===p&&this.boundLayoutVertexBuffer===h&&!T&&this.boundIndexBuffer===_&&this.boundVertexOffset===b&&this.boundDynamicVertexBuffer===w&&this.boundDynamicVertexBuffer2===I?(c.bindVertexArrayOES.set(this.vao),w&&w.bind(),_&&_.dynamicDraw&&_.bind(),I&&I.bind()):this.freshBind(p,h,d,_,b,w,I)},Vc.prototype.freshBind=function(c,p,h,d,_,b,w){var I,T=c.numAttributes,O=this.context,V=O.gl;if(O.extVertexArrayObject)this.vao&&this.destroy(),this.vao=O.extVertexArrayObject.createVertexArrayOES(),O.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=c,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=d,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=w;else{I=O.currentNumAttributes||0;for(var q=T;q<I;q++)V.disableVertexAttribArray(q)}p.enableAttributes(V,c);for(var j=0,K=h;j<K.length;j+=1)K[j].enableAttributes(V,c);b&&b.enableAttributes(V,c),w&&w.enableAttributes(V,c),p.bind(),p.setVertexAttribPointers(V,c,_);for(var Y=0,rt=h;Y<rt.length;Y+=1){var H=rt[Y];H.bind(),H.setVertexAttribPointers(V,c,_)}b&&(b.bind(),b.setVertexAttribPointers(V,c,_)),d&&d.bind(),w&&(w.bind(),w.setVertexAttribPointers(V,c,_)),O.currentNumAttributes=T},Vc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var hd=function(c,p,h,d,_,b){var w=c.gl;this.program=w.createProgram();for(var I=cd(h.staticAttributes),T=d?d.getBinderAttributes():[],O=I.concat(T),V=h.staticUniforms?cd(h.staticUniforms):[],q=d?d.getBinderUniforms():[],j=[],K=0,Y=V.concat(q);K<Y.length;K+=1){var rt=Y[K];j.indexOf(rt)<0&&j.push(rt)}var H=d?d.defines():[];b&&H.push("#define OVERDRAW_INSPECTOR;");var et=H.concat(Hu.fragmentSource,h.fragmentSource).join(`
`),at=H.concat(Hu.vertexSource,h.vertexSource).join(`
`),ct=w.createShader(w.FRAGMENT_SHADER);if(w.isContextLost())this.failedToCreate=!0;else{w.shaderSource(ct,et),w.compileShader(ct),w.attachShader(this.program,ct);var vt=w.createShader(w.VERTEX_SHADER);if(w.isContextLost())this.failedToCreate=!0;else{w.shaderSource(vt,at),w.compileShader(vt),w.attachShader(this.program,vt),this.attributes={};var yt={};this.numAttributes=O.length;for(var bt=0;bt<this.numAttributes;bt++)O[bt]&&(w.bindAttribLocation(this.program,bt,O[bt]),this.attributes[O[bt]]=bt);w.linkProgram(this.program),w.deleteShader(vt),w.deleteShader(ct);for(var Lt=0;Lt<j.length;Lt++){var kt=j[Lt];if(kt&&!yt[kt]){var Ot=w.getUniformLocation(this.program,kt);Ot&&(yt[kt]=Ot)}}this.fixedUniforms=_(c,yt),this.binderUniforms=d?d.getUniforms(c,yt):[]}}};function pd(c,p,h){var d=1/Vr(h,1,p.transform.tileZoom),_=Math.pow(2,h.tileID.overscaledZ),b=h.tileSize*Math.pow(2,p.transform.tileZoom)/_,w=b*(h.tileID.canonical.x+h.tileID.wrap*_),I=b*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[d,c.fromScale,c.toScale],u_fade:c.t,u_pixel_coord_upper:[w>>16,I>>16],u_pixel_coord_lower:[65535&w,65535&I]}}hd.prototype.draw=function(c,p,h,d,_,b,w,I,T,O,V,q,j,K,Y,rt){var H,et=c.gl;if(!this.failedToCreate){for(var at in c.program.set(this.program),c.setDepthMode(h),c.setStencilMode(d),c.setColorMode(_),c.setCullFace(b),this.fixedUniforms)this.fixedUniforms[at].set(w[at]);K&&K.setUniforms(c,this.binderUniforms,q,{zoom:j});for(var ct=(H={},H[et.LINES]=2,H[et.TRIANGLES]=3,H[et.LINE_STRIP]=1,H)[p],vt=0,yt=V.get();vt<yt.length;vt+=1){var bt=yt[vt],Lt=bt.vaos||(bt.vaos={});(Lt[I]||(Lt[I]=new Vc)).bind(c,this,T,K?K.getPaintVertexBuffers():[],O,bt.vertexOffset,Y,rt),et.drawElements(p,bt.primitiveLength*ct,et.UNSIGNED_SHORT,bt.primitiveOffset*ct*2)}}};var fd=function(c,p,h,d){var _=p.style.light,b=_.properties.get("position"),w=[b.x,b.y,b.z],I=s.create$1();_.properties.get("anchor")==="viewport"&&s.fromRotation(I,-p.transform.angle),s.transformMat3(w,w,I);var T=_.properties.get("color");return{u_matrix:c,u_lightpos:w,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+h,u_opacity:d}},uu=function(c,p,h,d,_,b,w){return s.extend(fd(c,p,h,d),pd(b,p,w),{u_height_factor:-Math.pow(2,_.overscaledZ)/w.tileSize/8})},bs=function(c){return{u_matrix:c}},lu=function(c,p,h,d){return s.extend(bs(c),pd(h,p,d))},dd=function(c,p){return{u_matrix:c,u_world:p}},gd=function(c,p,h,d,_){return s.extend(lu(c,p,h,d),{u_world:_})},Sp=function(c,p,h,d){var _,b,w=c.transform;if(d.paint.get("circle-pitch-alignment")==="map"){var I=Vr(h,1,w.zoom);_=!0,b=[I,I]}else _=!1,b=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:c.translatePosMatrix(p.posMatrix,h,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:s.browser.devicePixelRatio,u_extrude_scale:b}},cu=function(c,p,h){var d=Vr(h,1,p.zoom),_=Math.pow(2,p.zoom-h.tileID.overscaledZ),b=h.tileID.overscaleFactor();return{u_matrix:c,u_camera_to_center_distance:p.cameraToCenterDistance,u_pixels_to_tile_units:d,u_extrude_scale:[p.pixelsToGLUnits[0]/(d*_),p.pixelsToGLUnits[1]/(d*_)],u_overscale_factor:b}},yd=function(c,p,h){return{u_matrix:c,u_inv_matrix:p,u_camera_to_center_distance:h.cameraToCenterDistance,u_viewport_size:[h.width,h.height]}},hu=function(c,p,h){return h===void 0&&(h=1),{u_matrix:c,u_color:p,u_overlay:0,u_overlay_scale:h}},pu=function(c){return{u_matrix:c}},md=function(c,p,h,d){return{u_matrix:c,u_extrude_scale:Vr(p,1,h),u_intensity:d}},Bl=function(c,p,h){var d=c.transform;return{u_matrix:_d(c,p,h),u_ratio:1/Vr(p,1,d.zoom),u_device_pixel_ratio:s.browser.devicePixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Or=function(c,p,h,d){return s.extend(Bl(c,p,h),{u_image:0,u_image_height:d})},Uc=function(c,p,h,d){var _=c.transform,b=Xu(p,_);return{u_matrix:_d(c,p,h),u_texsize:p.imageAtlasTexture.size,u_ratio:1/Vr(p,1,_.zoom),u_device_pixel_ratio:s.browser.devicePixelRatio,u_image:0,u_scale:[b,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},vy=function(c,p,h,d,_){var b=c.lineAtlas,w=Xu(p,c.transform),I=h.layout.get("line-cap")==="round",T=b.getDash(d.from,I),O=b.getDash(d.to,I),V=T.width*_.fromScale,q=O.width*_.toScale;return s.extend(Bl(c,p,h),{u_patternscale_a:[w/V,-T.height/2],u_patternscale_b:[w/q,-O.height/2],u_sdfgamma:b.width/(256*Math.min(V,q)*s.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:T.y,u_tex_y_b:O.y,u_mix:_.t})};function Xu(c,p){return 1/Vr(c,1,p.tileZoom)}function _d(c,p,h){return c.translatePosMatrix(p.tileID.posMatrix,p,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}var xy=function(c,p,h,d,_){return{u_matrix:c,u_tl_parent:p,u_scale_parent:h,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(w=_.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(b=_.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:vd(_.paint.get("raster-hue-rotate"))};var b,w};function vd(c){c*=Math.PI/180;var p=Math.sin(c),h=Math.cos(c);return[(2*h+1)/3,(-Math.sqrt(3)*p-h+1)/3,(Math.sqrt(3)*p-h+1)/3]}var qc,Zu=function(c,p,h,d,_,b,w,I,T,O){var V=_.transform;return{u_is_size_zoom_constant:+(c==="constant"||c==="source"),u_is_size_feature_constant:+(c==="constant"||c==="camera"),u_size_t:p?p.uSizeT:0,u_size:p?p.uSize:0,u_camera_to_center_distance:V.cameraToCenterDistance,u_pitch:V.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:V.width/V.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:w,u_coord_matrix:I,u_is_text:+T,u_pitch_with_map:+d,u_texsize:O,u_texture:0}},Vl=function(c,p,h,d,_,b,w,I,T,O,V){var q=_.transform;return s.extend(Zu(c,p,h,d,_,b,w,I,T,O),{u_gamma_scale:d?Math.cos(q._pitch)*q.cameraToCenterDistance:1,u_device_pixel_ratio:s.browser.devicePixelRatio,u_is_halo:+V})},jc=function(c,p,h,d,_,b,w,I,T,O){return s.extend(Vl(c,p,h,d,_,b,w,I,!0,T,!0),{u_texsize_icon:O,u_texture_icon:1})},Ul=function(c,p,h){return{u_matrix:c,u_opacity:p,u_color:h}},Yu=function(c,p,h,d,_,b){return s.extend(function(w,I,T,O){var V=T.imageManager.getPattern(w.from.toString()),q=T.imageManager.getPattern(w.to.toString()),j=T.imageManager.getPixelSize(),K=j.width,Y=j.height,rt=Math.pow(2,O.tileID.overscaledZ),H=O.tileSize*Math.pow(2,T.transform.tileZoom)/rt,et=H*(O.tileID.canonical.x+O.tileID.wrap*rt),at=H*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:V.tl,u_pattern_br_a:V.br,u_pattern_tl_b:q.tl,u_pattern_br_b:q.br,u_texsize:[K,Y],u_mix:I.t,u_pattern_size_a:V.displaySize,u_pattern_size_b:q.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/Vr(O,1,T.transform.tileZoom),u_pixel_coord_upper:[et>>16,at>>16],u_pixel_coord_lower:[65535&et,65535&at]}}(d,b,h,_),{u_matrix:c,u_opacity:p})},xd={fillExtrusion:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_lightpos:new s.Uniform3f(c,p.u_lightpos),u_lightintensity:new s.Uniform1f(c,p.u_lightintensity),u_lightcolor:new s.Uniform3f(c,p.u_lightcolor),u_vertical_gradient:new s.Uniform1f(c,p.u_vertical_gradient),u_opacity:new s.Uniform1f(c,p.u_opacity)}},fillExtrusionPattern:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_lightpos:new s.Uniform3f(c,p.u_lightpos),u_lightintensity:new s.Uniform1f(c,p.u_lightintensity),u_lightcolor:new s.Uniform3f(c,p.u_lightcolor),u_vertical_gradient:new s.Uniform1f(c,p.u_vertical_gradient),u_height_factor:new s.Uniform1f(c,p.u_height_factor),u_image:new s.Uniform1i(c,p.u_image),u_texsize:new s.Uniform2f(c,p.u_texsize),u_pixel_coord_upper:new s.Uniform2f(c,p.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(c,p.u_pixel_coord_lower),u_scale:new s.Uniform3f(c,p.u_scale),u_fade:new s.Uniform1f(c,p.u_fade),u_opacity:new s.Uniform1f(c,p.u_opacity)}},fill:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix)}},fillPattern:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_image:new s.Uniform1i(c,p.u_image),u_texsize:new s.Uniform2f(c,p.u_texsize),u_pixel_coord_upper:new s.Uniform2f(c,p.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(c,p.u_pixel_coord_lower),u_scale:new s.Uniform3f(c,p.u_scale),u_fade:new s.Uniform1f(c,p.u_fade)}},fillOutline:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_world:new s.Uniform2f(c,p.u_world)}},fillOutlinePattern:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_world:new s.Uniform2f(c,p.u_world),u_image:new s.Uniform1i(c,p.u_image),u_texsize:new s.Uniform2f(c,p.u_texsize),u_pixel_coord_upper:new s.Uniform2f(c,p.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(c,p.u_pixel_coord_lower),u_scale:new s.Uniform3f(c,p.u_scale),u_fade:new s.Uniform1f(c,p.u_fade)}},circle:function(c,p){return{u_camera_to_center_distance:new s.Uniform1f(c,p.u_camera_to_center_distance),u_scale_with_map:new s.Uniform1i(c,p.u_scale_with_map),u_pitch_with_map:new s.Uniform1i(c,p.u_pitch_with_map),u_extrude_scale:new s.Uniform2f(c,p.u_extrude_scale),u_device_pixel_ratio:new s.Uniform1f(c,p.u_device_pixel_ratio),u_matrix:new s.UniformMatrix4f(c,p.u_matrix)}},collisionBox:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_camera_to_center_distance:new s.Uniform1f(c,p.u_camera_to_center_distance),u_pixels_to_tile_units:new s.Uniform1f(c,p.u_pixels_to_tile_units),u_extrude_scale:new s.Uniform2f(c,p.u_extrude_scale),u_overscale_factor:new s.Uniform1f(c,p.u_overscale_factor)}},collisionCircle:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_inv_matrix:new s.UniformMatrix4f(c,p.u_inv_matrix),u_camera_to_center_distance:new s.Uniform1f(c,p.u_camera_to_center_distance),u_viewport_size:new s.Uniform2f(c,p.u_viewport_size)}},debug:function(c,p){return{u_color:new s.UniformColor(c,p.u_color),u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_overlay:new s.Uniform1i(c,p.u_overlay),u_overlay_scale:new s.Uniform1f(c,p.u_overlay_scale)}},clippingMask:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix)}},heatmap:function(c,p){return{u_extrude_scale:new s.Uniform1f(c,p.u_extrude_scale),u_intensity:new s.Uniform1f(c,p.u_intensity),u_matrix:new s.UniformMatrix4f(c,p.u_matrix)}},heatmapTexture:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_world:new s.Uniform2f(c,p.u_world),u_image:new s.Uniform1i(c,p.u_image),u_color_ramp:new s.Uniform1i(c,p.u_color_ramp),u_opacity:new s.Uniform1f(c,p.u_opacity)}},hillshade:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_image:new s.Uniform1i(c,p.u_image),u_latrange:new s.Uniform2f(c,p.u_latrange),u_light:new s.Uniform2f(c,p.u_light),u_shadow:new s.UniformColor(c,p.u_shadow),u_highlight:new s.UniformColor(c,p.u_highlight),u_accent:new s.UniformColor(c,p.u_accent)}},hillshadePrepare:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_image:new s.Uniform1i(c,p.u_image),u_dimension:new s.Uniform2f(c,p.u_dimension),u_zoom:new s.Uniform1f(c,p.u_zoom),u_unpack:new s.Uniform4f(c,p.u_unpack)}},line:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_ratio:new s.Uniform1f(c,p.u_ratio),u_device_pixel_ratio:new s.Uniform1f(c,p.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(c,p.u_units_to_pixels)}},lineGradient:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_ratio:new s.Uniform1f(c,p.u_ratio),u_device_pixel_ratio:new s.Uniform1f(c,p.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(c,p.u_units_to_pixels),u_image:new s.Uniform1i(c,p.u_image),u_image_height:new s.Uniform1f(c,p.u_image_height)}},linePattern:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_texsize:new s.Uniform2f(c,p.u_texsize),u_ratio:new s.Uniform1f(c,p.u_ratio),u_device_pixel_ratio:new s.Uniform1f(c,p.u_device_pixel_ratio),u_image:new s.Uniform1i(c,p.u_image),u_units_to_pixels:new s.Uniform2f(c,p.u_units_to_pixels),u_scale:new s.Uniform3f(c,p.u_scale),u_fade:new s.Uniform1f(c,p.u_fade)}},lineSDF:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_ratio:new s.Uniform1f(c,p.u_ratio),u_device_pixel_ratio:new s.Uniform1f(c,p.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(c,p.u_units_to_pixels),u_patternscale_a:new s.Uniform2f(c,p.u_patternscale_a),u_patternscale_b:new s.Uniform2f(c,p.u_patternscale_b),u_sdfgamma:new s.Uniform1f(c,p.u_sdfgamma),u_image:new s.Uniform1i(c,p.u_image),u_tex_y_a:new s.Uniform1f(c,p.u_tex_y_a),u_tex_y_b:new s.Uniform1f(c,p.u_tex_y_b),u_mix:new s.Uniform1f(c,p.u_mix)}},raster:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_tl_parent:new s.Uniform2f(c,p.u_tl_parent),u_scale_parent:new s.Uniform1f(c,p.u_scale_parent),u_buffer_scale:new s.Uniform1f(c,p.u_buffer_scale),u_fade_t:new s.Uniform1f(c,p.u_fade_t),u_opacity:new s.Uniform1f(c,p.u_opacity),u_image0:new s.Uniform1i(c,p.u_image0),u_image1:new s.Uniform1i(c,p.u_image1),u_brightness_low:new s.Uniform1f(c,p.u_brightness_low),u_brightness_high:new s.Uniform1f(c,p.u_brightness_high),u_saturation_factor:new s.Uniform1f(c,p.u_saturation_factor),u_contrast_factor:new s.Uniform1f(c,p.u_contrast_factor),u_spin_weights:new s.Uniform3f(c,p.u_spin_weights)}},symbolIcon:function(c,p){return{u_is_size_zoom_constant:new s.Uniform1i(c,p.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(c,p.u_is_size_feature_constant),u_size_t:new s.Uniform1f(c,p.u_size_t),u_size:new s.Uniform1f(c,p.u_size),u_camera_to_center_distance:new s.Uniform1f(c,p.u_camera_to_center_distance),u_pitch:new s.Uniform1f(c,p.u_pitch),u_rotate_symbol:new s.Uniform1i(c,p.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(c,p.u_aspect_ratio),u_fade_change:new s.Uniform1f(c,p.u_fade_change),u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(c,p.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(c,p.u_coord_matrix),u_is_text:new s.Uniform1i(c,p.u_is_text),u_pitch_with_map:new s.Uniform1i(c,p.u_pitch_with_map),u_texsize:new s.Uniform2f(c,p.u_texsize),u_texture:new s.Uniform1i(c,p.u_texture)}},symbolSDF:function(c,p){return{u_is_size_zoom_constant:new s.Uniform1i(c,p.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(c,p.u_is_size_feature_constant),u_size_t:new s.Uniform1f(c,p.u_size_t),u_size:new s.Uniform1f(c,p.u_size),u_camera_to_center_distance:new s.Uniform1f(c,p.u_camera_to_center_distance),u_pitch:new s.Uniform1f(c,p.u_pitch),u_rotate_symbol:new s.Uniform1i(c,p.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(c,p.u_aspect_ratio),u_fade_change:new s.Uniform1f(c,p.u_fade_change),u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(c,p.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(c,p.u_coord_matrix),u_is_text:new s.Uniform1i(c,p.u_is_text),u_pitch_with_map:new s.Uniform1i(c,p.u_pitch_with_map),u_texsize:new s.Uniform2f(c,p.u_texsize),u_texture:new s.Uniform1i(c,p.u_texture),u_gamma_scale:new s.Uniform1f(c,p.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(c,p.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(c,p.u_is_halo)}},symbolTextAndIcon:function(c,p){return{u_is_size_zoom_constant:new s.Uniform1i(c,p.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(c,p.u_is_size_feature_constant),u_size_t:new s.Uniform1f(c,p.u_size_t),u_size:new s.Uniform1f(c,p.u_size),u_camera_to_center_distance:new s.Uniform1f(c,p.u_camera_to_center_distance),u_pitch:new s.Uniform1f(c,p.u_pitch),u_rotate_symbol:new s.Uniform1i(c,p.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(c,p.u_aspect_ratio),u_fade_change:new s.Uniform1f(c,p.u_fade_change),u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(c,p.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(c,p.u_coord_matrix),u_is_text:new s.Uniform1i(c,p.u_is_text),u_pitch_with_map:new s.Uniform1i(c,p.u_pitch_with_map),u_texsize:new s.Uniform2f(c,p.u_texsize),u_texsize_icon:new s.Uniform2f(c,p.u_texsize_icon),u_texture:new s.Uniform1i(c,p.u_texture),u_texture_icon:new s.Uniform1i(c,p.u_texture_icon),u_gamma_scale:new s.Uniform1f(c,p.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(c,p.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(c,p.u_is_halo)}},background:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_opacity:new s.Uniform1f(c,p.u_opacity),u_color:new s.UniformColor(c,p.u_color)}},backgroundPattern:function(c,p){return{u_matrix:new s.UniformMatrix4f(c,p.u_matrix),u_opacity:new s.Uniform1f(c,p.u_opacity),u_image:new s.Uniform1i(c,p.u_image),u_pattern_tl_a:new s.Uniform2f(c,p.u_pattern_tl_a),u_pattern_br_a:new s.Uniform2f(c,p.u_pattern_br_a),u_pattern_tl_b:new s.Uniform2f(c,p.u_pattern_tl_b),u_pattern_br_b:new s.Uniform2f(c,p.u_pattern_br_b),u_texsize:new s.Uniform2f(c,p.u_texsize),u_mix:new s.Uniform1f(c,p.u_mix),u_pattern_size_a:new s.Uniform2f(c,p.u_pattern_size_a),u_pattern_size_b:new s.Uniform2f(c,p.u_pattern_size_b),u_scale_a:new s.Uniform1f(c,p.u_scale_a),u_scale_b:new s.Uniform1f(c,p.u_scale_b),u_pixel_coord_upper:new s.Uniform2f(c,p.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(c,p.u_pixel_coord_lower),u_tile_units_to_pixels:new s.Uniform1f(c,p.u_tile_units_to_pixels)}}};function Wu(c,p,h,d,_,b,w){for(var I=c.context,T=I.gl,O=c.useProgram("collisionBox"),V=[],q=0,j=0,K=0;K<d.length;K++){var Y=d[K],rt=p.getTile(Y),H=rt.getBucket(h);if(H){var et=Y.posMatrix;_[0]===0&&_[1]===0||(et=c.translatePosMatrix(Y.posMatrix,rt,_,b));var at=w?H.textCollisionBox:H.iconCollisionBox,ct=H.collisionCircleArray;if(ct.length>0){var vt=s.create(),yt=et;s.mul(vt,H.placementInvProjMatrix,c.transform.glCoordMatrix),s.mul(vt,vt,H.placementViewportMatrix),V.push({circleArray:ct,circleOffset:j,transform:yt,invTransform:vt}),j=q+=ct.length/4}at&&O.draw(I,T.LINES,G.disabled,W.disabled,c.colorModeForRenderPass(),st.disabled,cu(et,c.transform,rt),h.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,null,c.transform.zoom,null,null,at.collisionVertexBuffer)}}if(w&&V.length){var bt=c.useProgram("collisionCircle"),Lt=new s.StructArrayLayout2f1f2i16;Lt.resize(4*q),Lt._trim();for(var kt=0,Ot=0,Zt=V;Ot<Zt.length;Ot+=1)for(var ue=Zt[Ot],pe=0;pe<ue.circleArray.length/4;pe++){var he=4*pe,Je=ue.circleArray[he+0],Wt=ue.circleArray[he+1],Ee=ue.circleArray[he+2],De=ue.circleArray[he+3];Lt.emplace(kt++,Je,Wt,Ee,De,0),Lt.emplace(kt++,Je,Wt,Ee,De,1),Lt.emplace(kt++,Je,Wt,Ee,De,2),Lt.emplace(kt++,Je,Wt,Ee,De,3)}(!qc||qc.length<2*q)&&(qc=function(ti){var pn=2*ti,Gi=new s.StructArrayLayout3ui6;Gi.resize(pn),Gi._trim();for(var Wr=0;Wr<pn;Wr++){var ci=6*Wr;Gi.uint16[ci+0]=4*Wr+0,Gi.uint16[ci+1]=4*Wr+1,Gi.uint16[ci+2]=4*Wr+2,Gi.uint16[ci+3]=4*Wr+2,Gi.uint16[ci+4]=4*Wr+3,Gi.uint16[ci+5]=4*Wr+0}return Gi}(q));for(var we=I.createIndexBuffer(qc,!0),xe=I.createVertexBuffer(Lt,s.collisionCircleLayout.members,!0),Te=0,ve=V;Te<ve.length;Te+=1){var me=ve[Te],Fi=yd(me.transform,me.invTransform,c.transform);bt.draw(I,T.TRIANGLES,G.disabled,W.disabled,c.colorModeForRenderPass(),st.disabled,Fi,h.id,xe,we,s.SegmentVector.simpleSegment(0,2*me.circleOffset,me.circleArray.length,me.circleArray.length/2),null,c.transform.zoom,null,null,null)}xe.destroy(),we.destroy()}}var Qo=s.identity(new Float32Array(16));function bd(c,p,h,d,_,b){var w=s.getAnchorAlignment(c),I=-(w.horizontalAlign-.5)*p,T=-(w.verticalAlign-.5)*h,O=s.evaluateVariableOffset(c,d);return new s.Point((I/_+O[0])*b,(T/_+O[1])*b)}function wd(c,p,h,d,_,b,w,I,T,O,V){var q=c.text.placedSymbolArray,j=c.text.dynamicLayoutVertexArray,K=c.icon.dynamicLayoutVertexArray,Y={};j.clear();for(var rt=0;rt<q.length;rt++){var H=q.get(rt),et=H.hidden||!H.crossTileID||c.allowVerticalPlacement&&!H.placedOrientation?null:d[H.crossTileID];if(et){var at=new s.Point(H.anchorX,H.anchorY),ct=Ge(at,h?I:w),vt=ur(b.cameraToCenterDistance,ct.signedDistanceFromCamera),yt=_.evaluateSizeForFeature(c.textSizeData,O,H)*vt/s.ONE_EM;h&&(yt*=c.tilePixelRatio/T);for(var bt=bd(et.anchor,et.width,et.height,et.textOffset,et.textBoxScale,yt),Lt=h?Ge(at.add(bt),w).point:ct.point.add(p?bt.rotate(-b.angle):bt),kt=c.allowVerticalPlacement&&H.placedOrientation===s.WritingMode.vertical?Math.PI/2:0,Ot=0;Ot<H.numGlyphs;Ot++)s.addDynamicAttributes(j,Lt,kt);V&&H.associatedIconIndex>=0&&(Y[H.associatedIconIndex]={shiftedAnchor:Lt,angle:kt})}else xn(H.numGlyphs,j)}if(V){K.clear();for(var Zt=c.icon.placedSymbolArray,ue=0;ue<Zt.length;ue++){var pe=Zt.get(ue);if(pe.hidden)xn(pe.numGlyphs,K);else{var he=Y[ue];if(he)for(var Je=0;Je<pe.numGlyphs;Je++)s.addDynamicAttributes(K,he.shiftedAnchor,he.angle);else xn(pe.numGlyphs,K)}}c.icon.dynamicLayoutVertexBuffer.updateData(K)}c.text.dynamicLayoutVertexBuffer.updateData(j)}function Ed(c,p,h){return h.iconsInText&&p?"symbolTextAndIcon":c?"symbolSDF":"symbolIcon"}function fu(c,p,h,d,_,b,w,I,T,O,V,q){for(var j=c.context,K=j.gl,Y=c.transform,rt=I==="map",H=T==="map",et=rt&&h.layout.get("symbol-placement")!=="point",at=rt&&!H&&!et,ct=h.layout.get("symbol-sort-key").constantOr(1)!==void 0,vt=!1,yt=c.depthModeForSublayer(0,G.ReadOnly),bt=h.layout.get("text-variable-anchor"),Lt=[],kt=0,Ot=d;kt<Ot.length;kt+=1){var Zt=Ot[kt],ue=p.getTile(Zt),pe=ue.getBucket(h);if(pe){var he=_?pe.text:pe.icon;if(he&&he.segments.get().length){var Je=he.programConfigurations.get(h.id),Wt=_||pe.sdfIcons,Ee=_?pe.textSizeData:pe.iconSizeData,De=H||Y.pitch!==0,we=c.useProgram(Ed(Wt,_,pe),Je),xe=s.evaluateSizeForZoom(Ee,Y.zoom),Te=void 0,ve=[0,0],me=void 0,Fi=void 0,ti=null,pn=void 0;if(_)me=ue.glyphAtlasTexture,Fi=K.LINEAR,Te=ue.glyphAtlasTexture.size,pe.iconsInText&&(ve=ue.imageAtlasTexture.size,ti=ue.imageAtlasTexture,pn=De||c.options.rotating||c.options.zooming||Ee.kind==="composite"||Ee.kind==="camera"?K.LINEAR:K.NEAREST);else{var Gi=h.layout.get("icon-size").constantOr(0)!==1||pe.iconsNeedLinear;me=ue.imageAtlasTexture,Fi=Wt||c.options.rotating||c.options.zooming||Gi||De?K.LINEAR:K.NEAREST,Te=ue.imageAtlasTexture.size}var Wr=Vr(ue,1,c.transform.zoom),ci=ui(Zt.posMatrix,H,rt,c.transform,Wr),ro=Er(Zt.posMatrix,H,rt,c.transform,Wr),Sn=bt&&pe.hasTextData(),Ls=h.layout.get("icon-text-fit")!=="none"&&Sn&&pe.hasIconData();et&&Ol(pe,Zt.posMatrix,c,_,ci,ro,H,O);var Un=c.translatePosMatrix(Zt.posMatrix,ue,b,w),ia=et||_&&bt||Ls?Qo:ci,Ro=c.translatePosMatrix(ro,ue,b,w,!0),$l=Wt&&h.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0,el={program:we,buffers:he,uniformValues:Wt?pe.iconsInText?jc(Ee.kind,xe,at,H,c,Un,ia,Ro,Te,ve):Vl(Ee.kind,xe,at,H,c,Un,ia,Ro,_,Te,!0):Zu(Ee.kind,xe,at,H,c,Un,ia,Ro,_,Te),atlasTexture:me,atlasTextureIcon:ti,atlasInterpolation:Fi,atlasInterpolationIcon:pn,isSDF:Wt,hasHalo:$l};if(ct&&pe.canOverlap){vt=!0;for(var Ps=0,rl=he.segments.get();Ps<rl.length;Ps+=1){var tc=rl[Ps];Lt.push({segments:new s.SegmentVector([tc]),sortKey:tc.sortKey,state:el})}}else Lt.push({segments:he.segments,sortKey:0,state:el})}}}vt&&Lt.sort(function(Ts,vu){return Ts.sortKey-vu.sortKey});for(var xa=0,ec=Lt;xa<ec.length;xa+=1){var ba=ec[xa],zi=ba.state;if(j.activeTexture.set(K.TEXTURE0),zi.atlasTexture.bind(zi.atlasInterpolation,K.CLAMP_TO_EDGE),zi.atlasTextureIcon&&(j.activeTexture.set(K.TEXTURE1),zi.atlasTextureIcon&&zi.atlasTextureIcon.bind(zi.atlasInterpolationIcon,K.CLAMP_TO_EDGE)),zi.isSDF){var Za=zi.uniformValues;zi.hasHalo&&(Za.u_is_halo=1,ql(zi.buffers,ba.segments,h,c,zi.program,yt,V,q,Za)),Za.u_is_halo=0}ql(zi.buffers,ba.segments,h,c,zi.program,yt,V,q,zi.uniformValues)}}function ql(c,p,h,d,_,b,w,I,T){var O=d.context;_.draw(O,O.gl.TRIANGLES,b,w,I,st.disabled,T,h.id,c.layoutVertexBuffer,c.indexBuffer,p,h.paint,d.transform.zoom,c.programConfigurations.get(h.id),c.dynamicLayoutVertexBuffer,c.opacityVertexBuffer)}function Gc(c,p,h,d,_,b,w){var I,T,O,V,q,j=c.context.gl,K=h.paint.get("fill-pattern"),Y=K&&K.constantOr(1),rt=h.getCrossfadeParameters();w?(T=Y&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",I=j.LINES):(T=Y?"fillPattern":"fill",I=j.TRIANGLES);for(var H=0,et=d;H<et.length;H+=1){var at=et[H],ct=p.getTile(at);if(!Y||ct.patternsLoaded()){var vt=ct.getBucket(h);if(vt){var yt=vt.programConfigurations.get(h.id),bt=c.useProgram(T,yt);Y&&(c.context.activeTexture.set(j.TEXTURE0),ct.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),yt.updatePaintBuffers(rt));var Lt=K.constantOr(null);if(Lt&&ct.imageAtlas){var kt=ct.imageAtlas,Ot=kt.patternPositions[Lt.to.toString()],Zt=kt.patternPositions[Lt.from.toString()];Ot&&Zt&&yt.setConstantPatternPositions(Ot,Zt)}var ue=c.translatePosMatrix(at.posMatrix,ct,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(w){V=vt.indexBuffer2,q=vt.segments2;var pe=[j.drawingBufferWidth,j.drawingBufferHeight];O=T==="fillOutlinePattern"&&Y?gd(ue,c,rt,ct,pe):dd(ue,pe)}else V=vt.indexBuffer,q=vt.segments,O=Y?lu(ue,c,rt,ct):bs(ue);bt.draw(c.context,I,_,c.stencilModeForClipping(at),b,st.disabled,O,h.id,vt.layoutVertexBuffer,V,q,h.paint,c.transform.zoom,yt)}}}}function Ip(c,p,h,d,_,b,w){for(var I=c.context,T=I.gl,O=h.paint.get("fill-extrusion-pattern"),V=O.constantOr(1),q=h.getCrossfadeParameters(),j=h.paint.get("fill-extrusion-opacity"),K=0,Y=d;K<Y.length;K+=1){var rt=Y[K],H=p.getTile(rt),et=H.getBucket(h);if(et){var at=et.programConfigurations.get(h.id),ct=c.useProgram(V?"fillExtrusionPattern":"fillExtrusion",at);V&&(c.context.activeTexture.set(T.TEXTURE0),H.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),at.updatePaintBuffers(q));var vt=O.constantOr(null);if(vt&&H.imageAtlas){var yt=H.imageAtlas,bt=yt.patternPositions[vt.to.toString()],Lt=yt.patternPositions[vt.from.toString()];bt&&Lt&&at.setConstantPatternPositions(bt,Lt)}var kt=c.translatePosMatrix(rt.posMatrix,H,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Ot=h.paint.get("fill-extrusion-vertical-gradient"),Zt=V?uu(kt,c,Ot,j,rt,q,H):fd(kt,c,Ot,j);ct.draw(I,I.gl.TRIANGLES,_,b,w,st.backCCW,Zt,h.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,h.paint,c.transform.zoom,at)}}}function Hc(c,p,h,d,_,b){var w=c.context,I=w.gl,T=p.fbo;if(T){var O=c.useProgram("hillshade");w.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,T.colorAttachment.get());var V=function(q,j,K){var Y=K.paint.get("hillshade-shadow-color"),rt=K.paint.get("hillshade-highlight-color"),H=K.paint.get("hillshade-accent-color"),et=K.paint.get("hillshade-illumination-direction")*(Math.PI/180);K.paint.get("hillshade-illumination-anchor")==="viewport"&&(et-=q.transform.angle);var at,ct,vt,yt=!q.options.moving;return{u_matrix:q.transform.calculatePosMatrix(j.tileID.toUnwrapped(),yt),u_image:0,u_latrange:(at=j.tileID,ct=Math.pow(2,at.canonical.z),vt=at.canonical.y,[new s.MercatorCoordinate(0,vt/ct).toLngLat().lat,new s.MercatorCoordinate(0,(vt+1)/ct).toLngLat().lat]),u_light:[K.paint.get("hillshade-exaggeration"),et],u_shadow:Y,u_highlight:rt,u_accent:H}}(c,p,h);O.draw(w,I.TRIANGLES,d,_,b,st.disabled,V,h.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments)}}function by(c,p,h,d,_,b){var w=c.context,I=w.gl,T=p.dem;if(T&&T.data){var O=T.dim,V=T.stride,q=T.getPixels();if(w.activeTexture.set(I.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),p.demTexture=p.demTexture||c.getTileTexture(V),p.demTexture){var j=p.demTexture;j.update(q,{premultiply:!1}),j.bind(I.NEAREST,I.CLAMP_TO_EDGE)}else p.demTexture=new s.Texture(w,q,I.RGBA,{premultiply:!1}),p.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);w.activeTexture.set(I.TEXTURE0);var K=p.fbo;if(!K){var Y=new s.Texture(w,{width:O,height:O,data:null},I.RGBA);Y.bind(I.LINEAR,I.CLAMP_TO_EDGE),(K=p.fbo=w.createFramebuffer(O,O,!0)).colorAttachment.set(Y.texture)}w.bindFramebuffer.set(K.framebuffer),w.viewport.set([0,0,O,O]),c.useProgram("hillshadePrepare").draw(w,I.TRIANGLES,d,_,b,st.disabled,function(rt,H){var et=H.stride,at=s.create();return s.ortho(at,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(at,at,[0,-s.EXTENT,0]),{u_matrix:at,u_image:1,u_dimension:[et,et],u_zoom:rt.overscaledZ,u_unpack:H.getUnpackVector()}}(p.tileID,T),h.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments),p.needsHillshadePrepare=!1}}function Xc(c,p,h,d,_){var b=d.paint.get("raster-fade-duration");if(b>0){var w=s.browser.now(),I=(w-c.timeAdded)/b,T=p?(w-p.timeAdded)/b:-1,O=h.getSource(),V=_.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),q=!p||Math.abs(p.tileID.overscaledZ-V)>Math.abs(c.tileID.overscaledZ-V),j=q&&c.refreshedUponExpiration?1:s.clamp(q?I:1-T,0,1);return c.refreshedUponExpiration&&I>=1&&(c.refreshedUponExpiration=!1),p?{opacity:1,mix:1-j}:{opacity:j,mix:0}}return{opacity:1,mix:0}}var Cp=new s.Color(1,0,0,1),Sd=new s.Color(0,1,0,1),Id=new s.Color(0,0,1,1),Zc=new s.Color(1,0,1,1),Lp=new s.Color(0,1,1,1);function Pp(c,p,h,d){jl(c,0,p+h/2,c.transform.width,h,d)}function Tp(c,p,h,d){jl(c,p-h/2,0,h,c.transform.height,d)}function jl(c,p,h,d,_,b){var w=c.context,I=w.gl;I.enable(I.SCISSOR_TEST),I.scissor(p*s.browser.devicePixelRatio,h*s.browser.devicePixelRatio,d*s.browser.devicePixelRatio,_*s.browser.devicePixelRatio),w.clear({color:b}),I.disable(I.SCISSOR_TEST)}function Cd(c,p,h){var d=c.context,_=d.gl,b=h.posMatrix,w=c.useProgram("debug"),I=G.disabled,T=W.disabled,O=c.colorModeForRenderPass();d.activeTexture.set(_.TEXTURE0),c.emptyTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),w.draw(d,_.LINE_STRIP,I,T,O,st.disabled,hu(b,s.Color.red),"$debug",c.debugBuffer,c.tileBorderIndexBuffer,c.debugSegments);var V=p.getTileByID(h.key).latestRawTileData,q=Math.floor((V&&V.byteLength||0)/1024),j=p.getTile(h).tileSize,K=512/Math.min(j,512)*(h.overscaledZ/c.transform.zoom)*.5,Y=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(Y+=" => "+h.overscaledZ),function(rt,H){rt.initDebugOverlayCanvas();var et=rt.debugOverlayCanvas,at=rt.context.gl,ct=rt.debugOverlayCanvas.getContext("2d");ct.clearRect(0,0,et.width,et.height),ct.shadowColor="white",ct.shadowBlur=2,ct.lineWidth=1.5,ct.strokeStyle="white",ct.textBaseline="top",ct.font="bold 36px Open Sans, sans-serif",ct.fillText(H,5,5),ct.strokeText(H,5,5),rt.debugOverlayTexture.update(et),rt.debugOverlayTexture.bind(at.LINEAR,at.CLAMP_TO_EDGE)}(c,Y+" "+q+"kb"),w.draw(d,_.TRIANGLES,I,T,ot.alphaBlended,st.disabled,hu(b,s.Color.transparent,K),"$debug",c.debugBuffer,c.quadTriangleIndexBuffer,c.debugSegments)}var du={symbol:function(c,p,h,d,_){if(c.renderPass==="translucent"){var b=W.disabled,w=c.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(I,T,O,V,q,j,K){for(var Y=T.transform,rt=q==="map",H=j==="map",et=0,at=I;et<at.length;et+=1){var ct=at[et],vt=V.getTile(ct),yt=vt.getBucket(O);if(yt&&yt.text&&yt.text.segments.get().length){var bt=s.evaluateSizeForZoom(yt.textSizeData,Y.zoom),Lt=Vr(vt,1,T.transform.zoom),kt=ui(ct.posMatrix,H,rt,T.transform,Lt),Ot=O.layout.get("icon-text-fit")!=="none"&&yt.hasIconData();if(bt){var Zt=Math.pow(2,Y.zoom-vt.tileID.overscaledZ);wd(yt,rt,H,K,s.symbolSize,Y,kt,ct.posMatrix,Zt,bt,Ot)}}}}(d,c,h,p,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),_),h.paint.get("icon-opacity").constantOr(1)!==0&&fu(c,p,h,d,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),b,w),h.paint.get("text-opacity").constantOr(1)!==0&&fu(c,p,h,d,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),b,w),p.map.showCollisionBoxes&&(Wu(c,p,h,d,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Wu(c,p,h,d,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))}},circle:function(c,p,h,d){if(c.renderPass==="translucent"){var _=h.paint.get("circle-opacity"),b=h.paint.get("circle-stroke-width"),w=h.paint.get("circle-stroke-opacity"),I=h.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)!==0||b.constantOr(1)!==0&&w.constantOr(1)!==0){for(var T=c.context,O=T.gl,V=c.depthModeForSublayer(0,G.ReadOnly),q=W.disabled,j=c.colorModeForRenderPass(),K=[],Y=0;Y<d.length;Y++){var rt=d[Y],H=p.getTile(rt),et=H.getBucket(h);if(et){var at=et.programConfigurations.get(h.id),ct={programConfiguration:at,program:c.useProgram("circle",at),layoutVertexBuffer:et.layoutVertexBuffer,indexBuffer:et.indexBuffer,uniformValues:Sp(c,rt,H,h)};if(I)for(var vt=0,yt=et.segments.get();vt<yt.length;vt+=1){var bt=yt[vt];K.push({segments:new s.SegmentVector([bt]),sortKey:bt.sortKey,state:ct})}else K.push({segments:et.segments,sortKey:0,state:ct})}}I&&K.sort(function(ue,pe){return ue.sortKey-pe.sortKey});for(var Lt=0,kt=K;Lt<kt.length;Lt+=1){var Ot=kt[Lt],Zt=Ot.state;Zt.program.draw(T,O.TRIANGLES,V,q,j,st.disabled,Zt.uniformValues,h.id,Zt.layoutVertexBuffer,Zt.indexBuffer,Ot.segments,h.paint,c.transform.zoom,Zt.programConfiguration)}}}},heatmap:function(c,p,h,d){if(h.paint.get("heatmap-opacity")!==0)if(c.renderPass==="offscreen"){var _=c.context,b=_.gl,w=W.disabled,I=new ot([b.ONE,b.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(K,Y,rt){var H=K.gl;K.activeTexture.set(H.TEXTURE1),K.viewport.set([0,0,Y.width/4,Y.height/4]);var et=rt.heatmapFbo;if(et)H.bindTexture(H.TEXTURE_2D,et.colorAttachment.get()),K.bindFramebuffer.set(et.framebuffer);else{var at=H.createTexture();H.bindTexture(H.TEXTURE_2D,at),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.LINEAR),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.LINEAR),et=rt.heatmapFbo=K.createFramebuffer(Y.width/4,Y.height/4,!1),function(ct,vt,yt,bt){var Lt=ct.gl;Lt.texImage2D(Lt.TEXTURE_2D,0,Lt.RGBA,vt.width/4,vt.height/4,0,Lt.RGBA,ct.extRenderToTextureHalfFloat?ct.extTextureHalfFloat.HALF_FLOAT_OES:Lt.UNSIGNED_BYTE,null),bt.colorAttachment.set(yt)}(K,Y,at,et)}})(_,c,h),_.clear({color:s.Color.transparent});for(var T=0;T<d.length;T++){var O=d[T];if(!p.hasRenderableParent(O)){var V=p.getTile(O),q=V.getBucket(h);if(q){var j=q.programConfigurations.get(h.id);c.useProgram("heatmap",j).draw(_,b.TRIANGLES,G.disabled,w,I,st.disabled,md(O.posMatrix,V,c.transform.zoom,h.paint.get("heatmap-intensity")),h.id,q.layoutVertexBuffer,q.indexBuffer,q.segments,h.paint,c.transform.zoom,j)}}}_.viewport.set([0,0,c.width,c.height])}else c.renderPass==="translucent"&&(c.context.setColorMode(c.colorModeForRenderPass()),function(K,Y){var rt=K.context,H=rt.gl,et=Y.heatmapFbo;if(et){rt.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,et.colorAttachment.get()),rt.activeTexture.set(H.TEXTURE1);var at=Y.colorRampTexture;at||(at=Y.colorRampTexture=new s.Texture(rt,Y.colorRamp,H.RGBA)),at.bind(H.LINEAR,H.CLAMP_TO_EDGE),K.useProgram("heatmapTexture").draw(rt,H.TRIANGLES,G.disabled,W.disabled,K.colorModeForRenderPass(),st.disabled,function(ct,vt,yt,bt){var Lt=s.create();s.ortho(Lt,0,ct.width,ct.height,0,0,1);var kt=ct.context.gl;return{u_matrix:Lt,u_world:[kt.drawingBufferWidth,kt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:vt.paint.get("heatmap-opacity")}}(K,Y),Y.id,K.viewportBuffer,K.quadTriangleIndexBuffer,K.viewportSegments,Y.paint,K.transform.zoom)}}(c,h))},line:function(c,p,h,d){if(c.renderPass==="translucent"){var _=h.paint.get("line-opacity"),b=h.paint.get("line-width");if(_.constantOr(1)!==0&&b.constantOr(1)!==0)for(var w=c.depthModeForSublayer(0,G.ReadOnly),I=c.colorModeForRenderPass(),T=h.paint.get("line-dasharray"),O=h.paint.get("line-pattern"),V=O.constantOr(1),q=h.paint.get("line-gradient"),j=h.getCrossfadeParameters(),K=V?"linePattern":T?"lineSDF":q?"lineGradient":"line",Y=c.context,rt=Y.gl,H=!0,et=0,at=d;et<at.length;et+=1){var ct=at[et],vt=p.getTile(ct);if(!V||vt.patternsLoaded()){var yt=vt.getBucket(h);if(yt){var bt=yt.programConfigurations.get(h.id),Lt=c.context.program.get(),kt=c.useProgram(K,bt),Ot=H||kt.program!==Lt,Zt=O.constantOr(null);if(Zt&&vt.imageAtlas){var ue=vt.imageAtlas,pe=ue.patternPositions[Zt.to.toString()],he=ue.patternPositions[Zt.from.toString()];pe&&he&&bt.setConstantPatternPositions(pe,he)}var Je=V?Uc(c,vt,h,j):T?vy(c,vt,h,T,j):q?Or(c,vt,h,yt.lineClipsArray.length):Bl(c,vt,h);if(V)Y.activeTexture.set(rt.TEXTURE0),vt.imageAtlasTexture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE),bt.updatePaintBuffers(j);else if(T&&(Ot||c.lineAtlas.dirty))Y.activeTexture.set(rt.TEXTURE0),c.lineAtlas.bind(Y);else if(q){var Wt=yt.gradients[h.id],Ee=Wt.texture;if(h.gradientVersion!==Wt.version){var De=256;if(h.stepInterpolant){var we=p.getSource().maxzoom,xe=ct.canonical.z===we?Math.ceil(1<<c.transform.maxZoom-ct.canonical.z):1;De=s.clamp(s.nextPowerOfTwo(yt.maxLineLength/s.EXTENT*1024*xe),256,Y.maxTextureSize)}Wt.gradient=s.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:De,image:Wt.gradient||void 0,clips:yt.lineClipsArray}),Wt.texture?Wt.texture.update(Wt.gradient):Wt.texture=new s.Texture(Y,Wt.gradient,rt.RGBA),Wt.version=h.gradientVersion,Ee=Wt.texture}Y.activeTexture.set(rt.TEXTURE0),Ee.bind(h.stepInterpolant?rt.NEAREST:rt.LINEAR,rt.CLAMP_TO_EDGE)}kt.draw(Y,rt.TRIANGLES,w,c.stencilModeForClipping(ct),I,st.disabled,Je,h.id,yt.layoutVertexBuffer,yt.indexBuffer,yt.segments,h.paint,c.transform.zoom,bt,yt.layoutVertexBuffer2),H=!1}}}}},fill:function(c,p,h,d){var _=h.paint.get("fill-color"),b=h.paint.get("fill-opacity");if(b.constantOr(1)!==0){var w=c.colorModeForRenderPass(),I=h.paint.get("fill-pattern"),T=c.opaquePassEnabledForLayer()&&!I.constantOr(1)&&_.constantOr(s.Color.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";if(c.renderPass===T){var O=c.depthModeForSublayer(1,c.renderPass==="opaque"?G.ReadWrite:G.ReadOnly);Gc(c,p,h,d,O,w,!1)}if(c.renderPass==="translucent"&&h.paint.get("fill-antialias")){var V=c.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,G.ReadOnly);Gc(c,p,h,d,V,w,!0)}}},"fill-extrusion":function(c,p,h,d){var _=h.paint.get("fill-extrusion-opacity");if(_!==0&&c.renderPass==="translucent"){var b=new G(c.context.gl.LEQUAL,G.ReadWrite,c.depthRangeFor3D);if(_!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))Ip(c,p,h,d,b,W.disabled,ot.disabled),Ip(c,p,h,d,b,c.stencilModeFor3D(),c.colorModeForRenderPass());else{var w=c.colorModeForRenderPass();Ip(c,p,h,d,b,W.disabled,w)}}},hillshade:function(c,p,h,d){if(c.renderPass==="offscreen"||c.renderPass==="translucent"){for(var _=c.context,b=c.depthModeForSublayer(0,G.ReadOnly),w=c.colorModeForRenderPass(),I=c.renderPass==="translucent"?c.stencilConfigForOverlap(d):[{},d],T=I[0],O=0,V=I[1];O<V.length;O+=1){var q=V[O],j=p.getTile(q);j.needsHillshadePrepare&&c.renderPass==="offscreen"?by(c,j,h,b,W.disabled,w):c.renderPass==="translucent"&&Hc(c,j,h,b,T[q.overscaledZ],w)}_.viewport.set([0,0,c.width,c.height])}},raster:function(c,p,h,d){if(c.renderPass==="translucent"&&h.paint.get("raster-opacity")!==0&&d.length)for(var _=c.context,b=_.gl,w=p.getSource(),I=c.useProgram("raster"),T=c.colorModeForRenderPass(),O=w instanceof Li?[{},d]:c.stencilConfigForOverlap(d),V=O[0],q=O[1],j=q[q.length-1].overscaledZ,K=!c.options.moving,Y=0,rt=q;Y<rt.length;Y+=1){var H=rt[Y],et=c.depthModeForSublayer(H.overscaledZ-j,h.paint.get("raster-opacity")===1?G.ReadWrite:G.ReadOnly,b.LESS),at=p.getTile(H),ct=c.transform.calculatePosMatrix(H.toUnwrapped(),K);at.registerFadeDuration(h.paint.get("raster-fade-duration"));var vt=p.findLoadedParent(H,0),yt=Xc(at,vt,p,h,c.transform),bt=void 0,Lt=void 0,kt=h.paint.get("raster-resampling")==="nearest"?b.NEAREST:b.LINEAR;_.activeTexture.set(b.TEXTURE0),at.texture.bind(kt,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(b.TEXTURE1),vt?(vt.texture.bind(kt,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST),bt=Math.pow(2,vt.tileID.overscaledZ-at.tileID.overscaledZ),Lt=[at.tileID.canonical.x*bt%1,at.tileID.canonical.y*bt%1]):at.texture.bind(kt,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST);var Ot=xy(ct,Lt||[0,0],bt||1,yt,h);w instanceof Li?I.draw(_,b.TRIANGLES,et,W.disabled,T,st.disabled,Ot,h.id,w.boundsBuffer,c.quadTriangleIndexBuffer,w.boundsSegments):I.draw(_,b.TRIANGLES,et,V[H.overscaledZ],T,st.disabled,Ot,h.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments)}},background:function(c,p,h){var d=h.paint.get("background-color"),_=h.paint.get("background-opacity");if(_!==0){var b=c.context,w=b.gl,I=c.transform,T=I.tileSize,O=h.paint.get("background-pattern");if(!c.isPatternMissing(O)){var V=!O&&d.a===1&&_===1&&c.opaquePassEnabledForLayer()?"opaque":"translucent";if(c.renderPass===V){var q=W.disabled,j=c.depthModeForSublayer(0,V==="opaque"?G.ReadWrite:G.ReadOnly),K=c.colorModeForRenderPass(),Y=c.useProgram(O?"backgroundPattern":"background"),rt=I.coveringTiles({tileSize:T});O&&(b.activeTexture.set(w.TEXTURE0),c.imageManager.bind(c.context));for(var H=h.getCrossfadeParameters(),et=0,at=rt;et<at.length;et+=1){var ct=at[et],vt=c.transform.calculatePosMatrix(ct.toUnwrapped()),yt=O?Yu(vt,_,c,O,{tileID:ct,tileSize:T},H):Ul(vt,_,d);Y.draw(b,w.TRIANGLES,j,q,K,st.disabled,yt,h.id,c.tileExtentBuffer,c.quadTriangleIndexBuffer,c.tileExtentSegments)}}}}},debug:function(c,p,h){for(var d=0;d<h.length;d++)Cd(c,p,h[d])},custom:function(c,p,h){var d=c.context,_=h.implementation;if(c.renderPass==="offscreen"){var b=_.prerender;b&&(c.setCustomLayerDefaults(),d.setColorMode(c.colorModeForRenderPass()),b.call(_,d.gl,c.transform.customLayerMatrix()),d.setDirty(),c.setBaseState())}else if(c.renderPass==="translucent"){c.setCustomLayerDefaults(),d.setColorMode(c.colorModeForRenderPass()),d.setStencilMode(W.disabled);var w=_.renderingMode==="3d"?new G(c.context.gl.LEQUAL,G.ReadWrite,c.depthRangeFor3D):c.depthModeForSublayer(0,G.ReadOnly);d.setDepthMode(w),_.render(d.gl,c.transform.customLayerMatrix()),d.setDirty(),c.setBaseState(),d.bindFramebuffer.set(null)}}},Ur=function(c,p){this.context=new U(c),this.transform=p,this._tileTextures={},this.setup(),this.numSublayers=J.maxUnderzooming+J.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ds,this.gpuTimers={}};Ur.prototype.resize=function(c,p){if(this.width=c*s.browser.devicePixelRatio,this.height=p*s.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var h=0,d=this.style._order;h<d.length;h+=1)this.style._layers[d[h]].resize()},Ur.prototype.setup=function(){var c=this.context,p=new s.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(s.EXTENT,0),p.emplaceBack(0,s.EXTENT),p.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(p,xi.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);var h=new s.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(s.EXTENT,0),h.emplaceBack(0,s.EXTENT),h.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=c.createVertexBuffer(h,xi.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);var d=new s.StructArrayLayout4i8;d.emplaceBack(0,0,0,0),d.emplaceBack(s.EXTENT,0,s.EXTENT,0),d.emplaceBack(0,s.EXTENT,0,s.EXTENT),d.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(d,$r.members),this.rasterBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);var _=new s.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(_,xi.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);var b=new s.StructArrayLayout1ui2;b.emplaceBack(0),b.emplaceBack(1),b.emplaceBack(3),b.emplaceBack(2),b.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(b);var w=new s.StructArrayLayout3ui6;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(w),this.emptyTexture=new s.Texture(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA);var I=this.context.gl;this.stencilClearMode=new W({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO)},Ur.prototype.clearStencil=function(){var c=this.context,p=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var h=s.create();s.ortho(h,0,this.width,this.height,0,0,1),s.scale(h,h,[p.drawingBufferWidth,p.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,p.TRIANGLES,G.disabled,this.stencilClearMode,ot.disabled,st.disabled,pu(h),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Ur.prototype._renderTileClippingMasks=function(c,p){if(this.currentStencilSource!==c.source&&c.isTileClipped()&&p&&p.length){this.currentStencilSource=c.source;var h=this.context,d=h.gl;this.nextStencilID+p.length>256&&this.clearStencil(),h.setColorMode(ot.disabled),h.setDepthMode(G.disabled);var _=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var b=0,w=p;b<w.length;b+=1){var I=w[b],T=this._tileClippingMaskIDs[I.key]=this.nextStencilID++;_.draw(h,d.TRIANGLES,G.disabled,new W({func:d.ALWAYS,mask:0},T,255,d.KEEP,d.KEEP,d.REPLACE),ot.disabled,st.disabled,pu(I.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Ur.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var c=this.nextStencilID++,p=this.context.gl;return new W({func:p.NOTEQUAL,mask:255},c,255,p.KEEP,p.KEEP,p.REPLACE)},Ur.prototype.stencilModeForClipping=function(c){var p=this.context.gl;return new W({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,p.KEEP,p.KEEP,p.REPLACE)},Ur.prototype.stencilConfigForOverlap=function(c){var p,h=this.context.gl,d=c.sort(function(T,O){return O.overscaledZ-T.overscaledZ}),_=d[d.length-1].overscaledZ,b=d[0].overscaledZ-_+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();for(var w={},I=0;I<b;I++)w[I+_]=new W({func:h.GEQUAL,mask:255},I+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=b,[w,d]}return[(p={},p[_]=W.disabled,p),d]},Ur.prototype.colorModeForRenderPass=function(){var c=this.context.gl;return this._showOverdrawInspector?new ot([c.CONSTANT_COLOR,c.ONE],new s.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ot.unblended:ot.alphaBlended},Ur.prototype.depthModeForSublayer=function(c,p,h){if(!this.opaquePassEnabledForLayer())return G.disabled;var d=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new G(h||this.context.gl.LEQUAL,p,[d,d])},Ur.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Ur.prototype.render=function(c,p){var h=this;this.style=c,this.options=p,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(s.browser.now()),this.imageManager.beginFrame();var d=this.style._order,_=this.style.sourceCaches;for(var b in _){var w=_[b];w.used&&w.prepare(this.context)}var I,T,O={},V={},q={};for(var j in _){var K=_[j];O[j]=K.getVisibleCoordinates(),V[j]=O[j].slice().reverse(),q[j]=K.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Y=0;Y<d.length;Y++)if(this.style._layers[d[Y]].is3D()){this.opaquePassCutoff=Y;break}this.renderPass="offscreen";for(var rt=0,H=d;rt<H.length;rt+=1){var et=this.style._layers[H[rt]];if(et.hasOffscreenPass()&&!et.isHidden(this.transform.zoom)){var at=V[et.source];(et.type==="custom"||at.length)&&this.renderLayer(this,_[et.source],et,at)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){var ct=this.style._layers[d[this.currentLayer]],vt=_[ct.source],yt=O[ct.source];this._renderTileClippingMasks(ct,yt),this.renderLayer(this,vt,ct,yt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){var bt=this.style._layers[d[this.currentLayer]],Lt=_[bt.source],kt=(bt.type==="symbol"?q:V)[bt.source];this._renderTileClippingMasks(bt,O[bt.source]),this.renderLayer(this,Lt,bt,kt)}this.options.showTileBoundaries&&(s.values(this.style._layers).forEach(function(Ot){Ot.source&&!Ot.isHidden(h.transform.zoom)&&(Ot.source!==(T&&T.id)&&(T=h.style.sourceCaches[Ot.source]),(!I||I.getSource().maxzoom<T.getSource().maxzoom)&&(I=T))}),I&&du.debug(this,I,I.getVisibleCoordinates())),this.options.showPadding&&function(Ot){var Zt=Ot.transform.padding;Pp(Ot,Ot.transform.height-(Zt.top||0),3,Cp),Pp(Ot,Zt.bottom||0,3,Sd),Tp(Ot,Zt.left||0,3,Id),Tp(Ot,Ot.transform.width-(Zt.right||0),3,Zc);var ue=Ot.transform.centerPoint;(function(pe,he,Je,Wt){jl(pe,he-1,Je-10,2,20,Wt),jl(pe,he-10,Je-1,20,2,Wt)})(Ot,ue.x,Ot.transform.height-ue.y,Lp)}(this),this.context.setDefault()},Ur.prototype.renderLayer=function(c,p,h,d){h.isHidden(this.transform.zoom)||(h.type==="background"||h.type==="custom"||d.length)&&(this.id=h.id,this.gpuTimingStart(h),du[h.type](c,p,h,d,this.style.placement.variableOffsets),this.gpuTimingEnd())},Ur.prototype.gpuTimingStart=function(c){if(this.options.gpuTiming){var p=this.context.extTimerQuery,h=this.gpuTimers[c.id];h||(h=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),h.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,h.query)}},Ur.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}},Ur.prototype.collectGpuTimers=function(){var c=this.gpuTimers;return this.gpuTimers={},c},Ur.prototype.queryGpuTimers=function(c){var p={};for(var h in c){var d=c[h],_=this.context.extTimerQuery,b=_.getQueryObjectEXT(d.query,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(d.query),p[h]=b}return p},Ur.prototype.translatePosMatrix=function(c,p,h,d,_){if(!h[0]&&!h[1])return c;var b=_?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(b){var w=Math.sin(b),I=Math.cos(b);h=[h[0]*I-h[1]*w,h[0]*w+h[1]*I]}var T=[_?h[0]:Vr(p,h[0],this.transform.zoom),_?h[1]:Vr(p,h[1],this.transform.zoom),0],O=new Float32Array(16);return s.translate(O,c,T),O},Ur.prototype.saveTileTexture=function(c){var p=this._tileTextures[c.size[0]];p?p.push(c):this._tileTextures[c.size[0]]=[c]},Ur.prototype.getTileTexture=function(c){var p=this._tileTextures[c];return p&&p.length>0?p.pop():null},Ur.prototype.isPatternMissing=function(c){if(!c)return!1;if(!c.from||!c.to)return!0;var p=this.imageManager.getPattern(c.from.toString()),h=this.imageManager.getPattern(c.to.toString());return!p||!h},Ur.prototype.useProgram=function(c,p){this.cache=this.cache||{};var h=""+c+(p?p.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[h]||(this.cache[h]=new hd(this.context,c,_y[c],p,xd[c],this._showOverdrawInspector)),this.cache[h]},Ur.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Ur.prototype.setBaseState=function(){var c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)},Ur.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Ur.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Yc=function(c,p){this.points=c,this.planes=p};Yc.fromInvProjectionMatrix=function(c,p,h){var d=Math.pow(2,h),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(w){return s.transformMat4([],w,c)}).map(function(w){return s.scale$1([],w,1/w[3]/p*d)}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(w){var I=s.sub([],_[w[0]],_[w[1]]),T=s.sub([],_[w[2]],_[w[1]]),O=s.normalize([],s.cross([],I,T)),V=-s.dot(O,_[w[1]]);return O.concat(V)});return new Yc(_,b)};var gu=function(c,p){this.min=c,this.max=p,this.center=s.scale$2([],s.add([],this.min,this.max),.5)};gu.prototype.quadrant=function(c){for(var p=[c%2==0,c<2],h=s.clone$2(this.min),d=s.clone$2(this.max),_=0;_<p.length;_++)h[_]=p[_]?this.min[_]:this.center[_],d[_]=p[_]?this.center[_]:this.max[_];return d[2]=this.max[2],new gu(h,d)},gu.prototype.distanceX=function(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]},gu.prototype.distanceY=function(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]},gu.prototype.intersects=function(c){for(var p=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],h=!0,d=0;d<c.planes.length;d++){for(var _=c.planes[d],b=0,w=0;w<p.length;w++)b+=s.dot$1(_,p[w])>=0;if(b===0)return 0;b!==p.length&&(h=!1)}if(h)return 2;for(var I=0;I<3;I++){for(var T=Number.MAX_VALUE,O=-Number.MAX_VALUE,V=0;V<c.points.length;V++){var q=c.points[V][I]-this.min[I];T=Math.min(T,q),O=Math.max(O,q)}if(O<0||T>this.max[I]-this.min[I])return 0}return 1};var ws=function(c,p,h,d){if(c===void 0&&(c=0),p===void 0&&(p=0),h===void 0&&(h=0),d===void 0&&(d=0),isNaN(c)||c<0||isNaN(p)||p<0||isNaN(h)||h<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=p,this.left=h,this.right=d};ws.prototype.interpolate=function(c,p,h){return p.top!=null&&c.top!=null&&(this.top=s.number(c.top,p.top,h)),p.bottom!=null&&c.bottom!=null&&(this.bottom=s.number(c.bottom,p.bottom,h)),p.left!=null&&c.left!=null&&(this.left=s.number(c.left,p.left,h)),p.right!=null&&c.right!=null&&(this.right=s.number(c.right,p.right,h)),this},ws.prototype.getCenter=function(c,p){var h=s.clamp((this.left+c-this.right)/2,0,c),d=s.clamp((this.top+p-this.bottom)/2,0,p);return new s.Point(h,d)},ws.prototype.equals=function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right},ws.prototype.clone=function(){return new ws(this.top,this.bottom,this.left,this.right)},ws.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ye=function(c,p,h,d,_){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=_===void 0||_,this._minZoom=c||0,this._maxZoom=p||22,this._minPitch=h==null?0:h,this._maxPitch=d==null?60:d,this.setMaxBounds(),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ws,this._posMatrixCache={},this._alignedPosMatrixCache={}},kr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ye.prototype.clone=function(){var c=new Ye(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c._center=this._center,c.zoom=this.zoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._calcMatrices(),c},kr.minZoom.get=function(){return this._minZoom},kr.minZoom.set=function(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))},kr.maxZoom.get=function(){return this._maxZoom},kr.maxZoom.set=function(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))},kr.minPitch.get=function(){return this._minPitch},kr.minPitch.set=function(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))},kr.maxPitch.get=function(){return this._maxPitch},kr.maxPitch.set=function(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))},kr.renderWorldCopies.get=function(){return this._renderWorldCopies},kr.renderWorldCopies.set=function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c},kr.worldSize.get=function(){return this.tileSize*this.scale},kr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},kr.size.get=function(){return new s.Point(this.width,this.height)},kr.bearing.get=function(){return-this.angle/Math.PI*180},kr.bearing.set=function(c){var p=-s.wrap(c,-180,180)*Math.PI/180;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=s.create$2(),s.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},kr.pitch.get=function(){return this._pitch/Math.PI*180},kr.pitch.set=function(c){var p=s.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())},kr.fov.get=function(){return this._fov/Math.PI*180},kr.fov.set=function(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())},kr.zoom.get=function(){return this._zoom},kr.zoom.set=function(c){var p=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this._constrain(),this._calcMatrices())},kr.center.get=function(){return this._center},kr.center.set=function(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())},kr.padding.get=function(){return this._edgeInsets.toJSON()},kr.padding.set=function(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())},kr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ye.prototype.isPaddingEqual=function(c){return this._edgeInsets.equals(c)},Ye.prototype.interpolatePadding=function(c,p,h){this._unmodified=!1,this._edgeInsets.interpolate(c,p,h),this._constrain(),this._calcMatrices()},Ye.prototype.coveringZoomLevel=function(c){var p=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,p)},Ye.prototype.getVisibleUnwrappedCoordinates=function(c){var p=[new s.UnwrappedTileID(0,c)];if(this._renderWorldCopies)for(var h=this.pointCoordinate(new s.Point(0,0)),d=this.pointCoordinate(new s.Point(this.width,0)),_=this.pointCoordinate(new s.Point(this.width,this.height)),b=this.pointCoordinate(new s.Point(0,this.height)),w=Math.floor(Math.min(h.x,d.x,_.x,b.x)),I=Math.floor(Math.max(h.x,d.x,_.x,b.x)),T=w-1;T<=I+1;T++)T!==0&&p.push(new s.UnwrappedTileID(T,c));return p},Ye.prototype.coveringTiles=function(c){var p=this.coveringZoomLevel(c),h=p;if(c.minzoom!==void 0&&p<c.minzoom)return[];c.maxzoom!==void 0&&p>c.maxzoom&&(p=c.maxzoom);var d=s.MercatorCoordinate.fromLngLat(this.center),_=Math.pow(2,p),b=[_*d.x,_*d.y,0],w=Yc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p),I=c.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(I=p);var T=function(Ot){return{aabb:new gu([Ot*_,0,0],[(Ot+1)*_,_,0]),zoom:0,x:0,y:0,wrap:Ot,fullyVisible:!1}},O=[],V=[],q=p,j=c.reparseOverscaled?h:p;if(this._renderWorldCopies)for(var K=1;K<=3;K++)O.push(T(-K)),O.push(T(K));for(O.push(T(0));O.length>0;){var Y=O.pop(),rt=Y.x,H=Y.y,et=Y.fullyVisible;if(!et){var at=Y.aabb.intersects(w);if(at===0)continue;et=at===2}var ct=Y.aabb.distanceX(b),vt=Y.aabb.distanceY(b),yt=Math.max(Math.abs(ct),Math.abs(vt));if(Y.zoom===q||yt>3+(1<<q-Y.zoom)-2&&Y.zoom>=I)V.push({tileID:new s.OverscaledTileID(Y.zoom===q?j:Y.zoom,Y.wrap,Y.zoom,rt,H),distanceSq:s.sqrLen([b[0]-.5-rt,b[1]-.5-H])});else for(var bt=0;bt<4;bt++){var Lt=(rt<<1)+bt%2,kt=(H<<1)+(bt>>1);O.push({aabb:Y.aabb.quadrant(bt),zoom:Y.zoom+1,x:Lt,y:kt,wrap:Y.wrap,fullyVisible:et})}}return V.sort(function(Ot,Zt){return Ot.distanceSq-Zt.distanceSq}).map(function(Ot){return Ot.tileID})},Ye.prototype.resize=function(c,p){this.width=c,this.height=p,this.pixelsToGLUnits=[2/c,-2/p],this._constrain(),this._calcMatrices()},kr.unmodified.get=function(){return this._unmodified},Ye.prototype.zoomScale=function(c){return Math.pow(2,c)},Ye.prototype.scaleZoom=function(c){return Math.log(c)/Math.LN2},Ye.prototype.project=function(c){var p=s.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new s.Point(s.mercatorXfromLng(c.lng)*this.worldSize,s.mercatorYfromLat(p)*this.worldSize)},Ye.prototype.unproject=function(c){return new s.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()},kr.point.get=function(){return this.project(this.center)},Ye.prototype.setLocationAtPoint=function(c,p){var h=this.pointCoordinate(p),d=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(c),b=new s.MercatorCoordinate(_.x-(h.x-d.x),_.y-(h.y-d.y));this.center=this.coordinateLocation(b),this._renderWorldCopies&&(this.center=this.center.wrap())},Ye.prototype.locationPoint=function(c){return this.coordinatePoint(this.locationCoordinate(c))},Ye.prototype.pointLocation=function(c){return this.coordinateLocation(this.pointCoordinate(c))},Ye.prototype.locationCoordinate=function(c){return s.MercatorCoordinate.fromLngLat(c)},Ye.prototype.coordinateLocation=function(c){return c.toLngLat()},Ye.prototype.pointCoordinate=function(c){var p=[c.x,c.y,0,1],h=[c.x,c.y,1,1];s.transformMat4(p,p,this.pixelMatrixInverse),s.transformMat4(h,h,this.pixelMatrixInverse);var d=p[3],_=h[3],b=p[1]/d,w=h[1]/_,I=p[2]/d,T=h[2]/_,O=I===T?0:(0-I)/(T-I);return new s.MercatorCoordinate(s.number(p[0]/d,h[0]/_,O)/this.worldSize,s.number(b,w,O)/this.worldSize)},Ye.prototype.coordinatePoint=function(c){var p=[c.x*this.worldSize,c.y*this.worldSize,0,1];return s.transformMat4(p,p,this.pixelMatrix),new s.Point(p[0]/p[3],p[1]/p[3])},Ye.prototype.getBounds=function(){return new s.LngLatBounds().extend(this.pointLocation(new s.Point(0,0))).extend(this.pointLocation(new s.Point(this.width,0))).extend(this.pointLocation(new s.Point(this.width,this.height))).extend(this.pointLocation(new s.Point(0,this.height)))},Ye.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new s.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ye.prototype.setMaxBounds=function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ye.prototype.calculatePosMatrix=function(c,p){p===void 0&&(p=!1);var h=c.key,d=p?this._alignedPosMatrixCache:this._posMatrixCache;if(d[h])return d[h];var _=c.canonical,b=this.worldSize/this.zoomScale(_.z),w=_.x+Math.pow(2,_.z)*c.wrap,I=s.identity(new Float64Array(16));return s.translate(I,I,[w*b,_.y*b,0]),s.scale(I,I,[b/s.EXTENT,b/s.EXTENT,1]),s.multiply(I,p?this.alignedProjMatrix:this.projMatrix,I),d[h]=new Float32Array(I),d[h]},Ye.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ye.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var c,p,h,d,_=-90,b=90,w=-180,I=180,T=this.size,O=this._unmodified;if(this.latRange){var V=this.latRange;_=s.mercatorYfromLat(V[1])*this.worldSize,c=(b=s.mercatorYfromLat(V[0])*this.worldSize)-_<T.y?T.y/(b-_):0}if(this.lngRange){var q=this.lngRange;w=s.mercatorXfromLng(q[0])*this.worldSize,p=(I=s.mercatorXfromLng(q[1])*this.worldSize)-w<T.x?T.x/(I-w):0}var j=this.point,K=Math.max(p||0,c||0);if(K)return this.center=this.unproject(new s.Point(p?(I+w)/2:j.x,c?(b+_)/2:j.y)),this.zoom+=this.scaleZoom(K),this._unmodified=O,void(this._constraining=!1);if(this.latRange){var Y=j.y,rt=T.y/2;Y-rt<_&&(d=_+rt),Y+rt>b&&(d=b-rt)}if(this.lngRange){var H=j.x,et=T.x/2;H-et<w&&(h=w+et),H+et>I&&(h=I-et)}h===void 0&&d===void 0||(this.center=this.unproject(new s.Point(h!==void 0?h:j.x,d!==void 0?d:j.y))),this._unmodified=O,this._constraining=!1}},Ye.prototype._calcMatrices=function(){if(this.height){var c=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var p=Math.PI/2+this._pitch,h=this._fov*(.5+c.y/this.height),d=Math.sin(h)*this.cameraToCenterDistance/Math.sin(s.clamp(Math.PI-p-h,.01,Math.PI-.01)),_=this.point,b=_.x,w=_.y,I=1.01*(Math.cos(Math.PI/2-this._pitch)*d+this.cameraToCenterDistance),T=this.height/50,O=new Float64Array(16);s.perspective(O,this._fov,this.width/this.height,T,I),O[8]=2*-c.x/this.width,O[9]=2*c.y/this.height,s.scale(O,O,[1,-1,1]),s.translate(O,O,[0,0,-this.cameraToCenterDistance]),s.rotateX(O,O,this._pitch),s.rotateZ(O,O,this.angle),s.translate(O,O,[-b,-w,0]),this.mercatorMatrix=s.scale([],O,[this.worldSize,this.worldSize,this.worldSize]),s.scale(O,O,[1,1,s.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=O,this.invProjMatrix=s.invert([],this.projMatrix);var V=this.width%2/2,q=this.height%2/2,j=Math.cos(this.angle),K=Math.sin(this.angle),Y=b-Math.round(b)+j*V+K*q,rt=w-Math.round(w)+j*q+K*V,H=new Float64Array(O);if(s.translate(H,H,[Y>.5?Y-1:Y,rt>.5?rt-1:rt,0]),this.alignedProjMatrix=H,O=s.create(),s.scale(O,O,[this.width/2,-this.height/2,1]),s.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=s.create(),s.scale(O,O,[1,-1,1]),s.translate(O,O,[-1,-1,0]),s.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(O=s.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=O,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ye.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new s.Point(0,0)),p=[c.x*this.worldSize,c.y*this.worldSize,0,1];return s.transformMat4(p,p,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ye.prototype.getCameraPoint=function(){var c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,c))},Ye.prototype.getCameraQueryGeometry=function(c){var p=this.getCameraPoint();if(c.length===1)return[c[0],p];for(var h=p.x,d=p.y,_=p.x,b=p.y,w=0,I=c;w<I.length;w+=1){var T=I[w];h=Math.min(h,T.x),d=Math.min(d,T.y),_=Math.max(_,T.x),b=Math.max(b,T.y)}return[new s.Point(h,d),new s.Point(_,d),new s.Point(_,b),new s.Point(h,b),new s.Point(h,d)]},Object.defineProperties(Ye.prototype,kr);var po=function(c){var p,h,d,_;this._hashName=c&&encodeURIComponent(c),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(p=this._updateHashUnthrottled.bind(this),h=!1,d=null,_=function(){d=null,h&&(p(),d=setTimeout(_,300),h=!1)},function(){return h=!0,d||_(),d})};po.prototype.addTo=function(c){return this._map=c,s.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},po.prototype.remove=function(){return s.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},po.prototype.getHashString=function(c){var p=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,d=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,d),b=Math.round(p.lng*_)/_,w=Math.round(p.lat*_)/_,I=this._map.getBearing(),T=this._map.getPitch(),O="";if(O+=c?"/"+b+"/"+w+"/"+h:h+"/"+w+"/"+b,(I||T)&&(O+="/"+Math.round(10*I)/10),T&&(O+="/"+Math.round(T)),this._hashName){var V=this._hashName,q=!1,j=s.window.location.hash.slice(1).split("&").map(function(K){var Y=K.split("=")[0];return Y===V?(q=!0,Y+"="+O):K}).filter(function(K){return K});return q||j.push(V+"="+O),"#"+j.join("&")}return"#"+O},po.prototype._getCurrentHash=function(){var c,p=this,h=s.window.location.hash.replace("#","");return this._hashName?(h.split("&").map(function(d){return d.split("=")}).forEach(function(d){d[0]===p._hashName&&(c=d)}),(c&&c[1]||"").split("/")):h.split("/")},po.prototype._onHashChange=function(){var c=this._getCurrentHash();if(c.length>=3&&!c.some(function(h){return isNaN(h)})){var p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:p,pitch:+(c[4]||0)}),!0}return!1},po.prototype._updateHashUnthrottled=function(){var c=s.window.location.href.replace(/(#.+)?$/,this.getHashString());try{s.window.history.replaceState(s.window.history.state,null,c)}catch{}};var Gl={linearity:.3,easing:s.bezier(0,0,.3,1)},Ku=s.extend({deceleration:2500,maxSpeed:1400},Gl),Hl=s.extend({deceleration:20,maxSpeed:1400},Gl),wy=s.extend({deceleration:1e3,maxSpeed:360},Gl),Ey=s.extend({deceleration:1e3,maxSpeed:90},Gl),Xl=function(c){this._map=c,this.clear()};function Zl(c,p){(!c.duration||c.duration<p.duration)&&(c.duration=p.duration,c.easing=p.easing)}function Ga(c,p,h){var d=h.maxSpeed,_=h.linearity,b=h.deceleration,w=s.clamp(c*_/(p/1e3),-d,d),I=Math.abs(w)/(b*_);return{easing:h.easing,duration:1e3*I,amount:w*(I/2)}}Xl.prototype.clear=function(){this._inertiaBuffer=[]},Xl.prototype.record=function(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.browser.now(),settings:c})},Xl.prototype._drainInertiaBuffer=function(){for(var c=this._inertiaBuffer,p=s.browser.now();c.length>0&&p-c[0].time>160;)c.shift()},Xl.prototype._onMoveEnd=function(c){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var p={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0},h=0,d=this._inertiaBuffer;h<d.length;h+=1){var _=d[h].settings;p.zoom+=_.zoomDelta||0,p.bearing+=_.bearingDelta||0,p.pitch+=_.pitchDelta||0,_.panDelta&&p.pan._add(_.panDelta),_.around&&(p.around=_.around),_.pinchAround&&(p.pinchAround=_.pinchAround)}var b=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(p.pan.mag()){var I=Ga(p.pan.mag(),b,s.extend({},Ku,c||{}));w.offset=p.pan.mult(I.amount/p.pan.mag()),w.center=this._map.transform.center,Zl(w,I)}if(p.zoom){var T=Ga(p.zoom,b,Hl);w.zoom=this._map.transform.zoom+T.amount,Zl(w,T)}if(p.bearing){var O=Ga(p.bearing,b,wy);w.bearing=this._map.transform.bearing+s.clamp(O.amount,-179,179),Zl(w,O)}if(p.pitch){var V=Ga(p.pitch,b,Ey);w.pitch=this._map.transform.pitch+V.amount,Zl(w,V)}if(w.zoom||w.bearing){var q=p.pinchAround===void 0?p.around:p.pinchAround;w.around=q?this._map.unproject(q):this._map.getCenter()}return this.clear(),s.extend(w,{noMoveStart:!0})}};var Pi=function(c){function p(d,_,b,w){w===void 0&&(w={});var I=v.mousePos(_.getCanvasContainer(),b),T=_.unproject(I);c.call(this,d,s.extend({point:I,lngLat:T,originalEvent:b},w)),this._defaultPrevented=!1,this.target=_}c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var h={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,h),p}(s.Event),Yl=function(c){function p(d,_,b){var w=d==="touchend"?b.changedTouches:b.touches,I=v.touchPos(_.getCanvasContainer(),w),T=I.map(function(q){return _.unproject(q)}),O=I.reduce(function(q,j,K,Y){return q.add(j.div(Y.length))},new s.Point(0,0)),V=_.unproject(O);c.call(this,d,{points:I,point:O,lngLats:T,lngLat:V,originalEvent:b}),this._defaultPrevented=!1}c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var h={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,h),p}(s.Event),Ld=function(c){function p(d,_,b){c.call(this,d,{originalEvent:b}),this._defaultPrevented=!1}c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var h={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,h),p}(s.Event),bi=function(c,p){this._map=c,this._clickTolerance=p.clickTolerance};bi.prototype.reset=function(){delete this._mousedownPos},bi.prototype.wheel=function(c){return this._firePreventable(new Ld(c.type,this._map,c))},bi.prototype.mousedown=function(c,p){return this._mousedownPos=p,this._firePreventable(new Pi(c.type,this._map,c))},bi.prototype.mouseup=function(c){this._map.fire(new Pi(c.type,this._map,c))},bi.prototype.click=function(c,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new Pi(c.type,this._map,c))},bi.prototype.dblclick=function(c){return this._firePreventable(new Pi(c.type,this._map,c))},bi.prototype.mouseover=function(c){this._map.fire(new Pi(c.type,this._map,c))},bi.prototype.mouseout=function(c){this._map.fire(new Pi(c.type,this._map,c))},bi.prototype.touchstart=function(c){return this._firePreventable(new Yl(c.type,this._map,c))},bi.prototype.touchmove=function(c){this._map.fire(new Yl(c.type,this._map,c))},bi.prototype.touchend=function(c){this._map.fire(new Yl(c.type,this._map,c))},bi.prototype.touchcancel=function(c){this._map.fire(new Yl(c.type,this._map,c))},bi.prototype._firePreventable=function(c){if(this._map.fire(c),c.defaultPrevented)return{}},bi.prototype.isEnabled=function(){return!0},bi.prototype.isActive=function(){return!1},bi.prototype.enable=function(){},bi.prototype.disable=function(){};var Qt=function(c){this._map=c};Qt.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Qt.prototype.mousemove=function(c){this._map.fire(new Pi(c.type,this._map,c))},Qt.prototype.mousedown=function(){this._delayContextMenu=!0},Qt.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Qt.prototype.contextmenu=function(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new Pi(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()},Qt.prototype.isEnabled=function(){return!0},Qt.prototype.isActive=function(){return!1},Qt.prototype.enable=function(){},Qt.prototype.disable=function(){};var Jn=function(c,p){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=p.clickTolerance||1};function Wc(c,p){for(var h={},d=0;d<c.length;d++)h[c[d].identifier]=p[d];return h}Jn.prototype.isEnabled=function(){return!!this._enabled},Jn.prototype.isActive=function(){return!!this._active},Jn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Jn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Jn.prototype.mousedown=function(c,p){this.isEnabled()&&c.shiftKey&&c.button===0&&(v.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)},Jn.prototype.mousemoveWindow=function(c,p){if(this._active){var h=p;if(!(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)){var d=this._startPos;this._lastPos=h,this._box||(this._box=v.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));var _=Math.min(d.x,h.x),b=Math.max(d.x,h.x),w=Math.min(d.y,h.y),I=Math.max(d.y,h.y);v.setTransform(this._box,"translate("+_+"px,"+w+"px)"),this._box.style.width=b-_+"px",this._box.style.height=I-w+"px"}}},Jn.prototype.mouseupWindow=function(c,p){var h=this;if(this._active&&c.button===0){var d=this._startPos,_=p;if(this.reset(),v.suppressClick(),d.x!==_.x||d.y!==_.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:function(b){return b.fitScreenCoordinates(d,_,h._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",c)}},Jn.prototype.keydown=function(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))},Jn.prototype.blur=function(){this.reset()},Jn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(v.remove(this._box),this._box=null),v.enableDrag(),delete this._startPos,delete this._lastPos},Jn.prototype._fireEvent=function(c,p){return this._map.fire(new s.Event(c,{originalEvent:p}))};var Ju=function(c){this.reset(),this.numTouches=c.numTouches};Ju.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ju.prototype.touchstart=function(c,p,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),h.length===this.numTouches&&(this.centroid=function(d){for(var _=new s.Point(0,0),b=0,w=d;b<w.length;b+=1)_._add(w[b]);return _.div(d.length)}(p),this.touches=Wc(h,p)))},Ju.prototype.touchmove=function(c,p,h){if(!this.aborted&&this.centroid){var d=Wc(h,p);for(var _ in this.touches){var b=d[_];(!b||b.dist(this.touches[_])>30)&&(this.aborted=!0)}}},Ju.prototype.touchend=function(c,p,h){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){var d=!this.aborted&&this.centroid;if(this.reset(),d)return d}};var $o=function(c){this.singleTap=new Ju(c),this.numTaps=c.numTaps,this.reset()};$o.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},$o.prototype.touchstart=function(c,p,h){this.singleTap.touchstart(c,p,h)},$o.prototype.touchmove=function(c,p,h){this.singleTap.touchmove(c,p,h)},$o.prototype.touchend=function(c,p,h){var d=this.singleTap.touchend(c,p,h);if(d){var _=c.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(d)<30;if(_&&b||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}};var Qn=function(){this._zoomIn=new $o({numTouches:1,numTaps:2}),this._zoomOut=new $o({numTouches:2,numTaps:1}),this.reset()};Qn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Qn.prototype.touchstart=function(c,p,h){this._zoomIn.touchstart(c,p,h),this._zoomOut.touchstart(c,p,h)},Qn.prototype.touchmove=function(c,p,h){this._zoomIn.touchmove(c,p,h),this._zoomOut.touchmove(c,p,h)},Qn.prototype.touchend=function(c,p,h){var d=this,_=this._zoomIn.touchend(c,p,h),b=this._zoomOut.touchend(c,p,h);return _?(this._active=!0,c.preventDefault(),setTimeout(function(){return d.reset()},0),{cameraAnimation:function(w){return w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(_)},{originalEvent:c})}}):b?(this._active=!0,c.preventDefault(),setTimeout(function(){return d.reset()},0),{cameraAnimation:function(w){return w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(b)},{originalEvent:c})}}):void 0},Qn.prototype.touchcancel=function(){this.reset()},Qn.prototype.enable=function(){this._enabled=!0},Qn.prototype.disable=function(){this._enabled=!1,this.reset()},Qn.prototype.isEnabled=function(){return this._enabled},Qn.prototype.isActive=function(){return this._active};var Mp={0:1,2:2},Bt=function(c){this.reset(),this._clickTolerance=c.clickTolerance||1};Bt.prototype.blur=function(){this.reset()},Bt.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Bt.prototype._correctButton=function(c,p){return!1},Bt.prototype._move=function(c,p){return{}},Bt.prototype.mousedown=function(c,p){if(!this._lastPoint){var h=v.mouseButton(c);this._correctButton(c,h)&&(this._lastPoint=p,this._eventButton=h)}},Bt.prototype.mousemoveWindow=function(c,p){var h=this._lastPoint;if(h){if(c.preventDefault(),function(d,_){var b=Mp[_];return d.buttons===void 0||(d.buttons&b)!==b}(c,this._eventButton))this.reset();else if(this._moved||!(p.dist(h)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(h,p)}},Bt.prototype.mouseupWindow=function(c){this._lastPoint&&v.mouseButton(c)===this._eventButton&&(this._moved&&v.suppressClick(),this.reset())},Bt.prototype.enable=function(){this._enabled=!0},Bt.prototype.disable=function(){this._enabled=!1,this.reset()},Bt.prototype.isEnabled=function(){return this._enabled},Bt.prototype.isActive=function(){return this._active};var Ap=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.mousedown=function(h,d){c.prototype.mousedown.call(this,h,d),this._lastPoint&&(this._active=!0)},p.prototype._correctButton=function(h,d){return d===0&&!h.ctrlKey},p.prototype._move=function(h,d){return{around:d,panDelta:d.sub(h)}},p}(Bt),Kc=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype._correctButton=function(h,d){return d===0&&h.ctrlKey||d===2},p.prototype._move=function(h,d){var _=.8*(d.x-h.x);if(_)return this._active=!0,{bearingDelta:_}},p.prototype.contextmenu=function(h){h.preventDefault()},p}(Bt),Dp=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype._correctButton=function(h,d){return d===0&&h.ctrlKey||d===2},p.prototype._move=function(h,d){var _=-.5*(d.y-h.y);if(_)return this._active=!0,{pitchDelta:_}},p.prototype.contextmenu=function(h){h.preventDefault()},p}(Bt),Oo=function(c){this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset()};Oo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)},Oo.prototype.touchstart=function(c,p,h){return this._calculateTransform(c,p,h)},Oo.prototype.touchmove=function(c,p,h){if(this._active&&!(h.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,p,h)},Oo.prototype.touchend=function(c,p,h){this._calculateTransform(c,p,h),this._active&&h.length<this._minTouches&&this.reset()},Oo.prototype.touchcancel=function(){this.reset()},Oo.prototype._calculateTransform=function(c,p,h){h.length>0&&(this._active=!0);var d=Wc(h,p),_=new s.Point(0,0),b=new s.Point(0,0),w=0;for(var I in d){var T=d[I],O=this._touches[I];O&&(_._add(T),b._add(T.sub(O)),w++,d[I]=T)}if(this._touches=d,!(w<this._minTouches)&&b.mag()){var V=b.div(w);if(this._sum._add(V),!(this._sum.mag()<this._clickTolerance))return{around:_.div(w),panDelta:V}}},Oo.prototype.enable=function(){this._enabled=!0},Oo.prototype.disable=function(){this._enabled=!1,this.reset()},Oo.prototype.isEnabled=function(){return this._enabled},Oo.prototype.isActive=function(){return this._active};var $n=function(){this.reset()};function Jc(c,p,h){for(var d=0;d<c.length;d++)if(c[d].identifier===h)return p[d]}function Qc(c,p){return Math.log(c/p)/Math.LN2}$n.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},$n.prototype._start=function(c){},$n.prototype._move=function(c,p,h){return{}},$n.prototype.touchstart=function(c,p,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([p[0],p[1]]))},$n.prototype.touchmove=function(c,p,h){if(this._firstTwoTouches){c.preventDefault();var d=this._firstTwoTouches,_=d[1],b=Jc(h,p,d[0]),w=Jc(h,p,_);if(b&&w){var I=this._aroundCenter?null:b.add(w).div(2);return this._move([b,w],I,c)}}},$n.prototype.touchend=function(c,p,h){if(this._firstTwoTouches){var d=this._firstTwoTouches,_=d[1],b=Jc(h,p,d[0]),w=Jc(h,p,_);b&&w||(this._active&&v.suppressClick(),this.reset())}},$n.prototype.touchcancel=function(){this.reset()},$n.prototype.enable=function(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"},$n.prototype.disable=function(){this._enabled=!1,this.reset()},$n.prototype.isEnabled=function(){return this._enabled},$n.prototype.isActive=function(){return this._active};var to=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.reset=function(){c.prototype.reset.call(this),delete this._distance,delete this._startDistance},p.prototype._start=function(h){this._startDistance=this._distance=h[0].dist(h[1])},p.prototype._move=function(h,d){var _=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(Qc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qc(this._distance,_),pinchAround:d}},p}($n);function Ha(c,p){return 180*c.angleWith(p)/Math.PI}var Pd=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.reset=function(){c.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},p.prototype._start=function(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])},p.prototype._move=function(h,d){var _=this._vector;if(this._vector=h[0].sub(h[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ha(this._vector,_),pinchAround:d}},p.prototype._isBelowThreshold=function(h){this._minDiameter=Math.min(this._minDiameter,h.mag());var d=25/(Math.PI*this._minDiameter)*360,_=Ha(h,this._startVector);return Math.abs(_)<d},p}($n);function Wl(c){return Math.abs(c.y)>Math.abs(c.x)}var Op=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.reset=function(){c.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},p.prototype._start=function(h){this._lastPoints=h,Wl(h[0].sub(h[1]))&&(this._valid=!1)},p.prototype._move=function(h,d,_){var b=h[0].sub(this._lastPoints[0]),w=h[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(b,w,_.timeStamp),this._valid)return this._lastPoints=h,this._active=!0,{pitchDelta:(b.y+w.y)/2*-.5}},p.prototype.gestureBeginsVertically=function(h,d,_){if(this._valid!==void 0)return this._valid;var b=h.mag()>=2,w=d.mag()>=2;if(b||w){if(!b||!w)return this._firstMove===void 0&&(this._firstMove=_),_-this._firstMove<100&&void 0;var I=h.y>0==d.y>0;return Wl(h)&&Wl(d)&&I}},p}($n),kp={panStep:100,bearingStep:15,pitchStep:10},ta=function(){var c=kp;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1};function fo(c){return c*(2-c)}ta.prototype.blur=function(){this.reset()},ta.prototype.reset=function(){this._active=!1},ta.prototype.keydown=function(c){var p=this;if(!(c.altKey||c.ctrlKey||c.metaKey)){var h=0,d=0,_=0,b=0,w=0;switch(c.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:c.shiftKey?d=-1:(c.preventDefault(),b=-1);break;case 39:c.shiftKey?d=1:(c.preventDefault(),b=1);break;case 38:c.shiftKey?_=1:(c.preventDefault(),w=-1);break;case 40:c.shiftKey?_=-1:(c.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(d=0,_=0),{cameraAnimation:function(I){var T=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:fo,zoom:h?Math.round(T)+h*(c.shiftKey?2:1):T,bearing:I.getBearing()+d*p._bearingStep,pitch:I.getPitch()+_*p._pitchStep,offset:[-b*p._panStep,-w*p._panStep],center:I.getCenter()},{originalEvent:c})}}}},ta.prototype.enable=function(){this._enabled=!0},ta.prototype.disable=function(){this._enabled=!1,this.reset()},ta.prototype.isEnabled=function(){return this._enabled},ta.prototype.isActive=function(){return this._active},ta.prototype.disableRotation=function(){this._rotationDisabled=!0},ta.prototype.enableRotation=function(){this._rotationDisabled=!1};var Ue=function(c,p){this._map=c,this._el=c.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,s.bindAll(["_onTimeout"],this)};Ue.prototype.setZoomRate=function(c){this._defaultZoomRate=c},Ue.prototype.setWheelZoomRate=function(c){this._wheelZoomRate=c},Ue.prototype.isEnabled=function(){return!!this._enabled},Ue.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ue.prototype.isZooming=function(){return!!this._zooming},Ue.prototype.enable=function(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&c.around==="center")},Ue.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ue.prototype.wheel=function(c){if(this.isEnabled()){var p=c.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY,h=s.browser.now(),d=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,p!==0&&p%4.000244140625==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(d*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),c.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=c,this._delta-=p,this._active||this._start(c)),c.preventDefault()}},Ue.prototype._onTimeout=function(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},Ue.prototype._start=function(c){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var p=v.mousePos(this._el,c);this._around=s.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(p)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ue.prototype.renderFrame=function(){var c=this;if(this._frameId&&(this._frameId=null,this.isActive())){var p=this._map.transform;if(this._delta!==0){var h=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,d=2/(1+Math.exp(-Math.abs(this._delta*h)));this._delta<0&&d!==0&&(d=1/d);var _=typeof this._targetZoom=="number"?p.zoomScale(this._targetZoom):p.scale;this._targetZoom=Math.min(p.maxZoom,Math.max(p.minZoom,p.scaleZoom(_*d))),this._type==="wheel"&&(this._startZoom=p.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var b,w=typeof this._targetZoom=="number"?this._targetZoom:p.zoom,I=this._startZoom,T=this._easing,O=!1;if(this._type==="wheel"&&I&&T){var V=Math.min((s.browser.now()-this._lastWheelEventTime)/200,1),q=T(V);b=s.number(I,w,q),V<1?this._frameId||(this._frameId=!0):O=!0}else b=w,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(function(){c._zooming=!1,c._handler._triggerRenderFrame(),delete c._targetZoom,delete c._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:b-p.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ue.prototype._smoothOutEasing=function(c){var p=s.ease;if(this._prevEase){var h=this._prevEase,d=(s.browser.now()-h.start)/h.duration,_=h.easing(d+.01)-h.easing(d),b=.27/Math.sqrt(_*_+1e-4)*.01,w=Math.sqrt(.0729-b*b);p=s.bezier(b,w,.25,1)}return this._prevEase={start:s.browser.now(),duration:c,easing:p},p},Ue.prototype.blur=function(){this.reset()},Ue.prototype.reset=function(){this._active=!1};var ma=function(c,p){this._clickZoom=c,this._tapZoom=p};ma.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ma.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ma.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ma.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ko=function(){this.reset()};ko.prototype.reset=function(){this._active=!1},ko.prototype.blur=function(){this.reset()},ko.prototype.dblclick=function(c,p){return c.preventDefault(),{cameraAnimation:function(h){h.easeTo({duration:300,zoom:h.getZoom()+(c.shiftKey?-1:1),around:h.unproject(p)},{originalEvent:c})}}},ko.prototype.enable=function(){this._enabled=!0},ko.prototype.disable=function(){this._enabled=!1,this.reset()},ko.prototype.isEnabled=function(){return this._enabled},ko.prototype.isActive=function(){return this._active};var tn=function(){this._tap=new $o({numTouches:1,numTaps:1}),this.reset()};tn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},tn.prototype.touchstart=function(c,p,h){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?h.length>0&&(this._swipePoint=p[0],this._swipeTouch=h[0].identifier):this._tap.touchstart(c,p,h))},tn.prototype.touchmove=function(c,p,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;var d=p[0],_=d.y-this._swipePoint.y;return this._swipePoint=d,c.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(c,p,h)},tn.prototype.touchend=function(c,p,h){this._tapTime?this._swipePoint&&h.length===0&&this.reset():this._tap.touchend(c,p,h)&&(this._tapTime=c.timeStamp)},tn.prototype.touchcancel=function(){this.reset()},tn.prototype.enable=function(){this._enabled=!0},tn.prototype.disable=function(){this._enabled=!1,this.reset()},tn.prototype.isEnabled=function(){return this._enabled},tn.prototype.isActive=function(){return this._active};var yu=function(c,p,h){this._el=c,this._mousePan=p,this._touchPan=h};yu.prototype.enable=function(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},yu.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},yu.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},yu.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Es=function(c,p,h){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=p,this._mousePitch=h};Es.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Es.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Es.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Es.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ea=function(c,p,h,d){this._el=c,this._touchZoom=p,this._touchRotate=h,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0};ea.prototype.enable=function(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ea.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ea.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ea.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ea.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ea.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var wn=function(c){return c.zoom||c.drag||c.pitch||c.rotate},Kl=function(c){function p(){c.apply(this,arguments)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p}(s.Event);function se(c){return c.panDelta&&c.panDelta.mag()||c.zoomDelta||c.bearingDelta||c.pitchDelta}var ee=function(c,p){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Xl(c),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p),s.bindAll(["handleEvent","handleWindowEvent"],this);var h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[s.window,"blur",void 0]];for(var d=0,_=this._listeners;d<_.length;d+=1){var b=_[d],w=b[0];v.addEventListener(w,b[1],w===s.window.document?this.handleWindowEvent:this.handleEvent,b[2])}};ee.prototype.destroy=function(){for(var c=0,p=this._listeners;c<p.length;c+=1){var h=p[c],d=h[0];v.removeEventListener(d,h[1],d===s.window.document?this.handleWindowEvent:this.handleEvent,h[2])}},ee.prototype._addDefaultHandlers=function(c){var p=this._map,h=p.getCanvasContainer();this._add("mapEvent",new bi(p,c));var d=p.boxZoom=new Jn(p,c);this._add("boxZoom",d);var _=new Qn,b=new ko;p.doubleClickZoom=new ma(b,_),this._add("tapZoom",_),this._add("clickZoom",b);var w=new tn;this._add("tapDragZoom",w);var I=p.touchPitch=new Op;this._add("touchPitch",I);var T=new Kc(c),O=new Dp(c);p.dragRotate=new Es(c,T,O),this._add("mouseRotate",T,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);var V=new Ap(c),q=new Oo(c);p.dragPan=new yu(h,V,q),this._add("mousePan",V),this._add("touchPan",q,["touchZoom","touchRotate"]);var j=new Pd,K=new to;p.touchZoomRotate=new ea(h,K,j,w),this._add("touchRotate",j,["touchPan","touchZoom"]),this._add("touchZoom",K,["touchPan","touchRotate"]);var Y=p.scrollZoom=new Ue(p,this);this._add("scrollZoom",Y,["mousePan"]);var rt=p.keyboard=new ta;this._add("keyboard",rt),this._add("blockableMapEvent",new Qt(p));for(var H=0,et=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];H<et.length;H+=1){var at=et[H];c.interactive&&c[at]&&p[at].enable(c[at])}},ee.prototype._add=function(c,p,h){this._handlers.push({handlerName:c,handler:p,allowed:h}),this._handlersById[c]=p},ee.prototype.stop=function(c){if(!this._updatingCamera){for(var p=0,h=this._handlers;p<h.length;p+=1)h[p].handler.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}},ee.prototype.isActive=function(){for(var c=0,p=this._handlers;c<p.length;c+=1)if(p[c].handler.isActive())return!0;return!1},ee.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},ee.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},ee.prototype.isMoving=function(){return Boolean(wn(this._eventsInProgress))||this.isZooming()},ee.prototype._blockedByActive=function(c,p,h){for(var d in c)if(d!==h&&(!p||p.indexOf(d)<0))return!0;return!1},ee.prototype.handleWindowEvent=function(c){this.handleEvent(c,c.type+"Window")},ee.prototype._getMapTouches=function(c){for(var p=[],h=0,d=c;h<d.length;h+=1){var _=d[h];this._el.contains(_.target)&&p.push(_)}return p},ee.prototype.handleEvent=function(c,p){this._updatingCamera=!0;for(var h=c.type==="renderFrame"?void 0:c,d={needsRenderFrame:!1},_={},b={},w=c.touches?this._getMapTouches(c.touches):void 0,I=w?v.touchPos(this._el,w):v.mousePos(this._el,c),T=0,O=this._handlers;T<O.length;T+=1){var V=O[T],q=V.handlerName,j=V.handler,K=V.allowed;if(j.isEnabled()){var Y=void 0;this._blockedByActive(b,K,q)?j.reset():j[p||c.type]&&(Y=j[p||c.type](c,I,w),this.mergeHandlerResult(d,_,Y,q,h),Y&&Y.needsRenderFrame&&this._triggerRenderFrame()),(Y||j.isActive())&&(b[q]=j)}}var rt={};for(var H in this._previousActiveHandlers)b[H]||(rt[H]=h);this._previousActiveHandlers=b,(Object.keys(rt).length||se(d))&&(this._changes.push([d,_,rt]),this._triggerRenderFrame()),(Object.keys(b).length||se(d))&&this._map._stop(!0),this._updatingCamera=!1;var et=d.cameraAnimation;et&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],et(this._map))},ee.prototype.mergeHandlerResult=function(c,p,h,d,_){if(h){s.extend(c,h);var b={handlerName:d,originalEvent:h.originalEvent||_};h.zoomDelta!==void 0&&(p.zoom=b),h.panDelta!==void 0&&(p.drag=b),h.pitchDelta!==void 0&&(p.pitch=b),h.bearingDelta!==void 0&&(p.rotate=b)}},ee.prototype._applyChanges=function(){for(var c={},p={},h={},d=0,_=this._changes;d<_.length;d+=1){var b=_[d],w=b[0],I=b[1],T=b[2];w.panDelta&&(c.panDelta=(c.panDelta||new s.Point(0,0))._add(w.panDelta)),w.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(c.around=w.around),w.pinchAround!==void 0&&(c.pinchAround=w.pinchAround),w.noInertia&&(c.noInertia=w.noInertia),s.extend(p,I),s.extend(h,T)}this._updateMapTransform(c,p,h),this._changes=[]},ee.prototype._updateMapTransform=function(c,p,h){var d=this._map,_=d.transform;if(!se(c))return this._fireEvents(p,h,!0);var b=c.panDelta,w=c.zoomDelta,I=c.bearingDelta,T=c.pitchDelta,O=c.around,V=c.pinchAround;V!==void 0&&(O=V),d._stop(!0),O=O||d.transform.centerPoint;var q=_.pointLocation(b?O.sub(b):O);I&&(_.bearing+=I),T&&(_.pitch+=T),w&&(_.zoom+=w),_.setLocationAtPoint(q,O),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(p,h,!0)},ee.prototype._fireEvents=function(c,p,h){var d=this,_=wn(this._eventsInProgress),b=wn(c),w={};for(var I in c)this._eventsInProgress[I]||(w[I+"start"]=c[I].originalEvent),this._eventsInProgress[I]=c[I];for(var T in!_&&b&&this._fireEvent("movestart",b.originalEvent),w)this._fireEvent(T,w[T]);for(var O in b&&this._fireEvent("move",b.originalEvent),c)this._fireEvent(O,c[O].originalEvent);var V,q={};for(var j in this._eventsInProgress){var K=this._eventsInProgress[j],Y=K.handlerName,rt=K.originalEvent;this._handlersById[Y].isActive()||(delete this._eventsInProgress[j],q[j+"end"]=V=p[Y]||rt)}for(var H in q)this._fireEvent(H,q[H]);var et=wn(this._eventsInProgress);if(h&&(_||b)&&!et){this._updatingCamera=!0;var at=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ct=function(vt){return vt!==0&&-d._bearingSnap<vt&&vt<d._bearingSnap};at?(ct(at.bearing||this._map.getBearing())&&(at.bearing=0),this._map.easeTo(at,{originalEvent:V})):(this._map.fire(new s.Event("moveend",{originalEvent:V})),ct(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},ee.prototype._fireEvent=function(c,p){this._map.fire(new s.Event(c,p?{originalEvent:p}:{}))},ee.prototype._requestFrame=function(){var c=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(p){delete c._frameId,c.handleEvent(new Kl("renderFrame",{timeStamp:p})),c._applyChanges()})},ee.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var $c=function(c){function p(h,d){c.call(this),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=d.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.getCenter=function(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)},p.prototype.setCenter=function(h,d){return this.jumpTo({center:h},d)},p.prototype.panBy=function(h,d,_){return h=s.Point.convert(h).mult(-1),this.panTo(this.transform.center,s.extend({offset:h},d),_)},p.prototype.panTo=function(h,d,_){return this.easeTo(s.extend({center:h},d),_)},p.prototype.getZoom=function(){return this.transform.zoom},p.prototype.setZoom=function(h,d){return this.jumpTo({zoom:h},d),this},p.prototype.zoomTo=function(h,d,_){return this.easeTo(s.extend({zoom:h},d),_)},p.prototype.zoomIn=function(h,d){return this.zoomTo(this.getZoom()+1,h,d),this},p.prototype.zoomOut=function(h,d){return this.zoomTo(this.getZoom()-1,h,d),this},p.prototype.getBearing=function(){return this.transform.bearing},p.prototype.setBearing=function(h,d){return this.jumpTo({bearing:h},d),this},p.prototype.getPadding=function(){return this.transform.padding},p.prototype.setPadding=function(h,d){return this.jumpTo({padding:h},d),this},p.prototype.rotateTo=function(h,d,_){return this.easeTo(s.extend({bearing:h},d),_)},p.prototype.resetNorth=function(h,d){return this.rotateTo(0,s.extend({duration:1e3},h),d),this},p.prototype.resetNorthPitch=function(h,d){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},h),d),this},p.prototype.snapToNorth=function(h,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,d):this},p.prototype.getPitch=function(){return this.transform.pitch},p.prototype.setPitch=function(h,d){return this.jumpTo({pitch:h},d),this},p.prototype.cameraForBounds=function(h,d){h=s.LngLatBounds.convert(h);var _=d&&d.bearing||0;return this._cameraForBoxAndBearing(h.getNorthWest(),h.getSouthEast(),_,d)},p.prototype._cameraForBoxAndBearing=function(h,d,_,b){var w={top:0,bottom:0,right:0,left:0};if(typeof(b=s.extend({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},b)).padding=="number"){var I=b.padding;b.padding={top:I,bottom:I,right:I,left:I}}b.padding=s.extend(w,b.padding);var T=this.transform,O=T.padding,V=T.project(s.LngLat.convert(h)),q=T.project(s.LngLat.convert(d)),j=V.rotate(-_*Math.PI/180),K=q.rotate(-_*Math.PI/180),Y=new s.Point(Math.max(j.x,K.x),Math.max(j.y,K.y)),rt=new s.Point(Math.min(j.x,K.x),Math.min(j.y,K.y)),H=Y.sub(rt),et=(T.width-(O.left+O.right+b.padding.left+b.padding.right))/H.x,at=(T.height-(O.top+O.bottom+b.padding.top+b.padding.bottom))/H.y;if(!(at<0||et<0)){var ct=Math.min(T.scaleZoom(T.scale*Math.min(et,at)),b.maxZoom),vt=typeof b.offset.x=="number"?new s.Point(b.offset.x,b.offset.y):s.Point.convert(b.offset),yt=new s.Point((b.padding.left-b.padding.right)/2,(b.padding.top-b.padding.bottom)/2).rotate(_*Math.PI/180),bt=vt.add(yt).mult(T.scale/T.zoomScale(ct));return{center:T.unproject(V.add(q).div(2).sub(bt)),zoom:ct,bearing:_}}s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},p.prototype.fitBounds=function(h,d,_){return this._fitInternal(this.cameraForBounds(h,d),d,_)},p.prototype.fitScreenCoordinates=function(h,d,_,b,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(s.Point.convert(h)),this.transform.pointLocation(s.Point.convert(d)),_,b),b,w)},p.prototype._fitInternal=function(h,d,_){return h?(delete(d=s.extend(h,d)).padding,d.linear?this.easeTo(d,_):this.flyTo(d,_)):this},p.prototype.jumpTo=function(h,d){this.stop();var _=this.transform,b=!1,w=!1,I=!1;return"zoom"in h&&_.zoom!==+h.zoom&&(b=!0,_.zoom=+h.zoom),h.center!==void 0&&(_.center=s.LngLat.convert(h.center)),"bearing"in h&&_.bearing!==+h.bearing&&(w=!0,_.bearing=+h.bearing),"pitch"in h&&_.pitch!==+h.pitch&&(I=!0,_.pitch=+h.pitch),h.padding==null||_.isPaddingEqual(h.padding)||(_.padding=h.padding),this.fire(new s.Event("movestart",d)).fire(new s.Event("move",d)),b&&this.fire(new s.Event("zoomstart",d)).fire(new s.Event("zoom",d)).fire(new s.Event("zoomend",d)),w&&this.fire(new s.Event("rotatestart",d)).fire(new s.Event("rotate",d)).fire(new s.Event("rotateend",d)),I&&this.fire(new s.Event("pitchstart",d)).fire(new s.Event("pitch",d)).fire(new s.Event("pitchend",d)),this.fire(new s.Event("moveend",d))},p.prototype.easeTo=function(h,d){var _=this;this._stop(!1,h.easeId),((h=s.extend({offset:[0,0],duration:500,easing:s.ease},h)).animate===!1||!h.essential&&s.browser.prefersReducedMotion)&&(h.duration=0);var b=this.transform,w=this.getZoom(),I=this.getBearing(),T=this.getPitch(),O=this.getPadding(),V="zoom"in h?+h.zoom:w,q="bearing"in h?this._normalizeBearing(h.bearing,I):I,j="pitch"in h?+h.pitch:T,K="padding"in h?h.padding:b.padding,Y=s.Point.convert(h.offset),rt=b.centerPoint.add(Y),H=b.pointLocation(rt),et=s.LngLat.convert(h.center||H);this._normalizeCenter(et);var at,ct,vt=b.project(H),yt=b.project(et).sub(vt),bt=b.zoomScale(V-w);h.around&&(at=s.LngLat.convert(h.around),ct=b.locationPoint(at));var Lt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||V!==w,this._rotating=this._rotating||I!==q,this._pitching=this._pitching||j!==T,this._padding=!b.isPaddingEqual(K),this._easeId=h.easeId,this._prepareEase(d,h.noMoveStart,Lt),this._ease(function(kt){if(_._zooming&&(b.zoom=s.number(w,V,kt)),_._rotating&&(b.bearing=s.number(I,q,kt)),_._pitching&&(b.pitch=s.number(T,j,kt)),_._padding&&(b.interpolatePadding(O,K,kt),rt=b.centerPoint.add(Y)),at)b.setLocationAtPoint(at,ct);else{var Ot=b.zoomScale(b.zoom-w),Zt=V>w?Math.min(2,bt):Math.max(.5,bt),ue=Math.pow(Zt,1-kt),pe=b.unproject(vt.add(yt.mult(kt*ue)).mult(Ot));b.setLocationAtPoint(b.renderWorldCopies?pe.wrap():pe,rt)}_._fireMoveEvents(d)},function(kt){_._afterEase(d,kt)},h),this},p.prototype._prepareEase=function(h,d,_){_===void 0&&(_={}),this._moving=!0,d||_.moving||this.fire(new s.Event("movestart",h)),this._zooming&&!_.zooming&&this.fire(new s.Event("zoomstart",h)),this._rotating&&!_.rotating&&this.fire(new s.Event("rotatestart",h)),this._pitching&&!_.pitching&&this.fire(new s.Event("pitchstart",h))},p.prototype._fireMoveEvents=function(h){this.fire(new s.Event("move",h)),this._zooming&&this.fire(new s.Event("zoom",h)),this._rotating&&this.fire(new s.Event("rotate",h)),this._pitching&&this.fire(new s.Event("pitch",h))},p.prototype._afterEase=function(h,d){if(!this._easeId||!d||this._easeId!==d){delete this._easeId;var _=this._zooming,b=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new s.Event("zoomend",h)),b&&this.fire(new s.Event("rotateend",h)),w&&this.fire(new s.Event("pitchend",h)),this.fire(new s.Event("moveend",h))}},p.prototype.flyTo=function(h,d){var _=this;if(!h.essential&&s.browser.prefersReducedMotion){var b=s.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(b,d)}this.stop(),h=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},h);var w=this.transform,I=this.getZoom(),T=this.getBearing(),O=this.getPitch(),V=this.getPadding(),q="zoom"in h?s.clamp(+h.zoom,w.minZoom,w.maxZoom):I,j="bearing"in h?this._normalizeBearing(h.bearing,T):T,K="pitch"in h?+h.pitch:O,Y="padding"in h?h.padding:w.padding,rt=w.zoomScale(q-I),H=s.Point.convert(h.offset),et=w.centerPoint.add(H),at=w.pointLocation(et),ct=s.LngLat.convert(h.center||at);this._normalizeCenter(ct);var vt=w.project(at),yt=w.project(ct).sub(vt),bt=h.curve,Lt=Math.max(w.width,w.height),kt=Lt/rt,Ot=yt.mag();if("minZoom"in h){var Zt=s.clamp(Math.min(h.minZoom,I,q),w.minZoom,w.maxZoom),ue=Lt/w.zoomScale(Zt-I);bt=Math.sqrt(ue/Ot*2)}var pe=bt*bt;function he(ve){var me=(kt*kt-Lt*Lt+(ve?-1:1)*pe*pe*Ot*Ot)/(2*(ve?kt:Lt)*pe*Ot);return Math.log(Math.sqrt(me*me+1)-me)}function Je(ve){return(Math.exp(ve)-Math.exp(-ve))/2}function Wt(ve){return(Math.exp(ve)+Math.exp(-ve))/2}var Ee=he(0),De=function(ve){return Wt(Ee)/Wt(Ee+bt*ve)},we=function(ve){return Lt*((Wt(Ee)*(Je(me=Ee+bt*ve)/Wt(me))-Je(Ee))/pe)/Ot;var me},xe=(he(1)-Ee)/bt;if(Math.abs(Ot)<1e-6||!isFinite(xe)){if(Math.abs(Lt-kt)<1e-6)return this.easeTo(h,d);var Te=kt<Lt?-1:1;xe=Math.abs(Math.log(kt/Lt))/bt,we=function(){return 0},De=function(ve){return Math.exp(Te*bt*ve)}}return h.duration="duration"in h?+h.duration:1e3*xe/("screenSpeed"in h?+h.screenSpeed/bt:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0),this._zooming=!0,this._rotating=T!==j,this._pitching=K!==O,this._padding=!w.isPaddingEqual(Y),this._prepareEase(d,!1),this._ease(function(ve){var me=ve*xe,Fi=1/De(me);w.zoom=ve===1?q:I+w.scaleZoom(Fi),_._rotating&&(w.bearing=s.number(T,j,ve)),_._pitching&&(w.pitch=s.number(O,K,ve)),_._padding&&(w.interpolatePadding(V,Y,ve),et=w.centerPoint.add(H));var ti=ve===1?ct:w.unproject(vt.add(yt.mult(we(me))).mult(Fi));w.setLocationAtPoint(w.renderWorldCopies?ti.wrap():ti,et),_._fireMoveEvents(d)},function(){return _._afterEase(d)},h),this},p.prototype.isEasing=function(){return!!this._easeFrameId},p.prototype.stop=function(){return this._stop()},p.prototype._stop=function(h,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,d)}if(!h){var b=this.handlers;b&&b.stop(!1)}return this},p.prototype._ease=function(h,d,_){_.animate===!1||_.duration===0?(h(1),d()):(this._easeStart=s.browser.now(),this._easeOptions=_,this._onEaseFrame=h,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},p.prototype._renderFrameCallback=function(){var h=Math.min((s.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},p.prototype._normalizeBearing=function(h,d){h=s.wrap(h,-180,180);var _=Math.abs(h-d);return Math.abs(h-360-d)<_&&(h-=360),Math.abs(h+360-d)<_&&(h+=360),h},p.prototype._normalizeCenter=function(h){var d=this.transform;if(d.renderWorldCopies&&!d.lngRange){var _=h.lng-d.center.lng;h.lng+=_>180?-360:_<-180?360:0}},p}(s.Evented),En=function(c){c===void 0&&(c={}),this.options=c,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};En.prototype.getDefaultPosition=function(){return"bottom-right"},En.prototype.onAdd=function(c){var p=this.options&&this.options.compact;return this._map=c,this._container=v.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=v.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=v.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),p&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),p===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},En.prototype.onRemove=function(){v.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},En.prototype._setElementTitle=function(c,p){var h=this._map._getUIString("AttributionControl."+p);c.title=h,c.setAttribute("aria-label",h)},En.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},En.prototype._updateEditLink=function(){var c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));var p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(c){var h=p.reduce(function(d,_,b){return _.value&&(d+=_.key+"="+_.value+(b<p.length-1?"&":"")),d},"?");c.href=s.config.FEEDBACK_URL+"/"+h+(this._map._hash?this._map._hash.getHashString(!0):""),c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}},En.prototype._updateData=function(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},En.prototype._updateAttributions=function(){if(this._map.style){var c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(function(I){return typeof I!="string"?"":I})):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){var p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}var h=this._map.style.sourceCaches;for(var d in h){var _=h[d];if(_.used){var b=_.getSource();b.attribution&&c.indexOf(b.attribution)<0&&c.push(b.attribution)}}c.sort(function(I,T){return I.length-T.length});var w=(c=c.filter(function(I,T){for(var O=T+1;O<c.length;O++)if(c[O].indexOf(I)>=0)return!1;return!0})).join(" | ");w!==this._attribHTML&&(this._attribHTML=w,c.length?(this._innerContainer.innerHTML=w,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},En.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var ra=function(){s.bindAll(["_updateLogo"],this),s.bindAll(["_updateCompact"],this)};ra.prototype.onAdd=function(c){this._map=c,this._container=v.create("div","mapboxgl-ctrl");var p=v.create("a","mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://www.mapbox.com/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ra.prototype.onRemove=function(){v.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ra.prototype.getDefaultPosition=function(){return"bottom-left"},ra.prototype._updateLogo=function(c){c&&c.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ra.prototype._logoRequired=function(){if(this._map.style){var c=this._map.style.sourceCaches;for(var p in c)if(c[p].getSource().mapbox_logo)return!0;return!1}},ra.prototype._updateCompact=function(){var c=this._container.children;if(c.length){var p=c[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("mapboxgl-compact"):p.classList.remove("mapboxgl-compact")}};var en=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};en.prototype.add=function(c){var p=++this._id;return this._queue.push({callback:c,id:p,cancelled:!1}),p},en.prototype.remove=function(c){for(var p=this._currentlyRunning,h=0,d=p?this._queue.concat(p):this._queue;h<d.length;h+=1){var _=d[h];if(_.id===c)return void(_.cancelled=!0)}},en.prototype.run=function(c){c===void 0&&(c=0);var p=this._currentlyRunning=this._queue;this._queue=[];for(var h=0,d=p;h<d.length;h+=1){var _=d[h];if(!_.cancelled&&(_.callback(c),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},en.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var _a={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Np=s.window.HTMLImageElement,th=s.window.HTMLElement,gr=s.window.ImageBitmap,ji={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Td=function(c){function p(d){var _=this;if((d=s.extend({},ji,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var b=new Ye(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies);if(c.call(this,b,d),this._interactive=d.interactive,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._crossSourceCollisions=d.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=d.collectResourceTiming,this._renderTaskQueue=new en,this._controls=[],this._mapId=s.uniqueId(),this._locale=s.extend({},_a,d.locale),this._clickTolerance=d.clickTolerance,this._requestManager=new s.RequestManager(d.transformRequest,d.accessToken),typeof d.container=="string"){if(this._container=s.window.document.getElementById(d.container),!this._container)throw new Error("Container '"+d.container+"' not found.")}else{if(!(d.container instanceof th))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return _._update(!1)}),this.on("moveend",function(){return _._update(!1)}),this.on("zoom",function(){return _._update(!0)}),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new ee(this,d),this._hash=d.hash&&new po(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,s.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localIdeographFontFamily:d.localIdeographFontFamily}),d.attributionControl&&this.addControl(new En({customAttribution:d.customAttribution})),this.addControl(new ra,d.logoPosition),this.on("style.load",function(){_.transform.unmodified&&_.jumpTo(_.style.stylesheet)}),this.on("data",function(w){_._update(w.dataType==="style"),_.fire(new s.Event(w.dataType+"data",w))}),this.on("dataloading",function(w){_.fire(new s.Event(w.dataType+"dataloading",w))})}c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p;var h={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return p.prototype._getMapId=function(){return this._mapId},p.prototype.addControl=function(d,_){if(_===void 0&&(_=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var b=d.onAdd(this);this._controls.push(d);var w=this._controlPositions[_];return _.indexOf("bottom")!==-1?w.insertBefore(b,w.firstChild):w.appendChild(b),this},p.prototype.removeControl=function(d){if(!d||!d.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var _=this._controls.indexOf(d);return _>-1&&this._controls.splice(_,1),d.onRemove(this),this},p.prototype.hasControl=function(d){return this._controls.indexOf(d)>-1},p.prototype.resize=function(d){var _=this._containerDimensions(),b=_[0],w=_[1];if(b===this.transform.width&&w===this.transform.height)return this;this._resizeCanvas(b,w),this.transform.resize(b,w),this.painter.resize(b,w);var I=!this._moving;return I&&this.fire(new s.Event("movestart",d)).fire(new s.Event("move",d)),this.fire(new s.Event("resize",d)),I&&this.fire(new s.Event("moveend",d)),this},p.prototype.getBounds=function(){return this.transform.getBounds()},p.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},p.prototype.setMaxBounds=function(d){return this.transform.setMaxBounds(s.LngLatBounds.convert(d)),this._update()},p.prototype.setMinZoom=function(d){if((d=d==null?-2:d)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d&&this.setZoom(d),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},p.prototype.getMinZoom=function(){return this.transform.minZoom},p.prototype.setMaxZoom=function(d){if((d=d==null?22:d)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d&&this.setZoom(d),this;throw new Error("maxZoom must be greater than the current minZoom")},p.prototype.getMaxZoom=function(){return this.transform.maxZoom},p.prototype.setMinPitch=function(d){if((d=d==null?0:d)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d&&this.setPitch(d),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},p.prototype.getMinPitch=function(){return this.transform.minPitch},p.prototype.setMaxPitch=function(d){if((d=d==null?60:d)>60)throw new Error("maxPitch must be less than or equal to 60");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d&&this.setPitch(d),this;throw new Error("maxPitch must be greater than the current minPitch")},p.prototype.getMaxPitch=function(){return this.transform.maxPitch},p.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},p.prototype.setRenderWorldCopies=function(d){return this.transform.renderWorldCopies=d,this._update()},p.prototype.project=function(d){return this.transform.locationPoint(s.LngLat.convert(d))},p.prototype.unproject=function(d){return this.transform.pointLocation(s.Point.convert(d))},p.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},p.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},p.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},p.prototype._createDelegatedListener=function(d,_,b){var w,I=this;if(d==="mouseenter"||d==="mouseover"){var T=!1;return{layer:_,listener:b,delegates:{mousemove:function(V){var q=I.getLayer(_)?I.queryRenderedFeatures(V.point,{layers:[_]}):[];q.length?T||(T=!0,b.call(I,new Pi(d,I,V.originalEvent,{features:q}))):T=!1},mouseout:function(){T=!1}}}}if(d==="mouseleave"||d==="mouseout"){var O=!1;return{layer:_,listener:b,delegates:{mousemove:function(V){(I.getLayer(_)?I.queryRenderedFeatures(V.point,{layers:[_]}):[]).length?O=!0:O&&(O=!1,b.call(I,new Pi(d,I,V.originalEvent)))},mouseout:function(V){O&&(O=!1,b.call(I,new Pi(d,I,V.originalEvent)))}}}}return{layer:_,listener:b,delegates:(w={},w[d]=function(V){var q=I.getLayer(_)?I.queryRenderedFeatures(V.point,{layers:[_]}):[];q.length&&(V.features=q,b.call(I,V),delete V.features)},w)}},p.prototype.on=function(d,_,b){if(b===void 0)return c.prototype.on.call(this,d,_);var w=this._createDelegatedListener(d,_,b);for(var I in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(w),w.delegates)this.on(I,w.delegates[I]);return this},p.prototype.once=function(d,_,b){if(b===void 0)return c.prototype.once.call(this,d,_);var w=this._createDelegatedListener(d,_,b);for(var I in w.delegates)this.once(I,w.delegates[I]);return this},p.prototype.off=function(d,_,b){var w=this;return b===void 0?c.prototype.off.call(this,d,_):(this._delegatedListeners&&this._delegatedListeners[d]&&function(I){for(var T=I[d],O=0;O<T.length;O++){var V=T[O];if(V.layer===_&&V.listener===b){for(var q in V.delegates)w.off(q,V.delegates[q]);return T.splice(O,1),w}}}(this._delegatedListeners),this)},p.prototype.queryRenderedFeatures=function(d,_){if(!this.style)return[];var b;if(_!==void 0||d===void 0||d instanceof s.Point||Array.isArray(d)||(_=d,d=void 0),_=_||{},(d=d||[[0,0],[this.transform.width,this.transform.height]])instanceof s.Point||typeof d[0]=="number")b=[s.Point.convert(d)];else{var w=s.Point.convert(d[0]),I=s.Point.convert(d[1]);b=[w,new s.Point(I.x,w.y),I,new s.Point(w.x,I.y),w]}return this.style.queryRenderedFeatures(b,_,this.transform)},p.prototype.querySourceFeatures=function(d,_){return this.style.querySourceFeatures(d,_)},p.prototype.setStyle=function(d,_){return(_=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},_)).diff!==!1&&_.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&d?(this._diffStyle(d,_),this):(this._localIdeographFontFamily=_.localIdeographFontFamily,this._updateStyle(d,_))},p.prototype._getUIString=function(d){var _=this._locale[d];if(_==null)throw new Error("Missing UI string '"+d+"'");return _},p.prototype._updateStyle=function(d,_){return this.style&&(this.style.setEventedParent(null),this.style._remove()),d?(this.style=new Kn(this,_||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d):this.style.loadJSON(d),this):(delete this.style,this)},p.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Kn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},p.prototype._diffStyle=function(d,_){var b=this;if(typeof d=="string"){var w=this._requestManager.normalizeStyleURL(d),I=this._requestManager.transformRequest(w,s.ResourceType.Style);s.getJSON(I,function(T,O){T?b.fire(new s.ErrorEvent(T)):O&&b._updateDiff(O,_)})}else typeof d=="object"&&this._updateDiff(d,_)},p.prototype._updateDiff=function(d,_){try{this.style.setState(d)&&this._update(!0)}catch(b){s.warnOnce("Unable to perform style diff: "+(b.message||b.error||b)+".  Rebuilding the style from scratch."),this._updateStyle(d,_)}},p.prototype.getStyle=function(){if(this.style)return this.style.serialize()},p.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():s.warnOnce("There is no style added to the map.")},p.prototype.addSource=function(d,_){return this._lazyInitEmptyStyle(),this.style.addSource(d,_),this._update(!0)},p.prototype.isSourceLoaded=function(d){var _=this.style&&this.style.sourceCaches[d];if(_!==void 0)return _.loaded();this.fire(new s.ErrorEvent(new Error("There is no source with ID '"+d+"'")))},p.prototype.areTilesLoaded=function(){var d=this.style&&this.style.sourceCaches;for(var _ in d){var b=d[_]._tiles;for(var w in b){var I=b[w];if(I.state!=="loaded"&&I.state!=="errored")return!1}}return!0},p.prototype.addSourceType=function(d,_,b){return this._lazyInitEmptyStyle(),this.style.addSourceType(d,_,b)},p.prototype.removeSource=function(d){return this.style.removeSource(d),this._update(!0)},p.prototype.getSource=function(d){return this.style.getSource(d)},p.prototype.addImage=function(d,_,b){b===void 0&&(b={});var w=b.pixelRatio;w===void 0&&(w=1);var I=b.sdf;I===void 0&&(I=!1);var T=b.stretchX,O=b.stretchY,V=b.content;if(this._lazyInitEmptyStyle(),_ instanceof Np||gr&&_ instanceof gr){var q=s.browser.getImageData(_);this.style.addImage(d,{data:new s.RGBAImage({width:q.width,height:q.height},q.data),pixelRatio:w,stretchX:T,stretchY:O,content:V,sdf:I,version:0})}else{if(_.width===void 0||_.height===void 0)return this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var j=_;this.style.addImage(d,{data:new s.RGBAImage({width:_.width,height:_.height},new Uint8Array(_.data)),pixelRatio:w,stretchX:T,stretchY:O,content:V,sdf:I,version:0,userImage:j}),j.onAdd&&j.onAdd(this,d)}},p.prototype.updateImage=function(d,_){var b=this.style.getImage(d);if(!b)return this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var w=_ instanceof Np||gr&&_ instanceof gr?s.browser.getImageData(_):_,I=w.width,T=w.height,O=w.data;return I===void 0||T===void 0?this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):I!==b.data.width||T!==b.data.height?this.fire(new s.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(b.data.replace(O,!(_ instanceof Np||gr&&_ instanceof gr)),void this.style.updateImage(d,b))},p.prototype.hasImage=function(d){return d?!!this.style.getImage(d):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)},p.prototype.removeImage=function(d){this.style.removeImage(d)},p.prototype.loadImage=function(d,_){s.getImage(this._requestManager.transformRequest(d,s.ResourceType.Image),_)},p.prototype.listImages=function(){return this.style.listImages()},p.prototype.addLayer=function(d,_){return this._lazyInitEmptyStyle(),this.style.addLayer(d,_),this._update(!0)},p.prototype.moveLayer=function(d,_){return this.style.moveLayer(d,_),this._update(!0)},p.prototype.removeLayer=function(d){return this.style.removeLayer(d),this._update(!0)},p.prototype.getLayer=function(d){return this.style.getLayer(d)},p.prototype.setLayerZoomRange=function(d,_,b){return this.style.setLayerZoomRange(d,_,b),this._update(!0)},p.prototype.setFilter=function(d,_,b){return b===void 0&&(b={}),this.style.setFilter(d,_,b),this._update(!0)},p.prototype.getFilter=function(d){return this.style.getFilter(d)},p.prototype.setPaintProperty=function(d,_,b,w){return w===void 0&&(w={}),this.style.setPaintProperty(d,_,b,w),this._update(!0)},p.prototype.getPaintProperty=function(d,_){return this.style.getPaintProperty(d,_)},p.prototype.setLayoutProperty=function(d,_,b,w){return w===void 0&&(w={}),this.style.setLayoutProperty(d,_,b,w),this._update(!0)},p.prototype.getLayoutProperty=function(d,_){return this.style.getLayoutProperty(d,_)},p.prototype.setLight=function(d,_){return _===void 0&&(_={}),this._lazyInitEmptyStyle(),this.style.setLight(d,_),this._update(!0)},p.prototype.getLight=function(){return this.style.getLight()},p.prototype.setFeatureState=function(d,_){return this.style.setFeatureState(d,_),this._update()},p.prototype.removeFeatureState=function(d,_){return this.style.removeFeatureState(d,_),this._update()},p.prototype.getFeatureState=function(d){return this.style.getFeatureState(d)},p.prototype.getContainer=function(){return this._container},p.prototype.getCanvasContainer=function(){return this._canvasContainer},p.prototype.getCanvas=function(){return this._canvas},p.prototype._containerDimensions=function(){var d=0,_=0;return this._container&&(d=this._container.clientWidth||400,_=this._container.clientHeight||300),[d,_]},p.prototype._detectMissingCSS=function(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},p.prototype._setupContainer=function(){var d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=v.create("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();var _=this._canvasContainer=v.create("div","mapboxgl-canvas-container",d);this._interactive&&_.classList.add("mapboxgl-interactive"),this._canvas=v.create("canvas","mapboxgl-canvas",_),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var b=this._containerDimensions();this._resizeCanvas(b[0],b[1]);var w=this._controlContainer=v.create("div","mapboxgl-control-container",d),I=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(T){I[T]=v.create("div","mapboxgl-ctrl-"+T,w)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},p.prototype._resizeCanvas=function(d,_){var b=s.browser.devicePixelRatio||1;this._canvas.width=b*d,this._canvas.height=b*_,this._canvas.style.width=d+"px",this._canvas.style.height=_+"px"},p.prototype._setupPainter=function(){var d=s.extend({},y.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),_=this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);_?(this.painter=new Ur(_,this.transform),s.webpSupported.testSupport(_)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))},p.prototype._contextLost=function(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:d}))},p.prototype._contextRestored=function(d){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:d}))},p.prototype._onMapScroll=function(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},p.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},p.prototype._update=function(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this},p.prototype._requestRenderFrame=function(d){return this._update(),this._renderTaskQueue.add(d)},p.prototype._cancelRenderFrame=function(d){this._renderTaskQueue.remove(d)},p.prototype._render=function(d){var _,b=this,w=0,I=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(_=I.createQueryEXT(),I.beginQueryEXT(I.TIME_ELAPSED_EXT,_),w=s.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),!this._removed){var T=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var O=this.transform.zoom,V=s.browser.now();this.style.zoomHistory.update(O,V);var q=new s.EvaluationParameters(O,{now:V,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),j=q.crossFadingFactor();j===1&&j===this._crossFadingFactor||(T=!0,this._crossFadingFactor=j),this.style.update(q)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||T)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var K=s.browser.now()-w;I.endQueryEXT(I.TIME_ELAPSED_EXT,_),setTimeout(function(){var H=I.getQueryObjectEXT(_,I.QUERY_RESULT_EXT)/1e6;I.deleteQueryEXT(_),b.fire(new s.Event("gpu-timing-frame",{cpuTime:K,gpuTime:H}))},50)}if(this.listens("gpu-timing-layer")){var Y=this.painter.collectGpuTimers();setTimeout(function(){var H=b.painter.queryGpuTimers(Y);b.fire(new s.Event("gpu-timing-layer",{layerTimes:H}))},50)}var rt=this._sourcesDirty||this._styleDirty||this._placementDirty;return rt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.Event("idle")),!this._loaded||this._fullyLoaded||rt||(this._fullyLoaded=!0),this}},p.prototype.remove=function(){this._hash&&this._hash.remove();for(var d=0,_=this._controls;d<_.length;d+=1)_[d].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1));var b=this.painter.context.gl.getExtension("WEBGL_lose_context");b&&b.loseContext(),mu(this._canvasContainer),mu(this._controlContainer),mu(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new s.Event("remove"))},p.prototype.triggerRepaint=function(){var d=this;this.style&&!this._frame&&(this._frame=s.browser.frame(function(_){d._frame=null,d._render(_)}))},p.prototype._onWindowOnline=function(){this._update()},p.prototype._onWindowResize=function(d){this._trackResize&&this.resize({originalEvent:d})._update()},h.showTileBoundaries.get=function(){return!!this._showTileBoundaries},h.showTileBoundaries.set=function(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())},h.showPadding.get=function(){return!!this._showPadding},h.showPadding.set=function(d){this._showPadding!==d&&(this._showPadding=d,this._update())},h.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},h.showCollisionBoxes.set=function(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())},h.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},h.showOverdrawInspector.set=function(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())},h.repaint.get=function(){return!!this._repaint},h.repaint.set=function(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())},h.vertices.get=function(){return!!this._vertices},h.vertices.set=function(d){this._vertices=d,this._update()},p.prototype._setCacheLimits=function(d,_){s.setCacheLimits(d,_)},h.version.get=function(){return s.version},Object.defineProperties(p.prototype,h),p}($c);function mu(c){c.parentNode&&c.parentNode.removeChild(c)}var Rp={showCompass:!0,showZoom:!0,visualizePitch:!1},Xa=function(c){var p=this;this.options=s.extend({},Rp,c),this._container=v.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(h){return h.preventDefault()}),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(h){return p._map.zoomIn({},{originalEvent:h})}),v.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(h){return p._map.zoomOut({},{originalEvent:h})}),v.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(h){p.options.visualizePitch?p._map.resetNorthPitch({},{originalEvent:h}):p._map.resetNorth({},{originalEvent:h})}),this._compassIcon=v.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Xa.prototype._updateZoomButtons=function(){var c=this._map.getZoom(),p=c===this._map.getMaxZoom(),h=c===this._map.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},Xa.prototype._rotateCompassArrow=function(){var c=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=c},Xa.prototype.onAdd=function(c){return this._map=c,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new eo(this._map,this._compass,this.options.visualizePitch)),this._container},Xa.prototype.onRemove=function(){v.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Xa.prototype._createButton=function(c,p){var h=v.create("button",c,this._container);return h.type="button",h.addEventListener("click",p),h},Xa.prototype._setButtonTitle=function(c,p){var h=this._map._getUIString("NavigationControl."+p);c.title=h,c.setAttribute("aria-label",h)};var eo=function(c,p,h){h===void 0&&(h=!1),this._clickTolerance=10,this.element=p,this.mouseRotate=new Kc({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,h&&(this.mousePitch=new Dp({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),v.addEventListener(p,"mousedown",this.mousedown),v.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),v.addEventListener(p,"touchmove",this.touchmove),v.addEventListener(p,"touchend",this.touchend),v.addEventListener(p,"touchcancel",this.reset)};function Qu(c,p,h){if(c=new s.LngLat(c.lng,c.lat),p){var d=new s.LngLat(c.lng-360,c.lat),_=new s.LngLat(c.lng+360,c.lat),b=h.locationPoint(c).distSqr(p);h.locationPoint(d).distSqr(p)<b?c=d:h.locationPoint(_).distSqr(p)<b&&(c=_)}for(;Math.abs(c.lng-h.center.lng)>180;){var w=h.locationPoint(c);if(w.x>=0&&w.y>=0&&w.x<=h.width&&w.y<=h.height)break;c.lng>h.center.lng?c.lng-=360:c.lng+=360}return c}eo.prototype.down=function(c,p){this.mouseRotate.mousedown(c,p),this.mousePitch&&this.mousePitch.mousedown(c,p),v.disableDrag()},eo.prototype.move=function(c,p){var h=this.map,d=this.mouseRotate.mousemoveWindow(c,p);if(d&&d.bearingDelta&&h.setBearing(h.getBearing()+d.bearingDelta),this.mousePitch){var _=this.mousePitch.mousemoveWindow(c,p);_&&_.pitchDelta&&h.setPitch(h.getPitch()+_.pitchDelta)}},eo.prototype.off=function(){var c=this.element;v.removeEventListener(c,"mousedown",this.mousedown),v.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),v.removeEventListener(c,"touchmove",this.touchmove),v.removeEventListener(c,"touchend",this.touchend),v.removeEventListener(c,"touchcancel",this.reset),this.offTemp()},eo.prototype.offTemp=function(){v.enableDrag(),v.removeEventListener(s.window,"mousemove",this.mousemove),v.removeEventListener(s.window,"mouseup",this.mouseup)},eo.prototype.mousedown=function(c){this.down(s.extend({},c,{ctrlKey:!0,preventDefault:function(){return c.preventDefault()}}),v.mousePos(this.element,c)),v.addEventListener(s.window,"mousemove",this.mousemove),v.addEventListener(s.window,"mouseup",this.mouseup)},eo.prototype.mousemove=function(c){this.move(c,v.mousePos(this.element,c))},eo.prototype.mouseup=function(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()},eo.prototype.touchstart=function(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=v.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return c.preventDefault()}},this._startPos))},eo.prototype.touchmove=function(c){c.targetTouches.length!==1?this.reset():(this._lastPos=v.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:function(){return c.preventDefault()}},this._lastPos))},eo.prototype.touchend=function(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},eo.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var va={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function eh(c,p,h){var d=c.classList;for(var _ in va)d.remove("mapboxgl-"+h+"-anchor-"+_);d.add("mapboxgl-"+h+"-anchor-"+p)}var $u,Jl=function(c){function p(h,d){if(c.call(this),(h instanceof s.window.HTMLElement||d)&&(h=s.extend({element:h},d)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&h.pitchAlignment!=="auto"?h.pitchAlignment:this._rotationAlignment,h&&h.element)this._element=h.element,this._offset=s.Point.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=v.create("div"),this._element.setAttribute("aria-label","Map marker");var _=v.createNS("http://www.w3.org/2000/svg","svg");_.setAttributeNS(null,"display","block"),_.setAttributeNS(null,"height","41px"),_.setAttributeNS(null,"width","27px"),_.setAttributeNS(null,"viewBox","0 0 27 41");var b=v.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"stroke","none"),b.setAttributeNS(null,"stroke-width","1"),b.setAttributeNS(null,"fill","none"),b.setAttributeNS(null,"fill-rule","evenodd");var w=v.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");var I=v.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");for(var T=0,O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];T<O.length;T+=1){var V=O[T],q=v.createNS("http://www.w3.org/2000/svg","ellipse");q.setAttributeNS(null,"opacity","0.04"),q.setAttributeNS(null,"cx","10.5"),q.setAttributeNS(null,"cy","5.80029008"),q.setAttributeNS(null,"rx",V.rx),q.setAttributeNS(null,"ry",V.ry),I.appendChild(q)}var j=v.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill",this._color);var K=v.createNS("http://www.w3.org/2000/svg","path");K.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),j.appendChild(K);var Y=v.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"fill","#000000");var rt=v.createNS("http://www.w3.org/2000/svg","path");rt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Y.appendChild(rt);var H=v.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");var et=v.createNS("http://www.w3.org/2000/svg","g");et.setAttributeNS(null,"transform","translate(8.0, 8.0)");var at=v.createNS("http://www.w3.org/2000/svg","circle");at.setAttributeNS(null,"fill","#000000"),at.setAttributeNS(null,"opacity","0.25"),at.setAttributeNS(null,"cx","5.5"),at.setAttributeNS(null,"cy","5.5"),at.setAttributeNS(null,"r","5.4999962");var ct=v.createNS("http://www.w3.org/2000/svg","circle");ct.setAttributeNS(null,"fill","#FFFFFF"),ct.setAttributeNS(null,"cx","5.5"),ct.setAttributeNS(null,"cy","5.5"),ct.setAttributeNS(null,"r","5.4999962"),et.appendChild(at),et.appendChild(ct),w.appendChild(I),w.appendChild(j),w.appendChild(Y),w.appendChild(H),w.appendChild(et),_.appendChild(w),_.setAttributeNS(null,"height",41*this._scale+"px"),_.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(_),this._offset=s.Point.convert(h&&h.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(vt){vt.preventDefault()}),this._element.addEventListener("mousedown",function(vt){vt.preventDefault()}),eh(this._element,this._anchor,"marker"),this._popup=null}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.addTo=function(h){return this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._update),h.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},p.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),v.remove(this._element),this._popup&&this._popup.remove(),this},p.prototype.getLngLat=function(){return this._lngLat},p.prototype.setLngLat=function(h){return this._lngLat=s.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},p.prototype.getElement=function(){return this._element},p.prototype.setPopup=function(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){var d=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(24.6+d)],"bottom-right":[-d,-1*(24.6+d)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=h,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},p.prototype._onKeyPress=function(h){var d=h.code,_=h.charCode||h.keyCode;d!=="Space"&&d!=="Enter"&&_!==32&&_!==13||this.togglePopup()},p.prototype._onMapClick=function(h){var d=h.originalEvent.target,_=this._element;this._popup&&(d===_||_.contains(d))&&this.togglePopup()},p.prototype.getPopup=function(){return this._popup},p.prototype.togglePopup=function(){var h=this._popup;return h?(h.isOpen()?h.remove():h.addTo(this._map),this):this},p.prototype._update=function(h){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Qu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(d="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_="rotateX("+this._map.getPitch()+"deg)"),h&&h.type!=="moveend"||(this._pos=this._pos.round()),v.setTransform(this._element,va[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+_+" "+d)}},p.prototype.getOffset=function(){return this._offset},p.prototype.setOffset=function(h){return this._offset=s.Point.convert(h),this._update(),this},p.prototype._onMove=function(h){if(!this._isDragging){var d=this._clickTolerance||this._map._clickTolerance;this._isDragging=h.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=h.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))},p.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"},p.prototype._addDragHandler=function(h){this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(this._pos).add(this._offset),this._pointerdownPos=h.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},p.prototype.setDraggable=function(h){return this._draggable=!!h,this._map&&(h?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},p.prototype.isDraggable=function(){return this._draggable},p.prototype.setRotation=function(h){return this._rotation=h||0,this._update(),this},p.prototype.getRotation=function(){return this._rotation},p.prototype.setRotationAlignment=function(h){return this._rotationAlignment=h||"auto",this._update(),this},p.prototype.getRotationAlignment=function(){return this._rotationAlignment},p.prototype.setPitchAlignment=function(h){return this._pitchAlignment=h&&h!=="auto"?h:this._rotationAlignment,this._update(),this},p.prototype.getPitchAlignment=function(){return this._pitchAlignment},p}(s.Evented),Fp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},tl=0,_u=!1,zp=function(c){function p(h){c.call(this),this.options=s.extend({},Fp,h),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.onAdd=function(h){var d;return this._map=h,this._container=v.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),d=this._setupUI,$u!==void 0?d($u):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(function(_){d($u=_.state!=="denied")}):d($u=!!s.window.navigator.geolocation),this._container},p.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),v.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,tl=0,_u=!1},p.prototype._isOutOfMapMaxBounds=function(h){var d=this._map.getMaxBounds(),_=h.coords;return d&&(_.longitude<d.getWest()||_.longitude>d.getEast()||_.latitude<d.getSouth()||_.latitude>d.getNorth())},p.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},p.prototype._onSuccess=function(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",h)),this._finish()}},p.prototype._updateCamera=function(h){var d=new s.LngLat(h.coords.longitude,h.coords.latitude),_=h.coords.accuracy,b=this._map.getBearing(),w=s.extend({bearing:b},this.options.fitBoundsOptions);this._map.fitBounds(d.toBounds(_),w,{geolocateSource:!0})},p.prototype._updateMarker=function(h){if(h){var d=new s.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},p.prototype._updateCircleRadius=function(){var h=this._map._container.clientHeight/2,d=this._map.unproject([0,h]),_=this._map.unproject([1,h]),b=d.distanceTo(_),w=Math.ceil(2*this._accuracy/b);this._circleElement.style.width=w+"px",this._circleElement.style.height=w+"px"},p.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},p.prototype._onError=function(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&_u)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",h)),this._finish()}},p.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},p.prototype._setupUI=function(h){var d=this;if(this._container.addEventListener("contextmenu",function(w){return w.preventDefault()}),this._geolocateButton=v.create("button","mapboxgl-ctrl-geolocate",this._container),v.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",h===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var _=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)}else{var b=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=b,this._geolocateButton.setAttribute("aria-label",b)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=v.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Jl(this._dotElement),this._circleElement=v.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Jl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(w){w.geolocateSource||d._watchState!=="ACTIVE_LOCK"||w.originalEvent&&w.originalEvent.type==="resize"||(d._watchState="BACKGROUND",d._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),d._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),d.fire(new s.Event("trackuserlocationend")))})},p.prototype.trigger=function(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":tl--,_u=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++tl>1?(h={maximumAge:6e5,timeout:0},_u=!0):(h=this.options.positionOptions,_u=!1),this._geolocationWatchID=s.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else s.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},p.prototype._clearWatch=function(){s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},p}(s.Evented),Ss={maxWidth:100,unit:"metric"},Is=function(c){this.options=s.extend({},Ss,c),s.bindAll(["_onMove","setUnit"],this)};function rh(c,p,h){var d=h&&h.maxWidth||100,_=c._container.clientHeight/2,b=c.unproject([0,_]),w=c.unproject([d,_]),I=b.distanceTo(w);if(h&&h.unit==="imperial"){var T=3.2808*I;T>5280?Cs(p,d,T/5280,c._getUIString("ScaleControl.Miles")):Cs(p,d,T,c._getUIString("ScaleControl.Feet"))}else h&&h.unit==="nautical"?Cs(p,d,I/1852,c._getUIString("ScaleControl.NauticalMiles")):I>=1e3?Cs(p,d,I/1e3,c._getUIString("ScaleControl.Kilometers")):Cs(p,d,I,c._getUIString("ScaleControl.Meters"))}function Cs(c,p,h,d){var _,b,w,I=(_=h,(b=Math.pow(10,(""+Math.floor(_)).length-1))*(w=(w=_/b)>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(T){var O=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*O)/O}(w)));c.style.width=p*(I/h)+"px",c.innerHTML=I+"&nbsp;"+d}Is.prototype.getDefaultPosition=function(){return"bottom-left"},Is.prototype._onMove=function(){rh(this._map,this._container,this.options)},Is.prototype.onAdd=function(c){return this._map=c,this._container=v.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",c.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Is.prototype.onRemove=function(){v.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Is.prototype.setUnit=function(c){this.options.unit=c,rh(this._map,this._container,this.options)};var No=function(c){this._fullscreen=!1,c&&c.container&&(c.container instanceof s.window.HTMLElement?this._container=c.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in s.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in s.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in s.window.document&&(this._fullscreenchange="MSFullscreenChange")};No.prototype.onAdd=function(c){return this._map=c,this._container||(this._container=this._map.getContainer()),this._controlContainer=v.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},No.prototype.onRemove=function(){v.remove(this._controlContainer),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},No.prototype._checkFullscreenSupport=function(){return!!(s.window.document.fullscreenEnabled||s.window.document.mozFullScreenEnabled||s.window.document.msFullscreenEnabled||s.window.document.webkitFullscreenEnabled)},No.prototype._setupUI=function(){var c=this._fullscreenButton=v.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);v.create("span","mapboxgl-ctrl-icon",c).setAttribute("aria-hidden",!0),c.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},No.prototype._updateTitle=function(){var c=this._getTitle();this._fullscreenButton.setAttribute("aria-label",c),this._fullscreenButton.title=c},No.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},No.prototype._isFullscreen=function(){return this._fullscreen},No.prototype._changeIcon=function(){(s.window.document.fullscreenElement||s.window.document.mozFullScreenElement||s.window.document.webkitFullscreenElement||s.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},No.prototype._onClickFullscreen=function(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.mozCancelFullScreen?s.window.document.mozCancelFullScreen():s.window.document.msExitFullscreen?s.window.document.msExitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Bp={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ql=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Vp=function(c){function p(h){c.call(this),this.options=s.extend(Object.create(Bp),h),s.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return c&&(p.__proto__=c),(p.prototype=Object.create(c&&c.prototype)).constructor=p,p.prototype.addTo=function(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new s.Event("open")),this},p.prototype.isOpen=function(){return!!this._map},p.prototype.remove=function(){return this._content&&v.remove(this._content),this._container&&(v.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new s.Event("close")),this},p.prototype.getLngLat=function(){return this._lngLat},p.prototype.setLngLat=function(h){return this._lngLat=s.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},p.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},p.prototype.getElement=function(){return this._container},p.prototype.setText=function(h){return this.setDOMContent(s.window.document.createTextNode(h))},p.prototype.setHTML=function(h){var d,_=s.window.document.createDocumentFragment(),b=s.window.document.createElement("body");for(b.innerHTML=h;d=b.firstChild;)_.appendChild(d);return this.setDOMContent(_)},p.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},p.prototype.setMaxWidth=function(h){return this.options.maxWidth=h,this._update(),this},p.prototype.setDOMContent=function(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=v.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this},p.prototype.addClassName=function(h){this._container&&this._container.classList.add(h)},p.prototype.removeClassName=function(h){this._container&&this._container.classList.remove(h)},p.prototype.setOffset=function(h){return this.options.offset=h,this._update(),this},p.prototype.toggleClassName=function(h){if(this._container)return this._container.classList.toggle(h)},p.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=v.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},p.prototype._onMouseUp=function(h){this._update(h.point)},p.prototype._onMouseMove=function(h){this._update(h.point)},p.prototype._onDrag=function(h){this._update(h.point)},p.prototype._update=function(h){var d=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=v.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=v.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(q){return d._container.classList.add(q)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Qu(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||h)){var _=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat),b=this.options.anchor,w=function q(j){if(j){if(typeof j=="number"){var K=Math.round(Math.sqrt(.5*Math.pow(j,2)));return{center:new s.Point(0,0),top:new s.Point(0,j),"top-left":new s.Point(K,K),"top-right":new s.Point(-K,K),bottom:new s.Point(0,-j),"bottom-left":new s.Point(K,-K),"bottom-right":new s.Point(-K,-K),left:new s.Point(j,0),right:new s.Point(-j,0)}}if(j instanceof s.Point||Array.isArray(j)){var Y=s.Point.convert(j);return{center:Y,top:Y,"top-left":Y,"top-right":Y,bottom:Y,"bottom-left":Y,"bottom-right":Y,left:Y,right:Y}}return{center:s.Point.convert(j.center||[0,0]),top:s.Point.convert(j.top||[0,0]),"top-left":s.Point.convert(j["top-left"]||[0,0]),"top-right":s.Point.convert(j["top-right"]||[0,0]),bottom:s.Point.convert(j.bottom||[0,0]),"bottom-left":s.Point.convert(j["bottom-left"]||[0,0]),"bottom-right":s.Point.convert(j["bottom-right"]||[0,0]),left:s.Point.convert(j.left||[0,0]),right:s.Point.convert(j.right||[0,0])}}return q(new s.Point(0,0))}(this.options.offset);if(!b){var I,T=this._container.offsetWidth,O=this._container.offsetHeight;I=_.y+w.bottom.y<O?["top"]:_.y>this._map.transform.height-O?["bottom"]:[],_.x<T/2?I.push("left"):_.x>this._map.transform.width-T/2&&I.push("right"),b=I.length===0?"bottom":I.join("-")}var V=_.add(w[b]).round();v.setTransform(this._container,va[b]+" translate("+V.x+"px,"+V.y+"px)"),eh(this._container,b,"popup")}},p.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var h=this._container.querySelector(Ql);h&&h.focus()}},p.prototype._onClose=function(){this.remove()},p}(s.Evented),ih={version:s.version,supported:y,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:Td,NavigationControl:Xa,GeolocateControl:zp,AttributionControl:En,ScaleControl:Is,FullscreenControl:No,Popup:Vp,Marker:Jl,Style:Kn,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,Evented:s.Evented,config:s.config,prewarm:function(){St().acquire(wt)},clearPrewarmedResources:function(){var c=te;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(wt),te=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(c){s.config.ACCESS_TOKEN=c},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(c){s.config.API_URL=c},get workerCount(){return Mt.workerCount},set workerCount(c){Mt.workerCount=c},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(c){s.config.MAX_PARALLEL_IMAGE_REQUESTS=c},clearStorage:function(c){s.clearTileCache(c)},workerUrl:""};return ih}),o})})(Z0);var be=Z0.exports;const lw=8,cw={"raster-tiles":{type:"raster",tiles:["https://iserver.supermap.io/iserver/services/map-china400/rest/maps/China/zxyTileImage.png?z={z}&x={x}&y={y}"],tileSize:256}},hw=[{id:"simple-tiles",type:"raster",source:"raster-tiles",minzoom:0,maxzoom:22}];var pw={version:lw,sources:cw,layers:hw};const fw={class:"map-box"},dw=iw({__name:"index",props:{iconList:null},emits:["load"],setup(n,{emit:t}){const e=n,i=nw();let o;ow(()=>{o=new be.Map({container:i.value,zoom:10,minZoom:1,maxZoom:18,center:[106.263683,29.274074],style:pw}),o.on("load",u),o.on("data",s)});const u=()=>{t("load",o)},s=y=>{var v;y.dataType==="style"&&((v=e.iconList)==null||v.forEach(S=>{o!=null&&o.hasImage(S.name)||o.loadImage(S.path,(L,k)=>{var N,Q;if(L)throw L;o!=null&&o.hasImage(S.name)||o.addImage(S.name,k,{pixelRatio:(N=S.pixelRatio)!=null?N:1,sdf:(Q=S.sdf)!=null?Q:!1})})}))};return(y,v)=>(aw(),sw("div",fw,[uw("div",{ref_key:"mapContainer",ref:i,class:"map-container"},null,512)]))}});var NC=rw(dw,[["__scopeId","data-v-c186ef06"]]),no=63710088e-1,Y0={centimeters:no*100,centimetres:no*100,degrees:no/111325,feet:no*3.28084,inches:no*39.37,kilometers:no/1e3,kilometres:no/1e3,meters:no,metres:no,miles:no/1609.344,millimeters:no*1e3,millimetres:no*1e3,nauticalmiles:no/1852,radians:1,yards:no*1.0936};function qs(n,t,e){e===void 0&&(e={});var i={type:"Feature"};return(e.id===0||e.id)&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.properties=t||{},i.geometry=n,i}function Me(n,t,e){if(e===void 0&&(e={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Iv(n[0])||!Iv(n[1]))throw new Error("coordinates must contain numbers");var i={type:"Point",coordinates:n};return qs(i,t,e)}function es(n,t,e){e===void 0&&(e={});for(var i=0,o=n;i<o.length;i++){var u=o[i];if(u.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<u[u.length-1].length;s++)if(u[u.length-1][s]!==u[0][s])throw new Error("First and last Position are not equivalent.")}var y={type:"Polygon",coordinates:n};return qs(y,t,e)}function Yi(n,t,e){if(e===void 0&&(e={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:n};return qs(i,t,e)}function Ir(n,t){t===void 0&&(t={});var e={type:"FeatureCollection"};return t.id&&(e.id=t.id),t.bbox&&(e.bbox=t.bbox),e.features=n,e}function gw(n,t,e){e===void 0&&(e={});var i={type:"MultiLineString",coordinates:n};return qs(i,t,e)}function Ig(n,t,e){e===void 0&&(e={});var i={type:"MultiPoint",coordinates:n};return qs(i,t,e)}function Am(n,t){t===void 0&&(t="kilometers");var e=Y0[t];if(!e)throw new Error(t+" units is invalid");return n*e}function Dm(n,t){t===void 0&&(t="kilometers");var e=Y0[t];if(!e)throw new Error(t+" units is invalid");return n/e}function _m(n){var t=n%(2*Math.PI);return t*180/Math.PI}function Qa(n){var t=n%360;return t*Math.PI/180}function yw(n,t,e){if(t===void 0&&(t="kilometers"),e===void 0&&(e="kilometers"),!(n>=0))throw new Error("length must be a positive number");return Am(Dm(n,t),e)}function Iv(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function RC(n){return!!n&&n.constructor===Object}function Vf(n,t,e){if(n!==null)for(var i,o,u,s,y,v,S,L=0,k=0,N,Q=n.type,tt=Q==="FeatureCollection",xt=Q==="Feature",mt=tt?n.features.length:1,Ct=0;Ct<mt;Ct++){S=tt?n.features[Ct].geometry:xt?n.geometry:n,N=S?S.type==="GeometryCollection":!1,y=N?S.geometries.length:1;for(var ut=0;ut<y;ut++){var Pt=0,Ft=0;if(s=N?S.geometries[ut]:S,s!==null){v=s.coordinates;var ie=s.type;switch(L=e&&(ie==="Polygon"||ie==="MultiPolygon")?1:0,ie){case null:break;case"Point":if(t(v,k,Ct,Pt,Ft)===!1)return!1;k++,Pt++;break;case"LineString":case"MultiPoint":for(i=0;i<v.length;i++){if(t(v[i],k,Ct,Pt,Ft)===!1)return!1;k++,ie==="MultiPoint"&&Pt++}ie==="LineString"&&Pt++;break;case"Polygon":case"MultiLineString":for(i=0;i<v.length;i++){for(o=0;o<v[i].length-L;o++){if(t(v[i][o],k,Ct,Pt,Ft)===!1)return!1;k++}ie==="MultiLineString"&&Pt++,ie==="Polygon"&&Ft++}ie==="Polygon"&&Pt++;break;case"MultiPolygon":for(i=0;i<v.length;i++){for(Ft=0,o=0;o<v[i].length;o++){for(u=0;u<v[i][o].length-L;u++){if(t(v[i][o][u],k,Ct,Pt,Ft)===!1)return!1;k++}Ft++}Pt++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(Vf(s.geometries[i],t,e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Cg(n,t){if(n.type==="Feature")t(n,0);else if(n.type==="FeatureCollection")for(var e=0;e<n.features.length&&t(n.features[e],e)!==!1;e++);}function FC(n){var t=[];return Vf(n,function(e){t.push(e)}),t}function qg(n,t){var e,i,o,u,s,y,v,S,L,k,N=0,Q=n.type==="FeatureCollection",tt=n.type==="Feature",xt=Q?n.features.length:1;for(e=0;e<xt;e++){for(y=Q?n.features[e].geometry:tt?n.geometry:n,S=Q?n.features[e].properties:tt?n.properties:{},L=Q?n.features[e].bbox:tt?n.bbox:void 0,k=Q?n.features[e].id:tt?n.id:void 0,v=y?y.type==="GeometryCollection":!1,s=v?y.geometries.length:1,o=0;o<s;o++){if(u=v?y.geometries[o]:y,u===null){if(t(null,N,S,L,k)===!1)return!1;continue}switch(u.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(u,N,S,L,k)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<u.geometries.length;i++)if(t(u.geometries[i],N,S,L,k)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}N++}}function mw(n,t,e){var i=e;return qg(n,function(o,u,s,y,v){u===0&&e===void 0?i=o:i=t(i,o,u,s,y,v)}),i}function W0(n,t){qg(n,function(e,i,o,u,s){var y=e===null?null:e.type;switch(y){case null:case"Point":case"LineString":case"Polygon":return t(qs(e,o,{bbox:u,id:s}),i,0)===!1?!1:void 0}var v;switch(y){case"MultiPoint":v="Point";break;case"MultiLineString":v="LineString";break;case"MultiPolygon":v="Polygon";break}for(var S=0;S<e.coordinates.length;S++){var L=e.coordinates[S],k={type:v,coordinates:L};if(t(qs(k,o),i,S)===!1)return!1}})}function _w(n,t){W0(n,function(e,i,o){var u=0;if(!!e.geometry){var s=e.geometry.type;if(!(s==="Point"||s==="MultiPoint")){var y,v=0,S=0,L=0;if(Vf(e,function(k,N,Q,tt,xt){if(y===void 0||i>v||tt>S||xt>L){y=k,v=i,S=tt,L=xt,u=0;return}var mt=Yi([y,k],e.properties);if(t(mt,i,o,xt,u)===!1)return!1;u++,y=k})===!1)return!1}}})}function vw(n,t,e){var i=e,o=!1;return _w(n,function(u,s,y,v,S){o===!1&&e===void 0?i=u:i=t(i,u,s,y,v,S),o=!0}),i}function zr(n){var t=[1/0,1/0,-1/0,-1/0];return Vf(n,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}zr.default=zr;function ni(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function _g(n){if(Array.isArray(n))return n;if(n.type==="Feature"){if(n.geometry!==null)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function pc(n){return n.type==="Feature"?n.geometry:n}function xw(n,t){return n.type==="FeatureCollection"?"FeatureCollection":n.type==="GeometryCollection"?"GeometryCollection":n.type==="Feature"&&n.geometry!==null?n.geometry.type:n.type}function bw(n,t,e){if(e===void 0&&(e={}),!n)throw new Error("point is required");if(!t)throw new Error("polygon is required");var i=ni(n),o=pc(t),u=o.type,s=t.bbox,y=o.coordinates;if(s&&ww(i,s)===!1)return!1;u==="Polygon"&&(y=[y]);for(var v=!1,S=0;S<y.length&&!v;S++)if(Cv(i,y[S][0],e.ignoreBoundary)){for(var L=!1,k=1;k<y[S].length&&!L;)Cv(i,y[S][k],!e.ignoreBoundary)&&(L=!0),k++;L||(v=!0)}return v}function Cv(n,t,e){var i=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var o=0,u=t.length-1;o<t.length;u=o++){var s=t[o][0],y=t[o][1],v=t[u][0],S=t[u][1],L=n[1]*(s-v)+y*(v-n[0])+S*(n[0]-s)===0&&(s-n[0])*(v-n[0])<=0&&(y-n[1])*(S-n[1])<=0;if(L)return!e;var k=y>n[1]!=S>n[1]&&n[0]<(v-s)*(n[1]-y)/(S-y)+s;k&&(i=!i)}return i}function ww(n,t){return t[0]<=n[0]&&t[1]<=n[1]&&t[2]>=n[0]&&t[3]>=n[1]}function Uf(n,t,e){e===void 0&&(e={});var i=ni(n),o=ni(t),u=Qa(o[1]-i[1]),s=Qa(o[0]-i[0]),y=Qa(i[1]),v=Qa(o[1]),S=Math.pow(Math.sin(u/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(y)*Math.cos(v);return Am(2*Math.atan2(Math.sqrt(S),Math.sqrt(1-S)),e.units)}function $e(n){if(!n)throw new Error("geojson is required");switch(n.type){case"Feature":return K0(n);case"FeatureCollection":return Ew(n);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Om(n);default:throw new Error("unknown GeoJSON type")}}function K0(n){var t={type:"Feature"};return Object.keys(n).forEach(function(e){switch(e){case"type":case"properties":case"geometry":return;default:t[e]=n[e]}}),t.properties=J0(n.properties),t.geometry=Om(n.geometry),t}function J0(n){var t={};return n&&Object.keys(n).forEach(function(e){var i=n[e];typeof i=="object"?i===null?t[e]=null:Array.isArray(i)?t[e]=i.map(function(o){return o}):t[e]=J0(i):t[e]=i}),t}function Ew(n){var t={type:"FeatureCollection"};return Object.keys(n).forEach(function(e){switch(e){case"type":case"features":return;default:t[e]=n[e]}}),t.features=n.features.map(function(e){return K0(e)}),t}function Om(n){var t={type:n.type};return n.bbox&&(t.bbox=n.bbox),n.type==="GeometryCollection"?(t.geometries=n.geometries.map(function(e){return Om(e)}),t):(t.coordinates=Q0(n.coordinates),t)}function Q0(n){var t=n;return typeof t[0]!="object"?t.slice():t.map(function(e){return Q0(e)})}var km={exports:{}},$0={exports:{}};(function(n,t){(function(e,i){n.exports=i()})(X0,function(){function e(s,y,v,S,L){i(s,y,v||0,S||s.length-1,L||u)}function i(s,y,v,S,L){for(;S>v;){if(S-v>600){var k=S-v+1,N=y-v+1,Q=Math.log(k),tt=.5*Math.exp(2*Q/3),xt=.5*Math.sqrt(Q*tt*(k-tt)/k)*(N-k/2<0?-1:1),mt=Math.max(v,Math.floor(y-N*tt/k+xt)),Ct=Math.min(S,Math.floor(y+(k-N)*tt/k+xt));i(s,y,mt,Ct,L)}var ut=s[y],Pt=v,Ft=S;for(o(s,v,y),L(s[S],ut)>0&&o(s,v,S);Pt<Ft;){for(o(s,Pt,Ft),Pt++,Ft--;L(s[Pt],ut)<0;)Pt++;for(;L(s[Ft],ut)>0;)Ft--}L(s[v],ut)===0?o(s,v,Ft):(Ft++,o(s,Ft,S)),Ft<=y&&(v=Ft+1),y<=Ft&&(S=Ft-1)}}function o(s,y,v){var S=s[y];s[y]=s[v],s[v]=S}function u(s,y){return s<y?-1:s>y?1:0}return e})})($0);km.exports=wf;km.exports.default=wf;var Sw=$0.exports;function wf(n,t){if(!(this instanceof wf))return new wf(n,t);this._maxEntries=Math.max(4,n||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),t&&this._initFormat(t),this.clear()}wf.prototype={all:function(){return this._all(this.data,[])},search:function(n){var t=this.data,e=[],i=this.toBBox;if(!cg(n,t))return e;for(var o=[],u,s,y,v;t;){for(u=0,s=t.children.length;u<s;u++)y=t.children[u],v=t.leaf?i(y):y,cg(n,v)&&(t.leaf?e.push(y):im(n,v)?this._all(y,e):o.push(y));t=o.pop()}return e},collides:function(n){var t=this.data,e=this.toBBox;if(!cg(n,t))return!1;for(var i=[],o,u,s,y;t;){for(o=0,u=t.children.length;o<u;o++)if(s=t.children[o],y=t.leaf?e(s):s,cg(n,y)){if(t.leaf||im(n,y))return!0;i.push(s)}t=i.pop()}return!1},load:function(n){if(!(n&&n.length))return this;if(n.length<this._minEntries){for(var t=0,e=n.length;t<e;t++)this.insert(n[t]);return this}var i=this._build(n.slice(),0,n.length-1,0);if(!this.data.children.length)this.data=i;else if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var o=this.data;this.data=i,i=o}this._insert(i,this.data.height-i.height-1,!0)}return this},insert:function(n){return n&&this._insert(n,this.data.height-1),this},clear:function(){return this.data=Rh([]),this},remove:function(n,t){if(!n)return this;for(var e=this.data,i=this.toBBox(n),o=[],u=[],s,y,v,S;e||o.length;){if(e||(e=o.pop(),y=o[o.length-1],s=u.pop(),S=!0),e.leaf&&(v=Iw(n,e.children,t),v!==-1))return e.children.splice(v,1),o.push(e),this._condense(o),this;!S&&!e.leaf&&im(e,i)?(o.push(e),u.push(s),s=0,y=e,e=e.children[0]):y?(s++,e=y.children[s],S=!1):e=null}return this},toBBox:function(n){return n},compareMinX:Lv,compareMinY:Pv,toJSON:function(){return this.data},fromJSON:function(n){return this.data=n,this},_all:function(n,t){for(var e=[];n;)n.leaf?t.push.apply(t,n.children):e.push.apply(e,n.children),n=e.pop();return t},_build:function(n,t,e,i){var o=e-t+1,u=this._maxEntries,s;if(o<=u)return s=Rh(n.slice(t,e+1)),Dh(s,this.toBBox),s;i||(i=Math.ceil(Math.log(o)/Math.log(u)),u=Math.ceil(o/Math.pow(u,i-1))),s=Rh([]),s.leaf=!1,s.height=i;var y=Math.ceil(o/u),v=y*Math.ceil(Math.sqrt(u)),S,L,k,N;for(Tv(n,t,e,v,this.compareMinX),S=t;S<=e;S+=v)for(k=Math.min(S+v-1,e),Tv(n,S,k,y,this.compareMinY),L=S;L<=k;L+=y)N=Math.min(L+y-1,k),s.children.push(this._build(n,L,N,i-1));return Dh(s,this.toBBox),s},_chooseSubtree:function(n,t,e,i){for(var o,u,s,y,v,S,L,k;i.push(t),!(t.leaf||i.length-1===e);){for(L=k=1/0,o=0,u=t.children.length;o<u;o++)s=t.children[o],v=rm(s),S=Cw(n,s)-v,S<k?(k=S,L=v<L?v:L,y=s):S===k&&v<L&&(L=v,y=s);t=y||t.children[0]}return t},_insert:function(n,t,e){var i=this.toBBox,o=e?n:i(n),u=[],s=this._chooseSubtree(o,this.data,t,u);for(s.children.push(n),yf(s,o);t>=0&&u[t].children.length>this._maxEntries;)this._split(u,t),t--;this._adjustParentBBoxes(o,u,t)},_split:function(n,t){var e=n[t],i=e.children.length,o=this._minEntries;this._chooseSplitAxis(e,o,i);var u=this._chooseSplitIndex(e,o,i),s=Rh(e.children.splice(u,e.children.length-u));s.height=e.height,s.leaf=e.leaf,Dh(e,this.toBBox),Dh(s,this.toBBox),t?n[t-1].children.push(s):this._splitRoot(e,s)},_splitRoot:function(n,t){this.data=Rh([n,t]),this.data.height=n.height+1,this.data.leaf=!1,Dh(this.data,this.toBBox)},_chooseSplitIndex:function(n,t,e){var i,o,u,s,y,v,S,L;for(v=S=1/0,i=t;i<=e-t;i++)o=gf(n,0,i,this.toBBox),u=gf(n,i,e,this.toBBox),s=Lw(o,u),y=rm(o)+rm(u),s<v?(v=s,L=i,S=y<S?y:S):s===v&&y<S&&(S=y,L=i);return L},_chooseSplitAxis:function(n,t,e){var i=n.leaf?this.compareMinX:Lv,o=n.leaf?this.compareMinY:Pv,u=this._allDistMargin(n,t,e,i),s=this._allDistMargin(n,t,e,o);u<s&&n.children.sort(i)},_allDistMargin:function(n,t,e,i){n.children.sort(i);var o=this.toBBox,u=gf(n,0,t,o),s=gf(n,e-t,e,o),y=lg(u)+lg(s),v,S;for(v=t;v<e-t;v++)S=n.children[v],yf(u,n.leaf?o(S):S),y+=lg(u);for(v=e-t-1;v>=t;v--)S=n.children[v],yf(s,n.leaf?o(S):S),y+=lg(s);return y},_adjustParentBBoxes:function(n,t,e){for(var i=e;i>=0;i--)yf(t[i],n)},_condense:function(n){for(var t=n.length-1,e;t>=0;t--)n[t].children.length===0?t>0?(e=n[t-1].children,e.splice(e.indexOf(n[t]),1)):this.clear():Dh(n[t],this.toBBox)},_initFormat:function(n){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(n[0])),this.compareMinY=new Function("a","b",t.join(n[1])),this.toBBox=new Function("a","return {minX: a"+n[0]+", minY: a"+n[1]+", maxX: a"+n[2]+", maxY: a"+n[3]+"};")}};function Iw(n,t,e){if(!e)return t.indexOf(n);for(var i=0;i<t.length;i++)if(e(n,t[i]))return i;return-1}function Dh(n,t){gf(n,0,n.children.length,t,n)}function gf(n,t,e,i,o){o||(o=Rh(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var u=t,s;u<e;u++)s=n.children[u],yf(o,n.leaf?i(s):s);return o}function yf(n,t){return n.minX=Math.min(n.minX,t.minX),n.minY=Math.min(n.minY,t.minY),n.maxX=Math.max(n.maxX,t.maxX),n.maxY=Math.max(n.maxY,t.maxY),n}function Lv(n,t){return n.minX-t.minX}function Pv(n,t){return n.minY-t.minY}function rm(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function lg(n){return n.maxX-n.minX+(n.maxY-n.minY)}function Cw(n,t){return(Math.max(t.maxX,n.maxX)-Math.min(t.minX,n.minX))*(Math.max(t.maxY,n.maxY)-Math.min(t.minY,n.minY))}function Lw(n,t){var e=Math.max(n.minX,t.minX),i=Math.max(n.minY,t.minY),o=Math.min(n.maxX,t.maxX),u=Math.min(n.maxY,t.maxY);return Math.max(0,o-e)*Math.max(0,u-i)}function im(n,t){return n.minX<=t.minX&&n.minY<=t.minY&&t.maxX<=n.maxX&&t.maxY<=n.maxY}function cg(n,t){return t.minX<=n.maxX&&t.minY<=n.maxY&&t.maxX>=n.minX&&t.maxY>=n.minY}function Rh(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Tv(n,t,e,i,o){for(var u=[t,e],s;u.length;)e=u.pop(),t=u.pop(),!(e-t<=i)&&(s=t+Math.ceil((e-t)/i/2)*i,Sw(n,s,t,e,o),u.push(t,s,s,e))}var tx=km.exports;function fc(n,t){t===void 0&&(t={});var e=typeof t=="object"?t.mutate:t;if(!n)throw new Error("geojson is required");var i=xw(n),o=[];switch(i){case"LineString":o=nm(n);break;case"MultiLineString":case"Polygon":_g(n).forEach(function(s){o.push(nm(s))});break;case"MultiPolygon":_g(n).forEach(function(s){var y=[];s.forEach(function(v){y.push(nm(v))}),o.push(y)});break;case"Point":return n;case"MultiPoint":var u={};_g(n).forEach(function(s){var y=s.join("-");Object.prototype.hasOwnProperty.call(u,y)||(o.push(s),u[y]=!0)});break;default:throw new Error(i+" geometry not supported")}return n.coordinates?e===!0?(n.coordinates=o,n):{type:i,coordinates:o}:e===!0?(n.geometry.coordinates=o,n):qs({type:i,coordinates:o},n.properties,{bbox:n.bbox,id:n.id})}function nm(n){var t=_g(n);if(t.length===2&&!Mv(t[0],t[1]))return t;var e=[],i=t.length-1,o=e.length;e.push(t[0]);for(var u=1;u<i;u++){var s=e[e.length-1];t[u][0]===s[0]&&t[u][1]===s[1]||(e.push(t[u]),o=e.length,o>2&&Av(e[o-3],e[o-1],e[o-2])&&e.splice(e.length-2,1))}if(e.push(t[t.length-1]),o=e.length,Mv(t[0],t[t.length-1])&&o<4)throw new Error("invalid polygon");return Av(e[o-3],e[o-1],e[o-2])&&e.splice(e.length-2,1),e}function Mv(n,t){return n[0]===t[0]&&n[1]===t[1]}function Av(n,t,e){var i=e[0],o=e[1],u=n[0],s=n[1],y=t[0],v=t[1],S=i-u,L=o-s,k=y-u,N=v-s,Q=S*N-L*k;return Q!==0?!1:Math.abs(k)>=Math.abs(N)?k>0?u<=i&&i<=y:y<=i&&i<=u:N>0?s<=o&&o<=v:v<=o&&o<=s}function Xr(n,t){t===void 0&&(t={});var e=Number(n[0]),i=Number(n[1]),o=Number(n[2]),u=Number(n[3]);if(n.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var s=[e,i],y=[e,u],v=[o,u],S=[o,i];return es([[s,S,v,y,s]],t.properties,{bbox:n,id:t.id})}function ex(n,t,e,i){i===void 0&&(i={});var o=ni(n),u=Qa(o[0]),s=Qa(o[1]),y=Qa(e),v=Dm(t,i.units),S=Math.asin(Math.sin(s)*Math.cos(v)+Math.cos(s)*Math.sin(v)*Math.cos(y)),L=u+Math.atan2(Math.sin(y)*Math.sin(v)*Math.cos(s),Math.cos(v)-Math.sin(s)*Math.sin(S)),k=_m(L),N=_m(S);return Me([k,N],i.properties)}function jg(n,t,e){e===void 0&&(e={});for(var i=e.steps||64,o=e.properties?e.properties:!Array.isArray(n)&&n.type==="Feature"&&n.properties?n.properties:{},u=[],s=0;s<i;s++)u.push(ex(n,t,s*-360/i,e).geometry.coordinates);return u.push(u[0]),es([u],o)}function Ef(n,t,e){if(e===void 0&&(e={}),e.final===!0)return Pw(n,t);var i=ni(n),o=ni(t),u=Qa(i[0]),s=Qa(o[0]),y=Qa(i[1]),v=Qa(o[1]),S=Math.sin(s-u)*Math.cos(v),L=Math.cos(y)*Math.sin(v)-Math.sin(y)*Math.cos(v)*Math.cos(s-u);return _m(Math.atan2(S,L))}function Pw(n,t){var e=Ef(t,n);return e=(e+180)%360,e}function rx(n,t){t===void 0&&(t={});var e=zr(n),i=(e[0]+e[2])/2,o=(e[1]+e[3])/2;return Me([i,o],t.properties,t)}function Tn(n,t){t===void 0&&(t={});var e=0,i=0,o=0;return Vf(n,function(u){e+=u[0],i+=u[1],o++},!0),Me([e/o,i/o],t.properties)}function Gg(n){var t={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return Cg(n,function(e){var i,o,u,s;switch((s=e.geometry)===null||s===void 0?void 0:s.type){case"Point":t.MultiPoint.coordinates.push(e.geometry.coordinates),t.MultiPoint.properties.push(e.properties);break;case"MultiPoint":(i=t.MultiPoint.coordinates).push.apply(i,e.geometry.coordinates),t.MultiPoint.properties.push(e.properties);break;case"LineString":t.MultiLineString.coordinates.push(e.geometry.coordinates),t.MultiLineString.properties.push(e.properties);break;case"MultiLineString":(o=t.MultiLineString.coordinates).push.apply(o,e.geometry.coordinates),t.MultiLineString.properties.push(e.properties);break;case"Polygon":t.MultiPolygon.coordinates.push(e.geometry.coordinates),t.MultiPolygon.properties.push(e.properties);break;case"MultiPolygon":(u=t.MultiPolygon.coordinates).push.apply(u,e.geometry.coordinates),t.MultiPolygon.properties.push(e.properties);break}}),Ir(Object.keys(t).filter(function(e){return t[e].coordinates.length}).sort().map(function(e){var i={type:e,coordinates:t[e].coordinates},o={collectedProperties:t[e].properties};return qs(i,o)}))}function Tw(n,t,e){e===void 0&&(e={});var i=ni(n),o=ni(t);o[0]+=o[0]-i[0]>180?-360:i[0]-o[0]>180?360:0;var u=Mw(i,o),s=yw(u,"meters",e.units);return s}function Mw(n,t,e){e=e===void 0?no:Number(e);var i=e,o=n[1]*Math.PI/180,u=t[1]*Math.PI/180,s=u-o,y=Math.abs(t[0]-n[0])*Math.PI/180;y>Math.PI&&(y-=2*Math.PI);var v=Math.log(Math.tan(u/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),S=Math.abs(v)>1e-11?s/v:Math.cos(o),L=Math.sqrt(s*s+S*S*y*y),k=L*i;return k}var Dv=6378137;function dc(n){return mw(n,function(t,e){return t+Aw(e)},0)}function Aw(n){var t=0,e;switch(n.type){case"Polygon":return Ov(n.coordinates);case"MultiPolygon":for(e=0;e<n.coordinates.length;e++)t+=Ov(n.coordinates[e]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function Ov(n){var t=0;if(n&&n.length>0){t+=Math.abs(kv(n[0]));for(var e=1;e<n.length;e++)t-=Math.abs(kv(n[e]))}return t}function kv(n){var t,e,i,o,u,s,y,v=0,S=n.length;if(S>2){for(y=0;y<S;y++)y===S-2?(o=S-2,u=S-1,s=0):y===S-1?(o=S-1,u=0,s=1):(o=y,u=y+1,s=y+2),t=n[o],e=n[u],i=n[s],v+=(om(i[0])-om(t[0]))*Math.sin(om(e[1]));v=v*Dv*Dv/2}return v}function om(n){return n*Math.PI/180}function ix(n,t,e){e===void 0&&(e={});for(var i=pc(n),o=i.coordinates,u=0,s=0;s<o.length&&!(t>=u&&s===o.length-1);s++)if(u>=t){var y=t-u;if(y){var v=Ef(o[s],o[s-1])-180,S=ex(o[s],y,v,e);return S}else return Me(o[s])}else u+=Uf(o[s],o[s+1],e);return Me(o[o.length-1])}function Nm(n,t){return t===void 0&&(t={}),vw(n,function(e,i){var o=i.geometry.coordinates;return e+Uf(o[0],o[1],t)},0)}function Dw(n,t,e){if(n.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");e===void 0&&(e=1);var i=n.geometry.coordinates,o=[],u={};if(e){for(var s=[],y=0;y<i.length;y++)for(var v=0;v<i[y].length-1;v++)s.push(mt(y,v));var S=tx();S.load(s)}for(var L=0;L<i.length;L++)for(var k=0;k<i[L].length-1;k++)if(e){var N=S.search(mt(L,k));N.forEach(function(Ct){var ut=Ct.ring,Pt=Ct.edge;xt(L,k,ut,Pt)})}else for(var Q=0;Q<i.length;Q++)for(var tt=0;tt<i[Q].length-1;tt++)xt(L,k,Q,tt);return t||(o={type:"Feature",geometry:{type:"MultiPoint",coordinates:o}}),o;function xt(Ct,ut,Pt,Ft){var ie=i[Ct][ut],ne=i[Ct][ut+1],ae=i[Pt][Ft],de=i[Pt][Ft+1],$t=Ow(ie,ne,ae,de);if($t!==null){var Be,Ce;if(ne[0]!==ie[0]?Be=($t[0]-ie[0])/(ne[0]-ie[0]):Be=($t[1]-ie[1])/(ne[1]-ie[1]),de[0]!==ae[0]?Ce=($t[0]-ae[0])/(de[0]-ae[0]):Ce=($t[1]-ae[1])/(de[1]-ae[1]),!(Be>=1||Be<=0||Ce>=1||Ce<=0)){var er=$t,Le=!u[er];Le&&(u[er]=!0),t?o.push(t($t,Ct,ut,ie,ne,Be,Pt,Ft,ae,de,Ce,Le)):o.push($t)}}}function mt(Ct,ut){var Pt=i[Ct][ut],Ft=i[Ct][ut+1],ie,ne,ae,de;return Pt[0]<Ft[0]?(ie=Pt[0],ne=Ft[0]):(ie=Ft[0],ne=Pt[0]),Pt[1]<Ft[1]?(ae=Pt[1],de=Ft[1]):(ae=Ft[1],de=Pt[1]),{minX:ie,minY:ae,maxX:ne,maxY:de,ring:Ct,edge:ut}}}function Ow(n,t,e,i){if(mf(n,e)||mf(n,i)||mf(t,e)||mf(i,e))return null;var o=n[0],u=n[1],s=t[0],y=t[1],v=e[0],S=e[1],L=i[0],k=i[1],N=(o-s)*(S-k)-(u-y)*(v-L);if(N===0)return null;var Q=((o*y-u*s)*(v-L)-(o-s)*(v*k-S*L))/N,tt=((o*y-u*s)*(S-k)-(u-y)*(v*k-S*L))/N;return[Q,tt]}function mf(n,t){if(!n||!t||n.length!==t.length)return!1;for(var e=0,i=n.length;e<i;e++)if(n[e]instanceof Array&&t[e]instanceof Array){if(!mf(n[e],t[e]))return!1}else if(n[e]!==t[e])return!1;return!0}function kw(n){if(n.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(n.geometry===void 0||n.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(n.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var t=n.geometry.coordinates.length,e=[],ut=0;ut<t;ut++){var i=n.geometry.coordinates[ut];_f(i[0],i[i.length-1])||i.push(i[0]),e.push.apply(e,i.slice(0,i.length-1))}if(!Rw(e))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var o=e.length,u=Dw(n,function(wr,Dr,So,Yr,Yo,_r,Io,ps,co,qe,ga,hn){return[wr,Dr,So,Yr,Yo,_r,Io,ps,co,qe,ga,hn]}),s=u.length;if(s==0){for(var ae=[],ut=0;ut<t;ut++)ae.push(es([n.geometry.coordinates[ut]],{parent:-1,winding:Nw(n.geometry.coordinates[ut])}));var or=Ir(ae);return cn(),$r(),or}for(var y=[],v=[],ut=0;ut<t;ut++){y.push([]);for(var S=0;S<n.geometry.coordinates[ut].length-1;S++)y[ut].push([new Nv(n.geometry.coordinates[ut][zh(S+1,n.geometry.coordinates[ut].length-1)],1,[ut,S],[ut,zh(S+1,n.geometry.coordinates[ut].length-1)],void 0)]),v.push(new Rv(n.geometry.coordinates[ut][S],[ut,zh(S-1,n.geometry.coordinates[ut].length-1)],[ut,S],void 0,void 0,!1,!0))}for(var ut=0;ut<s;ut++)y[u[ut][1]][u[ut][2]].push(new Nv(u[ut][0],u[ut][5],[u[ut][1],u[ut][2]],[u[ut][6],u[ut][7]],void 0)),u[ut][11]&&v.push(new Rv(u[ut][0],[u[ut][1],u[ut][2]],[u[ut][6],u[ut][7]],void 0,void 0,!0,!0));for(var L=v.length,ut=0;ut<y.length;ut++)for(var S=0;S<y[ut].length;S++)y[ut][S].sort(function(Dr,So){return Dr.param<So.param?-1:1});for(var k=[],ut=0;ut<L;ut++)k.push({minX:v[ut].coord[0],minY:v[ut].coord[1],maxX:v[ut].coord[0],maxY:v[ut].coord[1],index:ut});var N=tx();N.load(k);for(var ut=0;ut<y.length;ut++)for(var S=0;S<y[ut].length;S++)for(var Q=0;Q<y[ut][S].length;Q++){var tt;Q==y[ut][S].length-1?tt=y[ut][zh(S+1,n.geometry.coordinates[ut].length-1)][0].coord:tt=y[ut][S][Q+1].coord;var xt=N.search({minX:tt[0],minY:tt[1],maxX:tt[0],maxY:tt[1]})[0];y[ut][S][Q].nxtIsectAlongEdgeIn=xt.index}for(var ut=0;ut<y.length;ut++)for(var S=0;S<y[ut].length;S++)for(var Q=0;Q<y[ut][S].length;Q++){var tt=y[ut][S][Q].coord,xt=N.search({minX:tt[0],minY:tt[1],maxX:tt[0],maxY:tt[1]})[0],mt=xt.index;mt<o?v[mt].nxtIsectAlongRingAndEdge2=y[ut][S][Q].nxtIsectAlongEdgeIn:_f(v[mt].ringAndEdge1,y[ut][S][Q].ringAndEdgeIn)?v[mt].nxtIsectAlongRingAndEdge1=y[ut][S][Q].nxtIsectAlongEdgeIn:v[mt].nxtIsectAlongRingAndEdge2=y[ut][S][Q].nxtIsectAlongEdgeIn}for(var Ct=[],ut=0,S=0;S<t;S++){for(var Pt=ut,Q=0;Q<n.geometry.coordinates[S].length-1;Q++)v[ut].coord[0]<v[Pt].coord[0]&&(Pt=ut),ut++;for(var Ft=v[Pt].nxtIsectAlongRingAndEdge2,Q=0;Q<v.length;Q++)if(v[Q].nxtIsectAlongRingAndEdge1==Pt||v[Q].nxtIsectAlongRingAndEdge2==Pt){var ie=Q;break}var ne=vg([v[ie].coord,v[Pt].coord,v[Ft].coord],!0)?1:-1;Ct.push({isect:Pt,parent:-1,winding:ne})}Ct.sort(function(ar,wr){return v[ar.isect].coord>v[wr.isect].coord?-1:1});for(var ae=[];Ct.length>0;){var de=Ct.pop(),$t=de.isect,Be=de.parent,Ce=de.winding,er=ae.length,Le=[v[$t].coord],Ut=$t;if(v[$t].ringAndEdge1Walkable)var Fe=v[$t].ringAndEdge1,ye=v[$t].nxtIsectAlongRingAndEdge1;else var Fe=v[$t].ringAndEdge2,ye=v[$t].nxtIsectAlongRingAndEdge2;for(;!_f(v[$t].coord,v[ye].coord);){Le.push(v[ye].coord);for(var Ar=void 0,ut=0;ut<Ct.length;ut++)if(Ct[ut].isect==ye){Ar=ut;break}if(Ar!=null&&Ct.splice(Ar,1),_f(Fe,v[ye].ringAndEdge1)){if(Fe=v[ye].ringAndEdge2,v[ye].ringAndEdge2Walkable=!1,v[ye].ringAndEdge1Walkable){var mr={isect:ye};vg([v[Ut].coord,v[ye].coord,v[v[ye].nxtIsectAlongRingAndEdge2].coord],Ce==1)?(mr.parent=Be,mr.winding=-Ce):(mr.parent=er,mr.winding=Ce),Ct.push(mr)}Ut=ye,ye=v[ye].nxtIsectAlongRingAndEdge2}else{if(Fe=v[ye].ringAndEdge1,v[ye].ringAndEdge1Walkable=!1,v[ye].ringAndEdge2Walkable){var mr={isect:ye};vg([v[Ut].coord,v[ye].coord,v[v[ye].nxtIsectAlongRingAndEdge1].coord],Ce==1)?(mr.parent=Be,mr.winding=-Ce):(mr.parent=er,mr.winding=Ce),Ct.push(mr)}Ut=ye,ye=v[ye].nxtIsectAlongRingAndEdge1}}Le.push(v[ye].coord),ae.push(es([Le],{index:er,parent:Be,winding:Ce,netWinding:void 0}))}var or=Ir(ae);cn(),$r();function cn(){for(var ar=[],wr=0;wr<or.features.length;wr++)or.features[wr].properties.parent==-1&&ar.push(wr);if(ar.length>1)for(var wr=0;wr<ar.length;wr++){for(var Dr=-1,So=1/0,Yr=0;Yr<or.features.length;Yr++)ar[wr]!=Yr&&bw(or.features[ar[wr]].geometry.coordinates[0][0],or.features[Yr],{ignoreBoundary:!0})&&dc(or.features[Yr])<So&&(Dr=Yr);or.features[ar[wr]].properties.parent=Dr}}function $r(){for(var ar=0;ar<or.features.length;ar++)if(or.features[ar].properties.parent==-1){var wr=or.features[ar].properties.winding;or.features[ar].properties.netWinding=wr,Li(ar,wr)}}function Li(ar,wr){for(var Dr=0;Dr<or.features.length;Dr++)if(or.features[Dr].properties.parent==ar){var So=wr+or.features[Dr].properties.winding;or.features[Dr].properties.netWinding=So,Li(Dr,So)}}return or}var Nv=function(n,t,e,i,o){this.coord=n,this.param=t,this.ringAndEdgeIn=e,this.ringAndEdgeOut=i,this.nxtIsectAlongEdgeIn=o},Rv=function(n,t,e,i,o,u,s){this.coord=n,this.ringAndEdge1=t,this.ringAndEdge2=e,this.nxtIsectAlongRingAndEdge1=i,this.nxtIsectAlongRingAndEdge2=o,this.ringAndEdge1Walkable=u,this.ringAndEdge2Walkable=s};function vg(n,t){if(typeof t=="undefined"&&(t=!0),n.length!=3)throw new Error("This function requires an array of three points [x,y]");var e=(n[1][0]-n[0][0])*(n[2][1]-n[0][1])-(n[1][1]-n[0][1])*(n[2][0]-n[0][0]);return e>=0==t}function Nw(n){for(var t=0,e=0;e<n.length-1;e++)n[e][0]<n[t][0]&&(t=e);if(vg([n[zh(t-1,n.length-1)],n[t],n[zh(t+1,n.length-1)]],!0))var i=1;else var i=-1;return i}function _f(n,t){if(!n||!t||n.length!=t.length)return!1;for(var e=0,i=n.length;e<i;e++)if(n[e]instanceof Array&&t[e]instanceof Array){if(!_f(n[e],t[e]))return!1}else if(n[e]!=t[e])return!1;return!0}function zh(n,t){return(n%t+t)%t}function Rw(n){for(var t={},e=1,i=0,o=n.length;i<o;++i){if(Object.prototype.hasOwnProperty.call(t,n[i])){e=0;break}t[n[i]]=1}return e}function Hg(n){var t=[];return W0(n,function(e){e.geometry.type==="Polygon"&&Cg(kw(e),function(i){t.push(es(i.geometry.coordinates,e.properties))})}),Ir(t)}function Fw(n,t){t===void 0&&(t={});var e=pc(n);switch(!t.properties&&n.type==="Feature"&&(t.properties=n.properties),e.type){case"Polygon":return zw(e,t);case"MultiPolygon":return Bw(e,t);default:throw new Error("invalid poly")}}function zw(n,t){t===void 0&&(t={});var e=pc(n),i=e.coordinates,o=t.properties?t.properties:n.type==="Feature"?n.properties:{};return nx(i,o)}function Bw(n,t){t===void 0&&(t={});var e=pc(n),i=e.coordinates,o=t.properties?t.properties:n.type==="Feature"?n.properties:{},u=[];return i.forEach(function(s){u.push(nx(s,o))}),Ir(u)}function nx(n,t){return n.length>1?gw(n,t):Yi(n[0],t)}var Fv=Object.prototype.toString,ox=function(t){var e=Fv.call(t),i=e==="[object Arguments]";return i||(i=e!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&Fv.call(t.callee)==="[object Function]"),i},ax;if(!Object.keys){var hg=Object.prototype.hasOwnProperty,zv=Object.prototype.toString,Vw=ox,Bv=Object.prototype.propertyIsEnumerable,Uw=!Bv.call({toString:null},"toString"),qw=Bv.call(function(){},"prototype"),pg=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],am=function(n){var t=n.constructor;return t&&t.prototype===n},jw={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},Gw=function(){if(typeof window=="undefined")return!1;for(var n in window)try{if(!jw["$"+n]&&hg.call(window,n)&&window[n]!==null&&typeof window[n]=="object")try{am(window[n])}catch{return!0}}catch{return!0}return!1}(),Hw=function(n){if(typeof window=="undefined"||!Gw)return am(n);try{return am(n)}catch{return!1}};ax=function(t){var e=t!==null&&typeof t=="object",i=zv.call(t)==="[object Function]",o=Vw(t),u=e&&zv.call(t)==="[object String]",s=[];if(!e&&!i&&!o)throw new TypeError("Object.keys called on a non-object");var y=qw&&i;if(u&&t.length>0&&!hg.call(t,0))for(var v=0;v<t.length;++v)s.push(String(v));if(o&&t.length>0)for(var S=0;S<t.length;++S)s.push(String(S));else for(var L in t)!(y&&L==="prototype")&&hg.call(t,L)&&s.push(String(L));if(Uw)for(var k=Hw(t),N=0;N<pg.length;++N)!(k&&pg[N]==="constructor")&&hg.call(t,pg[N])&&s.push(pg[N]);return s}}var Xw=ax,Zw=Array.prototype.slice,Yw=ox,Vv=Object.keys,xg=Vv?function(t){return Vv(t)}:Xw,Uv=Object.keys;xg.shim=function(){if(Object.keys){var t=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);t||(Object.keys=function(i){return Yw(i)?Uv(Zw.call(i)):Uv(i)})}else Object.keys=xg;return Object.keys||xg};var sx=xg,ux=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),i=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var o=42;t[e]=o;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var u=Object.getOwnPropertySymbols(t);if(u.length!==1||u[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(t,e);if(s.value!==o||s.enumerable!==!0)return!1}return!0},Ww=ux,Rm=function(){return Ww()&&!!Symbol.toStringTag},Kw=Error,Jw=EvalError,Qw=RangeError,$w=ReferenceError,lx=SyntaxError,lp=TypeError,tE=URIError,qv=typeof Symbol!="undefined"&&Symbol,eE=ux,rE=function(){return typeof qv!="function"||typeof Symbol!="function"||typeof qv("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:eE()},sm={__proto__:null,foo:{}},iE=Object,nE=function(){return{__proto__:sm}.foo===sm.foo&&!(sm instanceof iE)},oE="Function.prototype.bind called on incompatible ",aE=Object.prototype.toString,sE=Math.max,uE="[object Function]",jv=function(t,e){for(var i=[],o=0;o<t.length;o+=1)i[o]=t[o];for(var u=0;u<e.length;u+=1)i[u+t.length]=e[u];return i},lE=function(t,e){for(var i=[],o=e||0,u=0;o<t.length;o+=1,u+=1)i[u]=t[o];return i},cE=function(n,t){for(var e="",i=0;i<n.length;i+=1)e+=n[i],i+1<n.length&&(e+=t);return e},hE=function(t){var e=this;if(typeof e!="function"||aE.apply(e)!==uE)throw new TypeError(oE+e);for(var i=lE(arguments,1),o,u=function(){if(this instanceof o){var L=e.apply(this,jv(i,arguments));return Object(L)===L?L:this}return e.apply(t,jv(i,arguments))},s=sE(0,e.length-i.length),y=[],v=0;v<s;v++)y[v]="$"+v;if(o=Function("binder","return function ("+cE(y,",")+"){ return binder.apply(this,arguments); }")(u),e.prototype){var S=function(){};S.prototype=e.prototype,o.prototype=new S,S.prototype=null}return o},pE=hE,Fm=Function.prototype.bind||pE,fE=Function.prototype.call,dE=Object.prototype.hasOwnProperty,gE=Fm,yE=gE.call(fE,dE),yr,mE=Kw,_E=Jw,vE=Qw,xE=$w,Uh=lx,Vh=lp,bE=tE,cx=Function,um=function(n){try{return cx('"use strict"; return ('+n+").constructor;")()}catch{}},cc=Object.getOwnPropertyDescriptor;if(cc)try{cc({},"")}catch{cc=null}var lm=function(){throw new Vh},wE=cc?function(){try{return arguments.callee,lm}catch{try{return cc(arguments,"callee").get}catch{return lm}}}():lm,Oh=rE(),EE=nE(),Pn=Object.getPrototypeOf||(EE?function(n){return n.__proto__}:null),Fh={},SE=typeof Uint8Array=="undefined"||!Pn?yr:Pn(Uint8Array),hc={__proto__:null,"%AggregateError%":typeof AggregateError=="undefined"?yr:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?yr:ArrayBuffer,"%ArrayIteratorPrototype%":Oh&&Pn?Pn([][Symbol.iterator]()):yr,"%AsyncFromSyncIteratorPrototype%":yr,"%AsyncFunction%":Fh,"%AsyncGenerator%":Fh,"%AsyncGeneratorFunction%":Fh,"%AsyncIteratorPrototype%":Fh,"%Atomics%":typeof Atomics=="undefined"?yr:Atomics,"%BigInt%":typeof BigInt=="undefined"?yr:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?yr:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?yr:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?yr:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":mE,"%eval%":eval,"%EvalError%":_E,"%Float32Array%":typeof Float32Array=="undefined"?yr:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?yr:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?yr:FinalizationRegistry,"%Function%":cx,"%GeneratorFunction%":Fh,"%Int8Array%":typeof Int8Array=="undefined"?yr:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?yr:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?yr:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Oh&&Pn?Pn(Pn([][Symbol.iterator]())):yr,"%JSON%":typeof JSON=="object"?JSON:yr,"%Map%":typeof Map=="undefined"?yr:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!Oh||!Pn?yr:Pn(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?yr:Promise,"%Proxy%":typeof Proxy=="undefined"?yr:Proxy,"%RangeError%":vE,"%ReferenceError%":xE,"%Reflect%":typeof Reflect=="undefined"?yr:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?yr:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!Oh||!Pn?yr:Pn(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?yr:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Oh&&Pn?Pn(""[Symbol.iterator]()):yr,"%Symbol%":Oh?Symbol:yr,"%SyntaxError%":Uh,"%ThrowTypeError%":wE,"%TypedArray%":SE,"%TypeError%":Vh,"%Uint8Array%":typeof Uint8Array=="undefined"?yr:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?yr:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?yr:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?yr:Uint32Array,"%URIError%":bE,"%WeakMap%":typeof WeakMap=="undefined"?yr:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?yr:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?yr:WeakSet};if(Pn)try{null.error}catch(n){var IE=Pn(Pn(n));hc["%Error.prototype%"]=IE}var CE=function n(t){var e;if(t==="%AsyncFunction%")e=um("async function () {}");else if(t==="%GeneratorFunction%")e=um("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=um("async function* () {}");else if(t==="%AsyncGenerator%"){var i=n("%AsyncGeneratorFunction%");i&&(e=i.prototype)}else if(t==="%AsyncIteratorPrototype%"){var o=n("%AsyncGenerator%");o&&Pn&&(e=Pn(o.prototype))}return hc[t]=e,e},Gv={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},qf=Fm,Lg=yE,LE=qf.call(Function.call,Array.prototype.concat),PE=qf.call(Function.apply,Array.prototype.splice),Hv=qf.call(Function.call,String.prototype.replace),Pg=qf.call(Function.call,String.prototype.slice),TE=qf.call(Function.call,RegExp.prototype.exec),ME=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,AE=/\\(\\)?/g,DE=function(t){var e=Pg(t,0,1),i=Pg(t,-1);if(e==="%"&&i!=="%")throw new Uh("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&e!=="%")throw new Uh("invalid intrinsic syntax, expected opening `%`");var o=[];return Hv(t,ME,function(u,s,y,v){o[o.length]=y?Hv(v,AE,"$1"):s||u}),o},OE=function(t,e){var i=t,o;if(Lg(Gv,i)&&(o=Gv[i],i="%"+o[0]+"%"),Lg(hc,i)){var u=hc[i];if(u===Fh&&(u=CE(i)),typeof u=="undefined"&&!e)throw new Vh("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:o,name:i,value:u}}throw new Uh("intrinsic "+t+" does not exist!")},jf=function(t,e){if(typeof t!="string"||t.length===0)throw new Vh("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new Vh('"allowMissing" argument must be a boolean');if(TE(/^%?[^%]*%?$/,t)===null)throw new Uh("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=DE(t),o=i.length>0?i[0]:"",u=OE("%"+o+"%",e),s=u.name,y=u.value,v=!1,S=u.alias;S&&(o=S[0],PE(i,LE([0,1],S)));for(var L=1,k=!0;L<i.length;L+=1){var N=i[L],Q=Pg(N,0,1),tt=Pg(N,-1);if((Q==='"'||Q==="'"||Q==="`"||tt==='"'||tt==="'"||tt==="`")&&Q!==tt)throw new Uh("property names with quotes must have matching quotes");if((N==="constructor"||!k)&&(v=!0),o+="."+N,s="%"+o+"%",Lg(hc,s))y=hc[s];else if(y!=null){if(!(N in y)){if(!e)throw new Vh("base intrinsic for "+t+" exists, but the property is not available.");return}if(cc&&L+1>=i.length){var xt=cc(y,N);k=!!xt,k&&"get"in xt&&!("originalValue"in xt.get)?y=xt.get:y=y[N]}else k=Lg(y,N),y=y[N];k&&!v&&(hc[s]=y)}}return y},Xg={exports:{}},kE=jf,bg=kE("%Object.defineProperty%",!0)||!1;if(bg)try{bg({},"a",{value:1})}catch{bg=!1}var zm=bg,NE=jf,wg=NE("%Object.getOwnPropertyDescriptor%",!0);if(wg)try{wg([],"length")}catch{wg=null}var hx=wg,Xv=zm,RE=lx,kh=lp,Zv=hx,Bm=function(t,e,i){if(!t||typeof t!="object"&&typeof t!="function")throw new kh("`obj` must be an object or a function`");if(typeof e!="string"&&typeof e!="symbol")throw new kh("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new kh("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new kh("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new kh("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new kh("`loose`, if provided, must be a boolean");var o=arguments.length>3?arguments[3]:null,u=arguments.length>4?arguments[4]:null,s=arguments.length>5?arguments[5]:null,y=arguments.length>6?arguments[6]:!1,v=!!Zv&&Zv(t,e);if(Xv)Xv(t,e,{configurable:s===null&&v?v.configurable:!s,enumerable:o===null&&v?v.enumerable:!o,value:i,writable:u===null&&v?v.writable:!u});else if(y||!o&&!u&&!s)t[e]=i;else throw new RE("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},vm=zm,px=function(){return!!vm};px.hasArrayLengthDefineBug=function(){if(!vm)return null;try{return vm([],"length",{value:1}).length!==1}catch{return!0}};var Vm=px,FE=jf,Yv=Bm,zE=Vm(),Wv=hx,Kv=lp,BE=FE("%Math.floor%"),VE=function(t,e){if(typeof t!="function")throw new Kv("`fn` is not a function");if(typeof e!="number"||e<0||e>4294967295||BE(e)!==e)throw new Kv("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],o=!0,u=!0;if("length"in t&&Wv){var s=Wv(t,"length");s&&!s.configurable&&(o=!1),s&&!s.writable&&(u=!1)}return(o||u||!i)&&(zE?Yv(t,"length",e,!0,!0):Yv(t,"length",e)),t};(function(n){var t=Fm,e=jf,i=VE,o=lp,u=e("%Function.prototype.apply%"),s=e("%Function.prototype.call%"),y=e("%Reflect.apply%",!0)||t.call(s,u),v=zm,S=e("%Math.max%");n.exports=function(N){if(typeof N!="function")throw new o("a function is required");var Q=y(t,s,arguments);return i(Q,1+S(0,N.length-(arguments.length-1)),!0)};var L=function(){return y(t,u,arguments)};v?v(n.exports,"apply",{value:L}):n.exports.apply=L})(Xg);var fx=jf,dx=Xg.exports,UE=dx(fx("String.prototype.indexOf")),gx=function(t,e){var i=fx(t,!!e);return typeof i=="function"&&UE(t,".prototype.")>-1?dx(i):i},qE=Rm(),jE=gx,xm=jE("Object.prototype.toString"),Zg=function(t){return qE&&t&&typeof t=="object"&&Symbol.toStringTag in t?!1:xm(t)==="[object Arguments]"},yx=function(t){return Zg(t)?!0:t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&xm(t)!=="[object Array]"&&xm(t.callee)==="[object Function]"},GE=function(){return Zg(arguments)}();Zg.isLegacyArguments=yx;var HE=GE?Zg:yx,XE=sx,ZE=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",YE=Object.prototype.toString,WE=Array.prototype.concat,Jv=Bm,KE=function(n){return typeof n=="function"&&YE.call(n)==="[object Function]"},mx=Vm(),JE=function(n,t,e,i){if(t in n){if(i===!0){if(n[t]===e)return}else if(!KE(i)||!i())return}mx?Jv(n,t,e,!0):Jv(n,t,e)},_x=function(n,t){var e=arguments.length>2?arguments[2]:{},i=XE(t);ZE&&(i=WE.call(i,Object.getOwnPropertySymbols(t)));for(var o=0;o<i.length;o+=1)JE(n,i[o],t[i[o]],e[i[o]])};_x.supportsDescriptors=!!mx;var Gf=_x,Qv=function(n){return n!==n},vx=function(t,e){return t===0&&e===0?1/t===1/e:!!(t===e||Qv(t)&&Qv(e))},QE=vx,xx=function(){return typeof Object.is=="function"?Object.is:QE},$E=xx,tS=Gf,eS=function(){var t=$E();return tS(Object,{is:t},{is:function(){return Object.is!==t}}),t},rS=Gf,iS=Xg.exports,nS=vx,bx=xx,oS=eS,wx=iS(bx(),Object);rS(wx,{getPolyfill:bx,implementation:nS,shim:oS});var aS=wx,bm=gx,Ex=Rm(),Sx,Ix,wm,Em;if(Ex){Sx=bm("Object.prototype.hasOwnProperty"),Ix=bm("RegExp.prototype.exec"),wm={};var cm=function(){throw wm};Em={toString:cm,valueOf:cm},typeof Symbol.toPrimitive=="symbol"&&(Em[Symbol.toPrimitive]=cm)}var sS=bm("Object.prototype.toString"),uS=Object.getOwnPropertyDescriptor,lS="[object RegExp]",cS=Ex?function(t){if(!t||typeof t!="object")return!1;var e=uS(t,"lastIndex"),i=e&&Sx(e,"value");if(!i)return!1;try{Ix(t,Em)}catch(o){return o===wm}}:function(t){return!t||typeof t!="object"&&typeof t!="function"?!1:sS(t)===lS},Sf=function(){return typeof function(){}.name=="string"},bf=Object.getOwnPropertyDescriptor;if(bf)try{bf([],"length")}catch{bf=null}Sf.functionsHaveConfigurableNames=function(){if(!Sf()||!bf)return!1;var t=bf(function(){},"name");return!!t&&!!t.configurable};var hS=Function.prototype.bind;Sf.boundFunctionsHaveNames=function(){return Sf()&&typeof hS=="function"&&function(){}.bind().name!==""};var pS=Sf,$v=Bm,fS=Vm(),dS=pS.functionsHaveConfigurableNames(),gS=lp,yS=function(t,e){if(typeof t!="function")throw new gS("`fn` is not a function");var i=arguments.length>2&&!!arguments[2];return(!i||dS)&&(fS?$v(t,"name",e,!0,!0):$v(t,"name",e)),t},mS=yS,_S=lp,vS=Object,Cx=mS(function(){if(this==null||this!==vS(this))throw new _S("RegExp.prototype.flags getter called on non-object");var t="";return this.hasIndices&&(t+="d"),this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.unicodeSets&&(t+="v"),this.sticky&&(t+="y"),t},"get flags",!0),xS=Cx,bS=Gf.supportsDescriptors,wS=Object.getOwnPropertyDescriptor,Lx=function(){if(bS&&/a/mig.flags==="gim"){var t=wS(RegExp.prototype,"flags");if(t&&typeof t.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var e="",i={};if(Object.defineProperty(i,"hasIndices",{get:function(){e+="d"}}),Object.defineProperty(i,"sticky",{get:function(){e+="y"}}),e==="dy")return t.get}}return xS},ES=Gf.supportsDescriptors,SS=Lx,IS=Object.getOwnPropertyDescriptor,CS=Object.defineProperty,LS=TypeError,t0=Object.getPrototypeOf,PS=/a/,TS=function(){if(!ES||!t0)throw new LS("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=SS(),e=t0(PS),i=IS(e,"flags");return(!i||i.get!==t)&&CS(e,"flags",{configurable:!0,enumerable:!1,get:t}),t},MS=Gf,AS=Xg.exports,DS=Cx,Px=Lx,OS=TS,Tx=AS(Px());MS(Tx,{getPolyfill:Px,implementation:DS,shim:OS});var kS=Tx,NS=Date.prototype.getDay,RS=function(t){try{return NS.call(t),!0}catch{return!1}},FS=Object.prototype.toString,zS="[object Date]",BS=Rm(),VS=function(t){return typeof t!="object"||t===null?!1:BS?RS(t):FS.call(t)===zS},e0=sx,r0=HE,i0=aS,n0=cS,o0=kS,a0=VS,s0=Date.prototype.getTime;function Mx(n,t,e){var i=e||{};return(i.strict?i0(n,t):n===t)?!0:!n||!t||typeof n!="object"&&typeof t!="object"?i.strict?i0(n,t):n==t:US(n,t,i)}function u0(n){return n==null}function l0(n){return!(!n||typeof n!="object"||typeof n.length!="number"||typeof n.copy!="function"||typeof n.slice!="function"||n.length>0&&typeof n[0]!="number")}function US(n,t,e){var i,o;if(typeof n!=typeof t||u0(n)||u0(t)||n.prototype!==t.prototype||r0(n)!==r0(t))return!1;var u=n0(n),s=n0(t);if(u!==s)return!1;if(u||s)return n.source===t.source&&o0(n)===o0(t);if(a0(n)&&a0(t))return s0.call(n)===s0.call(t);var y=l0(n),v=l0(t);if(y!==v)return!1;if(y||v){if(n.length!==t.length)return!1;for(i=0;i<n.length;i++)if(n[i]!==t[i])return!1;return!0}if(typeof n!=typeof t)return!1;try{var S=e0(n),L=e0(t)}catch{return!1}if(S.length!==L.length)return!1;for(S.sort(),L.sort(),i=S.length-1;i>=0;i--)if(S[i]!=L[i])return!1;for(i=S.length-1;i>=0;i--)if(o=S[i],!Mx(n[o],t[o],e))return!1;return!0}var qS=Mx,jS=qS,Ws=function(n){this.precision=n&&n.precision?n.precision:17,this.direction=n&&n.direction?n.direction:!1,this.pseudoNode=n&&n.pseudoNode?n.pseudoNode:!1,this.objectComparator=n&&n.objectComparator?n.objectComparator:GS};Ws.prototype.compare=function(n,t){if(n.type!==t.type||!Ax(n,t))return!1;switch(n.type){case"Point":return this.compareCoord(n.coordinates,t.coordinates);case"LineString":return this.compareLine(n.coordinates,t.coordinates,0,!1);case"Polygon":return this.comparePolygon(n,t);case"Feature":return this.compareFeature(n,t);default:if(n.type.indexOf("Multi")===0){var e=this,i=c0(n),o=c0(t);return i.every(function(u){return this.some(function(s){return e.compare(u,s)})},o)}}return!1};function c0(n){return n.coordinates.map(function(t){return{type:n.type.replace("Multi",""),coordinates:t}})}function Ax(n,t){return n.hasOwnProperty("coordinates")?n.coordinates.length===t.coordinates.length:n.length===t.length}Ws.prototype.compareCoord=function(n,t){if(n.length!==t.length)return!1;for(var e=0;e<n.length;e++)if(n[e].toFixed(this.precision)!==t[e].toFixed(this.precision))return!1;return!0};Ws.prototype.compareLine=function(n,t,e,i){if(!Ax(n,t))return!1;var o=this.pseudoNode?n:this.removePseudo(n),u=this.pseudoNode?t:this.removePseudo(t);if(!(i&&!this.compareCoord(o[0],u[0])&&(u=this.fixStartIndex(u,o),!u))){var s=this.compareCoord(o[e],u[e]);return this.direction||s?this.comparePath(o,u):this.compareCoord(o[e],u[u.length-(1+e)])?this.comparePath(o.slice().reverse(),u):!1}};Ws.prototype.fixStartIndex=function(n,t){for(var e,i=-1,o=0;o<n.length;o++)if(this.compareCoord(n[o],t[0])){i=o;break}return i>=0&&(e=[].concat(n.slice(i,n.length),n.slice(1,i+1))),e};Ws.prototype.comparePath=function(n,t){var e=this;return n.every(function(i,o){return e.compareCoord(i,this[o])},t)};Ws.prototype.comparePolygon=function(n,t){if(this.compareLine(n.coordinates[0],t.coordinates[0],1,!0)){var e=n.coordinates.slice(1,n.coordinates.length),i=t.coordinates.slice(1,t.coordinates.length),o=this;return e.every(function(u){return this.some(function(s){return o.compareLine(u,s,1,!0)})},i)}else return!1};Ws.prototype.compareFeature=function(n,t){return n.id!==t.id||!this.objectComparator(n.properties,t.properties)||!this.compareBBox(n,t)?!1:this.compare(n.geometry,t.geometry)};Ws.prototype.compareBBox=function(n,t){return!!(!n.bbox&&!t.bbox||n.bbox&&t.bbox&&this.compareCoord(n.bbox,t.bbox))};Ws.prototype.removePseudo=function(n){return n};function GS(n,t){return jS(n,t,{strict:!0})}var HS=Ws;function Dx(n,t){var e=pc(n).type,i=pc(t).type;if(e!==i)return!1;var o=new HS({precision:6});return o.compare(fc(n),fc(t))}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var e=Object(this),i=Math.max(Math.min(e.length,9007199254740991),0)||0,o=1 in arguments&&parseInt(Number(arguments[1]),10)||0;o=o<0?Math.max(i+o,0):Math.min(o,i);var u=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:i;for(u=u<0?Math.max(i+arguments[2],0):Math.min(u,i);o<u;)e[o]=t,++o;return e},writable:!0});Number.isFinite=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)};Number.isInteger=Number.isInteger||function(n){return typeof n=="number"&&isFinite(n)&&Math.floor(n)===n};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(n){return n!==n};Math.trunc=Math.trunc||function(n){return n<0?Math.ceil(n):Math.floor(n)};var gc=function(){};gc.prototype.interfaces_=function(){return[]};gc.prototype.getClass=function(){return gc};gc.prototype.equalsWithTolerance=function(t,e,i){return Math.abs(t-e)<=i};var Zr=function(n){function t(e){n.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=new n().stack}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t}(Error),Ae=function(){},Ox={MAX_VALUE:{configurable:!0}};Ae.isNaN=function(t){return Number.isNaN(t)};Ae.doubleToLongBits=function(t){return t};Ae.longBitsToDouble=function(t){return t};Ae.isInfinite=function(t){return!Number.isFinite(t)};Ox.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(Ae,Ox);var Xo=function(){},Yg=function(){},qh=function(){};function Zo(){}var ft=function n(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=n.NULL_ORDINATE;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.z=t.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=n.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Pc={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};ft.prototype.setOrdinate=function(t,e){switch(t){case ft.X:this.x=e;break;case ft.Y:this.y=e;break;case ft.Z:this.z=e;break;default:throw new Zr("Invalid ordinate index: "+t)}};ft.prototype.equals2D=function(){if(arguments.length===1){var t=arguments[0];return!(this.x!==t.x||this.y!==t.y)}else if(arguments.length===2){var e=arguments[0],i=arguments[1];return!(!gc.equalsWithTolerance(this.x,e.x,i)||!gc.equalsWithTolerance(this.y,e.y,i))}};ft.prototype.getOrdinate=function(t){switch(t){case ft.X:return this.x;case ft.Y:return this.y;case ft.Z:return this.z}throw new Zr("Invalid ordinate index: "+t)};ft.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||Ae.isNaN(this.z))&&Ae.isNaN(t.z)};ft.prototype.equals=function(t){return t instanceof ft?this.equals2D(t):!1};ft.prototype.equalInZ=function(t,e){return gc.equalsWithTolerance(this.z,t.z,e)};ft.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0};ft.prototype.clone=function(){};ft.prototype.copy=function(){return new ft(this)};ft.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};ft.prototype.distance3D=function(t){var e=this.x-t.x,i=this.y-t.y,o=this.z-t.z;return Math.sqrt(e*e+i*i+o*o)};ft.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)};ft.prototype.hashCode=function(){var t=17;return t=37*t+ft.hashCode(this.x),t=37*t+ft.hashCode(this.y),t};ft.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z};ft.prototype.interfaces_=function(){return[Xo,Yg,Zo]};ft.prototype.getClass=function(){return ft};ft.hashCode=function(){if(arguments.length===1){var t=arguments[0],e=Ae.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}};Pc.DimensionalComparator.get=function(){return Pu};Pc.serialVersionUID.get=function(){return 6683108902428367e3};Pc.NULL_ORDINATE.get=function(){return Ae.NaN};Pc.X.get=function(){return 0};Pc.Y.get=function(){return 1};Pc.Z.get=function(){return 2};Object.defineProperties(ft,Pc);var Pu=function(t){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var e=arguments[0];if(e!==2&&e!==3)throw new Zr("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}}};Pu.prototype.compare=function(t,e){var i=t,o=e,u=Pu.compare(i.x,o.x);if(u!==0)return u;var s=Pu.compare(i.y,o.y);if(s!==0)return s;if(this._dimensionsToTest<=2)return 0;var y=Pu.compare(i.z,o.z);return y};Pu.prototype.interfaces_=function(){return[qh]};Pu.prototype.getClass=function(){return Pu};Pu.compare=function(t,e){return t<e?-1:t>e?1:Ae.isNaN(t)?Ae.isNaN(e)?0:-1:Ae.isNaN(e)?1:0};var jh=function(){};jh.prototype.create=function(){};jh.prototype.interfaces_=function(){return[]};jh.prototype.getClass=function(){return jh};var dt=function(){},Hf={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};dt.prototype.interfaces_=function(){return[]};dt.prototype.getClass=function(){return dt};dt.toLocationSymbol=function(t){switch(t){case dt.EXTERIOR:return"e";case dt.BOUNDARY:return"b";case dt.INTERIOR:return"i";case dt.NONE:return"-"}throw new Zr("Unknown location value: "+t)};Hf.INTERIOR.get=function(){return 0};Hf.BOUNDARY.get=function(){return 1};Hf.EXTERIOR.get=function(){return 2};Hf.NONE.get=function(){return-1};Object.defineProperties(dt,Hf);var Ie=function(n,t){return n.interfaces_&&n.interfaces_().indexOf(t)>-1},vo=function(){},kx={LOG_10:{configurable:!0}};vo.prototype.interfaces_=function(){return[]};vo.prototype.getClass=function(){return vo};vo.log10=function(t){var e=Math.log(t);return Ae.isInfinite(e)||Ae.isNaN(e)?e:e/vo.LOG_10};vo.min=function(t,e,i,o){var u=t;return e<u&&(u=e),i<u&&(u=i),o<u&&(u=o),u};vo.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1],i=arguments[2];return t<e?e:t>i?i:t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var o=arguments[0],u=arguments[1],s=arguments[2];return o<u?u:o>s?s:o}};vo.wrap=function(t,e){return t<0?e- -t%e:t%e};vo.max=function(){if(arguments.length===3){var t=arguments[0],e=arguments[1],i=arguments[2],o=t;return e>o&&(o=e),i>o&&(o=i),o}else if(arguments.length===4){var u=arguments[0],s=arguments[1],y=arguments[2],v=arguments[3],S=u;return s>S&&(S=s),y>S&&(S=y),v>S&&(S=v),S}};vo.average=function(t,e){return(t+e)/2};kx.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(vo,kx);var Ba=function(t){this.str=t};Ba.prototype.append=function(t){this.str+=t};Ba.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)};Ba.prototype.toString=function(t){return this.str};var Ta=function(t){this.value=t};Ta.prototype.intValue=function(){return this.value};Ta.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0};Ta.isNaN=function(t){return Number.isNaN(t)};var If=function(){};If.isWhitespace=function(t){return t<=32&&t>=0||t===127};If.toUpperCase=function(t){return t.toUpperCase()};var Et=function n(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof n){var e=arguments[0];this.init(e)}else if(typeof arguments[0]=="string"){var i=arguments[0];n.call(this,n.parse(i))}}else if(arguments.length===2){var o=arguments[0],u=arguments[1];this.init(o,u)}},fa={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Et.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo};Et.prototype.extractSignificantDigits=function(t,e){var i=this.abs(),o=Et.magnitude(i._hi),u=Et.TEN.pow(o);i=i.divide(u),i.gt(Et.TEN)?(i=i.divide(Et.TEN),o+=1):i.lt(Et.ONE)&&(i=i.multiply(Et.TEN),o-=1);for(var s=o+1,y=new Ba,v=Et.MAX_PRINT_DIGITS-1,S=0;S<=v;S++){t&&S===s&&y.append(".");var L=Math.trunc(i._hi);if(L<0)break;var k=!1,N=0;L>9?(k=!0,N="9"):N="0"+L,y.append(N),i=i.subtract(Et.valueOf(L)).multiply(Et.TEN),k&&i.selfAdd(Et.TEN);var Q=!0,tt=Et.magnitude(i._hi);if(tt<0&&Math.abs(tt)>=v-S&&(Q=!1),!Q)break}return e[0]=o,y.toString()};Et.prototype.sqr=function(){return this.multiply(this)};Et.prototype.doubleValue=function(){return this._hi+this._lo};Et.prototype.subtract=function(){if(arguments[0]instanceof Et){var t=arguments[0];return this.add(t.negate())}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.add(-e)}};Et.prototype.equals=function(){if(arguments.length===1){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}};Et.prototype.isZero=function(){return this._hi===0&&this._lo===0};Et.prototype.selfSubtract=function(){if(arguments[0]instanceof Et){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}};Et.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};Et.prototype.min=function(t){return this.le(t)?this:t};Et.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof Et){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfDivide(e,0)}}else if(arguments.length===2){var i=arguments[0],o=arguments[1],u=null,s=null,y=null,v=null,S=null,L=null,k=null,N=null;return S=this._hi/i,L=Et.SPLIT*S,u=L-S,N=Et.SPLIT*i,u=L-u,s=S-u,y=N-i,k=S*i,y=N-y,v=i-y,N=u*y-k+u*v+s*y+s*v,L=(this._hi-k-N+this._lo-S*o)/i,N=S+L,this._hi=N,this._lo=S-N+L,this}};Et.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};Et.prototype.divide=function(){if(arguments[0]instanceof Et){var t=arguments[0],e=null,i=null,o=null,u=null,s=null,y=null,v=null,S=null;s=this._hi/t._hi,y=Et.SPLIT*s,e=y-s,S=Et.SPLIT*t._hi,e=y-e,i=s-e,o=S-t._hi,v=s*t._hi,o=S-o,u=t._hi-o,S=e*o-v+e*u+i*o+i*u,y=(this._hi-v-S+this._lo-s*t._lo)/t._hi,S=s+y;var L=S,k=s-S+y;return new Et(L,k)}else if(typeof arguments[0]=="number"){var N=arguments[0];return Ae.isNaN(N)?Et.createNaN():Et.copy(this).selfDivide(N,0)}};Et.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo};Et.prototype.pow=function(t){if(t===0)return Et.valueOf(1);var e=new Et(this),i=Et.valueOf(1),o=Math.abs(t);if(o>1)for(;o>0;)o%2===1&&i.selfMultiply(e),o/=2,o>0&&(e=e.sqr());else i=e;return t<0?i.reciprocal():i};Et.prototype.ceil=function(){if(this.isNaN())return Et.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new Et(t,e)};Et.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0};Et.prototype.rint=function(){if(this.isNaN())return this;var t=this.add(.5);return t.floor()};Et.prototype.setValue=function(){if(arguments[0]instanceof Et){var t=arguments[0];return this.init(t),this}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.init(e),this}};Et.prototype.max=function(t){return this.ge(t)?this:t};Et.prototype.sqrt=function(){if(this.isZero())return Et.valueOf(0);if(this.isNegative())return Et.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,i=Et.valueOf(e),o=this.subtract(i.sqr()),u=o._hi*(t*.5);return i.add(u)};Et.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof Et){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var e=arguments[0],i=null,o=null,u=null,s=null,y=null,v=null;return u=this._hi+e,y=u-this._hi,s=u-y,s=e-y+(this._hi-s),v=s+this._lo,i=u+v,o=v+(u-i),this._hi=i+o,this._lo=o+(i-this._hi),this}}else if(arguments.length===2){var S=arguments[0],L=arguments[1],k=null,N=null,Q=null,tt=null,xt=null,mt=null,Ct=null,ut=null;xt=this._hi+S,Q=this._lo+L,Ct=xt-this._hi,ut=Q-this._lo,mt=xt-Ct,tt=Q-ut,mt=S-Ct+(this._hi-mt),tt=L-ut+(this._lo-tt),Ct=mt+Q,k=xt+Ct,N=Ct+(xt-k),Ct=tt+N;var Pt=k+Ct,Ft=Ct+(k-Pt);return this._hi=Pt,this._lo=Ft,this}};Et.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof Et){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfMultiply(e,0)}}else if(arguments.length===2){var i=arguments[0],o=arguments[1],u=null,s=null,y=null,v=null,S=null,L=null;S=Et.SPLIT*this._hi,u=S-this._hi,L=Et.SPLIT*i,u=S-u,s=this._hi-u,y=L-i,S=this._hi*i,y=L-y,v=i-y,L=u*y-S+u*v+s*y+s*v+(this._hi*o+this._lo*i);var k=S+L;u=S-k;var N=L+u;return this._hi=k,this._lo=N,this}};Et.prototype.selfSqr=function(){return this.selfMultiply(this)};Et.prototype.floor=function(){if(this.isNaN())return Et.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new Et(t,e)};Et.prototype.negate=function(){return this.isNaN()?this:new Et(-this._hi,-this._lo)};Et.prototype.clone=function(){};Et.prototype.multiply=function(){if(arguments[0]instanceof Et){var t=arguments[0];return t.isNaN()?Et.createNaN():Et.copy(this).selfMultiply(t)}else if(typeof arguments[0]=="number"){var e=arguments[0];return Ae.isNaN(e)?Et.createNaN():Et.copy(this).selfMultiply(e,0)}};Et.prototype.isNaN=function(){return Ae.isNaN(this._hi)};Et.prototype.intValue=function(){return Math.trunc(this._hi)};Et.prototype.toString=function(){var t=Et.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()};Et.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),i=this.extractSignificantDigits(!0,e),o=e[0]+1,u=i;if(i.charAt(0)===".")u="0"+i;else if(o<0)u="0."+Et.stringOfChar("0",-o)+i;else if(i.indexOf(".")===-1){var s=o-i.length,y=Et.stringOfChar("0",s);u=i+y+".0"}return this.isNegative()?"-"+u:u};Et.prototype.reciprocal=function(){var t=null,e=null,i=null,o=null,u=null,s=null,y=null,v=null;u=1/this._hi,s=Et.SPLIT*u,t=s-u,v=Et.SPLIT*this._hi,t=s-t,e=u-t,i=v-this._hi,y=u*this._hi,i=v-i,o=this._hi-i,v=t*i-y+t*o+e*i+e*o,s=(1-y-v-u*this._lo)/this._hi;var S=u+s,L=u-S+s;return new Et(S,L)};Et.prototype.toSciNotation=function(){if(this.isZero())return Et.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),i=this.extractSignificantDigits(!1,e),o=Et.SCI_NOT_EXPONENT_CHAR+e[0];if(i.charAt(0)==="0")throw new Error("Found leading zero: "+i);var u="";i.length>1&&(u=i.substring(1));var s=i.charAt(0)+"."+u;return this.isNegative()?"-"+s+o:s+o};Et.prototype.abs=function(){return this.isNaN()?Et.NaN:this.isNegative()?this.negate():new Et(this)};Et.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0};Et.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo};Et.prototype.add=function(){if(arguments[0]instanceof Et){var t=arguments[0];return Et.copy(this).selfAdd(t)}else if(typeof arguments[0]=="number"){var e=arguments[0];return Et.copy(this).selfAdd(e)}};Et.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof Et){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(arguments.length===2){var i=arguments[0],o=arguments[1];this._hi=i,this._lo=o}};Et.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo};Et.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0};Et.prototype.trunc=function(){return this.isNaN()?Et.NaN:this.isPositive()?this.floor():this.ceil()};Et.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0};Et.prototype.interfaces_=function(){return[Zo,Xo,Yg]};Et.prototype.getClass=function(){return Et};Et.sqr=function(t){return Et.valueOf(t).selfMultiply(t)};Et.valueOf=function(){if(typeof arguments[0]=="string"){var t=arguments[0];return Et.parse(t)}else if(typeof arguments[0]=="number"){var e=arguments[0];return new Et(e)}};Et.sqrt=function(t){return Et.valueOf(t).sqrt()};Et.parse=function(t){for(var e=0,i=t.length;If.isWhitespace(t.charAt(e));)e++;var o=!1;if(e<i){var u=t.charAt(e);(u==="-"||u==="+")&&(e++,u==="-"&&(o=!0))}for(var s=new Et,y=0,v=0,S=0;!(e>=i);){var L=t.charAt(e);if(e++,If.isDigit(L)){var k=L-"0";s.selfMultiply(Et.TEN),s.selfAdd(k),y++;continue}if(L==="."){v=y;continue}if(L==="e"||L==="E"){var N=t.substring(e);try{S=Ta.parseInt(N)}catch(Ct){throw Ct instanceof Error?new Error("Invalid exponent "+N+" in string "+t):Ct}finally{}break}throw new Error("Unexpected character '"+L+"' at position "+e+" in string "+t)}var Q=s,tt=y-v-S;if(tt===0)Q=s;else if(tt>0){var xt=Et.TEN.pow(tt);Q=s.divide(xt)}else if(tt<0){var mt=Et.TEN.pow(-tt);Q=s.multiply(mt)}return o?Q.negate():Q};Et.createNaN=function(){return new Et(Ae.NaN,Ae.NaN)};Et.copy=function(t){return new Et(t)};Et.magnitude=function(t){var e=Math.abs(t),i=Math.log(e)/Math.log(10),o=Math.trunc(Math.floor(i)),u=Math.pow(10,o);return u*10<=e&&(o+=1),o};Et.stringOfChar=function(t,e){for(var i=new Ba,o=0;o<e;o++)i.append(t);return i.toString()};fa.PI.get=function(){return new Et(3.141592653589793,12246467991473532e-32)};fa.TWO_PI.get=function(){return new Et(6.283185307179586,24492935982947064e-32)};fa.PI_2.get=function(){return new Et(1.5707963267948966,6123233995736766e-32)};fa.E.get=function(){return new Et(2.718281828459045,14456468917292502e-32)};fa.NaN.get=function(){return new Et(Ae.NaN,Ae.NaN)};fa.EPS.get=function(){return 123259516440783e-46};fa.SPLIT.get=function(){return 134217729};fa.MAX_PRINT_DIGITS.get=function(){return 32};fa.TEN.get=function(){return Et.valueOf(10)};fa.ONE.get=function(){return Et.valueOf(1)};fa.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};fa.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(Et,fa);var Xn=function(){},Nx={DP_SAFE_EPSILON:{configurable:!0}};Xn.prototype.interfaces_=function(){return[]};Xn.prototype.getClass=function(){return Xn};Xn.orientationIndex=function(t,e,i){var o=Xn.orientationIndexFilter(t,e,i);if(o<=1)return o;var u=Et.valueOf(e.x).selfAdd(-t.x),s=Et.valueOf(e.y).selfAdd(-t.y),y=Et.valueOf(i.x).selfAdd(-e.x),v=Et.valueOf(i.y).selfAdd(-e.y);return u.selfMultiply(v).selfSubtract(s.selfMultiply(y)).signum()};Xn.signOfDet2x2=function(t,e,i,o){var u=t.multiply(o).selfSubtract(e.multiply(i));return u.signum()};Xn.intersection=function(t,e,i,o){var u=Et.valueOf(o.y).selfSubtract(i.y).selfMultiply(Et.valueOf(e.x).selfSubtract(t.x)),s=Et.valueOf(o.x).selfSubtract(i.x).selfMultiply(Et.valueOf(e.y).selfSubtract(t.y)),y=u.subtract(s),v=Et.valueOf(o.x).selfSubtract(i.x).selfMultiply(Et.valueOf(t.y).selfSubtract(i.y)),S=Et.valueOf(o.y).selfSubtract(i.y).selfMultiply(Et.valueOf(t.x).selfSubtract(i.x)),L=v.subtract(S),k=L.selfDivide(y).doubleValue(),N=Et.valueOf(t.x).selfAdd(Et.valueOf(e.x).selfSubtract(t.x).selfMultiply(k)).doubleValue(),Q=Et.valueOf(e.x).selfSubtract(t.x).selfMultiply(Et.valueOf(t.y).selfSubtract(i.y)),tt=Et.valueOf(e.y).selfSubtract(t.y).selfMultiply(Et.valueOf(t.x).selfSubtract(i.x)),xt=Q.subtract(tt),mt=xt.selfDivide(y).doubleValue(),Ct=Et.valueOf(i.y).selfAdd(Et.valueOf(o.y).selfSubtract(i.y).selfMultiply(mt)).doubleValue();return new ft(N,Ct)};Xn.orientationIndexFilter=function(t,e,i){var o=null,u=(t.x-i.x)*(e.y-i.y),s=(t.y-i.y)*(e.x-i.x),y=u-s;if(u>0){if(s<=0)return Xn.signum(y);o=u+s}else if(u<0){if(s>=0)return Xn.signum(y);o=-u-s}else return Xn.signum(y);var v=Xn.DP_SAFE_EPSILON*o;return y>=v||-y>=v?Xn.signum(y):2};Xn.signum=function(t){return t>0?1:t<0?-1:0};Nx.DP_SAFE_EPSILON.get=function(){return 1e-15};Object.defineProperties(Xn,Nx);var rr=function(){},Xf={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Xf.X.get=function(){return 0};Xf.Y.get=function(){return 1};Xf.Z.get=function(){return 2};Xf.M.get=function(){return 3};rr.prototype.setOrdinate=function(t,e,i){};rr.prototype.size=function(){};rr.prototype.getOrdinate=function(t,e){};rr.prototype.getCoordinate=function(){};rr.prototype.getCoordinateCopy=function(t){};rr.prototype.getDimension=function(){};rr.prototype.getX=function(t){};rr.prototype.clone=function(){};rr.prototype.expandEnvelope=function(t){};rr.prototype.copy=function(){};rr.prototype.getY=function(t){};rr.prototype.toCoordinateArray=function(){};rr.prototype.interfaces_=function(){return[Yg]};rr.prototype.getClass=function(){return rr};Object.defineProperties(rr,Xf);var Rx=function(){},cp=function(n){function t(){n.call(this,"Projective point not representable on the Cartesian plane.")}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Rx),an=function(){};an.arraycopy=function(t,e,i,o,u){for(var s=0,y=e;y<e+u;y++)i[o+s]=t[y],s++};an.getProperty=function(t){return{"line.separator":`
`}[t]};var na=function n(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],i=arguments[1];this.x=e,this.y=i,this.w=1}else if(arguments[0]instanceof n&&arguments[1]instanceof n){var o=arguments[0],u=arguments[1];this.x=o.y*u.w-u.y*o.w,this.y=u.x*o.w-o.x*u.w,this.w=o.x*u.y-u.x*o.y}else if(arguments[0]instanceof ft&&arguments[1]instanceof ft){var s=arguments[0],y=arguments[1];this.x=s.y-y.y,this.y=y.x-s.x,this.w=s.x*y.y-y.x*s.y}}else if(arguments.length===3){var v=arguments[0],S=arguments[1],L=arguments[2];this.x=v,this.y=S,this.w=L}else if(arguments.length===4){var k=arguments[0],N=arguments[1],Q=arguments[2],tt=arguments[3],xt=k.y-N.y,mt=N.x-k.x,Ct=k.x*N.y-N.x*k.y,ut=Q.y-tt.y,Pt=tt.x-Q.x,Ft=Q.x*tt.y-tt.x*Q.y;this.x=mt*Ft-Pt*Ct,this.y=ut*Ct-xt*Ft,this.w=xt*Pt-ut*mt}};na.prototype.getY=function(){var t=this.y/this.w;if(Ae.isNaN(t)||Ae.isInfinite(t))throw new cp;return t};na.prototype.getX=function(){var t=this.x/this.w;if(Ae.isNaN(t)||Ae.isInfinite(t))throw new cp;return t};na.prototype.getCoordinate=function(){var t=new ft;return t.x=this.getX(),t.y=this.getY(),t};na.prototype.interfaces_=function(){return[]};na.prototype.getClass=function(){return na};na.intersection=function(t,e,i,o){var u=t.y-e.y,s=e.x-t.x,y=t.x*e.y-e.x*t.y,v=i.y-o.y,S=o.x-i.x,L=i.x*o.y-o.x*i.y,k=s*L-S*y,N=v*y-u*L,Q=u*S-v*s,tt=k/Q,xt=N/Q;if(Ae.isNaN(tt)||Ae.isInfinite(tt)||Ae.isNaN(xt)||Ae.isInfinite(xt))throw new cp;return new ft(tt,xt)};var fe=function n(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof ft){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof n){var e=arguments[0];this.init(e)}}else if(arguments.length===2){var i=arguments[0],o=arguments[1];this.init(i.x,o.x,i.y,o.y)}else if(arguments.length===4){var u=arguments[0],s=arguments[1],y=arguments[2],v=arguments[3];this.init(u,s,y,v)}},Fx={serialVersionUID:{configurable:!0}};fe.prototype.getArea=function(){return this.getWidth()*this.getHeight()};fe.prototype.equals=function(t){if(!(t instanceof fe))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()};fe.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new fe;var e=this._minx>t._minx?this._minx:t._minx,i=this._miny>t._miny?this._miny:t._miny,o=this._maxx<t._maxx?this._maxx:t._maxx,u=this._maxy<t._maxy?this._maxy:t._maxy;return new fe(e,o,i,u)};fe.prototype.isNull=function(){return this._maxx<this._minx};fe.prototype.getMaxX=function(){return this._maxx};fe.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof ft){var t=arguments[0];return this.covers(t.x,t.y)}else if(arguments[0]instanceof fe){var e=arguments[0];return this.isNull()||e.isNull()?!1:e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(arguments.length===2){var i=arguments[0],o=arguments[1];return this.isNull()?!1:i>=this._minx&&i<=this._maxx&&o>=this._miny&&o<=this._maxy}};fe.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof fe){var t=arguments[0];return this.isNull()||t.isNull()?!1:!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}else if(arguments[0]instanceof ft){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(arguments.length===2){var i=arguments[0],o=arguments[1];return this.isNull()?!1:!(i>this._maxx||i<this._minx||o>this._maxy||o<this._miny)}};fe.prototype.getMinY=function(){return this._miny};fe.prototype.getMinX=function(){return this._minx};fe.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof ft){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof fe){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(arguments.length===2){var i=arguments[0],o=arguments[1];this.isNull()?(this._minx=i,this._maxx=i,this._miny=o,this._maxy=o):(i<this._minx&&(this._minx=i),i>this._maxx&&(this._maxx=i),o<this._miny&&(this._miny=o),o>this._maxy&&(this._maxy=o))}};fe.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e};fe.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};fe.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0};fe.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)};fe.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};fe.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1};fe.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny};fe.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e};fe.prototype.expandBy=function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var e=arguments[0],i=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=i,this._maxy+=i,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};fe.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof fe){var t=arguments[0];return this.covers(t)}else if(arguments[0]instanceof ft){var e=arguments[0];return this.covers(e)}}else if(arguments.length===2){var i=arguments[0],o=arguments[1];return this.covers(i,o)}};fe.prototype.centre=function(){return this.isNull()?null:new ft((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};fe.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof ft){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof fe){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(arguments.length===2){var i=arguments[0],o=arguments[1];this.init(i.x,o.x,i.y,o.y)}else if(arguments.length===4){var u=arguments[0],s=arguments[1],y=arguments[2],v=arguments[3];u<s?(this._minx=u,this._maxx=s):(this._minx=s,this._maxx=u),y<v?(this._miny=y,this._maxy=v):(this._miny=v,this._maxy=y)}};fe.prototype.getMaxY=function(){return this._maxy};fe.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var i=0;return this._maxy<t._miny?i=t._miny-this._maxy:this._miny>t._maxy&&(i=this._miny-t._maxy),e===0?i:i===0?e:Math.sqrt(e*e+i*i)};fe.prototype.hashCode=function(){var t=17;return t=37*t+ft.hashCode(this._minx),t=37*t+ft.hashCode(this._maxx),t=37*t+ft.hashCode(this._miny),t=37*t+ft.hashCode(this._maxy),t};fe.prototype.interfaces_=function(){return[Xo,Zo]};fe.prototype.getClass=function(){return fe};fe.intersects=function(){if(arguments.length===3){var t=arguments[0],e=arguments[1],i=arguments[2];return i.x>=(t.x<e.x?t.x:e.x)&&i.x<=(t.x>e.x?t.x:e.x)&&i.y>=(t.y<e.y?t.y:e.y)&&i.y<=(t.y>e.y?t.y:e.y)}else if(arguments.length===4){var o=arguments[0],u=arguments[1],s=arguments[2],y=arguments[3],v=Math.min(s.x,y.x),S=Math.max(s.x,y.x),L=Math.min(o.x,u.x),k=Math.max(o.x,u.x);return!(L>S||k<v||(v=Math.min(s.y,y.y),S=Math.max(s.y,y.y),L=Math.min(o.y,u.y),k=Math.max(o.y,u.y),L>S)||k<v)}};Fx.serialVersionUID.get=function(){return 5873921885273102e3};Object.defineProperties(fe,Fx);var Ea={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Wg=function(t){this.geometryFactory=t||new He};Wg.prototype.read=function(t){var e,i,o;t=t.replace(/[\n\r]/g," ");var u=Ea.typeStr.exec(t);if(t.search("EMPTY")!==-1&&(u=Ea.emptyTypeStr.exec(t),u[2]=void 0),u&&(i=u[1].toLowerCase(),o=u[2],Bh[i]&&(e=Bh[i].apply(this,[o]))),e===void 0)throw new Error("Could not parse WKT "+t);return e};Wg.prototype.write=function(t){return this.extractGeometry(t)};Wg.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Fs[e])return null;var i=e.toUpperCase(),o;return t.isEmpty()?o=i+" EMPTY":o=i+"("+Fs[e].apply(this,[t])+")",o};var Fs={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Fs.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=this,i=[],o=0,u=t._geometries.length;o<u;++o)i.push("("+Fs.point.apply(e,[t._geometries[o]])+")");return i.join(",")},linestring:function(t){for(var e=this,i=[],o=0,u=t._points._coordinates.length;o<u;++o)i.push(Fs.coordinate.apply(e,[t._points._coordinates[o]]));return i.join(",")},linearring:function(t){for(var e=this,i=[],o=0,u=t._points._coordinates.length;o<u;++o)i.push(Fs.coordinate.apply(e,[t._points._coordinates[o]]));return i.join(",")},multilinestring:function(t){for(var e=this,i=[],o=0,u=t._geometries.length;o<u;++o)i.push("("+Fs.linestring.apply(e,[t._geometries[o]])+")");return i.join(",")},polygon:function(t){var e=this,i=[];i.push("("+Fs.linestring.apply(this,[t._shell])+")");for(var o=0,u=t._holes.length;o<u;++o)i.push("("+Fs.linestring.apply(e,[t._holes[o]])+")");return i.join(",")},multipolygon:function(t){for(var e=this,i=[],o=0,u=t._geometries.length;o<u;++o)i.push("("+Fs.polygon.apply(e,[t._geometries[o]])+")");return i.join(",")},geometrycollection:function(t){for(var e=this,i=[],o=0,u=t._geometries.length;o<u;++o)i.push(e.extractGeometry(t._geometries[o]));return i.join(",")}},Bh={point:function(t){if(t===void 0)return this.geometryFactory.createPoint();var e=t.trim().split(Ea.spaces);return this.geometryFactory.createPoint(new ft(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){var e=this;if(t===void 0)return this.geometryFactory.createMultiPoint();for(var i,o=t.trim().split(","),u=[],s=0,y=o.length;s<y;++s)i=o[s].replace(Ea.trimParens,"$1"),u.push(Bh.point.apply(e,[i]));return this.geometryFactory.createMultiPoint(u)},linestring:function(t){if(t===void 0)return this.geometryFactory.createLineString();for(var e=t.trim().split(","),i=[],o,u=0,s=e.length;u<s;++u)o=e[u].trim().split(Ea.spaces),i.push(new ft(Number.parseFloat(o[0]),Number.parseFloat(o[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(t===void 0)return this.geometryFactory.createLinearRing();for(var e=t.trim().split(","),i=[],o,u=0,s=e.length;u<s;++u)o=e[u].trim().split(Ea.spaces),i.push(new ft(Number.parseFloat(o[0]),Number.parseFloat(o[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){var e=this;if(t===void 0)return this.geometryFactory.createMultiLineString();for(var i,o=t.trim().split(Ea.parenComma),u=[],s=0,y=o.length;s<y;++s)i=o[s].replace(Ea.trimParens,"$1"),u.push(Bh.linestring.apply(e,[i]));return this.geometryFactory.createMultiLineString(u)},polygon:function(t){var e=this;if(t===void 0)return this.geometryFactory.createPolygon();for(var i,o,u,s=t.trim().split(Ea.parenComma),y,v=[],S=0,L=s.length;S<L;++S)i=s[S].replace(Ea.trimParens,"$1"),o=Bh.linestring.apply(e,[i]),u=e.geometryFactory.createLinearRing(o._points),S===0?y=u:v.push(u);return this.geometryFactory.createPolygon(y,v)},multipolygon:function(t){var e=this;if(t===void 0)return this.geometryFactory.createMultiPolygon();for(var i,o=t.trim().split(Ea.doubleParenComma),u=[],s=0,y=o.length;s<y;++s)i=o[s].replace(Ea.trimParens,"$1"),u.push(Bh.polygon.apply(e,[i]));return this.geometryFactory.createMultiPolygon(u)},geometrycollection:function(t){var e=this;if(t===void 0)return this.geometryFactory.createGeometryCollection();t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var i=t.trim().split("|"),o=[],u=0,s=i.length;u<s;++u)o.push(e.read(i[u]));return this.geometryFactory.createGeometryCollection(o)}},aa=function(t){this.parser=new Wg(t)};aa.prototype.write=function(t){return this.parser.write(t)};aa.toLineString=function(t,e){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var js=function(n){function t(e){n.call(this,e),this.name="RuntimeException",this.message=e,this.stack=new n().stack}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t}(Error),Tg=function(n){function t(){if(n.call(this),arguments.length===0)n.call(this);else if(arguments.length===1){var e=arguments[0];n.call(this,e)}}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(js),Re=function(){};Re.prototype.interfaces_=function(){return[]};Re.prototype.getClass=function(){return Re};Re.shouldNeverReachHere=function(){if(arguments.length===0)Re.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new Tg("Should never reach here"+(t!==null?": "+t:""))}};Re.isTrue=function(){var t,e;if(arguments.length===1)t=arguments[0],Re.isTrue(t,null);else if(arguments.length===2&&(t=arguments[0],e=arguments[1],!t))throw e===null?new Tg:new Tg(e)};Re.equals=function(){var t,e,i;if(arguments.length===2)t=arguments[0],e=arguments[1],Re.equals(t,e,null);else if(arguments.length===3&&(t=arguments[0],e=arguments[1],i=arguments[2],!e.equals(t)))throw new Tg("Expected "+t+" but encountered "+e+(i!==null?": "+i:""))};var Jr=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new ft,this._intPt[1]=new ft,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},Tc={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Jr.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]};Jr.prototype.getTopologySummary=function(){var t=new Ba;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()};Jr.prototype.computeIntersection=function(t,e,i,o){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=i,this._inputLines[1][1]=o,this._result=this.computeIntersect(t,e,i,o)};Jr.prototype.getIntersectionNum=function(){return this._result};Jr.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0],e=this.getEdgeDistance(t,0),i=this.getEdgeDistance(t,1);e>i?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}};Jr.prototype.isProper=function(){return this.hasIntersection()&&this._isProper};Jr.prototype.setPrecisionModel=function(t){this._precisionModel=t};Jr.prototype.isInteriorIntersection=function(){var t=this;if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){for(var e=arguments[0],i=0;i<this._result;i++)if(!(t._intPt[i].equals2D(t._inputLines[e][0])||t._intPt[i].equals2D(t._inputLines[e][1])))return!0;return!1}};Jr.prototype.getIntersection=function(t){return this._intPt[t]};Jr.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper};Jr.prototype.hasIntersection=function(){return this._result!==Jr.NO_INTERSECTION};Jr.prototype.getEdgeDistance=function(t,e){var i=Jr.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1]);return i};Jr.prototype.isCollinear=function(){return this._result===Jr.COLLINEAR_INTERSECTION};Jr.prototype.toString=function(){return aa.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+aa.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()};Jr.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]};Jr.prototype.isIntersection=function(t){for(var e=this,i=0;i<this._result;i++)if(e._intPt[i].equals2D(t))return!0;return!1};Jr.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]};Jr.prototype.interfaces_=function(){return[]};Jr.prototype.getClass=function(){return Jr};Jr.computeEdgeDistance=function(t,e,i){var o=Math.abs(i.x-e.x),u=Math.abs(i.y-e.y),s=-1;if(t.equals(e))s=0;else if(t.equals(i))o>u?s=o:s=u;else{var y=Math.abs(t.x-e.x),v=Math.abs(t.y-e.y);o>u?s=y:s=v,s===0&&!t.equals(e)&&(s=Math.max(y,v))}return Re.isTrue(!(s===0&&!t.equals(e)),"Bad distance calculation"),s};Jr.nonRobustComputeEdgeDistance=function(t,e,i){var o=t.x-e.x,u=t.y-e.y,s=Math.sqrt(o*o+u*u);return Re.isTrue(!(s===0&&!t.equals(e)),"Invalid distance calculation"),s};Tc.DONT_INTERSECT.get=function(){return 0};Tc.DO_INTERSECT.get=function(){return 1};Tc.COLLINEAR.get=function(){return 2};Tc.NO_INTERSECTION.get=function(){return 0};Tc.POINT_INTERSECTION.get=function(){return 1};Tc.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(Jr,Tc);var Sl=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.isInSegmentEnvelopes=function(i){var o=new fe(this._inputLines[0][0],this._inputLines[0][1]),u=new fe(this._inputLines[1][0],this._inputLines[1][1]);return o.contains(i)&&u.contains(i)},t.prototype.computeIntersection=function(){if(arguments.length===3){var i=arguments[0],o=arguments[1],u=arguments[2];if(this._isProper=!1,fe.intersects(o,u,i)&&Kt.orientationIndex(o,u,i)===0&&Kt.orientationIndex(u,o,i)===0)return this._isProper=!0,(i.equals(o)||i.equals(u))&&(this._isProper=!1),this._result=n.POINT_INTERSECTION,null;this._result=n.NO_INTERSECTION}else return n.prototype.computeIntersection.apply(this,arguments)},t.prototype.normalizeToMinimum=function(i,o,u,s,y){y.x=this.smallestInAbsValue(i.x,o.x,u.x,s.x),y.y=this.smallestInAbsValue(i.y,o.y,u.y,s.y),i.x-=y.x,i.y-=y.y,o.x-=y.x,o.y-=y.y,u.x-=y.x,u.y-=y.y,s.x-=y.x,s.y-=y.y},t.prototype.safeHCoordinateIntersection=function(i,o,u,s){var y=null;try{y=na.intersection(i,o,u,s)}catch(v){if(v instanceof cp)y=t.nearestEndpoint(i,o,u,s);else throw v}finally{}return y},t.prototype.intersection=function(i,o,u,s){var y=this.intersectionWithNormalization(i,o,u,s);return this.isInSegmentEnvelopes(y)||(y=new ft(t.nearestEndpoint(i,o,u,s))),this._precisionModel!==null&&this._precisionModel.makePrecise(y),y},t.prototype.smallestInAbsValue=function(i,o,u,s){var y=i,v=Math.abs(y);return Math.abs(o)<v&&(y=o,v=Math.abs(o)),Math.abs(u)<v&&(y=u,v=Math.abs(u)),Math.abs(s)<v&&(y=s),y},t.prototype.checkDD=function(i,o,u,s,y){var v=Xn.intersection(i,o,u,s),S=this.isInSegmentEnvelopes(v);an.out.println("DD in env = "+S+"  --------------------- "+v),y.distance(v)>1e-4&&an.out.println("Distance = "+y.distance(v))},t.prototype.intersectionWithNormalization=function(i,o,u,s){var y=new ft(i),v=new ft(o),S=new ft(u),L=new ft(s),k=new ft;this.normalizeToEnvCentre(y,v,S,L,k);var N=this.safeHCoordinateIntersection(y,v,S,L);return N.x+=k.x,N.y+=k.y,N},t.prototype.computeCollinearIntersection=function(i,o,u,s){var y=fe.intersects(i,o,u),v=fe.intersects(i,o,s),S=fe.intersects(u,s,i),L=fe.intersects(u,s,o);return y&&v?(this._intPt[0]=u,this._intPt[1]=s,n.COLLINEAR_INTERSECTION):S&&L?(this._intPt[0]=i,this._intPt[1]=o,n.COLLINEAR_INTERSECTION):y&&S?(this._intPt[0]=u,this._intPt[1]=i,u.equals(i)&&!v&&!L?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):y&&L?(this._intPt[0]=u,this._intPt[1]=o,u.equals(o)&&!v&&!S?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):v&&S?(this._intPt[0]=s,this._intPt[1]=i,s.equals(i)&&!y&&!L?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):v&&L?(this._intPt[0]=s,this._intPt[1]=o,s.equals(o)&&!y&&!S?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):n.NO_INTERSECTION},t.prototype.normalizeToEnvCentre=function(i,o,u,s,y){var v=i.x<o.x?i.x:o.x,S=i.y<o.y?i.y:o.y,L=i.x>o.x?i.x:o.x,k=i.y>o.y?i.y:o.y,N=u.x<s.x?u.x:s.x,Q=u.y<s.y?u.y:s.y,tt=u.x>s.x?u.x:s.x,xt=u.y>s.y?u.y:s.y,mt=v>N?v:N,Ct=L<tt?L:tt,ut=S>Q?S:Q,Pt=k<xt?k:xt,Ft=(mt+Ct)/2,ie=(ut+Pt)/2;y.x=Ft,y.y=ie,i.x-=y.x,i.y-=y.y,o.x-=y.x,o.y-=y.y,u.x-=y.x,u.y-=y.y,s.x-=y.x,s.y-=y.y},t.prototype.computeIntersect=function(i,o,u,s){if(this._isProper=!1,!fe.intersects(i,o,u,s))return n.NO_INTERSECTION;var y=Kt.orientationIndex(i,o,u),v=Kt.orientationIndex(i,o,s);if(y>0&&v>0||y<0&&v<0)return n.NO_INTERSECTION;var S=Kt.orientationIndex(u,s,i),L=Kt.orientationIndex(u,s,o);if(S>0&&L>0||S<0&&L<0)return n.NO_INTERSECTION;var k=y===0&&v===0&&S===0&&L===0;return k?this.computeCollinearIntersection(i,o,u,s):(y===0||v===0||S===0||L===0?(this._isProper=!1,i.equals2D(u)||i.equals2D(s)?this._intPt[0]=i:o.equals2D(u)||o.equals2D(s)?this._intPt[0]=o:y===0?this._intPt[0]=new ft(u):v===0?this._intPt[0]=new ft(s):S===0?this._intPt[0]=new ft(i):L===0&&(this._intPt[0]=new ft(o))):(this._isProper=!0,this._intPt[0]=this.intersection(i,o,u,s)),n.POINT_INTERSECTION)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.nearestEndpoint=function(i,o,u,s){var y=i,v=Kt.distancePointLine(i,u,s),S=Kt.distancePointLine(o,u,s);return S<v&&(v=S,y=o),S=Kt.distancePointLine(u,i,o),S<v&&(v=S,y=u),S=Kt.distancePointLine(s,i,o),S<v&&(v=S,y=s),y},t}(Jr),yc=function(){};yc.prototype.interfaces_=function(){return[]};yc.prototype.getClass=function(){return yc};yc.orientationIndex=function(t,e,i){var o=e.x-t.x,u=e.y-t.y,s=i.x-e.x,y=i.y-e.y;return yc.signOfDet2x2(o,u,s,y)};yc.signOfDet2x2=function(t,e,i,o){var u=null,s=null,y=null;if(u=1,t===0||o===0)return e===0||i===0?0:e>0?i>0?-u:u:i>0?u:-u;if(e===0||i===0)return o>0?t>0?u:-u:t>0?-u:u;if(e>0?o>0?e<=o||(u=-u,s=t,t=i,i=s,s=e,e=o,o=s):e<=-o?(u=-u,i=-i,o=-o):(s=t,t=-i,i=s,s=e,e=-o,o=s):o>0?-e<=o?(u=-u,t=-t,e=-e):(s=-t,t=i,i=s,s=-e,e=o,o=s):e>=o?(t=-t,e=-e,i=-i,o=-o):(u=-u,s=-t,t=-i,i=s,s=-e,e=-o,o=s),t>0)if(i>0){if(!(t<=i))return u}else return u;else{if(i>0)return-u;if(t>=i)u=-u,t=-t,i=-i;else return-u}for(;;){if(y=Math.floor(i/t),i=i-y*t,o=o-y*e,o<0)return-u;if(o>e)return u;if(t>i+i){if(e<o+o)return u}else{if(e>o+o)return-u;i=t-i,o=e-o,u=-u}if(o===0)return i===0?0:-u;if(i===0||(y=Math.floor(t/i),t=t-y*i,e=e-y*o,e<0))return u;if(e>o)return-u;if(i>t+t){if(o<e+e)return-u}else{if(o>e+e)return u;t=i-t,e=o-e,u=-u}if(e===0)return t===0?0:u;if(t===0)return-u}};var La=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};La.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var i=t.x,o=e.x;return i>o&&(i=e.x,o=t.x),this._p.x>=i&&this._p.x<=o&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var u=t.x-this._p.x,s=t.y-this._p.y,y=e.x-this._p.x,v=e.y-this._p.y,S=yc.signOfDet2x2(u,s,y,v);if(S===0)return this._isPointOnSegment=!0,null;v<s&&(S=-S),S>0&&this._crossingCount++}};La.prototype.isPointInPolygon=function(){return this.getLocation()!==dt.EXTERIOR};La.prototype.getLocation=function(){return this._isPointOnSegment?dt.BOUNDARY:this._crossingCount%2===1?dt.INTERIOR:dt.EXTERIOR};La.prototype.isOnSegment=function(){return this._isPointOnSegment};La.prototype.interfaces_=function(){return[]};La.prototype.getClass=function(){return La};La.locatePointInRing=function(){if(arguments[0]instanceof ft&&Ie(arguments[1],rr)){for(var t=arguments[0],e=arguments[1],i=new La(t),o=new ft,u=new ft,s=1;s<e.size();s++)if(e.getCoordinate(s,o),e.getCoordinate(s-1,u),i.countSegment(o,u),i.isOnSegment())return i.getLocation();return i.getLocation()}else if(arguments[0]instanceof ft&&arguments[1]instanceof Array){for(var y=arguments[0],v=arguments[1],S=new La(y),L=1;L<v.length;L++){var k=v[L],N=v[L-1];if(S.countSegment(k,N),S.isOnSegment())return S.getLocation()}return S.getLocation()}};var Kt=function(){},Mc={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Kt.prototype.interfaces_=function(){return[]};Kt.prototype.getClass=function(){return Kt};Kt.orientationIndex=function(t,e,i){return Xn.orientationIndex(t,e,i)};Kt.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,i=t[0].x,o=1;o<t.length-1;o++){var u=t[o].x-i,s=t[o+1].y,y=t[o-1].y;e+=u*(y-s)}return e/2}else if(Ie(arguments[0],rr)){var v=arguments[0],S=v.size();if(S<3)return 0;var L=new ft,k=new ft,N=new ft;v.getCoordinate(0,k),v.getCoordinate(1,N);var Q=k.x;N.x-=Q;for(var tt=0,xt=1;xt<S-1;xt++)L.y=k.y,k.x=N.x,k.y=N.y,v.getCoordinate(xt+1,N),N.x-=Q,tt+=k.x*(L.y-N.y);return tt/2}};Kt.distanceLineLine=function(t,e,i,o){if(t.equals(e))return Kt.distancePointLine(t,i,o);if(i.equals(o))return Kt.distancePointLine(o,t,e);var u=!1;if(!fe.intersects(t,e,i,o))u=!0;else{var s=(e.x-t.x)*(o.y-i.y)-(e.y-t.y)*(o.x-i.x);if(s===0)u=!0;else{var y=(t.y-i.y)*(o.x-i.x)-(t.x-i.x)*(o.y-i.y),v=(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y),S=v/s,L=y/s;(L<0||L>1||S<0||S>1)&&(u=!0)}}return u?vo.min(Kt.distancePointLine(t,i,o),Kt.distancePointLine(e,i,o),Kt.distancePointLine(i,t,e),Kt.distancePointLine(o,t,e)):0};Kt.isPointInRing=function(t,e){return Kt.locatePointInRing(t,e)!==dt.EXTERIOR};Kt.computeLength=function(t){var e=t.size();if(e<=1)return 0;var i=0,o=new ft;t.getCoordinate(0,o);for(var u=o.x,s=o.y,y=1;y<e;y++){t.getCoordinate(y,o);var v=o.x,S=o.y,L=v-u,k=S-s;i+=Math.sqrt(L*L+k*k),u=v,s=S}return i};Kt.isCCW=function(t){var e=t.length-1;if(e<3)throw new Zr("Ring has fewer than 4 points, so orientation cannot be determined");for(var i=t[0],o=0,u=1;u<=e;u++){var s=t[u];s.y>i.y&&(i=s,o=u)}var y=o;do y=y-1,y<0&&(y=e);while(t[y].equals2D(i)&&y!==o);var v=o;do v=(v+1)%e;while(t[v].equals2D(i)&&v!==o);var S=t[y],L=t[v];if(S.equals2D(i)||L.equals2D(i)||S.equals2D(L))return!1;var k=Kt.computeOrientation(S,i,L),N=!1;return k===0?N=S.x>L.x:N=k>0,N};Kt.locatePointInRing=function(t,e){return La.locatePointInRing(t,e)};Kt.distancePointLinePerpendicular=function(t,e,i){var o=(i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y),u=((e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y))/o;return Math.abs(u)*Math.sqrt(o)};Kt.computeOrientation=function(t,e,i){return Kt.orientationIndex(t,e,i)};Kt.distancePointLine=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];if(e.length===0)throw new Zr("Line array must contain at least one vertex");for(var i=t.distance(e[0]),o=0;o<e.length-1;o++){var u=Kt.distancePointLine(t,e[o],e[o+1]);u<i&&(i=u)}return i}else if(arguments.length===3){var s=arguments[0],y=arguments[1],v=arguments[2];if(y.x===v.x&&y.y===v.y)return s.distance(y);var S=(v.x-y.x)*(v.x-y.x)+(v.y-y.y)*(v.y-y.y),L=((s.x-y.x)*(v.x-y.x)+(s.y-y.y)*(v.y-y.y))/S;if(L<=0)return s.distance(y);if(L>=1)return s.distance(v);var k=((y.y-s.y)*(v.x-y.x)-(y.x-s.x)*(v.y-y.y))/S;return Math.abs(k)*Math.sqrt(S)}};Kt.isOnLine=function(t,e){for(var i=new Sl,o=1;o<e.length;o++){var u=e[o-1],s=e[o];if(i.computeIntersection(t,u,s),i.hasIntersection())return!0}return!1};Mc.CLOCKWISE.get=function(){return-1};Mc.RIGHT.get=function(){return Kt.CLOCKWISE};Mc.COUNTERCLOCKWISE.get=function(){return 1};Mc.LEFT.get=function(){return Kt.COUNTERCLOCKWISE};Mc.COLLINEAR.get=function(){return 0};Mc.STRAIGHT.get=function(){return Kt.COLLINEAR};Object.defineProperties(Kt,Mc);var Gs=function(){};Gs.prototype.filter=function(t){};Gs.prototype.interfaces_=function(){return[]};Gs.prototype.getClass=function(){return Gs};var Se=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},hs={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Se.prototype.isGeometryCollection=function(){return this.getSortIndex()===Se.SORTINDEX_GEOMETRYCOLLECTION};Se.prototype.getFactory=function(){return this._factory};Se.prototype.getGeometryN=function(t){return this};Se.prototype.getArea=function(){return 0};Se.prototype.isRectangle=function(){return!1};Se.prototype.equals=function(){if(arguments[0]instanceof Se){var t=arguments[0];return t===null?!1:this.equalsTopo(t)}else if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof Se))return!1;var i=e;return this.equalsExact(i)}};Se.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)};Se.prototype.geometryChanged=function(){this.apply(Se.geometryChangedFilter)};Se.prototype.geometryChangedAction=function(){this._envelope=null};Se.prototype.equalsNorm=function(t){return t===null?!1:this.norm().equalsExact(t.norm())};Se.prototype.getLength=function(){return 0};Se.prototype.getNumGeometries=function(){return 1};Se.prototype.compareTo=function(){if(arguments.length===1){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}else if(arguments.length===2){var i=arguments[0],o=arguments[1];return this.getSortIndex()!==i.getSortIndex()?this.getSortIndex()-i.getSortIndex():this.isEmpty()&&i.isEmpty()?0:this.isEmpty()?-1:i.isEmpty()?1:this.compareToSameClass(i,o)}};Se.prototype.getUserData=function(){return this._userData};Se.prototype.getSRID=function(){return this._SRID};Se.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};Se.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===Se.SORTINDEX_GEOMETRYCOLLECTION)throw new Zr("This method does not support GeometryCollection arguments")};Se.prototype.equal=function(t,e,i){return i===0?t.equals(e):t.distance(e)<=i};Se.prototype.norm=function(){var t=this.copy();return t.normalize(),t};Se.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};Se.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new fe(this._envelope)};Se.prototype.setSRID=function(t){this._SRID=t};Se.prototype.setUserData=function(t){this._userData=t};Se.prototype.compare=function(t,e){for(var i=t.iterator(),o=e.iterator();i.hasNext()&&o.hasNext();){var u=i.next(),s=o.next(),y=u.compareTo(s);if(y!==0)return y}return i.hasNext()?1:o.hasNext()?-1:0};Se.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};Se.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Se.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Se.SORTINDEX_MULTIPOINT||this.getSortIndex()===Se.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Se.SORTINDEX_MULTIPOLYGON};Se.prototype.interfaces_=function(){return[Yg,Xo,Zo]};Se.prototype.getClass=function(){return Se};Se.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1};Se.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(t[e]===null)return!0;return!1};hs.serialVersionUID.get=function(){return 8763622679187377e3};hs.SORTINDEX_POINT.get=function(){return 0};hs.SORTINDEX_MULTIPOINT.get=function(){return 1};hs.SORTINDEX_LINESTRING.get=function(){return 2};hs.SORTINDEX_LINEARRING.get=function(){return 3};hs.SORTINDEX_MULTILINESTRING.get=function(){return 4};hs.SORTINDEX_POLYGON.get=function(){return 5};hs.SORTINDEX_MULTIPOLYGON.get=function(){return 6};hs.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};hs.geometryChangedFilter.get=function(){return Um};Object.defineProperties(Se,hs);var Um=function(){};Um.interfaces_=function(){return[Gs]};Um.filter=function(t){t.geometryChangedAction()};var rs=function(){};rs.prototype.filter=function(t){};rs.prototype.interfaces_=function(){return[]};rs.prototype.getClass=function(){return rs};var jo=function(){},Ks={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};jo.prototype.isInBoundary=function(t){};jo.prototype.interfaces_=function(){return[]};jo.prototype.getClass=function(){return jo};Ks.Mod2BoundaryNodeRule.get=function(){return Gh};Ks.EndPointBoundaryNodeRule.get=function(){return Hh};Ks.MultiValentEndPointBoundaryNodeRule.get=function(){return Xh};Ks.MonoValentEndPointBoundaryNodeRule.get=function(){return Zh};Ks.MOD2_BOUNDARY_RULE.get=function(){return new Gh};Ks.ENDPOINT_BOUNDARY_RULE.get=function(){return new Hh};Ks.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Xh};Ks.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Zh};Ks.OGC_SFS_BOUNDARY_RULE.get=function(){return jo.MOD2_BOUNDARY_RULE};Object.defineProperties(jo,Ks);var Gh=function(){};Gh.prototype.isInBoundary=function(t){return t%2===1};Gh.prototype.interfaces_=function(){return[jo]};Gh.prototype.getClass=function(){return Gh};var Hh=function(){};Hh.prototype.isInBoundary=function(t){return t>0};Hh.prototype.interfaces_=function(){return[jo]};Hh.prototype.getClass=function(){return Hh};var Xh=function(){};Xh.prototype.isInBoundary=function(t){return t>1};Xh.prototype.interfaces_=function(){return[jo]};Xh.prototype.getClass=function(){return Xh};var Zh=function(){};Zh.prototype.isInBoundary=function(t){return t===1};Zh.prototype.interfaces_=function(){return[jo]};Zh.prototype.getClass=function(){return Zh};var Di=function(){};Di.prototype.add=function(){};Di.prototype.addAll=function(){};Di.prototype.isEmpty=function(){};Di.prototype.iterator=function(){};Di.prototype.size=function(){};Di.prototype.toArray=function(){};Di.prototype.remove=function(){};function qm(n){this.message=n||""}qm.prototype=new Error;qm.prototype.name="IndexOutOfBoundsException";var hp=function(){};hp.prototype.hasNext=function(){};hp.prototype.next=function(){};hp.prototype.remove=function(){};var oa=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.get=function(){},t.prototype.set=function(){},t.prototype.isEmpty=function(){},t}(Di);function pp(n){this.message=n||""}pp.prototype=new Error;pp.prototype.name="NoSuchElementException";var qt=function(n){function t(){n.call(this),this.array_=[],arguments[0]instanceof Di&&this.addAll(arguments[0])}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.ensureCapacity=function(){},t.prototype.interfaces_=function(){return[n,Di]},t.prototype.add=function(i){return arguments.length===1?this.array_.push(i):this.array_.splice(arguments[0],arguments[1]),!0},t.prototype.clear=function(){this.array_=[]},t.prototype.addAll=function(i){for(var o=this,u=i.iterator();u.hasNext();)o.add(u.next());return!0},t.prototype.set=function(i,o){var u=this.array_[i];return this.array_[i]=o,u},t.prototype.iterator=function(){return new XS(this)},t.prototype.get=function(i){if(i<0||i>=this.size())throw new qm;return this.array_[i]},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.size=function(){return this.array_.length},t.prototype.toArray=function(){for(var i=this,o=[],u=0,s=this.array_.length;u<s;u++)o.push(i.array_[u]);return o},t.prototype.remove=function(i){for(var o=this,u=!1,s=0,y=this.array_.length;s<y;s++)if(o.array_[s]===i){o.array_.splice(s,1),u=!0;break}return u},t}(oa),XS=function(n){function t(e){n.call(this),this.arrayList_=e,this.position_=0}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new pp;return this.arrayList_.get(this.position_++)},t.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},t.prototype.set=function(i){return this.arrayList_.set(this.position_-1,i)},t.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},t}(hp),Zf=function(n){function t(){if(n.call(this),arguments.length!==0){if(arguments.length===1){var i=arguments[0];this.ensureCapacity(i.length),this.add(i,!0)}else if(arguments.length===2){var o=arguments[0],u=arguments[1];this.ensureCapacity(o.length),this.add(o,u)}}}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={coordArrayType:{configurable:!0}};return e.coordArrayType.get=function(){return new Array(0).fill(null)},t.prototype.getCoordinate=function(o){return this.get(o)},t.prototype.addAll=function(){var o=this;if(arguments.length===2){for(var u=arguments[0],s=arguments[1],y=!1,v=u.iterator();v.hasNext();)o.add(v.next(),s),y=!0;return y}else return n.prototype.addAll.apply(this,arguments)},t.prototype.clone=function(){for(var o=this,u=n.prototype.clone.call(this),s=0;s<this.size();s++)u.add(s,o.get(s).copy());return u},t.prototype.toCoordinateArray=function(){return this.toArray(t.coordArrayType)},t.prototype.add=function(){var o=this;if(arguments.length===1){var u=arguments[0];n.prototype.add.call(this,u)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var s=arguments[0],y=arguments[1];return this.add(s,y,!0),!0}else if(arguments[0]instanceof ft&&typeof arguments[1]=="boolean"){var v=arguments[0],S=arguments[1];if(!S&&this.size()>=1){var L=this.get(this.size()-1);if(L.equals2D(v))return null}n.prototype.add.call(this,v)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var k=arguments[0],N=arguments[1];return this.add(k,N),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var Q=arguments[0],tt=arguments[1],xt=arguments[2];if(xt)for(var mt=0;mt<Q.length;mt++)o.add(Q[mt],tt);else for(var Ct=Q.length-1;Ct>=0;Ct--)o.add(Q[Ct],tt);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof ft){var ut=arguments[0],Pt=arguments[1],Ft=arguments[2];if(!Ft){var ie=this.size();if(ie>0){if(ut>0){var ne=this.get(ut-1);if(ne.equals2D(Pt))return null}if(ut<ie){var ae=this.get(ut);if(ae.equals2D(Pt))return null}}}n.prototype.add.call(this,ut,Pt)}}else if(arguments.length===4){var de=arguments[0],$t=arguments[1],Be=arguments[2],Ce=arguments[3],er=1;Be>Ce&&(er=-1);for(var Le=Be;Le!==Ce;Le+=er)o.add(de[Le],$t);return!0}},t.prototype.closeRing=function(){this.size()>0&&this.add(new ft(this.get(0)),!1)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},Object.defineProperties(t,e),t}(qt),Xe=function(){},Kg={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Kg.ForwardComparator.get=function(){return Cf};Kg.BidirectionalComparator.get=function(){return Yh};Kg.coordArrayType.get=function(){return new Array(0).fill(null)};Xe.prototype.interfaces_=function(){return[]};Xe.prototype.getClass=function(){return Xe};Xe.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))};Xe.ptNotInList=function(t,e){for(var i=0;i<t.length;i++){var o=t[i];if(Xe.indexOf(o,e)<0)return o}return null};Xe.scroll=function(t,e){var i=Xe.indexOf(e,t);if(i<0)return null;var o=new Array(t.length).fill(null);an.arraycopy(t,i,o,0,t.length-i),an.arraycopy(t,0,o,t.length-i,i),an.arraycopy(o,0,t,0,t.length)};Xe.equals=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(t===null||e===null||t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(!t[i].equals(e[i]))return!1;return!0}else if(arguments.length===3){var o=arguments[0],u=arguments[1],s=arguments[2];if(o===u)return!0;if(o===null||u===null||o.length!==u.length)return!1;for(var y=0;y<o.length;y++)if(s.compare(o[y],u[y])!==0)return!1;return!0}};Xe.intersection=function(t,e){for(var i=new Zf,o=0;o<t.length;o++)e.intersects(t[o])&&i.add(t[o],!0);return i.toCoordinateArray()};Xe.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1};Xe.removeRepeatedPoints=function(t){if(!Xe.hasRepeatedPoints(t))return t;var e=new Zf(t,!1);return e.toCoordinateArray()};Xe.reverse=function(t){for(var e=t.length-1,i=Math.trunc(e/2),o=0;o<=i;o++){var u=t[o];t[o]=t[e-o],t[e-o]=u}};Xe.removeNull=function(t){for(var e=0,i=0;i<t.length;i++)t[i]!==null&&e++;var o=new Array(e).fill(null);if(e===0)return o;for(var u=0,s=0;s<t.length;s++)t[s]!==null&&(o[u++]=t[s]);return o};Xe.copyDeep=function(){if(arguments.length===1){for(var t=arguments[0],e=new Array(t.length).fill(null),i=0;i<t.length;i++)e[i]=new ft(t[i]);return e}else if(arguments.length===5)for(var o=arguments[0],u=arguments[1],s=arguments[2],y=arguments[3],v=arguments[4],S=0;S<v;S++)s[y+S]=new ft(o[u+S])};Xe.isEqualReversed=function(t,e){for(var i=0;i<t.length;i++){var o=t[i],u=e[t.length-i-1];if(o.compareTo(u)!==0)return!1}return!0};Xe.envelope=function(t){for(var e=new fe,i=0;i<t.length;i++)e.expandToInclude(t[i]);return e};Xe.toCoordinateArray=function(t){return t.toArray(Xe.coordArrayType)};Xe.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]};Xe.indexOf=function(t,e){for(var i=0;i<e.length;i++)if(t.equals(e[i]))return i;return-1};Xe.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var i=t.length-1-e,o=t[e].compareTo(t[i]);if(o!==0)return o}return 1};Xe.compare=function(t,e){for(var i=0;i<t.length&&i<e.length;){var o=t[i].compareTo(e[i]);if(o!==0)return o;i++}return i<e.length?-1:i<t.length?1:0};Xe.minCoordinate=function(t){for(var e=null,i=0;i<t.length;i++)(e===null||e.compareTo(t[i])>0)&&(e=t[i]);return e};Xe.extract=function(t,e,i){e=vo.clamp(e,0,t.length),i=vo.clamp(i,-1,t.length);var o=i-e+1;i<0&&(o=0),e>=t.length&&(o=0),i<e&&(o=0);var u=new Array(o).fill(null);if(o===0)return u;for(var s=0,y=e;y<=i;y++)u[s++]=t[y];return u};Object.defineProperties(Xe,Kg);var Cf=function(){};Cf.prototype.compare=function(t,e){var i=t,o=e;return Xe.compare(i,o)};Cf.prototype.interfaces_=function(){return[qh]};Cf.prototype.getClass=function(){return Cf};var Yh=function(){};Yh.prototype.compare=function(t,e){var i=t,o=e;if(i.length<o.length)return-1;if(i.length>o.length)return 1;if(i.length===0)return 0;var u=Xe.compare(i,o),s=Xe.isEqualReversed(i,o);return s?0:u};Yh.prototype.OLDcompare=function(t,e){var i=t,o=e;if(i.length<o.length)return-1;if(i.length>o.length)return 1;if(i.length===0)return 0;for(var u=Xe.increasingDirection(i),s=Xe.increasingDirection(o),y=u>0?0:i.length-1,v=s>0?0:i.length-1,S=0;S<i.length;S++){var L=i[y].compareTo(o[v]);if(L!==0)return L;y+=u,v+=s}return 0};Yh.prototype.interfaces_=function(){return[qh]};Yh.prototype.getClass=function(){return Yh};var Ac=function(){};Ac.prototype.get=function(){};Ac.prototype.put=function(){};Ac.prototype.size=function(){};Ac.prototype.values=function(){};Ac.prototype.entrySet=function(){};var ZS=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t}(Ac);function Yf(n){this.message=n||""}Yf.prototype=new Error;Yf.prototype.name="OperationNotSupported";function Jg(){}Jg.prototype=new Di;Jg.prototype.contains=function(){};var jm=function(n){function t(){n.call(this),this.array_=[],arguments[0]instanceof Di&&this.addAll(arguments[0])}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.contains=function(i){for(var o=this,u=0,s=this.array_.length;u<s;u++){var y=o.array_[u];if(y===i)return!0}return!1},t.prototype.add=function(i){return this.contains(i)?!1:(this.array_.push(i),!0)},t.prototype.addAll=function(i){for(var o=this,u=i.iterator();u.hasNext();)o.add(u.next());return!0},t.prototype.remove=function(i){throw new Error},t.prototype.size=function(){return this.array_.length},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.toArray=function(){for(var i=this,o=[],u=0,s=this.array_.length;u<s;u++)o.push(i.array_[u]);return o},t.prototype.iterator=function(){return new YS(this)},t}(Jg),YS=function(n){function t(e){n.call(this),this.hashSet_=e,this.position_=0}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new pp;return this.hashSet_.array_[this.position_++]},t.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},t.prototype.remove=function(){throw new Yf},t}(hp),Bs=0,ul=1;function h0(n){return n===null?Bs:n.color}function Rr(n){return n===null?null:n.parent}function Rs(n,t){n!==null&&(n.color=t)}function hm(n){return n===null?null:n.left}function p0(n){return n===null?null:n.right}function yn(){this.root_=null,this.size_=0}yn.prototype=new ZS;yn.prototype.get=function(n){for(var t=this.root_;t!==null;){var e=n.compareTo(t.key);if(e<0)t=t.left;else if(e>0)t=t.right;else return t.value}return null};yn.prototype.put=function(n,t){if(this.root_===null)return this.root_={key:n,value:t,left:null,right:null,parent:null,color:Bs,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var e=this.root_,i,o;do if(i=e,o=n.compareTo(e.key),o<0)e=e.left;else if(o>0)e=e.right;else{var u=e.value;return e.value=t,u}while(e!==null);var s={key:n,left:null,right:null,value:t,parent:i,color:Bs,getValue:function(){return this.value},getKey:function(){return this.key}};return o<0?i.left=s:i.right=s,this.fixAfterInsertion(s),this.size_++,null};yn.prototype.fixAfterInsertion=function(n){var t=this;for(n.color=ul;n!=null&&n!==this.root_&&n.parent.color===ul;)if(Rr(n)===hm(Rr(Rr(n)))){var e=p0(Rr(Rr(n)));h0(e)===ul?(Rs(Rr(n),Bs),Rs(e,Bs),Rs(Rr(Rr(n)),ul),n=Rr(Rr(n))):(n===p0(Rr(n))&&(n=Rr(n),t.rotateLeft(n)),Rs(Rr(n),Bs),Rs(Rr(Rr(n)),ul),t.rotateRight(Rr(Rr(n))))}else{var i=hm(Rr(Rr(n)));h0(i)===ul?(Rs(Rr(n),Bs),Rs(i,Bs),Rs(Rr(Rr(n)),ul),n=Rr(Rr(n))):(n===hm(Rr(n))&&(n=Rr(n),t.rotateRight(n)),Rs(Rr(n),Bs),Rs(Rr(Rr(n)),ul),t.rotateLeft(Rr(Rr(n))))}this.root_.color=Bs};yn.prototype.values=function(){var n=new qt,t=this.getFirstEntry();if(t!==null)for(n.add(t.value);(t=yn.successor(t))!==null;)n.add(t.value);return n};yn.prototype.entrySet=function(){var n=new jm,t=this.getFirstEntry();if(t!==null)for(n.add(t);(t=yn.successor(t))!==null;)n.add(t);return n};yn.prototype.rotateLeft=function(n){if(n!=null){var t=n.right;n.right=t.left,t.left!=null&&(t.left.parent=n),t.parent=n.parent,n.parent===null?this.root_=t:n.parent.left===n?n.parent.left=t:n.parent.right=t,t.left=n,n.parent=t}};yn.prototype.rotateRight=function(n){if(n!=null){var t=n.left;n.left=t.right,t.right!=null&&(t.right.parent=n),t.parent=n.parent,n.parent===null?this.root_=t:n.parent.right===n?n.parent.right=t:n.parent.left=t,t.right=n,n.parent=t}};yn.prototype.getFirstEntry=function(){var n=this.root_;if(n!=null)for(;n.left!=null;)n=n.left;return n};yn.successor=function(n){if(n===null)return null;if(n.right!==null){for(var t=n.right;t.left!==null;)t=t.left;return t}else{for(var e=n.parent,i=n;e!==null&&i===e.right;)i=e,e=e.parent;return e}};yn.prototype.size=function(){return this.size_};var Lf=function(){};Lf.prototype.interfaces_=function(){return[]};Lf.prototype.getClass=function(){return Lf};function zx(){}zx.prototype=new Jg;function Ma(){this.array_=[],arguments[0]instanceof Di&&this.addAll(arguments[0])}Ma.prototype=new zx;Ma.prototype.contains=function(n){for(var t=this,e=0,i=this.array_.length;e<i;e++){var o=t.array_[e];if(o.compareTo(n)===0)return!0}return!1};Ma.prototype.add=function(n){var t=this;if(this.contains(n))return!1;for(var e=0,i=this.array_.length;e<i;e++){var o=t.array_[e];if(o.compareTo(n)===1)return t.array_.splice(e,0,n),!0}return this.array_.push(n),!0};Ma.prototype.addAll=function(n){for(var t=this,e=n.iterator();e.hasNext();)t.add(e.next());return!0};Ma.prototype.remove=function(n){throw new Yf};Ma.prototype.size=function(){return this.array_.length};Ma.prototype.isEmpty=function(){return this.array_.length===0};Ma.prototype.toArray=function(){for(var n=this,t=[],e=0,i=this.array_.length;e<i;e++)t.push(n.array_[e]);return t};Ma.prototype.iterator=function(){return new Qg(this)};var Qg=function(n){this.treeSet_=n,this.position_=0};Qg.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new pp;return this.treeSet_.array_[this.position_++]};Qg.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};Qg.prototype.remove=function(){throw new Yf};var fl=function(){};fl.sort=function(){var t=arguments[0],e,i,o,u;if(arguments.length===1)u=function(y,v){return y.compareTo(v)},t.sort(u);else if(arguments.length===2)o=arguments[1],u=function(y,v){return o.compare(y,v)},t.sort(u);else if(arguments.length===3){i=t.slice(arguments[1],arguments[2]),i.sort();var s=t.slice(0,arguments[1]).concat(i,t.slice(arguments[2],t.length));for(t.splice(0,t.length),e=0;e<s.length;e++)t.push(s[e])}else if(arguments.length===4)for(i=t.slice(arguments[1],arguments[2]),o=arguments[3],u=function(y,v){return o.compare(y,v)},i.sort(u),s=t.slice(0,arguments[1]).concat(i,t.slice(arguments[2],t.length)),t.splice(0,t.length),e=0;e<s.length;e++)t.push(s[e])};fl.asList=function(t){for(var e=new qt,i=0,o=t.length;i<o;i++)e.add(t[i]);return e};var cr=function(){},da={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};da.P.get=function(){return 0};da.L.get=function(){return 1};da.A.get=function(){return 2};da.FALSE.get=function(){return-1};da.TRUE.get=function(){return-2};da.DONTCARE.get=function(){return-3};da.SYM_FALSE.get=function(){return"F"};da.SYM_TRUE.get=function(){return"T"};da.SYM_DONTCARE.get=function(){return"*"};da.SYM_P.get=function(){return"0"};da.SYM_L.get=function(){return"1"};da.SYM_A.get=function(){return"2"};cr.prototype.interfaces_=function(){return[]};cr.prototype.getClass=function(){return cr};cr.toDimensionSymbol=function(t){switch(t){case cr.FALSE:return cr.SYM_FALSE;case cr.TRUE:return cr.SYM_TRUE;case cr.DONTCARE:return cr.SYM_DONTCARE;case cr.P:return cr.SYM_P;case cr.L:return cr.SYM_L;case cr.A:return cr.SYM_A}throw new Zr("Unknown dimension value: "+t)};cr.toDimensionValue=function(t){switch(If.toUpperCase(t)){case cr.SYM_FALSE:return cr.FALSE;case cr.SYM_TRUE:return cr.TRUE;case cr.SYM_DONTCARE:return cr.DONTCARE;case cr.SYM_P:return cr.P;case cr.SYM_L:return cr.L;case cr.SYM_A:return cr.A}throw new Zr("Unknown dimension symbol: "+t)};Object.defineProperties(cr,da);var Aa=function(){};Aa.prototype.filter=function(t){};Aa.prototype.interfaces_=function(){return[]};Aa.prototype.getClass=function(){return Aa};var sa=function(){};sa.prototype.filter=function(t,e){};sa.prototype.isDone=function(){};sa.prototype.isGeometryChanged=function(){};sa.prototype.interfaces_=function(){return[]};sa.prototype.getClass=function(){return sa};var Nn=function(n){function t(i,o){if(n.call(this,o),this._geometries=i||[],n.hasNullElements(this._geometries))throw new Zr("geometries must not contain null elements")}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){for(var o=this,u=new fe,s=0;s<this._geometries.length;s++)u.expandToInclude(o._geometries[s].getEnvelopeInternal());return u},t.prototype.getGeometryN=function(o){return this._geometries[o]},t.prototype.getSortIndex=function(){return n.SORTINDEX_GEOMETRYCOLLECTION},t.prototype.getCoordinates=function(){for(var o=this,u=new Array(this.getNumPoints()).fill(null),s=-1,y=0;y<this._geometries.length;y++)for(var v=o._geometries[y].getCoordinates(),S=0;S<v.length;S++)s++,u[s]=v[S];return u},t.prototype.getArea=function(){for(var o=this,u=0,s=0;s<this._geometries.length;s++)u+=o._geometries[s].getArea();return u},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var u=arguments[0],s=arguments[1];if(!this.isEquivalentClass(u))return!1;var y=u;if(this._geometries.length!==y._geometries.length)return!1;for(var v=0;v<this._geometries.length;v++)if(!o._geometries[v].equalsExact(y._geometries[v],s))return!1;return!0}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var o=this,u=0;u<this._geometries.length;u++)o._geometries[u].normalize();fl.sort(this._geometries)},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},t.prototype.getBoundaryDimension=function(){for(var o=this,u=cr.FALSE,s=0;s<this._geometries.length;s++)u=Math.max(u,o._geometries[s].getBoundaryDimension());return u},t.prototype.getDimension=function(){for(var o=this,u=cr.FALSE,s=0;s<this._geometries.length;s++)u=Math.max(u,o._geometries[s].getDimension());return u},t.prototype.getLength=function(){for(var o=this,u=0,s=0;s<this._geometries.length;s++)u+=o._geometries[s].getLength();return u},t.prototype.getNumPoints=function(){for(var o=this,u=0,s=0;s<this._geometries.length;s++)u+=o._geometries[s].getNumPoints();return u},t.prototype.getNumGeometries=function(){return this._geometries.length},t.prototype.reverse=function(){for(var o=this,u=this._geometries.length,s=new Array(u).fill(null),y=0;y<this._geometries.length;y++)s[y]=o._geometries[y].reverse();return this.getFactory().createGeometryCollection(s)},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){var u=arguments[0],s=new Ma(fl.asList(this._geometries)),y=new Ma(fl.asList(u._geometries));return this.compare(s,y)}else if(arguments.length===2){for(var v=arguments[0],S=arguments[1],L=v,k=this.getNumGeometries(),N=L.getNumGeometries(),Q=0;Q<k&&Q<N;){var tt=o.getGeometryN(Q),xt=L.getGeometryN(Q),mt=tt.compareToSameClass(xt,S);if(mt!==0)return mt;Q++}return Q<k?1:Q<N?-1:0}},t.prototype.apply=function(){var o=this;if(Ie(arguments[0],rs))for(var u=arguments[0],s=0;s<this._geometries.length;s++)o._geometries[s].apply(u);else if(Ie(arguments[0],sa)){var y=arguments[0];if(this._geometries.length===0)return null;for(var v=0;v<this._geometries.length&&(o._geometries[v].apply(y),!y.isDone());v++);y.isGeometryChanged()&&this.geometryChanged()}else if(Ie(arguments[0],Aa)){var S=arguments[0];S.filter(this);for(var L=0;L<this._geometries.length;L++)o._geometries[L].apply(S)}else if(Ie(arguments[0],Gs)){var k=arguments[0];k.filter(this);for(var N=0;N<this._geometries.length;N++)o._geometries[N].apply(k)}},t.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),Re.shouldNeverReachHere(),null},t.prototype.clone=function(){var o=this,u=n.prototype.clone.call(this);u._geometries=new Array(this._geometries.length).fill(null);for(var s=0;s<this._geometries.length;s++)u._geometries[s]=o._geometries[s].clone();return u},t.prototype.getGeometryType=function(){return"GeometryCollection"},t.prototype.copy=function(){for(var o=this,u=new Array(this._geometries.length).fill(null),s=0;s<u.length;s++)u[s]=o._geometries[s].copy();return new t(u,this._factory)},t.prototype.isEmpty=function(){for(var o=this,u=0;u<this._geometries.length;u++)if(!o._geometries[u].isEmpty())return!1;return!0},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(t,e),t}(Se),gl=function(n){function t(){n.apply(this,arguments)}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Se.SORTINDEX_MULTILINESTRING},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];return this.isEquivalentClass(o)?n.prototype.equalsExact.call(this,o,u):!1}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?cr.FALSE:0},t.prototype.isClosed=function(){var o=this;if(this.isEmpty())return!1;for(var u=0;u<this._geometries.length;u++)if(!o._geometries[u].isClosed())return!1;return!0},t.prototype.getDimension=function(){return 1},t.prototype.reverse=function(){for(var o=this,u=this._geometries.length,s=new Array(u).fill(null),y=0;y<this._geometries.length;y++)s[u-1-y]=o._geometries[y].reverse();return this.getFactory().createMultiLineString(s)},t.prototype.getBoundary=function(){return new Vo(this).getBoundary()},t.prototype.getGeometryType=function(){return"MultiLineString"},t.prototype.copy=function(){for(var o=this,u=new Array(this._geometries.length).fill(null),s=0;s<u.length;s++)u[s]=o._geometries[s].copy();return new t(u,this._factory)},t.prototype.interfaces_=function(){return[Lf]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(t,e),t}(Nn),Vo=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var t=arguments[0],e=jo.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(arguments.length===2){var i=arguments[0],o=arguments[1];this._geom=i,this._geomFact=i.getFactory(),this._bnRule=o}};Vo.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return e.length===1?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)};Vo.prototype.getBoundary=function(){return this._geom instanceof oi?this.boundaryLineString(this._geom):this._geom instanceof gl?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};Vo.prototype.boundaryLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){var e=this._bnRule.isInBoundary(2);return e?t.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])};Vo.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};Vo.prototype.computeBoundaryCoordinates=function(t){var e=this,i=new qt;this._endpointMap=new yn;for(var o=0;o<t.getNumGeometries();o++){var u=t.getGeometryN(o);u.getNumPoints()!==0&&(e.addEndpoint(u.getCoordinateN(0)),e.addEndpoint(u.getCoordinateN(u.getNumPoints()-1)))}for(var s=this._endpointMap.entrySet().iterator();s.hasNext();){var y=s.next(),v=y.getValue(),S=v.count;e._bnRule.isInBoundary(S)&&i.add(y.getKey())}return Xe.toCoordinateArray(i)};Vo.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);e===null&&(e=new Mg,this._endpointMap.put(t,e)),e.count++};Vo.prototype.interfaces_=function(){return[]};Vo.prototype.getClass=function(){return Vo};Vo.getBoundary=function(){if(arguments.length===1){var t=arguments[0],e=new Vo(t);return e.getBoundary()}else if(arguments.length===2){var i=arguments[0],o=arguments[1],u=new Vo(i,o);return u.getBoundary()}};var Mg=function(){this.count=null};Mg.prototype.interfaces_=function(){return[]};Mg.prototype.getClass=function(){return Mg};function WS(){}function KS(){}var JS=function(){};function QS(){}function $S(){}function tI(){}var Uo=function(){},Gm={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Uo.prototype.interfaces_=function(){return[]};Uo.prototype.getClass=function(){return Uo};Uo.chars=function(t,e){for(var i=new Array(e).fill(null),o=0;o<e;o++)i[o]=t;return String(i)};Uo.getStackTrace=function(){if(arguments.length===1){var t=arguments[0],e=new QS,i=new WS;return t.printStackTrace(i),e.toString()}else if(arguments.length===2){var o=arguments[0],u=arguments[1],s="";new KS(Uo.getStackTrace(o));for(var y=new tI,v=0;v<u;v++)try{s+=y.readLine()+Uo.NEWLINE}catch(S){if(S instanceof $S)Re.shouldNeverReachHere();else throw S}finally{}return s}};Uo.split=function(t,e){for(var i=e.length,o=new qt,u=""+t,s=u.indexOf(e);s>=0;){var y=u.substring(0,s);o.add(y),u=u.substring(s+i),s=u.indexOf(e)}u.length>0&&o.add(u);for(var v=new Array(o.size()).fill(null),S=0;S<v.length;S++)v[S]=o.get(S);return v};Uo.toString=function(){if(arguments.length===1){var t=arguments[0];return Uo.SIMPLE_ORDINATE_FORMAT.format(t)}};Uo.spaces=function(t){return Uo.chars(" ",t)};Gm.NEWLINE.get=function(){return an.getProperty("line.separator")};Gm.SIMPLE_ORDINATE_FORMAT.get=function(){return new JS};Object.defineProperties(Uo,Gm);var yi=function(){};yi.prototype.interfaces_=function(){return[]};yi.prototype.getClass=function(){return yi};yi.copyCoord=function(t,e,i,o){for(var u=Math.min(t.getDimension(),i.getDimension()),s=0;s<u;s++)i.setOrdinate(o,s,t.getOrdinate(e,s))};yi.isRing=function(t){var e=t.size();return e===0?!0:e<=3?!1:t.getOrdinate(0,rr.X)===t.getOrdinate(e-1,rr.X)&&t.getOrdinate(0,rr.Y)===t.getOrdinate(e-1,rr.Y)};yi.isEqual=function(t,e){var i=t.size(),o=e.size();if(i!==o)return!1;for(var u=Math.min(t.getDimension(),e.getDimension()),s=0;s<i;s++)for(var y=0;y<u;y++){var v=t.getOrdinate(s,y),S=e.getOrdinate(s,y);if(t.getOrdinate(s,y)!==e.getOrdinate(s,y)&&!(Ae.isNaN(v)&&Ae.isNaN(S)))return!1}return!0};yi.extend=function(t,e,i){var o=t.create(i,e.getDimension()),u=e.size();if(yi.copy(e,0,o,0,u),u>0)for(var s=u;s<i;s++)yi.copy(e,u-1,o,s,1);return o};yi.reverse=function(t){for(var e=t.size()-1,i=Math.trunc(e/2),o=0;o<=i;o++)yi.swap(t,o,e-o)};yi.swap=function(t,e,i){if(e===i)return null;for(var o=0;o<t.getDimension();o++){var u=t.getOrdinate(e,o);t.setOrdinate(e,o,t.getOrdinate(i,o)),t.setOrdinate(i,o,u)}};yi.copy=function(t,e,i,o,u){for(var s=0;s<u;s++)yi.copyCoord(t,e+s,i,o+s)};yi.toString=function(){if(arguments.length===1){var t=arguments[0],e=t.size();if(e===0)return"()";var i=t.getDimension(),o=new Ba;o.append("(");for(var u=0;u<e;u++){u>0&&o.append(" ");for(var s=0;s<i;s++)s>0&&o.append(","),o.append(Uo.toString(t.getOrdinate(u,s)))}return o.append(")"),o.toString()}};yi.ensureValidRing=function(t,e){var i=e.size();if(i===0)return e;if(i<=3)return yi.createClosedRing(t,e,4);var o=e.getOrdinate(0,rr.X)===e.getOrdinate(i-1,rr.X)&&e.getOrdinate(0,rr.Y)===e.getOrdinate(i-1,rr.Y);return o?e:yi.createClosedRing(t,e,i+1)};yi.createClosedRing=function(t,e,i){var o=t.create(i,e.getDimension()),u=e.size();yi.copy(e,0,o,0,u);for(var s=u;s<i;s++)yi.copy(e,0,o,s,1);return o};var oi=function(n){function t(i,o){n.call(this,o),this._points=null,this.init(i)}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new fe:this._points.expandEnvelope(new fe)},t.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},t.prototype.getSortIndex=function(){return n.SORTINDEX_LINESTRING},t.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var u=arguments[0],s=arguments[1];if(!this.isEquivalentClass(u))return!1;var y=u;if(this._points.size()!==y._points.size())return!1;for(var v=0;v<this._points.size();v++)if(!o.equal(o._points.getCoordinate(v),y._points.getCoordinate(v),s))return!1;return!0}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var o=this,u=0;u<Math.trunc(this._points.size()/2);u++){var s=o._points.size()-1-u;if(!o._points.getCoordinate(u).equals(o._points.getCoordinate(s)))return o._points.getCoordinate(u).compareTo(o._points.getCoordinate(s))>0&&yi.reverse(o._points),null}},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?cr.FALSE:0},t.prototype.isClosed=function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},t.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},t.prototype.getDimension=function(){return 1},t.prototype.getLength=function(){return Kt.computeLength(this._points)},t.prototype.getNumPoints=function(){return this._points.size()},t.prototype.reverse=function(){var o=this._points.copy();yi.reverse(o);var u=this.getFactory().createLineString(o);return u},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){for(var u=arguments[0],s=u,y=0,v=0;y<this._points.size()&&v<s._points.size();){var S=o._points.getCoordinate(y).compareTo(s._points.getCoordinate(v));if(S!==0)return S;y++,v++}return y<this._points.size()?1:v<s._points.size()?-1:0}else if(arguments.length===2){var L=arguments[0],k=arguments[1],N=L;return k.compare(this._points,N._points)}},t.prototype.apply=function(){var o=this;if(Ie(arguments[0],rs))for(var u=arguments[0],s=0;s<this._points.size();s++)u.filter(o._points.getCoordinate(s));else if(Ie(arguments[0],sa)){var y=arguments[0];if(this._points.size()===0)return null;for(var v=0;v<this._points.size()&&(y.filter(o._points,v),!y.isDone());v++);y.isGeometryChanged()&&this.geometryChanged()}else if(Ie(arguments[0],Aa)){var S=arguments[0];S.filter(this)}else if(Ie(arguments[0],Gs)){var L=arguments[0];L.filter(this)}},t.prototype.getBoundary=function(){return new Vo(this).getBoundary()},t.prototype.isEquivalentClass=function(o){return o instanceof t},t.prototype.clone=function(){var o=n.prototype.clone.call(this);return o._points=this._points.clone(),o},t.prototype.getCoordinateN=function(o){return this._points.getCoordinate(o)},t.prototype.getGeometryType=function(){return"LineString"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._points},t.prototype.isEmpty=function(){return this._points.size()===0},t.prototype.init=function(o){if(o===null&&(o=this.getFactory().getCoordinateSequenceFactory().create([])),o.size()===1)throw new Zr("Invalid number of points in LineString (found "+o.size()+" - must be 0 or >= 2)");this._points=o},t.prototype.isCoordinate=function(o){for(var u=this,s=0;s<this._points.size();s++)if(u._points.getCoordinate(s).equals(o))return!0;return!1},t.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},t.prototype.getPointN=function(o){return this.getFactory().createPoint(this._points.getCoordinate(o))},t.prototype.interfaces_=function(){return[Lf]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(t,e),t}(Se),Pf=function(){};Pf.prototype.interfaces_=function(){return[]};Pf.prototype.getClass=function(){return Pf};var ao=function(n){function t(i,o){n.call(this,o),this._coordinates=i||null,this.init(this._coordinates)}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new fe;var o=new fe;return o.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),o},t.prototype.getSortIndex=function(){return n.SORTINDEX_POINT},t.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];return this.isEquivalentClass(o)?this.isEmpty()&&o.isEmpty()?!0:this.isEmpty()!==o.isEmpty()?!1:this.equal(o.getCoordinate(),this.getCoordinate(),u):!1}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){},t.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},t.prototype.getBoundaryDimension=function(){return cr.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getNumPoints=function(){return this.isEmpty()?0:1},t.prototype.reverse=function(){return this.copy()},t.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},t.prototype.compareToSameClass=function(){if(arguments.length===1){var o=arguments[0],u=o;return this.getCoordinate().compareTo(u.getCoordinate())}else if(arguments.length===2){var s=arguments[0],y=arguments[1],v=s;return y.compare(this._coordinates,v._coordinates)}},t.prototype.apply=function(){if(Ie(arguments[0],rs)){var o=arguments[0];if(this.isEmpty())return null;o.filter(this.getCoordinate())}else if(Ie(arguments[0],sa)){var u=arguments[0];if(this.isEmpty())return null;u.filter(this._coordinates,0),u.isGeometryChanged()&&this.geometryChanged()}else if(Ie(arguments[0],Aa)){var s=arguments[0];s.filter(this)}else if(Ie(arguments[0],Gs)){var y=arguments[0];y.filter(this)}},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.clone=function(){var o=n.prototype.clone.call(this);return o._coordinates=this._coordinates.clone(),o},t.prototype.getGeometryType=function(){return"Point"},t.prototype.copy=function(){return new t(this._coordinates.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._coordinates},t.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},t.prototype.isEmpty=function(){return this._coordinates.size()===0},t.prototype.init=function(o){o===null&&(o=this.getFactory().getCoordinateSequenceFactory().create([])),Re.isTrue(o.size()<=1),this._coordinates=o},t.prototype.isSimple=function(){return!0},t.prototype.interfaces_=function(){return[Pf]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(t,e),t}(Se),Au=function(){};Au.prototype.interfaces_=function(){return[]};Au.prototype.getClass=function(){return Au};var Ri=function(n){function t(i,o,u){if(n.call(this,u),this._shell=null,this._holes=null,i===null&&(i=this.getFactory().createLinearRing()),o===null&&(o=[]),n.hasNullElements(o))throw new Zr("holes must not contain null elements");if(i.isEmpty()&&n.hasNonEmptyElements(o))throw new Zr("shell is empty but holes are not");this._shell=i,this._holes=o}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},t.prototype.getSortIndex=function(){return n.SORTINDEX_POLYGON},t.prototype.getCoordinates=function(){var o=this;if(this.isEmpty())return[];for(var u=new Array(this.getNumPoints()).fill(null),s=-1,y=this._shell.getCoordinates(),v=0;v<y.length;v++)s++,u[s]=y[v];for(var S=0;S<this._holes.length;S++)for(var L=o._holes[S].getCoordinates(),k=0;k<L.length;k++)s++,u[s]=L[k];return u},t.prototype.getArea=function(){var o=this,u=0;u+=Math.abs(Kt.signedArea(this._shell.getCoordinateSequence()));for(var s=0;s<this._holes.length;s++)u-=Math.abs(Kt.signedArea(o._holes[s].getCoordinateSequence()));return u},t.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var o=this._shell.getCoordinateSequence(),u=this.getEnvelopeInternal(),s=0;s<5;s++){var y=o.getX(s);if(!(y===u.getMinX()||y===u.getMaxX()))return!1;var v=o.getY(s);if(!(v===u.getMinY()||v===u.getMaxY()))return!1}for(var S=o.getX(0),L=o.getY(0),k=1;k<=4;k++){var N=o.getX(k),Q=o.getY(k),tt=N!==S,xt=Q!==L;if(tt===xt)return!1;S=N,L=Q}return!0},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var u=arguments[0],s=arguments[1];if(!this.isEquivalentClass(u))return!1;var y=u,v=this._shell,S=y._shell;if(!v.equalsExact(S,s)||this._holes.length!==y._holes.length)return!1;for(var L=0;L<this._holes.length;L++)if(!o._holes[L].equalsExact(y._holes[L],s))return!1;return!0}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){var o=this;if(arguments.length===0){this.normalize(this._shell,!0);for(var u=0;u<this._holes.length;u++)o.normalize(o._holes[u],!1);fl.sort(this._holes)}else if(arguments.length===2){var s=arguments[0],y=arguments[1];if(s.isEmpty())return null;var v=new Array(s.getCoordinates().length-1).fill(null);an.arraycopy(s.getCoordinates(),0,v,0,v.length);var S=Xe.minCoordinate(s.getCoordinates());Xe.scroll(v,S),an.arraycopy(v,0,s.getCoordinates(),0,v.length),s.getCoordinates()[v.length]=v[0],Kt.isCCW(s.getCoordinates())===y&&Xe.reverse(s.getCoordinates())}},t.prototype.getCoordinate=function(){return this._shell.getCoordinate()},t.prototype.getNumInteriorRing=function(){return this._holes.length},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.getLength=function(){var o=this,u=0;u+=this._shell.getLength();for(var s=0;s<this._holes.length;s++)u+=o._holes[s].getLength();return u},t.prototype.getNumPoints=function(){for(var o=this,u=this._shell.getNumPoints(),s=0;s<this._holes.length;s++)u+=o._holes[s].getNumPoints();return u},t.prototype.reverse=function(){var o=this,u=this.copy();u._shell=this._shell.copy().reverse(),u._holes=new Array(this._holes.length).fill(null);for(var s=0;s<this._holes.length;s++)u._holes[s]=o._holes[s].copy().reverse();return u},t.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){var u=arguments[0],s=this._shell,y=u._shell;return s.compareToSameClass(y)}else if(arguments.length===2){var v=arguments[0],S=arguments[1],L=v,k=this._shell,N=L._shell,Q=k.compareToSameClass(N,S);if(Q!==0)return Q;for(var tt=this.getNumInteriorRing(),xt=L.getNumInteriorRing(),mt=0;mt<tt&&mt<xt;){var Ct=o.getInteriorRingN(mt),ut=L.getInteriorRingN(mt),Pt=Ct.compareToSameClass(ut,S);if(Pt!==0)return Pt;mt++}return mt<tt?1:mt<xt?-1:0}},t.prototype.apply=function(o){var u=this;if(Ie(o,rs)){this._shell.apply(o);for(var s=0;s<this._holes.length;s++)u._holes[s].apply(o)}else if(Ie(o,sa)){if(this._shell.apply(o),!o.isDone())for(var y=0;y<this._holes.length&&(u._holes[y].apply(o),!o.isDone());y++);o.isGeometryChanged()&&this.geometryChanged()}else if(Ie(o,Aa))o.filter(this);else if(Ie(o,Gs)){o.filter(this),this._shell.apply(o);for(var v=0;v<this._holes.length;v++)u._holes[v].apply(o)}},t.prototype.getBoundary=function(){var o=this;if(this.isEmpty())return this.getFactory().createMultiLineString();var u=new Array(this._holes.length+1).fill(null);u[0]=this._shell;for(var s=0;s<this._holes.length;s++)u[s+1]=o._holes[s];return u.length<=1?this.getFactory().createLinearRing(u[0].getCoordinateSequence()):this.getFactory().createMultiLineString(u)},t.prototype.clone=function(){var o=this,u=n.prototype.clone.call(this);u._shell=this._shell.clone(),u._holes=new Array(this._holes.length).fill(null);for(var s=0;s<this._holes.length;s++)u._holes[s]=o._holes[s].clone();return u},t.prototype.getGeometryType=function(){return"Polygon"},t.prototype.copy=function(){for(var o=this,u=this._shell.copy(),s=new Array(this._holes.length).fill(null),y=0;y<s.length;y++)s[y]=o._holes[y].copy();return new t(u,s,this._factory)},t.prototype.getExteriorRing=function(){return this._shell},t.prototype.isEmpty=function(){return this._shell.isEmpty()},t.prototype.getInteriorRingN=function(o){return this._holes[o]},t.prototype.interfaces_=function(){return[Au]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(t,e),t}(Se),Wh=function(n){function t(){n.apply(this,arguments)}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Se.SORTINDEX_MULTIPOINT},t.prototype.isValid=function(){return!0},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];return this.isEquivalentClass(o)?n.prototype.equalsExact.call(this,o,u):!1}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.getCoordinate=function(){if(arguments.length===1){var o=arguments[0];return this._geometries[o].getCoordinate()}else return n.prototype.getCoordinate.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return cr.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.getGeometryType=function(){return"MultiPoint"},t.prototype.copy=function(){for(var o=this,u=new Array(this._geometries.length).fill(null),s=0;s<u.length;s++)u[s]=o._geometries[s].copy();return new t(u,this._factory)},t.prototype.interfaces_=function(){return[Pf]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(t,e),t}(Nn),is=function(n){function t(i,o){i instanceof ft&&o instanceof He&&(i=o.getCoordinateSequenceFactory().create(i)),n.call(this,i,o),this.validateConstruction()}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Se.SORTINDEX_LINEARRING},t.prototype.getBoundaryDimension=function(){return cr.FALSE},t.prototype.isClosed=function(){return this.isEmpty()?!0:n.prototype.isClosed.call(this)},t.prototype.reverse=function(){var o=this._points.copy();yi.reverse(o);var u=this.getFactory().createLinearRing(o);return u},t.prototype.validateConstruction=function(){if(!this.isEmpty()&&!n.prototype.isClosed.call(this))throw new Zr("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new Zr("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},t.prototype.getGeometryType=function(){return"LinearRing"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},e.MINIMUM_VALID_SIZE.get=function(){return 4},e.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(t,e),t}(oi),$a=function(n){function t(){n.apply(this,arguments)}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Se.SORTINDEX_MULTIPOLYGON},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];return this.isEquivalentClass(o)?n.prototype.equalsExact.call(this,o,u):!1}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.reverse=function(){for(var o=this,u=this._geometries.length,s=new Array(u).fill(null),y=0;y<this._geometries.length;y++)s[y]=o._geometries[y].reverse();return this.getFactory().createMultiPolygon(s)},t.prototype.getBoundary=function(){var o=this;if(this.isEmpty())return this.getFactory().createMultiLineString();for(var u=new qt,s=0;s<this._geometries.length;s++)for(var y=o._geometries[s],v=y.getBoundary(),S=0;S<v.getNumGeometries();S++)u.add(v.getGeometryN(S));var L=new Array(u.size()).fill(null);return this.getFactory().createMultiLineString(u.toArray(L))},t.prototype.getGeometryType=function(){return"MultiPolygon"},t.prototype.copy=function(){for(var o=this,u=new Array(this._geometries.length).fill(null),s=0;s<u.length;s++)u[s]=o._geometries[s].copy();return new t(u,this._factory)},t.prototype.interfaces_=function(){return[Au]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(t,e),t}(Nn),Go=function(t){this._factory=t||null,this._isUserDataCopied=!1},$g={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Go.prototype.setCopyUserData=function(t){this._isUserDataCopied=t};Go.prototype.edit=function(t,e){if(t===null)return null;var i=this.editInternal(t,e);return this._isUserDataCopied&&i.setUserData(t.getUserData()),i};Go.prototype.editInternal=function(t,e){return this._factory===null&&(this._factory=t.getFactory()),t instanceof Nn?this.editGeometryCollection(t,e):t instanceof Ri?this.editPolygon(t,e):t instanceof ao?e.edit(t,this._factory):t instanceof oi?e.edit(t,this._factory):(Re.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)};Go.prototype.editGeometryCollection=function(t,e){for(var i=this,o=e.edit(t,this._factory),u=new qt,s=0;s<o.getNumGeometries();s++){var y=i.edit(o.getGeometryN(s),e);y===null||y.isEmpty()||u.add(y)}return o.getClass()===Wh?this._factory.createMultiPoint(u.toArray([])):o.getClass()===gl?this._factory.createMultiLineString(u.toArray([])):o.getClass()===$a?this._factory.createMultiPolygon(u.toArray([])):this._factory.createGeometryCollection(u.toArray([]))};Go.prototype.editPolygon=function(t,e){var i=this,o=e.edit(t,this._factory);if(o===null&&(o=this._factory.createPolygon(null)),o.isEmpty())return o;var u=this.edit(o.getExteriorRing(),e);if(u===null||u.isEmpty())return this._factory.createPolygon();for(var s=new qt,y=0;y<o.getNumInteriorRing();y++){var v=i.edit(o.getInteriorRingN(y),e);v===null||v.isEmpty()||s.add(v)}return this._factory.createPolygon(u,s.toArray([]))};Go.prototype.interfaces_=function(){return[]};Go.prototype.getClass=function(){return Go};Go.GeometryEditorOperation=function(){};$g.NoOpGeometryOperation.get=function(){return Tf};$g.CoordinateOperation.get=function(){return Mf};$g.CoordinateSequenceOperation.get=function(){return Af};Object.defineProperties(Go,$g);var Tf=function(){};Tf.prototype.edit=function(t,e){return t};Tf.prototype.interfaces_=function(){return[Go.GeometryEditorOperation]};Tf.prototype.getClass=function(){return Tf};var Mf=function(){};Mf.prototype.edit=function(t,e){var i=this.editCoordinates(t.getCoordinates(),t);return i===null?t:t instanceof is?e.createLinearRing(i):t instanceof oi?e.createLineString(i):t instanceof ao?i.length>0?e.createPoint(i[0]):e.createPoint():t};Mf.prototype.interfaces_=function(){return[Go.GeometryEditorOperation]};Mf.prototype.getClass=function(){return Mf};var Af=function(){};Af.prototype.edit=function(t,e){return t instanceof is?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof oi?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof ao?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t};Af.prototype.interfaces_=function(){return[Go.GeometryEditorOperation]};Af.prototype.getClass=function(){return Af};var di=function(){var t=this;if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var i=0;i<e;i++)t._coordinates[i]=new ft}else if(Ie(arguments[0],rr)){var o=arguments[0];if(o===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=o.getDimension(),this._coordinates=new Array(o.size()).fill(null);for(var u=0;u<this._coordinates.length;u++)t._coordinates[u]=o.getCoordinateCopy(u)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var s=arguments[0],y=arguments[1];this._coordinates=s,this._dimension=y,s===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var v=arguments[0],S=arguments[1];this._coordinates=new Array(v).fill(null),this._dimension=S;for(var L=0;L<v;L++)t._coordinates[L]=new ft}}},Bx={serialVersionUID:{configurable:!0}};di.prototype.setOrdinate=function(t,e,i){switch(e){case rr.X:this._coordinates[t].x=i;break;case rr.Y:this._coordinates[t].y=i;break;case rr.Z:this._coordinates[t].z=i;break;default:throw new Zr("invalid ordinateIndex")}};di.prototype.size=function(){return this._coordinates.length};di.prototype.getOrdinate=function(t,e){switch(e){case rr.X:return this._coordinates[t].x;case rr.Y:return this._coordinates[t].y;case rr.Z:return this._coordinates[t].z}return Ae.NaN};di.prototype.getCoordinate=function(){if(arguments.length===1){var t=arguments[0];return this._coordinates[t]}else if(arguments.length===2){var e=arguments[0],i=arguments[1];i.x=this._coordinates[e].x,i.y=this._coordinates[e].y,i.z=this._coordinates[e].z}};di.prototype.getCoordinateCopy=function(t){return new ft(this._coordinates[t])};di.prototype.getDimension=function(){return this._dimension};di.prototype.getX=function(t){return this._coordinates[t].x};di.prototype.clone=function(){for(var t=this,e=new Array(this.size()).fill(null),i=0;i<this._coordinates.length;i++)e[i]=t._coordinates[i].clone();return new di(e,this._dimension)};di.prototype.expandEnvelope=function(t){for(var e=this,i=0;i<this._coordinates.length;i++)t.expandToInclude(e._coordinates[i]);return t};di.prototype.copy=function(){for(var t=this,e=new Array(this.size()).fill(null),i=0;i<this._coordinates.length;i++)e[i]=t._coordinates[i].copy();return new di(e,this._dimension)};di.prototype.toString=function(){var t=this;if(this._coordinates.length>0){var e=new Ba(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(var i=1;i<this._coordinates.length;i++)e.append(", "),e.append(t._coordinates[i]);return e.append(")"),e.toString()}else return"()"};di.prototype.getY=function(t){return this._coordinates[t].y};di.prototype.toCoordinateArray=function(){return this._coordinates};di.prototype.interfaces_=function(){return[rr,Zo]};di.prototype.getClass=function(){return di};Bx.serialVersionUID.get=function(){return-0xcb44a778db18e00};Object.defineProperties(di,Bx);var ns=function(){},Hm={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};ns.prototype.readResolve=function(){return ns.instance()};ns.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new di(t)}else if(Ie(arguments[0],rr)){var e=arguments[0];return new di(e)}}else if(arguments.length===2){var i=arguments[0],o=arguments[1];return o>3&&(o=3),o<2?new di(i):new di(i,o)}};ns.prototype.interfaces_=function(){return[jh,Zo]};ns.prototype.getClass=function(){return ns};ns.instance=function(){return ns.instanceObject};Hm.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};Hm.instanceObject.get=function(){return new ns};Object.defineProperties(ns,Hm);var Vx=function(n){function t(){n.call(this),this.map_=new Map}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.get=function(i){return this.map_.get(i)||null},t.prototype.put=function(i,o){return this.map_.set(i,o),o},t.prototype.values=function(){for(var i=new qt,o=this.map_.values(),u=o.next();!u.done;)i.add(u.value),u=o.next();return i},t.prototype.entrySet=function(){var i=new jm;return this.map_.entries().forEach(function(o){return i.add(o)}),i},t.prototype.size=function(){return this.map_.size()},t}(Ac),pr=function n(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=n.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Da){var t=arguments[0];this._modelType=t,t===n.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var e=arguments[0];this._modelType=n.FIXED,this.setScale(e)}else if(arguments[0]instanceof n){var i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}}},Xm={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};pr.prototype.equals=function(t){if(!(t instanceof pr))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale};pr.prototype.compareTo=function(t){var e=t,i=this.getMaximumSignificantDigits(),o=e.getMaximumSignificantDigits();return new Ta(i).compareTo(new Ta(o))};pr.prototype.getScale=function(){return this._scale};pr.prototype.isFloating=function(){return this._modelType===pr.FLOATING||this._modelType===pr.FLOATING_SINGLE};pr.prototype.getType=function(){return this._modelType};pr.prototype.toString=function(){var t="UNKNOWN";return this._modelType===pr.FLOATING?t="Floating":this._modelType===pr.FLOATING_SINGLE?t="Floating-Single":this._modelType===pr.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t};pr.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var t=arguments[0];if(Ae.isNaN(t))return t;if(this._modelType===pr.FLOATING_SINGLE){var e=t;return e}return this._modelType===pr.FIXED?Math.round(t*this._scale)/this._scale:t}else if(arguments[0]instanceof ft){var i=arguments[0];if(this._modelType===pr.FLOATING)return null;i.x=this.makePrecise(i.x),i.y=this.makePrecise(i.y)}};pr.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===pr.FLOATING?t=16:this._modelType===pr.FLOATING_SINGLE?t=6:this._modelType===pr.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t};pr.prototype.setScale=function(t){this._scale=Math.abs(t)};pr.prototype.interfaces_=function(){return[Zo,Xo]};pr.prototype.getClass=function(){return pr};pr.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e};Xm.serialVersionUID.get=function(){return 7777263578777804e3};Xm.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(pr,Xm);var Da=function n(t){this._name=t||null,n.nameToTypeMap.put(t,this)},Zm={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Da.prototype.readResolve=function(){return Da.nameToTypeMap.get(this._name)};Da.prototype.toString=function(){return this._name};Da.prototype.interfaces_=function(){return[Zo]};Da.prototype.getClass=function(){return Da};Zm.serialVersionUID.get=function(){return-552860263173159e4};Zm.nameToTypeMap.get=function(){return new Vx};Object.defineProperties(Da,Zm);pr.Type=Da;pr.FIXED=new Da("FIXED");pr.FLOATING=new Da("FLOATING");pr.FLOATING_SINGLE=new Da("FLOATING SINGLE");var He=function n(){this._precisionModel=new pr,this._SRID=0,this._coordinateSequenceFactory=n.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Ie(arguments[0],jh)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof pr&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Ux={serialVersionUID:{configurable:!0}};He.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new ft(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new ft(t.getMinX(),t.getMinY()),new ft(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new ft(t.getMinX(),t.getMinY()),new ft(t.getMinX(),t.getMaxY()),new ft(t.getMaxX(),t.getMaxY()),new ft(t.getMaxX(),t.getMinY()),new ft(t.getMinX(),t.getMinY())]),null)};He.prototype.createLineString=function(t){if(t){if(t instanceof Array)return new oi(this.getCoordinateSequenceFactory().create(t),this);if(Ie(t,rr))return new oi(t,this)}else return new oi(this.getCoordinateSequenceFactory().create([]),this)};He.prototype.createMultiLineString=function(){if(arguments.length===0)return new gl(null,this);if(arguments.length===1){var t=arguments[0];return new gl(t,this)}};He.prototype.buildGeometry=function(t){for(var e=null,i=!1,o=!1,u=t.iterator();u.hasNext();){var s=u.next(),y=s.getClass();e===null&&(e=y),y!==e&&(i=!0),s.isGeometryCollectionOrDerived()&&(o=!0)}if(e===null)return this.createGeometryCollection();if(i||o)return this.createGeometryCollection(He.toGeometryArray(t));var v=t.iterator().next(),S=t.size()>1;if(S){if(v instanceof Ri)return this.createMultiPolygon(He.toPolygonArray(t));if(v instanceof oi)return this.createMultiLineString(He.toLineStringArray(t));if(v instanceof ao)return this.createMultiPoint(He.toPointArray(t));Re.shouldNeverReachHere("Unhandled class: "+v.getClass().getName())}return v};He.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)};He.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof ft){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}else if(Ie(arguments[0],rr)){var e=arguments[0];return new ao(e,this)}}};He.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};He.prototype.createPolygon=function(){if(arguments.length===0)return new Ri(null,null,this);if(arguments.length===1){if(Ie(arguments[0],rr)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}else if(arguments[0]instanceof is){var i=arguments[0];return this.createPolygon(i,null)}}else if(arguments.length===2){var o=arguments[0],u=arguments[1];return new Ri(o,u,this)}};He.prototype.getSRID=function(){return this._SRID};He.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Nn(null,this);if(arguments.length===1){var t=arguments[0];return new Nn(t,this)}};He.prototype.createGeometry=function(t){var e=new Go(this);return e.edit(t,{edit:function(){if(arguments.length===2){var i=arguments[0];return this._coordinateSequenceFactory.create(i)}}})};He.prototype.getPrecisionModel=function(){return this._precisionModel};He.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}else if(Ie(arguments[0],rr)){var e=arguments[0];return new is(e,this)}}};He.prototype.createMultiPolygon=function(){if(arguments.length===0)return new $a(null,this);if(arguments.length===1){var t=arguments[0];return new $a(t,this)}};He.prototype.createMultiPoint=function(){var t=this;if(arguments.length===0)return new Wh(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return new Wh(e,this)}else if(arguments[0]instanceof Array){var i=arguments[0];return this.createMultiPoint(i!==null?this.getCoordinateSequenceFactory().create(i):null)}else if(Ie(arguments[0],rr)){var o=arguments[0];if(o===null)return this.createMultiPoint(new Array(0).fill(null));for(var u=new Array(o.size()).fill(null),s=0;s<o.size();s++){var y=t.getCoordinateSequenceFactory().create(1,o.getDimension());yi.copy(o,s,y,0,1),u[s]=t.createPoint(y)}return this.createMultiPoint(u)}}};He.prototype.interfaces_=function(){return[Zo]};He.prototype.getClass=function(){return He};He.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};He.toGeometryArray=function(t){if(t===null)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)};He.getDefaultCoordinateSequenceFactory=function(){return ns.instance()};He.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};He.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};He.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};He.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};He.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};He.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};He.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)};Ux.serialVersionUID.get=function(){return-6820524753094096e3};Object.defineProperties(He,Ux);var eI=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],ty=function(t){this.geometryFactory=t||new He};ty.prototype.read=function(t){var e;typeof t=="string"?e=JSON.parse(t):e=t;var i=e.type;if(!Ia[i])throw new Error("Unknown GeoJSON type: "+e.type);return eI.indexOf(i)!==-1?Ia[i].apply(this,[e.coordinates]):i==="GeometryCollection"?Ia[i].apply(this,[e.geometries]):Ia[i].apply(this,[e])};ty.prototype.write=function(t){var e=t.getGeometryType();if(!zs[e])throw new Error("Geometry is not supported");return zs[e].apply(this,[t])};var Ia={Feature:function(n){var t={};for(var e in n)t[e]=n[e];if(n.geometry){var i=n.geometry.type;if(!Ia[i])throw new Error("Unknown GeoJSON type: "+n.type);t.geometry=this.read(n.geometry)}return n.bbox&&(t.bbox=Ia.bbox.apply(this,[n.bbox])),t},FeatureCollection:function(n){var t=this,e={};if(n.features){e.features=[];for(var i=0;i<n.features.length;++i)e.features.push(t.read(n.features[i]))}return n.bbox&&(e.bbox=this.parse.bbox.apply(this,[n.bbox])),e},coordinates:function(n){for(var t=[],e=0;e<n.length;++e){var i=n[e];t.push(new ft(i[0],i[1]))}return t},bbox:function(n){return this.geometryFactory.createLinearRing([new ft(n[0],n[1]),new ft(n[2],n[1]),new ft(n[2],n[3]),new ft(n[0],n[3]),new ft(n[0],n[1])])},Point:function(n){var t=new ft(n[0],n[1]);return this.geometryFactory.createPoint(t)},MultiPoint:function(n){for(var t=this,e=[],i=0;i<n.length;++i)e.push(Ia.Point.apply(t,[n[i]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(n){var t=Ia.coordinates.apply(this,[n]);return this.geometryFactory.createLineString(t)},MultiLineString:function(n){for(var t=this,e=[],i=0;i<n.length;++i)e.push(Ia.LineString.apply(t,[n[i]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(n){for(var t=this,e=Ia.coordinates.apply(this,[n[0]]),i=this.geometryFactory.createLinearRing(e),o=[],u=1;u<n.length;++u){var s=n[u],y=Ia.coordinates.apply(t,[s]),v=t.geometryFactory.createLinearRing(y);o.push(v)}return this.geometryFactory.createPolygon(i,o)},MultiPolygon:function(n){for(var t=this,e=[],i=0;i<n.length;++i){var o=n[i];e.push(Ia.Polygon.apply(t,[o]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(n){for(var t=this,e=[],i=0;i<n.length;++i){var o=n[i];e.push(t.read(o))}return this.geometryFactory.createGeometryCollection(e)}},zs={coordinate:function(n){return[n.x,n.y]},Point:function(n){var t=zs.coordinate.apply(this,[n.getCoordinate()]);return{type:"Point",coordinates:t}},MultiPoint:function(n){for(var t=this,e=[],i=0;i<n._geometries.length;++i){var o=n._geometries[i],u=zs.Point.apply(t,[o]);e.push(u.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(n){for(var t=this,e=[],i=n.getCoordinates(),o=0;o<i.length;++o){var u=i[o];e.push(zs.coordinate.apply(t,[u]))}return{type:"LineString",coordinates:e}},MultiLineString:function(n){for(var t=this,e=[],i=0;i<n._geometries.length;++i){var o=n._geometries[i],u=zs.LineString.apply(t,[o]);e.push(u.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(n){var t=this,e=[],i=zs.LineString.apply(this,[n._shell]);e.push(i.coordinates);for(var o=0;o<n._holes.length;++o){var u=n._holes[o],s=zs.LineString.apply(t,[u]);e.push(s.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(n){for(var t=this,e=[],i=0;i<n._geometries.length;++i){var o=n._geometries[i],u=zs.Polygon.apply(t,[o]);e.push(u.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(n){for(var t=this,e=[],i=0;i<n._geometries.length;++i){var o=n._geometries[i],u=o.getGeometryType();e.push(zs[u].apply(t,[o]))}return{type:"GeometryCollection",geometries:e}}},Ym=function(t){this.geometryFactory=t||new He,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new ty(this.geometryFactory)};Ym.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===pr.FIXED&&this.reducePrecision(e),e};Ym.prototype.reducePrecision=function(t){var e=this,i,o;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(i=0,o=t.points.length;i<o;i++)e.precisionModel.makePrecise(t.points[i]);else if(t.geometries)for(i=0,o=t.geometries.length;i<o;i++)e.reducePrecision(t.geometries[i])};var qx=function(){this.parser=new ty(this.geometryFactory)};qx.prototype.write=function(t){return this.parser.write(t)};var Nt=function(){},ey={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Nt.prototype.interfaces_=function(){return[]};Nt.prototype.getClass=function(){return Nt};Nt.opposite=function(t){return t===Nt.LEFT?Nt.RIGHT:t===Nt.RIGHT?Nt.LEFT:t};ey.ON.get=function(){return 0};ey.LEFT.get=function(){return 1};ey.RIGHT.get=function(){return 2};Object.defineProperties(Nt,ey);function ry(n){this.message=n||""}ry.prototype=new Error;ry.prototype.name="EmptyStackException";function Va(){this.array_=[]}Va.prototype=new oa;Va.prototype.add=function(n){return this.array_.push(n),!0};Va.prototype.get=function(n){if(n<0||n>=this.size())throw new Error;return this.array_[n]};Va.prototype.push=function(n){return this.array_.push(n),n};Va.prototype.pop=function(n){if(this.array_.length===0)throw new ry;return this.array_.pop()};Va.prototype.peek=function(){if(this.array_.length===0)throw new ry;return this.array_[this.array_.length-1]};Va.prototype.empty=function(){return this.array_.length===0};Va.prototype.isEmpty=function(){return this.empty()};Va.prototype.search=function(n){return this.array_.indexOf(n)};Va.prototype.size=function(){return this.array_.length};Va.prototype.toArray=function(){for(var n=this,t=[],e=0,i=this.array_.length;e<i;e++)t.push(n.array_[e]);return t};var Oa=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Oa.prototype.getCoordinate=function(){return this._minCoord};Oa.prototype.getRightmostSide=function(t,e){var i=this.getRightmostSideOfSegment(t,e);return i<0&&(i=this.getRightmostSideOfSegment(t,e-1)),i<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),i};Oa.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();Re.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],i=t[this._minIndex+1],o=Kt.computeOrientation(this._minCoord,i,e),u=!1;(e.y<this._minCoord.y&&i.y<this._minCoord.y&&o===Kt.COUNTERCLOCKWISE||e.y>this._minCoord.y&&i.y>this._minCoord.y&&o===Kt.CLOCKWISE)&&(u=!0),u&&(this._minIndex=this._minIndex-1)};Oa.prototype.getRightmostSideOfSegment=function(t,e){var i=t.getEdge(),o=i.getCoordinates();if(e<0||e+1>=o.length||o[e].y===o[e+1].y)return-1;var u=Nt.LEFT;return o[e].y<o[e+1].y&&(u=Nt.RIGHT),u};Oa.prototype.getEdge=function(){return this._orientedDe};Oa.prototype.checkForRightmostCoordinate=function(t){for(var e=this,i=t.getEdge().getCoordinates(),o=0;o<i.length-1;o++)(e._minCoord===null||i[o].x>e._minCoord.x)&&(e._minDe=t,e._minIndex=o,e._minCoord=i[o])};Oa.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode(),e=t.getEdges();this._minDe=e.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};Oa.prototype.findEdge=function(t){for(var e=this,i=t.iterator();i.hasNext();){var o=i.next();!o.isForward()||e.checkForRightmostCoordinate(o)}Re.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;var u=this.getRightmostSide(this._minDe,this._minIndex);u===Nt.LEFT&&(this._orientedDe=this._minDe.getSym())};Oa.prototype.interfaces_=function(){return[]};Oa.prototype.getClass=function(){return Oa};var Hs=function(n){function t(e,i){n.call(this,t.msgWithCoord(e,i)),this.pt=i?new ft(i):null,this.name="TopologyException"}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.getCoordinate=function(){return this.pt},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.msgWithCoord=function(i,o){return o?i:i+" [ "+o+" ]"},t}(js),iy=function(){this.array_=[]};iy.prototype.addLast=function(t){this.array_.push(t)};iy.prototype.removeFirst=function(){return this.array_.shift()};iy.prototype.isEmpty=function(){return this.array_.length===0};var Rn=function(){this._finder=null,this._dirEdgeList=new qt,this._nodes=new qt,this._rightMostCoord=null,this._env=null,this._finder=new Oa};Rn.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.setVisited(!1)}};Rn.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};Rn.prototype.computeNodeDepth=function(t){for(var e=this,i=null,o=t.getEdges().iterator();o.hasNext();){var u=o.next();if(u.isVisited()||u.getSym().isVisited()){i=u;break}}if(i===null)throw new Hs("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(i);for(var s=t.getEdges().iterator();s.hasNext();){var y=s.next();y.setVisited(!0),e.copySymDepths(y)}};Rn.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Nt.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)};Rn.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()};Rn.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Nt.RIGHT)>=1&&e.getDepth(Nt.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}};Rn.prototype.computeDepths=function(t){var e=this,i=new jm,o=new iy,u=t.getNode();for(o.addLast(u),i.add(u),t.setVisited(!0);!o.isEmpty();){var s=o.removeFirst();i.add(s),e.computeNodeDepth(s);for(var y=s.getEdges().iterator();y.hasNext();){var v=y.next(),S=v.getSym();if(!S.isVisited()){var L=S.getNode();i.contains(L)||(o.addLast(L),i.add(L))}}}};Rn.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0};Rn.prototype.getEnvelope=function(){if(this._env===null){for(var t=new fe,e=this._dirEdgeList.iterator();e.hasNext();)for(var i=e.next(),o=i.getEdge().getCoordinates(),u=0;u<o.length-1;u++)t.expandToInclude(o[u]);this._env=t}return this._env};Rn.prototype.addReachable=function(t){var e=this,i=new Va;for(i.add(t);!i.empty();){var o=i.pop();e.add(o,i)}};Rn.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Nt.LEFT,t.getDepth(Nt.RIGHT)),e.setDepth(Nt.RIGHT,t.getDepth(Nt.LEFT))};Rn.prototype.add=function(t,e){var i=this;t.setVisited(!0),this._nodes.add(t);for(var o=t.getEdges().iterator();o.hasNext();){var u=o.next();i._dirEdgeList.add(u);var s=u.getSym(),y=s.getNode();y.isVisited()||e.push(y)}};Rn.prototype.getNodes=function(){return this._nodes};Rn.prototype.getDirectedEdges=function(){return this._dirEdgeList};Rn.prototype.interfaces_=function(){return[Xo]};Rn.prototype.getClass=function(){return Rn};var Fr=function n(){var t=this;if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var i=arguments[0];this.init(1),this.location[Nt.ON]=i}else if(arguments[0]instanceof n){var o=arguments[0];if(this.init(o.location.length),o!==null)for(var u=0;u<this.location.length;u++)t.location[u]=o.location[u]}}else if(arguments.length===3){var s=arguments[0],y=arguments[1],v=arguments[2];this.init(3),this.location[Nt.ON]=s,this.location[Nt.LEFT]=y,this.location[Nt.RIGHT]=v}};Fr.prototype.setAllLocations=function(t){for(var e=this,i=0;i<this.location.length;i++)e.location[i]=t};Fr.prototype.isNull=function(){for(var t=this,e=0;e<this.location.length;e++)if(t.location[e]!==dt.NONE)return!1;return!0};Fr.prototype.setAllLocationsIfNull=function(t){for(var e=this,i=0;i<this.location.length;i++)e.location[i]===dt.NONE&&(e.location[i]=t)};Fr.prototype.isLine=function(){return this.location.length===1};Fr.prototype.merge=function(t){var e=this;if(t.location.length>this.location.length){var i=new Array(3).fill(null);i[Nt.ON]=this.location[Nt.ON],i[Nt.LEFT]=dt.NONE,i[Nt.RIGHT]=dt.NONE,this.location=i}for(var o=0;o<this.location.length;o++)e.location[o]===dt.NONE&&o<t.location.length&&(e.location[o]=t.location[o])};Fr.prototype.getLocations=function(){return this.location};Fr.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Nt.LEFT];this.location[Nt.LEFT]=this.location[Nt.RIGHT],this.location[Nt.RIGHT]=t};Fr.prototype.toString=function(){var t=new Ba;return this.location.length>1&&t.append(dt.toLocationSymbol(this.location[Nt.LEFT])),t.append(dt.toLocationSymbol(this.location[Nt.ON])),this.location.length>1&&t.append(dt.toLocationSymbol(this.location[Nt.RIGHT])),t.toString()};Fr.prototype.setLocations=function(t,e,i){this.location[Nt.ON]=t,this.location[Nt.LEFT]=e,this.location[Nt.RIGHT]=i};Fr.prototype.get=function(t){return t<this.location.length?this.location[t]:dt.NONE};Fr.prototype.isArea=function(){return this.location.length>1};Fr.prototype.isAnyNull=function(){for(var t=this,e=0;e<this.location.length;e++)if(t.location[e]===dt.NONE)return!0;return!1};Fr.prototype.setLocation=function(){if(arguments.length===1){var t=arguments[0];this.setLocation(Nt.ON,t)}else if(arguments.length===2){var e=arguments[0],i=arguments[1];this.location[e]=i}};Fr.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(dt.NONE)};Fr.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]};Fr.prototype.allPositionsEqual=function(t){for(var e=this,i=0;i<this.location.length;i++)if(e.location[i]!==t)return!1;return!0};Fr.prototype.interfaces_=function(){return[]};Fr.prototype.getClass=function(){return Fr};var xr=function n(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new Fr(t),this.elt[1]=new Fr(t)}else if(arguments[0]instanceof n){var e=arguments[0];this.elt[0]=new Fr(e.elt[0]),this.elt[1]=new Fr(e.elt[1])}}else if(arguments.length===2){var i=arguments[0],o=arguments[1];this.elt[0]=new Fr(dt.NONE),this.elt[1]=new Fr(dt.NONE),this.elt[i].setLocation(o)}else if(arguments.length===3){var u=arguments[0],s=arguments[1],y=arguments[2];this.elt[0]=new Fr(u,s,y),this.elt[1]=new Fr(u,s,y)}else if(arguments.length===4){var v=arguments[0],S=arguments[1],L=arguments[2],k=arguments[3];this.elt[0]=new Fr(dt.NONE,dt.NONE,dt.NONE),this.elt[1]=new Fr(dt.NONE,dt.NONE,dt.NONE),this.elt[v].setLocations(S,L,k)}};xr.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t};xr.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)};xr.prototype.isNull=function(t){return this.elt[t].isNull()};xr.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var e=arguments[0],i=arguments[1];this.elt[e].setAllLocationsIfNull(i)}};xr.prototype.isLine=function(t){return this.elt[t].isLine()};xr.prototype.merge=function(t){for(var e=this,i=0;i<2;i++)e.elt[i]===null&&t.elt[i]!==null?e.elt[i]=new Fr(t.elt[i]):e.elt[i].merge(t.elt[i])};xr.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()};xr.prototype.getLocation=function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(Nt.ON)}else if(arguments.length===2){var e=arguments[0],i=arguments[1];return this.elt[e].get(i)}};xr.prototype.toString=function(){var t=new Ba;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()};xr.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}};xr.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()};xr.prototype.setLocation=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Nt.ON,e)}else if(arguments.length===3){var i=arguments[0],o=arguments[1],u=arguments[2];this.elt[i].setLocation(o,u)}};xr.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)};xr.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)};xr.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Fr(this.elt[t].location[0]))};xr.prototype.interfaces_=function(){return[]};xr.prototype.getClass=function(){return xr};xr.toLineLabel=function(t){for(var e=new xr(dt.NONE),i=0;i<2;i++)e.setLocation(i,t.getLocation(i));return e};var Ci=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new qt,this._pts=new qt,this._label=new xr(dt.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new qt,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Ci.prototype.computeRing=function(){var t=this;if(this._ring!==null)return null;for(var e=new Array(this._pts.size()).fill(null),i=0;i<this._pts.size();i++)e[i]=t._pts.get(i);this._ring=this._geometryFactory.createLinearRing(e),this._isHole=Kt.isCCW(this._ring.getCoordinates())};Ci.prototype.isIsolated=function(){return this._label.getGeometryCount()===1};Ci.prototype.computePoints=function(t){var e=this;this._startDe=t;var i=t,o=!0;do{if(i===null)throw new Hs("Found null DirectedEdge");if(i.getEdgeRing()===e)throw new Hs("Directed Edge visited twice during ring-building at "+i.getCoordinate());e._edges.add(i);var u=i.getLabel();Re.isTrue(u.isArea()),e.mergeLabel(u),e.addPoints(i.getEdge(),i.isForward(),o),o=!1,e.setEdgeRing(i,e),i=e.getNext(i)}while(i!==this._startDe)};Ci.prototype.getLinearRing=function(){return this._ring};Ci.prototype.getCoordinate=function(t){return this._pts.get(t)};Ci.prototype.computeMaxNodeDegree=function(){var t=this;this._maxNodeDegree=0;var e=this._startDe;do{var i=e.getNode(),o=i.getEdges().getOutgoingDegree(t);o>t._maxNodeDegree&&(t._maxNodeDegree=o),e=t.getNext(e)}while(e!==this._startDe);this._maxNodeDegree*=2};Ci.prototype.addPoints=function(t,e,i){var o=this,u=t.getCoordinates();if(e){var s=1;i&&(s=0);for(var y=s;y<u.length;y++)o._pts.add(u[y])}else{var v=u.length-2;i&&(v=u.length-1);for(var S=v;S>=0;S--)o._pts.add(u[S])}};Ci.prototype.isHole=function(){return this._isHole};Ci.prototype.setInResult=function(){var t=this._startDe;do t.getEdge().setInResult(!0),t=t.getNext();while(t!==this._startDe)};Ci.prototype.containsPoint=function(t){var e=this.getLinearRing(),i=e.getEnvelopeInternal();if(!i.contains(t)||!Kt.isPointInRing(t,e.getCoordinates()))return!1;for(var o=this._holes.iterator();o.hasNext();){var u=o.next();if(u.containsPoint(t))return!1}return!0};Ci.prototype.addHole=function(t){this._holes.add(t)};Ci.prototype.isShell=function(){return this._shell===null};Ci.prototype.getLabel=function(){return this._label};Ci.prototype.getEdges=function(){return this._edges};Ci.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree};Ci.prototype.getShell=function(){return this._shell};Ci.prototype.mergeLabel=function(){if(arguments.length===1){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(arguments.length===2){var e=arguments[0],i=arguments[1],o=e.getLocation(i,Nt.RIGHT);if(o===dt.NONE)return null;if(this._label.getLocation(i)===dt.NONE)return this._label.setLocation(i,o),null}};Ci.prototype.setShell=function(t){this._shell=t,t!==null&&t.addHole(this)};Ci.prototype.toPolygon=function(t){for(var e=this,i=new Array(this._holes.size()).fill(null),o=0;o<this._holes.size();o++)i[o]=e._holes.get(o).getLinearRing();var u=t.createPolygon(this.getLinearRing(),i);return u};Ci.prototype.interfaces_=function(){return[]};Ci.prototype.getClass=function(){return Ci};var rI=function(n){function t(){var e=arguments[0],i=arguments[1];n.call(this,e,i)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.setEdgeRing=function(i,o){i.setMinEdgeRing(o)},t.prototype.getNext=function(i){return i.getNextMin()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ci),iI=function(n){function t(){var e=arguments[0],i=arguments[1];n.call(this,e,i)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.buildMinimalRings=function(){var i=this,o=new qt,u=this._startDe;do{if(u.getMinEdgeRing()===null){var s=new rI(u,i._geometryFactory);o.add(s)}u=u.getNext()}while(u!==this._startDe);return o},t.prototype.setEdgeRing=function(i,o){i.setEdgeRing(o)},t.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var i=this,o=this._startDe;do{var u=o.getNode();u.getEdges().linkMinimalDirectedEdges(i),o=o.getNext()}while(o!==this._startDe)},t.prototype.getNext=function(i){return i.getNext()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ci),xo=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._label=t}}};xo.prototype.setVisited=function(t){this._isVisited=t};xo.prototype.setInResult=function(t){this._isInResult=t};xo.prototype.isCovered=function(){return this._isCovered};xo.prototype.isCoveredSet=function(){return this._isCoveredSet};xo.prototype.setLabel=function(t){this._label=t};xo.prototype.getLabel=function(){return this._label};xo.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0};xo.prototype.updateIM=function(t){Re.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)};xo.prototype.isInResult=function(){return this._isInResult};xo.prototype.isVisited=function(){return this._isVisited};xo.prototype.interfaces_=function(){return[]};xo.prototype.getClass=function(){return xo};var ny=function(n){function t(){n.call(this),this._coord=null,this._edges=null;var e=arguments[0],i=arguments[1];this._coord=e,this._edges=i,this._label=new xr(0,dt.NONE)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.isIncidentEdgeInResult=function(){for(var i=this.getEdges().getEdges().iterator();i.hasNext();){var o=i.next();if(o.getEdge().isInResult())return!0}return!1},t.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},t.prototype.getCoordinate=function(){return this._coord},t.prototype.print=function(i){i.println("node "+this._coord+" lbl: "+this._label)},t.prototype.computeIM=function(i){},t.prototype.computeMergedLocation=function(i,o){var u=dt.NONE;if(u=this._label.getLocation(o),!i.isNull(o)){var s=i.getLocation(o);u!==dt.BOUNDARY&&(u=s)}return u},t.prototype.setLabel=function(){if(arguments.length===2){var i=arguments[0],o=arguments[1];this._label===null?this._label=new xr(i,o):this._label.setLocation(i,o)}else return n.prototype.setLabel.apply(this,arguments)},t.prototype.getEdges=function(){return this._edges},t.prototype.mergeLabel=function(){var i=this;if(arguments[0]instanceof t){var o=arguments[0];this.mergeLabel(o._label)}else if(arguments[0]instanceof xr)for(var u=arguments[0],s=0;s<2;s++){var y=i.computeMergedLocation(u,s),v=i._label.getLocation(s);v===dt.NONE&&i._label.setLocation(s,y)}},t.prototype.add=function(i){this._edges.insert(i),i.setNode(this)},t.prototype.setLabelBoundary=function(i){if(this._label===null)return null;var o=dt.NONE;this._label!==null&&(o=this._label.getLocation(i));var u=null;switch(o){case dt.BOUNDARY:u=dt.INTERIOR;break;case dt.INTERIOR:u=dt.BOUNDARY;break;default:u=dt.BOUNDARY;break}this._label.setLocation(i,u)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(xo),ka=function(){this.nodeMap=new yn,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};ka.prototype.find=function(t){return this.nodeMap.get(t)};ka.prototype.addNode=function(){if(arguments[0]instanceof ft){var t=arguments[0],e=this.nodeMap.get(t);return e===null&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}else if(arguments[0]instanceof ny){var i=arguments[0],o=this.nodeMap.get(i.getCoordinate());return o===null?(this.nodeMap.put(i.getCoordinate(),i),i):(o.mergeLabel(i),o)}};ka.prototype.print=function(t){for(var e=this.iterator();e.hasNext();){var i=e.next();i.print(t)}};ka.prototype.iterator=function(){return this.nodeMap.values().iterator()};ka.prototype.values=function(){return this.nodeMap.values()};ka.prototype.getBoundaryNodes=function(t){for(var e=new qt,i=this.iterator();i.hasNext();){var o=i.next();o.getLabel().getLocation(t)===dt.BOUNDARY&&e.add(o)}return e};ka.prototype.add=function(t){var e=t.getCoordinate(),i=this.addNode(e);i.add(t)};ka.prototype.interfaces_=function(){return[]};ka.prototype.getClass=function(){return ka};var Tr=function(){},Wf={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Tr.prototype.interfaces_=function(){return[]};Tr.prototype.getClass=function(){return Tr};Tr.isNorthern=function(t){return t===Tr.NE||t===Tr.NW};Tr.isOpposite=function(t,e){if(t===e)return!1;var i=(t-e+4)%4;return i===2};Tr.commonHalfPlane=function(t,e){if(t===e)return t;var i=(t-e+4)%4;if(i===2)return-1;var o=t<e?t:e,u=t>e?t:e;return o===0&&u===3?3:o};Tr.isInHalfPlane=function(t,e){return e===Tr.SE?t===Tr.SE||t===Tr.SW:t===e||t===e+1};Tr.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new Zr("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Tr.NE:Tr.SE:e>=0?Tr.NW:Tr.SW}else if(arguments[0]instanceof ft&&arguments[1]instanceof ft){var i=arguments[0],o=arguments[1];if(o.x===i.x&&o.y===i.y)throw new Zr("Cannot compute the quadrant for two identical points "+i);return o.x>=i.x?o.y>=i.y?Tr.NE:Tr.SE:o.y>=i.y?Tr.NW:Tr.SW}};Wf.NE.get=function(){return 0};Wf.NW.get=function(){return 1};Wf.SW.get=function(){return 2};Wf.SE.get=function(){return 3};Object.defineProperties(Tr,Wf);var mn=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var t=arguments[0];this._edge=t}else if(arguments.length===3){var e=arguments[0],i=arguments[1],o=arguments[2],u=null;this._edge=e,this.init(i,o),this._label=u}else if(arguments.length===4){var s=arguments[0],y=arguments[1],v=arguments[2],S=arguments[3];this._edge=s,this.init(y,v),this._label=S}};mn.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:Kt.computeOrientation(t._p0,t._p1,this._p1)};mn.prototype.getDy=function(){return this._dy};mn.prototype.getCoordinate=function(){return this._p0};mn.prototype.setNode=function(t){this._node=t};mn.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),i=this.getClass().getName(),o=i.lastIndexOf("."),u=i.substring(o+1);t.print("  "+u+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)};mn.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)};mn.prototype.getDirectedCoordinate=function(){return this._p1};mn.prototype.getDx=function(){return this._dx};mn.prototype.getLabel=function(){return this._label};mn.prototype.getEdge=function(){return this._edge};mn.prototype.getQuadrant=function(){return this._quadrant};mn.prototype.getNode=function(){return this._node};mn.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),i=e.lastIndexOf("."),o=e.substring(i+1);return"  "+o+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label};mn.prototype.computeLabel=function(t){};mn.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Tr.quadrant(this._dx,this._dy),Re.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")};mn.prototype.interfaces_=function(){return[Xo]};mn.prototype.getClass=function(){return mn};var Sm=function(n){function t(){var e=arguments[0],i=arguments[1];if(n.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=i,i)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var o=e.getNumPoints()-1;this.init(e.getCoordinate(o),e.getCoordinate(o-1))}this.computeDirectedLabel()}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.getNextMin=function(){return this._nextMin},t.prototype.getDepth=function(i){return this._depth[i]},t.prototype.setVisited=function(i){this._isVisited=i},t.prototype.computeDirectedLabel=function(){this._label=new xr(this._edge.getLabel()),this._isForward||this._label.flip()},t.prototype.getNext=function(){return this._next},t.prototype.setDepth=function(i,o){if(this._depth[i]!==-999&&this._depth[i]!==o)throw new Hs("assigned depths do not match",this.getCoordinate());this._depth[i]=o},t.prototype.isInteriorAreaEdge=function(){for(var i=this,o=!0,u=0;u<2;u++)i._label.isArea(u)&&i._label.getLocation(u,Nt.LEFT)===dt.INTERIOR&&i._label.getLocation(u,Nt.RIGHT)===dt.INTERIOR||(o=!1);return o},t.prototype.setNextMin=function(i){this._nextMin=i},t.prototype.print=function(i){n.prototype.print.call(this,i),i.print(" "+this._depth[Nt.LEFT]+"/"+this._depth[Nt.RIGHT]),i.print(" ("+this.getDepthDelta()+")"),this._isInResult&&i.print(" inResult")},t.prototype.setMinEdgeRing=function(i){this._minEdgeRing=i},t.prototype.isLineEdge=function(){var i=this._label.isLine(0)||this._label.isLine(1),o=!this._label.isArea(0)||this._label.allPositionsEqual(0,dt.EXTERIOR),u=!this._label.isArea(1)||this._label.allPositionsEqual(1,dt.EXTERIOR);return i&&o&&u},t.prototype.setEdgeRing=function(i){this._edgeRing=i},t.prototype.getMinEdgeRing=function(){return this._minEdgeRing},t.prototype.getDepthDelta=function(){var i=this._edge.getDepthDelta();return this._isForward||(i=-i),i},t.prototype.setInResult=function(i){this._isInResult=i},t.prototype.getSym=function(){return this._sym},t.prototype.isForward=function(){return this._isForward},t.prototype.getEdge=function(){return this._edge},t.prototype.printEdge=function(i){this.print(i),i.print(" "),this._isForward?this._edge.print(i):this._edge.printReverse(i)},t.prototype.setSym=function(i){this._sym=i},t.prototype.setVisitedEdge=function(i){this.setVisited(i),this._sym.setVisited(i)},t.prototype.setEdgeDepths=function(i,o){var u=this.getEdge().getDepthDelta();this._isForward||(u=-u);var s=1;i===Nt.LEFT&&(s=-1);var y=Nt.opposite(i),v=u*s,S=o+v;this.setDepth(i,o),this.setDepth(y,S)},t.prototype.getEdgeRing=function(){return this._edgeRing},t.prototype.isInResult=function(){return this._isInResult},t.prototype.setNext=function(i){this._next=i},t.prototype.isVisited=function(){return this._isVisited},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.depthFactor=function(i,o){return i===dt.EXTERIOR&&o===dt.INTERIOR?1:i===dt.INTERIOR&&o===dt.EXTERIOR?-1:0},t}(mn),Kh=function(){};Kh.prototype.createNode=function(t){return new ny(t,null)};Kh.prototype.interfaces_=function(){return[]};Kh.prototype.getClass=function(){return Kh};var Qr=function(){if(this._edges=new qt,this._nodes=null,this._edgeEndList=new qt,arguments.length===0)this._nodes=new ka(new Kh);else if(arguments.length===1){var t=arguments[0];this._nodes=new ka(t)}};Qr.prototype.printEdges=function(t){var e=this;t.println("Edges:");for(var i=0;i<this._edges.size();i++){t.println("edge "+i+":");var o=e._edges.get(i);o.print(t),o.eiList.print(t)}};Qr.prototype.find=function(t){return this._nodes.find(t)};Qr.prototype.addNode=function(){if(arguments[0]instanceof ny){var t=arguments[0];return this._nodes.addNode(t)}else if(arguments[0]instanceof ft){var e=arguments[0];return this._nodes.addNode(e)}};Qr.prototype.getNodeIterator=function(){return this._nodes.iterator()};Qr.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var e=t.next();e.getEdges().linkResultDirectedEdges()}};Qr.prototype.debugPrintln=function(t){an.out.println(t)};Qr.prototype.isBoundaryNode=function(t,e){var i=this._nodes.find(e);if(i===null)return!1;var o=i.getLabel();return o!==null&&o.getLocation(t)===dt.BOUNDARY};Qr.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var e=t.next();e.getEdges().linkAllDirectedEdges()}};Qr.prototype.matchInSameDirection=function(t,e,i,o){return t.equals(i)?Kt.computeOrientation(t,e,o)===Kt.COLLINEAR&&Tr.quadrant(t,e)===Tr.quadrant(i,o):!1};Qr.prototype.getEdgeEnds=function(){return this._edgeEndList};Qr.prototype.debugPrint=function(t){an.out.print(t)};Qr.prototype.getEdgeIterator=function(){return this._edges.iterator()};Qr.prototype.findEdgeInSameDirection=function(t,e){for(var i=this,o=0;o<this._edges.size();o++){var u=i._edges.get(o),s=u.getCoordinates();if(i.matchInSameDirection(t,e,s[0],s[1])||i.matchInSameDirection(t,e,s[s.length-1],s[s.length-2]))return u}return null};Qr.prototype.insertEdge=function(t){this._edges.add(t)};Qr.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var i=e.next();if(i.getEdge()===t)return i}return null};Qr.prototype.addEdges=function(t){for(var e=this,i=t.iterator();i.hasNext();){var o=i.next();e._edges.add(o);var u=new Sm(o,!0),s=new Sm(o,!1);u.setSym(s),s.setSym(u),e.add(u),e.add(s)}};Qr.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)};Qr.prototype.getNodes=function(){return this._nodes.values()};Qr.prototype.findEdge=function(t,e){for(var i=this,o=0;o<this._edges.size();o++){var u=i._edges.get(o),s=u.getCoordinates();if(t.equals(s[0])&&e.equals(s[1]))return u}return null};Qr.prototype.interfaces_=function(){return[]};Qr.prototype.getClass=function(){return Qr};Qr.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next();i.getEdges().linkResultDirectedEdges()}};var so=function(){this._geometryFactory=null,this._shellList=new qt;var t=arguments[0];this._geometryFactory=t};so.prototype.sortShellsAndHoles=function(t,e,i){for(var o=t.iterator();o.hasNext();){var u=o.next();u.isHole()?i.add(u):e.add(u)}};so.prototype.computePolygons=function(t){for(var e=this,i=new qt,o=t.iterator();o.hasNext();){var u=o.next(),s=u.toPolygon(e._geometryFactory);i.add(s)}return i};so.prototype.placeFreeHoles=function(t,e){for(var i=this,o=e.iterator();o.hasNext();){var u=o.next();if(u.getShell()===null){var s=i.findEdgeRingContaining(u,t);if(s===null)throw new Hs("unable to assign hole to a shell",u.getCoordinate(0));u.setShell(s)}}};so.prototype.buildMinimalEdgeRings=function(t,e,i){for(var o=this,u=new qt,s=t.iterator();s.hasNext();){var y=s.next();if(y.getMaxNodeDegree()>2){y.linkDirectedEdgesForMinimalEdgeRings();var v=y.buildMinimalRings(),S=o.findShell(v);S!==null?(o.placePolygonHoles(S,v),e.add(S)):i.addAll(v)}else u.add(y)}return u};so.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();){var i=e.next();if(i.containsPoint(t))return!0}return!1};so.prototype.buildMaximalEdgeRings=function(t){for(var e=this,i=new qt,o=t.iterator();o.hasNext();){var u=o.next();if(u.isInResult()&&u.getLabel().isArea()&&u.getEdgeRing()===null){var s=new iI(u,e._geometryFactory);i.add(s),s.setInResult()}}return i};so.prototype.placePolygonHoles=function(t,e){for(var i=e.iterator();i.hasNext();){var o=i.next();o.isHole()&&o.setShell(t)}};so.prototype.getPolygons=function(){var t=this.computePolygons(this._shellList);return t};so.prototype.findEdgeRingContaining=function(t,e){for(var i=t.getLinearRing(),o=i.getEnvelopeInternal(),u=i.getCoordinateN(0),s=null,y=null,v=e.iterator();v.hasNext();){var S=v.next(),L=S.getLinearRing(),k=L.getEnvelopeInternal();s!==null&&(y=s.getLinearRing().getEnvelopeInternal());var N=!1;k.contains(o)&&Kt.isPointInRing(u,L.getCoordinates())&&(N=!0),N&&(s===null||y.contains(k))&&(s=S)}return s};so.prototype.findShell=function(t){for(var e=0,i=null,o=t.iterator();o.hasNext();){var u=o.next();u.isHole()||(i=u,e++)}return Re.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),i};so.prototype.add=function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var e=arguments[0],i=arguments[1];Qr.linkResultDirectedEdges(i);var o=this.buildMaximalEdgeRings(e),u=new qt,s=this.buildMinimalEdgeRings(o,this._shellList,u);this.sortShellsAndHoles(s,this._shellList,u),this.placeFreeHoles(this._shellList,u)}};so.prototype.interfaces_=function(){return[]};so.prototype.getClass=function(){return so};var Jh=function(){};Jh.prototype.getBounds=function(){};Jh.prototype.interfaces_=function(){return[]};Jh.prototype.getClass=function(){return Jh};var ua=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};ua.prototype.getItem=function(){return this._item};ua.prototype.getBounds=function(){return this._bounds};ua.prototype.interfaces_=function(){return[Jh,Zo]};ua.prototype.getClass=function(){return ua};var Xs=function(){this._size=null,this._items=null,this._size=0,this._items=new qt,this._items.add(null)};Xs.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t};Xs.prototype.size=function(){return this._size};Xs.prototype.reorder=function(t){for(var e=this,i=null,o=this._items.get(t);t*2<=this._size&&(i=t*2,i!==e._size&&e._items.get(i+1).compareTo(e._items.get(i))<0&&i++,e._items.get(i).compareTo(o)<0);t=i)e._items.set(t,e._items.get(i));this._items.set(t,o)};Xs.prototype.clear=function(){this._size=0,this._items.clear()};Xs.prototype.isEmpty=function(){return this._size===0};Xs.prototype.add=function(t){var e=this;this._items.add(null),this._size+=1;var i=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(i/2)))<0;i/=2)e._items.set(i,e._items.get(Math.trunc(i/2)));this._items.set(i,t)};Xs.prototype.interfaces_=function(){return[]};Xs.prototype.getClass=function(){return Xs};var Du=function(){};Du.prototype.visitItem=function(t){};Du.prototype.interfaces_=function(){return[]};Du.prototype.getClass=function(){return Du};var mc=function(){};mc.prototype.insert=function(t,e){};mc.prototype.remove=function(t,e){};mc.prototype.query=function(){};mc.prototype.interfaces_=function(){return[]};mc.prototype.getClass=function(){return mc};var Ni=function(){if(this._childBoundables=new qt,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._level=t}}},jx={serialVersionUID:{configurable:!0}};Ni.prototype.getLevel=function(){return this._level};Ni.prototype.size=function(){return this._childBoundables.size()};Ni.prototype.getChildBoundables=function(){return this._childBoundables};Ni.prototype.addChildBoundable=function(t){Re.isTrue(this._bounds===null),this._childBoundables.add(t)};Ni.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};Ni.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds};Ni.prototype.interfaces_=function(){return[Jh,Zo]};Ni.prototype.getClass=function(){return Ni};jx.serialVersionUID.get=function(){return 6493722185909574e3};Object.defineProperties(Ni,jx);var la=function(){};la.reverseOrder=function(){return{compare:function(e,i){return i.compareTo(e)}}};la.min=function(t){return la.sort(t),t.get(0)};la.sort=function(t,e){var i=t.toArray();e?fl.sort(i,e):fl.sort(i);for(var o=t.iterator(),u=0,s=i.length;u<s;u++)o.next(),o.set(i[u])};la.singletonList=function(t){var e=new qt;return e.add(t),e};var Ei=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],i=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=i,this._distance=this.distance()};Ei.prototype.expandToQueue=function(t,e){var i=Ei.isComposite(this._boundable1),o=Ei.isComposite(this._boundable2);if(i&&o)return Ei.area(this._boundable1)>Ei.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(i)return this.expand(this._boundable1,this._boundable2,t,e),null;if(o)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new Zr("neither boundable is composite")};Ei.prototype.isLeaves=function(){return!(Ei.isComposite(this._boundable1)||Ei.isComposite(this._boundable2))};Ei.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0};Ei.prototype.expand=function(t,e,i,o){for(var u=this,s=t.getChildBoundables(),y=s.iterator();y.hasNext();){var v=y.next(),S=new Ei(v,e,u._itemDistance);S.getDistance()<o&&i.add(S)}};Ei.prototype.getBoundable=function(t){return t===0?this._boundable1:this._boundable2};Ei.prototype.getDistance=function(){return this._distance};Ei.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};Ei.prototype.interfaces_=function(){return[Xo]};Ei.prototype.getClass=function(){return Ei};Ei.area=function(t){return t.getBounds().getArea()};Ei.isComposite=function(t){return t instanceof Ni};var Wi=function n(){if(this._root=null,this._built=!1,this._itemBoundables=new qt,this._nodeCapacity=null,arguments.length===0){var t=n.DEFAULT_NODE_CAPACITY;this._nodeCapacity=t}else if(arguments.length===1){var e=arguments[0];Re.isTrue(e>1,"Node capacity must be greater than 1"),this._nodeCapacity=e}},oy={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Wi.prototype.getNodeCapacity=function(){return this._nodeCapacity};Wi.prototype.lastNode=function(t){return t.get(t.size()-1)};Wi.prototype.size=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var e=arguments[0],i=0,o=e.getChildBoundables().iterator();o.hasNext();){var u=o.next();u instanceof Ni?i+=t.size(u):u instanceof ua&&(i+=1)}return i}};Wi.prototype.removeItem=function(t,e){for(var i=null,o=t.getChildBoundables().iterator();o.hasNext();){var u=o.next();u instanceof ua&&u.getItem()===e&&(i=u)}return i!==null?(t.getChildBoundables().remove(i),!0):!1};Wi.prototype.itemsTree=function(){var t=this;if(arguments.length===0){this.build();var e=this.itemsTree(this._root);return e===null?new qt:e}else if(arguments.length===1){for(var i=arguments[0],o=new qt,u=i.getChildBoundables().iterator();u.hasNext();){var s=u.next();if(s instanceof Ni){var y=t.itemsTree(s);y!==null&&o.add(y)}else s instanceof ua?o.add(s.getItem()):Re.shouldNeverReachHere()}return o.size()<=0?null:o}};Wi.prototype.insert=function(t,e){Re.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new ua(t,e))};Wi.prototype.boundablesAtLevel=function(){var t=this;if(arguments.length===1){var e=arguments[0],i=new qt;return this.boundablesAtLevel(e,this._root,i),i}else if(arguments.length===3){var o=arguments[0],u=arguments[1],s=arguments[2];if(Re.isTrue(o>-2),u.getLevel()===o)return s.add(u),null;for(var y=u.getChildBoundables().iterator();y.hasNext();){var v=y.next();v instanceof Ni?t.boundablesAtLevel(o,v,s):(Re.isTrue(v instanceof ua),o===-1&&s.add(v))}return null}};Wi.prototype.query=function(){var t=this;if(arguments.length===1){var e=arguments[0];this.build();var i=new qt;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.query(e,this._root,i),i}else if(arguments.length===2){var o=arguments[0],u=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.query(o,this._root,u)}else if(arguments.length===3){if(Ie(arguments[2],Du)&&arguments[0]instanceof Object&&arguments[1]instanceof Ni)for(var s=arguments[0],y=arguments[1],v=arguments[2],S=y.getChildBoundables(),L=0;L<S.size();L++){var k=S.get(L);!t.getIntersectsOp().intersects(k.getBounds(),s)||(k instanceof Ni?t.query(s,k,v):k instanceof ua?v.visitItem(k.getItem()):Re.shouldNeverReachHere())}else if(Ie(arguments[2],oa)&&arguments[0]instanceof Object&&arguments[1]instanceof Ni)for(var N=arguments[0],Q=arguments[1],tt=arguments[2],xt=Q.getChildBoundables(),mt=0;mt<xt.size();mt++){var Ct=xt.get(mt);!t.getIntersectsOp().intersects(Ct.getBounds(),N)||(Ct instanceof Ni?t.query(N,Ct,tt):Ct instanceof ua?tt.add(Ct.getItem()):Re.shouldNeverReachHere())}}};Wi.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0};Wi.prototype.getRoot=function(){return this.build(),this._root};Wi.prototype.remove=function(){var t=this;if(arguments.length===2){var e=arguments[0],i=arguments[1];return this.build(),this.getIntersectsOp().intersects(this._root.getBounds(),e)?this.remove(e,this._root,i):!1}else if(arguments.length===3){var o=arguments[0],u=arguments[1],s=arguments[2],y=this.removeItem(u,s);if(y)return!0;for(var v=null,S=u.getChildBoundables().iterator();S.hasNext();){var L=S.next();if(!!t.getIntersectsOp().intersects(L.getBounds(),o)&&L instanceof Ni&&(y=t.remove(o,L,s),y)){v=L;break}}return v!==null&&v.getChildBoundables().isEmpty()&&u.getChildBoundables().remove(v),y}};Wi.prototype.createHigherLevels=function(t,e){Re.isTrue(!t.isEmpty());var i=this.createParentBoundables(t,e+1);return i.size()===1?i.get(0):this.createHigherLevels(i,e+1)};Wi.prototype.depth=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var e=arguments[0],i=0,o=e.getChildBoundables().iterator();o.hasNext();){var u=o.next();if(u instanceof Ni){var s=t.depth(u);s>i&&(i=s)}}return i+1}};Wi.prototype.createParentBoundables=function(t,e){var i=this;Re.isTrue(!t.isEmpty());var o=new qt;o.add(this.createNode(e));var u=new qt(t);la.sort(u,this.getComparator());for(var s=u.iterator();s.hasNext();){var y=s.next();i.lastNode(o).getChildBoundables().size()===i.getNodeCapacity()&&o.add(i.createNode(e)),i.lastNode(o).addChildBoundable(y)}return o};Wi.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};Wi.prototype.interfaces_=function(){return[Zo]};Wi.prototype.getClass=function(){return Wi};Wi.compareDoubles=function(t,e){return t>e?1:t<e?-1:0};oy.IntersectsOp.get=function(){return nI};oy.serialVersionUID.get=function(){return-3886435814360241e3};oy.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(Wi,oy);var nI=function(){},Qh=function(){};Qh.prototype.distance=function(t,e){};Qh.prototype.interfaces_=function(){return[]};Qh.prototype.getClass=function(){return Qh};var Gx=function(n){function t(i){i=i||t.DEFAULT_NODE_CAPACITY,n.call(this,i)}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return t.prototype.createParentBoundablesFromVerticalSlices=function(o,u){var s=this;Re.isTrue(o.length>0);for(var y=new qt,v=0;v<o.length;v++)y.addAll(s.createParentBoundablesFromVerticalSlice(o[v],u));return y},t.prototype.createNode=function(o){return new f0(o)},t.prototype.size=function(){return arguments.length===0?n.prototype.size.call(this):n.prototype.size.apply(this,arguments)},t.prototype.insert=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];if(o.isNull())return null;n.prototype.insert.call(this,o,u)}else return n.prototype.insert.apply(this,arguments)},t.prototype.getIntersectsOp=function(){return t.intersectsOp},t.prototype.verticalSlices=function(o,u){for(var s=Math.trunc(Math.ceil(o.size()/u)),y=new Array(u).fill(null),v=o.iterator(),S=0;S<u;S++){y[S]=new qt;for(var L=0;v.hasNext()&&L<s;){var k=v.next();y[S].add(k),L++}}return y},t.prototype.query=function(){if(arguments.length===1){var o=arguments[0];return n.prototype.query.call(this,o)}else if(arguments.length===2){var u=arguments[0],s=arguments[1];n.prototype.query.call(this,u,s)}else if(arguments.length===3){if(Ie(arguments[2],Du)&&arguments[0]instanceof Object&&arguments[1]instanceof Ni){var y=arguments[0],v=arguments[1],S=arguments[2];n.prototype.query.call(this,y,v,S)}else if(Ie(arguments[2],oa)&&arguments[0]instanceof Object&&arguments[1]instanceof Ni){var L=arguments[0],k=arguments[1],N=arguments[2];n.prototype.query.call(this,L,k,N)}}},t.prototype.getComparator=function(){return t.yComparator},t.prototype.createParentBoundablesFromVerticalSlice=function(o,u){return n.prototype.createParentBoundables.call(this,o,u)},t.prototype.remove=function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];return n.prototype.remove.call(this,o,u)}else return n.prototype.remove.apply(this,arguments)},t.prototype.depth=function(){return arguments.length===0?n.prototype.depth.call(this):n.prototype.depth.apply(this,arguments)},t.prototype.createParentBoundables=function(o,u){Re.isTrue(!o.isEmpty());var s=Math.trunc(Math.ceil(o.size()/this.getNodeCapacity())),y=new qt(o);la.sort(y,t.xComparator);var v=this.verticalSlices(y,Math.trunc(Math.ceil(Math.sqrt(s))));return this.createParentBoundablesFromVerticalSlices(v,u)},t.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Ie(arguments[0],Qh)){var o=arguments[0],u=new Ei(this.getRoot(),this.getRoot(),o);return this.nearestNeighbour(u)}else if(arguments[0]instanceof Ei){var s=arguments[0];return this.nearestNeighbour(s,Ae.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof t&&Ie(arguments[1],Qh)){var y=arguments[0],v=arguments[1],S=new Ei(this.getRoot(),y.getRoot(),v);return this.nearestNeighbour(S)}else if(arguments[0]instanceof Ei&&typeof arguments[1]=="number"){var L=arguments[0],k=arguments[1],N=k,Q=null,tt=new Xs;for(tt.add(L);!tt.isEmpty()&&N>0;){var xt=tt.poll(),mt=xt.getDistance();if(mt>=N)break;xt.isLeaves()?(N=mt,Q=xt):xt.expandToQueue(tt,N)}return[Q.getBoundable(0).getItem(),Q.getBoundable(1).getItem()]}}else if(arguments.length===3){var Ct=arguments[0],ut=arguments[1],Pt=arguments[2],Ft=new ua(Ct,ut),ie=new Ei(this.getRoot(),Ft,Pt);return this.nearestNeighbour(ie)[0]}},t.prototype.interfaces_=function(){return[mc,Zo]},t.prototype.getClass=function(){return t},t.centreX=function(o){return t.avg(o.getMinX(),o.getMaxX())},t.avg=function(o,u){return(o+u)/2},t.centreY=function(o){return t.avg(o.getMinY(),o.getMaxY())},e.STRtreeNode.get=function(){return f0},e.serialVersionUID.get=function(){return 0x39920f7d5f261e0},e.xComparator.get=function(){return{interfaces_:function(){return[qh]},compare:function(i,o){return n.compareDoubles(t.centreX(i.getBounds()),t.centreX(o.getBounds()))}}},e.yComparator.get=function(){return{interfaces_:function(){return[qh]},compare:function(i,o){return n.compareDoubles(t.centreY(i.getBounds()),t.centreY(o.getBounds()))}}},e.intersectsOp.get=function(){return{interfaces_:function(){return[n.IntersectsOp]},intersects:function(i,o){return i.intersects(o)}}},e.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(t,e),t}(Wi),f0=function(n){function t(){var e=arguments[0];n.call(this,e)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.computeBounds=function(){for(var i=null,o=this.getChildBoundables().iterator();o.hasNext();){var u=o.next();i===null?i=new fe(u.getBounds()):i.expandToInclude(u.getBounds())}return i},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ni),Hn=function(){};Hn.prototype.interfaces_=function(){return[]};Hn.prototype.getClass=function(){return Hn};Hn.relativeSign=function(t,e){return t<e?-1:t>e?1:0};Hn.compare=function(t,e,i){if(e.equals2D(i))return 0;var o=Hn.relativeSign(e.x,i.x),u=Hn.relativeSign(e.y,i.y);switch(t){case 0:return Hn.compareValue(o,u);case 1:return Hn.compareValue(u,o);case 2:return Hn.compareValue(u,-o);case 3:return Hn.compareValue(-o,u);case 4:return Hn.compareValue(-o,-u);case 5:return Hn.compareValue(-u,-o);case 6:return Hn.compareValue(-u,o);case 7:return Hn.compareValue(o,-u)}return Re.shouldNeverReachHere("invalid octant value"),0};Hn.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var Ou=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],i=arguments[2],o=arguments[3];this._segString=t,this.coord=new ft(e),this.segmentIndex=i,this._segmentOctant=o,this._isInterior=!e.equals2D(t.getCoordinate(i))};Ou.prototype.getCoordinate=function(){return this.coord};Ou.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)};Ou.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:Hn.compare(this._segmentOctant,this.coord,e.coord)};Ou.prototype.isEndPoint=function(t){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===t};Ou.prototype.isInterior=function(){return this._isInterior};Ou.prototype.interfaces_=function(){return[Xo]};Ou.prototype.getClass=function(){return Ou};var Fn=function(){this._nodeMap=new yn,this._edge=null;var t=arguments[0];this._edge=t};Fn.prototype.getSplitCoordinates=function(){var t=this,e=new Zf;this.addEndpoints();for(var i=this.iterator(),o=i.next();i.hasNext();){var u=i.next();t.addEdgeCoordinates(o,u,e),o=u}return e.toCoordinateArray()};Fn.prototype.addCollapsedNodes=function(){var t=this,e=new qt;this.findCollapsesFromInsertedNodes(e),this.findCollapsesFromExistingVertices(e);for(var i=e.iterator();i.hasNext();){var o=i.next().intValue();t.add(t._edge.getCoordinate(o),o)}};Fn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){var i=e.next();i.print(t)}};Fn.prototype.findCollapsesFromExistingVertices=function(t){for(var e=this,i=0;i<this._edge.size()-2;i++){var o=e._edge.getCoordinate(i),u=e._edge.getCoordinate(i+2);o.equals2D(u)&&t.add(new Ta(i+1))}};Fn.prototype.addEdgeCoordinates=function(t,e,i){var o=this,u=this._edge.getCoordinate(e.segmentIndex),s=e.isInterior()||!e.coord.equals2D(u);i.add(new ft(t.coord),!1);for(var y=t.segmentIndex+1;y<=e.segmentIndex;y++)i.add(o._edge.getCoordinate(y));s&&i.add(new ft(e.coord))};Fn.prototype.iterator=function(){return this._nodeMap.values().iterator()};Fn.prototype.addSplitEdges=function(t){var e=this;this.addEndpoints(),this.addCollapsedNodes();for(var i=this.iterator(),o=i.next();i.hasNext();){var u=i.next(),s=e.createSplitEdge(o,u);t.add(s),o=u}};Fn.prototype.findCollapseIndex=function(t,e,i){if(!t.coord.equals2D(e.coord))return!1;var o=e.segmentIndex-t.segmentIndex;return e.isInterior()||o--,o===1?(i[0]=t.segmentIndex+1,!0):!1};Fn.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=this,i=new Array(1).fill(null),o=this.iterator(),u=o.next();o.hasNext();){var s=o.next(),y=e.findCollapseIndex(u,s,i);y&&t.add(new Ta(i[0])),u=s}};Fn.prototype.getEdge=function(){return this._edge};Fn.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)};Fn.prototype.createSplitEdge=function(t,e){var i=this,o=e.segmentIndex-t.segmentIndex+2,u=this._edge.getCoordinate(e.segmentIndex),s=e.isInterior()||!e.coord.equals2D(u);s||o--;var y=new Array(o).fill(null),v=0;y[v++]=new ft(t.coord);for(var S=t.segmentIndex+1;S<=e.segmentIndex;S++)y[v++]=i._edge.getCoordinate(S);return s&&(y[v]=new ft(e.coord)),new _i(y,this._edge.getData())};Fn.prototype.add=function(t,e){var i=new Ou(this._edge,t,e,this._edge.getSegmentOctant(e)),o=this._nodeMap.get(i);return o!==null?(Re.isTrue(o.coord.equals2D(t),"Found equal nodes with different coordinates"),o):(this._nodeMap.put(i,i),i)};Fn.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),i=t.get(0),o=i.getCoordinate(0);if(!o.equals2D(e[0]))throw new js("bad split edge start point at "+o);var u=t.get(t.size()-1),s=u.getCoordinates(),y=s[s.length-1];if(!y.equals2D(e[e.length-1]))throw new js("bad split edge end point at "+y)};Fn.prototype.interfaces_=function(){return[]};Fn.prototype.getClass=function(){return Fn};var _c=function(){};_c.prototype.interfaces_=function(){return[]};_c.prototype.getClass=function(){return _c};_c.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new Zr("Cannot compute the octant for point ( "+t+", "+e+" )");var i=Math.abs(t),o=Math.abs(e);return t>=0?e>=0?i>=o?0:1:i>=o?7:6:e>=0?i>=o?3:2:i>=o?4:5}else if(arguments[0]instanceof ft&&arguments[1]instanceof ft){var u=arguments[0],s=arguments[1],y=s.x-u.x,v=s.y-u.y;if(y===0&&v===0)throw new Zr("Cannot compute the octant for two identical points "+u);return _c.octant(y,v)}};var os=function(){};os.prototype.getCoordinates=function(){};os.prototype.size=function(){};os.prototype.getCoordinate=function(t){};os.prototype.isClosed=function(){};os.prototype.setData=function(t){};os.prototype.getData=function(){};os.prototype.interfaces_=function(){return[]};os.prototype.getClass=function(){return os};var Df=function(){};Df.prototype.addIntersection=function(t,e){};Df.prototype.interfaces_=function(){return[os]};Df.prototype.getClass=function(){return Df};var _i=function(){this._nodeList=new Fn(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};_i.prototype.getCoordinates=function(){return this._pts};_i.prototype.size=function(){return this._pts.length};_i.prototype.getCoordinate=function(t){return this._pts[t]};_i.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};_i.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))};_i.prototype.setData=function(t){this._data=t};_i.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:_c.octant(t,e)};_i.prototype.getData=function(){return this._data};_i.prototype.addIntersection=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(arguments.length===4){var i=arguments[0],o=arguments[1],u=arguments[3],s=new ft(i.getIntersection(u));this.addIntersection(s,o)}};_i.prototype.toString=function(){return aa.toLineString(new di(this._pts))};_i.prototype.getNodeList=function(){return this._nodeList};_i.prototype.addIntersectionNode=function(t,e){var i=e,o=i+1;if(o<this._pts.length){var u=this._pts[o];t.equals2D(u)&&(i=o)}var s=this._nodeList.add(t,i);return s};_i.prototype.addIntersections=function(t,e,i){for(var o=this,u=0;u<t.getIntersectionNum();u++)o.addIntersection(t,e,i,u)};_i.prototype.interfaces_=function(){return[Df]};_i.prototype.getClass=function(){return _i};_i.getNodedSubstrings=function(){if(arguments.length===1){var t=arguments[0],e=new qt;return _i.getNodedSubstrings(t,e),e}else if(arguments.length===2)for(var i=arguments[0],o=arguments[1],u=i.iterator();u.hasNext();){var s=u.next();s.getNodeList().addSplitEdges(o)}};var ge=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new ft,this.p1=new ft;else if(arguments.length===1){var t=arguments[0];this.p0=new ft(t.p0),this.p1=new ft(t.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var e=arguments[0],i=arguments[1],o=arguments[2],u=arguments[3];this.p0=new ft(e,i),this.p1=new ft(o,u)}},Hx={serialVersionUID:{configurable:!0}};ge.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};ge.prototype.orientationIndex=function(){if(arguments[0]instanceof ge){var t=arguments[0],e=Kt.orientationIndex(this.p0,this.p1,t.p0),i=Kt.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&i>=0||e<=0&&i<=0?Math.max(e,i):0}else if(arguments[0]instanceof ft){var o=arguments[0];return Kt.orientationIndex(this.p0,this.p1,o)}};ge.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])};ge.prototype.isVertical=function(){return this.p0.x===this.p1.x};ge.prototype.equals=function(t){if(!(t instanceof ge))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)};ge.prototype.intersection=function(t){var e=new Sl;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null};ge.prototype.project=function(){if(arguments[0]instanceof ft){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new ft(t);var e=this.projectionFactor(t),i=new ft;return i.x=this.p0.x+e*(this.p1.x-this.p0.x),i.y=this.p0.y+e*(this.p1.y-this.p0.y),i}else if(arguments[0]instanceof ge){var o=arguments[0],u=this.projectionFactor(o.p0),s=this.projectionFactor(o.p1);if(u>=1&&s>=1||u<=0&&s<=0)return null;var y=this.project(o.p0);u<0&&(y=this.p0),u>1&&(y=this.p1);var v=this.project(o.p1);return s<0&&(v=this.p0),s>1&&(v=this.p1),new ge(y,v)}};ge.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()};ge.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};ge.prototype.getCoordinate=function(t){return t===0?this.p0:this.p1};ge.prototype.distancePerpendicular=function(t){return Kt.distancePointLinePerpendicular(t,this.p0,this.p1)};ge.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)};ge.prototype.midPoint=function(){return ge.midPoint(this.p0,this.p1)};ge.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,o=e*e+i*i;if(o<=0)return Ae.NaN;var u=((t.x-this.p0.x)*e+(t.y-this.p0.y)*i)/o;return u};ge.prototype.closestPoints=function(t){var e=this.intersection(t);if(e!==null)return[e,e];var i=new Array(2).fill(null),o=Ae.MAX_VALUE,u=null,s=this.closestPoint(t.p0);o=s.distance(t.p0),i[0]=s,i[1]=t.p0;var y=this.closestPoint(t.p1);u=y.distance(t.p1),u<o&&(o=u,i[0]=y,i[1]=t.p1);var v=t.closestPoint(this.p0);u=v.distance(this.p0),u<o&&(o=u,i[0]=this.p0,i[1]=v);var S=t.closestPoint(this.p1);return u=S.distance(this.p1),u<o&&(o=u,i[0]=this.p1,i[1]=S),i};ge.prototype.closestPoint=function(t){var e=this.projectionFactor(t);if(e>0&&e<1)return this.project(t);var i=this.p0.distance(t),o=this.p1.distance(t);return i<o?this.p0:this.p1};ge.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};ge.prototype.getLength=function(){return this.p0.distance(this.p1)};ge.prototype.compareTo=function(t){var e=t,i=this.p0.compareTo(e.p0);return i!==0?i:this.p1.compareTo(e.p1)};ge.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t};ge.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)};ge.prototype.lineIntersection=function(t){try{var e=na.intersection(this.p0,this.p1,t.p0,t.p1);return e}catch(i){if(!(i instanceof cp))throw i}finally{}return null};ge.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};ge.prototype.pointAlongOffset=function(t,e){var i=this.p0.x+t*(this.p1.x-this.p0.x),o=this.p0.y+t*(this.p1.y-this.p0.y),u=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,y=Math.sqrt(u*u+s*s),v=0,S=0;if(e!==0){if(y<=0)throw new Error("Cannot compute offset from zero-length line segment");v=e*u/y,S=e*s/y}var L=i-S,k=o+v,N=new ft(L,k);return N};ge.prototype.setCoordinates=function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var e=arguments[0],i=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=i.x,this.p1.y=i.y}};ge.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||Ae.isNaN(e))&&(e=1),e};ge.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};ge.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};ge.prototype.distance=function(){if(arguments[0]instanceof ge){var t=arguments[0];return Kt.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}else if(arguments[0]instanceof ft){var e=arguments[0];return Kt.distancePointLine(e,this.p0,this.p1)}};ge.prototype.pointAlong=function(t){var e=new ft;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e};ge.prototype.hashCode=function(){var t=Ae.doubleToLongBits(this.p0.x);t^=Ae.doubleToLongBits(this.p0.y)*31;var e=Math.trunc(t)^Math.trunc(t>>32),i=Ae.doubleToLongBits(this.p1.x);i^=Ae.doubleToLongBits(this.p1.y)*31;var o=Math.trunc(i)^Math.trunc(i>>32);return e^o};ge.prototype.interfaces_=function(){return[Xo,Zo]};ge.prototype.getClass=function(){return ge};ge.midPoint=function(t,e){return new ft((t.x+e.x)/2,(t.y+e.y)/2)};Hx.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(ge,Hx);var Of=function(){this.tempEnv1=new fe,this.tempEnv2=new fe,this._overlapSeg1=new ge,this._overlapSeg2=new ge};Of.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var t=arguments[0],e=arguments[1],i=arguments[2],o=arguments[3];t.getLineSegment(e,this._overlapSeg1),i.getLineSegment(o,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}};Of.prototype.interfaces_=function(){return[]};Of.prototype.getClass=function(){return Of};var uo=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],i=arguments[2],o=arguments[3];this._pts=t,this._start=e,this._end=i,this._context=o};uo.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]};uo.prototype.computeSelect=function(t,e,i,o){var u=this._pts[e],s=this._pts[i];if(o.tempEnv1.init(u,s),i-e===1)return o.select(this,e),null;if(!t.intersects(o.tempEnv1))return null;var y=Math.trunc((e+i)/2);e<y&&this.computeSelect(t,e,y,o),y<i&&this.computeSelect(t,y,i,o)};uo.prototype.getCoordinates=function(){for(var t=this,e=new Array(this._end-this._start+1).fill(null),i=0,o=this._start;o<=this._end;o++)e[i++]=t._pts[o];return e};uo.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)};uo.prototype.setId=function(t){this._id=t};uo.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)};uo.prototype.getEnvelope=function(){if(this._env===null){var t=this._pts[this._start],e=this._pts[this._end];this._env=new fe(t,e)}return this._env};uo.prototype.getEndIndex=function(){return this._end};uo.prototype.getStartIndex=function(){return this._start};uo.prototype.getContext=function(){return this._context};uo.prototype.getId=function(){return this._id};uo.prototype.computeOverlapsInternal=function(t,e,i,o,u,s){var y=this._pts[t],v=this._pts[e],S=i._pts[o],L=i._pts[u];if(e-t===1&&u-o===1)return s.overlap(this,t,i,o),null;if(s.tempEnv1.init(y,v),s.tempEnv2.init(S,L),!s.tempEnv1.intersects(s.tempEnv2))return null;var k=Math.trunc((t+e)/2),N=Math.trunc((o+u)/2);t<k&&(o<N&&this.computeOverlapsInternal(t,k,i,o,N,s),N<u&&this.computeOverlapsInternal(t,k,i,N,u,s)),k<e&&(o<N&&this.computeOverlapsInternal(k,e,i,o,N,s),N<u&&this.computeOverlapsInternal(k,e,i,N,u,s))};uo.prototype.interfaces_=function(){return[]};uo.prototype.getClass=function(){return uo};var Pa=function(){};Pa.prototype.interfaces_=function(){return[]};Pa.prototype.getClass=function(){return Pa};Pa.getChainStartIndices=function(t){var e=0,i=new qt;i.add(new Ta(e));do{var o=Pa.findChainEnd(t,e);i.add(new Ta(o)),e=o}while(e<t.length-1);var u=Pa.toIntArray(i);return u};Pa.findChainEnd=function(t,e){for(var i=e;i<t.length-1&&t[i].equals2D(t[i+1]);)i++;if(i>=t.length-1)return t.length-1;for(var o=Tr.quadrant(t[i],t[i+1]),u=e+1;u<t.length;){if(!t[u-1].equals2D(t[u])){var s=Tr.quadrant(t[u-1],t[u]);if(s!==o)break}u++}return u-1};Pa.getChains=function(){if(arguments.length===1){var t=arguments[0];return Pa.getChains(t,null)}else if(arguments.length===2){for(var e=arguments[0],i=arguments[1],o=new qt,u=Pa.getChainStartIndices(e),s=0;s<u.length-1;s++){var y=new uo(e,u[s],u[s+1],i);o.add(y)}return o}};Pa.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e};var yl=function(){};yl.prototype.computeNodes=function(t){};yl.prototype.getNodedSubstrings=function(){};yl.prototype.interfaces_=function(){return[]};yl.prototype.getClass=function(){return yl};var kf=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setSegmentIntersector(t)}}};kf.prototype.setSegmentIntersector=function(t){this._segInt=t};kf.prototype.interfaces_=function(){return[yl]};kf.prototype.getClass=function(){return kf};var Wm=function(n){function t(i){i?n.call(this,i):n.call(this),this._monoChains=new qt,this._index=new Gx,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={SegmentOverlapAction:{configurable:!0}};return t.prototype.getMonotoneChains=function(){return this._monoChains},t.prototype.getNodedSubstrings=function(){return _i.getNodedSubstrings(this._nodedSegStrings)},t.prototype.getIndex=function(){return this._index},t.prototype.add=function(o){for(var u=this,s=Pa.getChains(o.getCoordinates(),o),y=s.iterator();y.hasNext();){var v=y.next();v.setId(u._idCounter++),u._index.insert(v.getEnvelope(),v),u._monoChains.add(v)}},t.prototype.computeNodes=function(o){var u=this;this._nodedSegStrings=o;for(var s=o.iterator();s.hasNext();)u.add(s.next());this.intersectChains()},t.prototype.intersectChains=function(){for(var o=this,u=new d0(this._segInt),s=this._monoChains.iterator();s.hasNext();)for(var y=s.next(),v=o._index.query(y.getEnvelope()),S=v.iterator();S.hasNext();){var L=S.next();if(L.getId()>y.getId()&&(y.computeOverlaps(L,u),o._nOverlaps++),o._segInt.isDone())return null}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},e.SegmentOverlapAction.get=function(){return d0},Object.defineProperties(t,e),t}(kf),d0=function(n){function t(){n.call(this),this._si=null;var e=arguments[0];this._si=e}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.overlap=function(){if(arguments.length===4){var i=arguments[0],o=arguments[1],u=arguments[2],s=arguments[3],y=i.getContext(),v=u.getContext();this._si.processIntersections(y,o,v,s)}else return n.prototype.overlap.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Of),hr=function n(){if(this._quadrantSegments=n.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=n.CAP_ROUND,this._joinStyle=n.JOIN_ROUND,this._mitreLimit=n.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=n.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setQuadrantSegments(t)}else if(arguments.length===2){var e=arguments[0],i=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(i)}else if(arguments.length===4){var o=arguments[0],u=arguments[1],s=arguments[2],y=arguments[3];this.setQuadrantSegments(o),this.setEndCapStyle(u),this.setJoinStyle(s),this.setMitreLimit(y)}}},Js={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};hr.prototype.getEndCapStyle=function(){return this._endCapStyle};hr.prototype.isSingleSided=function(){return this._isSingleSided};hr.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,this._quadrantSegments===0&&(this._joinStyle=hr.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=hr.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==hr.JOIN_ROUND&&(this._quadrantSegments=hr.DEFAULT_QUADRANT_SEGMENTS)};hr.prototype.getJoinStyle=function(){return this._joinStyle};hr.prototype.setJoinStyle=function(t){this._joinStyle=t};hr.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t};hr.prototype.getSimplifyFactor=function(){return this._simplifyFactor};hr.prototype.getQuadrantSegments=function(){return this._quadrantSegments};hr.prototype.setEndCapStyle=function(t){this._endCapStyle=t};hr.prototype.getMitreLimit=function(){return this._mitreLimit};hr.prototype.setMitreLimit=function(t){this._mitreLimit=t};hr.prototype.setSingleSided=function(t){this._isSingleSided=t};hr.prototype.interfaces_=function(){return[]};hr.prototype.getClass=function(){return hr};hr.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)};Js.CAP_ROUND.get=function(){return 1};Js.CAP_FLAT.get=function(){return 2};Js.CAP_SQUARE.get=function(){return 3};Js.JOIN_ROUND.get=function(){return 1};Js.JOIN_MITRE.get=function(){return 2};Js.JOIN_BEVEL.get=function(){return 3};Js.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};Js.DEFAULT_MITRE_LIMIT.get=function(){return 5};Js.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01};Object.defineProperties(hr,Js);var ai=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Kt.COUNTERCLOCKWISE,this._inputLine=t||null},Kf={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};ai.prototype.isDeletable=function(t,e,i,o){var u=this._inputLine[t],s=this._inputLine[e],y=this._inputLine[i];return!this.isConcave(u,s,y)||!this.isShallow(u,s,y,o)?!1:this.isShallowSampled(u,s,t,i,o)};ai.prototype.deleteShallowConcavities=function(){for(var t=this,e=1,i=this.findNextNonDeletedIndex(e),o=this.findNextNonDeletedIndex(i),u=!1;o<this._inputLine.length;){var s=!1;t.isDeletable(e,i,o,t._distanceTol)&&(t._isDeleted[i]=ai.DELETE,s=!0,u=!0),s?e=o:e=i,i=t.findNextNonDeletedIndex(e),o=t.findNextNonDeletedIndex(i)}return u};ai.prototype.isShallowConcavity=function(t,e,i,o){var u=Kt.computeOrientation(t,e,i),s=u===this._angleOrientation;if(!s)return!1;var y=Kt.distancePointLine(e,t,i);return y<o};ai.prototype.isShallowSampled=function(t,e,i,o,u){var s=this,y=Math.trunc((o-i)/ai.NUM_PTS_TO_CHECK);y<=0&&(y=1);for(var v=i;v<o;v+=y)if(!s.isShallow(t,e,s._inputLine[v],u))return!1;return!0};ai.prototype.isConcave=function(t,e,i){var o=Kt.computeOrientation(t,e,i),u=o===this._angleOrientation;return u};ai.prototype.simplify=function(t){var e=this;this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=Kt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var i=!1;do i=e.deleteShallowConcavities();while(i);return this.collapseLine()};ai.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===ai.DELETE;)e++;return e};ai.prototype.isShallow=function(t,e,i,o){var u=Kt.distancePointLine(e,t,i);return u<o};ai.prototype.collapseLine=function(){for(var t=this,e=new Zf,i=0;i<this._inputLine.length;i++)t._isDeleted[i]!==ai.DELETE&&e.add(t._inputLine[i]);return e.toCoordinateArray()};ai.prototype.interfaces_=function(){return[]};ai.prototype.getClass=function(){return ai};ai.simplify=function(t,e){var i=new ai(t);return i.simplify(e)};Kf.INIT.get=function(){return 0};Kf.DELETE.get=function(){return 1};Kf.KEEP.get=function(){return 1};Kf.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(ai,Kf);var bo=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new qt},Xx={COORDINATE_ARRAY_TYPE:{configurable:!0}};bo.prototype.getCoordinates=function(){var t=this._ptList.toArray(bo.COORDINATE_ARRAY_TYPE);return t};bo.prototype.setPrecisionModel=function(t){this._precisionModel=t};bo.prototype.addPt=function(t){var e=new ft(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)};bo.prototype.revere=function(){};bo.prototype.addPts=function(t,e){var i=this;if(e)for(var o=0;o<t.length;o++)i.addPt(t[o]);else for(var u=t.length-1;u>=0;u--)i.addPt(t[u])};bo.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1),i=t.distance(e);return i<this._minimimVertexDistance};bo.prototype.toString=function(){var t=new He,e=t.createLineString(this.getCoordinates());return e.toString()};bo.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new ft(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)};bo.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t};bo.prototype.interfaces_=function(){return[]};bo.prototype.getClass=function(){return bo};Xx.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)};Object.defineProperties(bo,Xx);var tr=function(){},Dc={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};tr.prototype.interfaces_=function(){return[]};tr.prototype.getClass=function(){return tr};tr.toDegrees=function(t){return t*180/Math.PI};tr.normalize=function(t){for(;t>Math.PI;)t-=tr.PI_TIMES_2;for(;t<=-Math.PI;)t+=tr.PI_TIMES_2;return t};tr.angle=function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}else if(arguments.length===2){var e=arguments[0],i=arguments[1],o=i.x-e.x,u=i.y-e.y;return Math.atan2(u,o)}};tr.isAcute=function(t,e,i){var o=t.x-e.x,u=t.y-e.y,s=i.x-e.x,y=i.y-e.y,v=o*s+u*y;return v>0};tr.isObtuse=function(t,e,i){var o=t.x-e.x,u=t.y-e.y,s=i.x-e.x,y=i.y-e.y,v=o*s+u*y;return v<0};tr.interiorAngle=function(t,e,i){var o=tr.angle(e,t),u=tr.angle(e,i);return Math.abs(u-o)};tr.normalizePositive=function(t){if(t<0){for(;t<0;)t+=tr.PI_TIMES_2;t>=tr.PI_TIMES_2&&(t=0)}else{for(;t>=tr.PI_TIMES_2;)t-=tr.PI_TIMES_2;t<0&&(t=0)}return t};tr.angleBetween=function(t,e,i){var o=tr.angle(e,t),u=tr.angle(e,i);return tr.diff(o,u)};tr.diff=function(t,e){var i=null;return t<e?i=e-t:i=t-e,i>Math.PI&&(i=2*Math.PI-i),i};tr.toRadians=function(t){return t*Math.PI/180};tr.getTurn=function(t,e){var i=Math.sin(e-t);return i>0?tr.COUNTERCLOCKWISE:i<0?tr.CLOCKWISE:tr.NONE};tr.angleBetweenOriented=function(t,e,i){var o=tr.angle(e,t),u=tr.angle(e,i),s=u-o;return s<=-Math.PI?s+tr.PI_TIMES_2:s>Math.PI?s-tr.PI_TIMES_2:s};Dc.PI_TIMES_2.get=function(){return 2*Math.PI};Dc.PI_OVER_2.get=function(){return Math.PI/2};Dc.PI_OVER_4.get=function(){return Math.PI/4};Dc.COUNTERCLOCKWISE.get=function(){return Kt.COUNTERCLOCKWISE};Dc.CLOCKWISE.get=function(){return Kt.CLOCKWISE};Dc.NONE.get=function(){return Kt.COLLINEAR};Object.defineProperties(tr,Dc);var Hr=function n(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new ge,this._seg1=new ge,this._offset0=new ge,this._offset1=new ge,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],i=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new Sl,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===hr.JOIN_ROUND&&(this._closingSegLengthFactor=n.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)},Jf={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Hr.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var i=Kt.computeOrientation(this._s0,this._s1,this._s2),o=i===Kt.CLOCKWISE&&this._side===Nt.LEFT||i===Kt.COUNTERCLOCKWISE&&this._side===Nt.RIGHT;i===0?this.addCollinear(e):o?this.addOutsideTurn(i,e):this.addInsideTurn(i,e)};Hr.prototype.addLineEndCap=function(t,e){var i=new ge(t,e),o=new ge;this.computeOffsetSegment(i,Nt.LEFT,this._distance,o);var u=new ge;this.computeOffsetSegment(i,Nt.RIGHT,this._distance,u);var s=e.x-t.x,y=e.y-t.y,v=Math.atan2(y,s);switch(this._bufParams.getEndCapStyle()){case hr.CAP_ROUND:this._segList.addPt(o.p1),this.addFilletArc(e,v+Math.PI/2,v-Math.PI/2,Kt.CLOCKWISE,this._distance),this._segList.addPt(u.p1);break;case hr.CAP_FLAT:this._segList.addPt(o.p1),this._segList.addPt(u.p1);break;case hr.CAP_SQUARE:var S=new ft;S.x=Math.abs(this._distance)*Math.cos(v),S.y=Math.abs(this._distance)*Math.sin(v);var L=new ft(o.p1.x+S.x,o.p1.y+S.y),k=new ft(u.p1.x+S.x,u.p1.y+S.y);this._segList.addPt(L),this._segList.addPt(k);break}};Hr.prototype.getCoordinates=function(){var t=this._segList.getCoordinates();return t};Hr.prototype.addMitreJoin=function(t,e,i,o){var u=!0,s=null;try{s=na.intersection(e.p0,e.p1,i.p0,i.p1);var y=o<=0?1:s.distance(t)/Math.abs(o);y>this._bufParams.getMitreLimit()&&(u=!1)}catch(v){if(v instanceof cp)s=new ft(0,0),u=!1;else throw v}finally{}u?this._segList.addPt(s):this.addLimitedMitreJoin(e,i,o,this._bufParams.getMitreLimit())};Hr.prototype.addFilletCorner=function(t,e,i,o,u){var s=e.x-t.x,y=e.y-t.y,v=Math.atan2(y,s),S=i.x-t.x,L=i.y-t.y,k=Math.atan2(L,S);o===Kt.CLOCKWISE?v<=k&&(v+=2*Math.PI):v>=k&&(v-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,v,k,o,u),this._segList.addPt(i)};Hr.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Hr.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===hr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===hr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))};Hr.prototype.createSquare=function(t){this._segList.addPt(new ft(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new ft(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new ft(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new ft(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()};Hr.prototype.addSegments=function(t,e){this._segList.addPts(t,e)};Hr.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};Hr.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};Hr.prototype.initSideSegments=function(t,e,i){this._s1=t,this._s2=e,this._side=i,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,i,this._distance,this._offset1)};Hr.prototype.addLimitedMitreJoin=function(t,e,i,o){var u=this._seg0.p1,s=tr.angle(u,this._seg0.p0),y=tr.angleBetweenOriented(this._seg0.p0,u,this._seg1.p1),v=y/2,S=tr.normalize(s+v),L=tr.normalize(S+Math.PI),k=o*i,N=k*Math.abs(Math.sin(v)),Q=i-N,tt=u.x+k*Math.cos(L),xt=u.y+k*Math.sin(L),mt=new ft(tt,xt),Ct=new ge(u,mt),ut=Ct.pointAlongOffset(1,Q),Pt=Ct.pointAlongOffset(1,-Q);this._side===Nt.LEFT?(this._segList.addPt(ut),this._segList.addPt(Pt)):(this._segList.addPt(Pt),this._segList.addPt(ut))};Hr.prototype.computeOffsetSegment=function(t,e,i,o){var u=e===Nt.LEFT?1:-1,s=t.p1.x-t.p0.x,y=t.p1.y-t.p0.y,v=Math.sqrt(s*s+y*y),S=u*i*s/v,L=u*i*y/v;o.p0.x=t.p0.x-L,o.p0.y=t.p0.y+S,o.p1.x=t.p1.x-L,o.p1.y=t.p1.y+S};Hr.prototype.addFilletArc=function(t,e,i,o,u){var s=this,y=o===Kt.CLOCKWISE?-1:1,v=Math.abs(e-i),S=Math.trunc(v/this._filletAngleQuantum+.5);if(S<1)return null;for(var L=0,k=v/S,N=L,Q=new ft;N<v;){var tt=e+y*N;Q.x=t.x+u*Math.cos(tt),Q.y=t.y+u*Math.sin(tt),s._segList.addPt(Q),N+=k}};Hr.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Hr.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var i=new ft((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i);var o=new ft((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(o)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}};Hr.prototype.createCircle=function(t){var e=new ft(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()};Hr.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)};Hr.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new bo,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Hr.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};Hr.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);var e=this._li.getIntersectionNum();e>=2&&(this._bufParams.getJoinStyle()===hr.JOIN_BEVEL||this._bufParams.getJoinStyle()===hr.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Kt.CLOCKWISE,this._distance))};Hr.prototype.closeRing=function(){this._segList.closeRing()};Hr.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};Hr.prototype.interfaces_=function(){return[]};Hr.prototype.getClass=function(){return Hr};Jf.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001};Jf.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001};Jf.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6};Jf.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(Hr,Jf);var Zn=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};Zn.prototype.getOffsetCurve=function(t,e){if(this._distance=e,e===0)return null;var i=e<0,o=Math.abs(e),u=this.getSegGen(o);t.length<=1?this.computePointCurve(t[0],u):this.computeOffsetCurve(t,i,u);var s=u.getCoordinates();return i&&Xe.reverse(s),s};Zn.prototype.computeSingleSidedBufferCurve=function(t,e,i){var o=this.simplifyTolerance(this._distance);if(e){i.addSegments(t,!0);var u=ai.simplify(t,-o),s=u.length-1;i.initSideSegments(u[s],u[s-1],Nt.LEFT),i.addFirstSegment();for(var y=s-2;y>=0;y--)i.addNextSegment(u[y],!0)}else{i.addSegments(t,!1);var v=ai.simplify(t,o),S=v.length-1;i.initSideSegments(v[0],v[1],Nt.LEFT),i.addFirstSegment();for(var L=2;L<=S;L++)i.addNextSegment(v[L],!0)}i.addLastSegment(),i.closeRing()};Zn.prototype.computeRingBufferCurve=function(t,e,i){var o=this.simplifyTolerance(this._distance);e===Nt.RIGHT&&(o=-o);var u=ai.simplify(t,o),s=u.length-1;i.initSideSegments(u[s-1],u[0],e);for(var y=1;y<=s;y++){var v=y!==1;i.addNextSegment(u[y],v)}i.closeRing()};Zn.prototype.computeLineBufferCurve=function(t,e){var i=this.simplifyTolerance(this._distance),o=ai.simplify(t,i),u=o.length-1;e.initSideSegments(o[0],o[1],Nt.LEFT);for(var s=2;s<=u;s++)e.addNextSegment(o[s],!0);e.addLastSegment(),e.addLineEndCap(o[u-1],o[u]);var y=ai.simplify(t,-i),v=y.length-1;e.initSideSegments(y[v],y[v-1],Nt.LEFT);for(var S=v-2;S>=0;S--)e.addNextSegment(y[S],!0);e.addLastSegment(),e.addLineEndCap(y[1],y[0]),e.closeRing()};Zn.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case hr.CAP_ROUND:e.createCircle(t);break;case hr.CAP_SQUARE:e.createSquare(t);break}};Zn.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided()||e===0)return null;var i=Math.abs(e),o=this.getSegGen(i);if(t.length<=1)this.computePointCurve(t[0],o);else if(this._bufParams.isSingleSided()){var u=e<0;this.computeSingleSidedBufferCurve(t,u,o)}else this.computeLineBufferCurve(t,o);var s=o.getCoordinates();return s};Zn.prototype.getBufferParameters=function(){return this._bufParams};Zn.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()};Zn.prototype.getRingCurve=function(t,e,i){if(this._distance=i,t.length<=2)return this.getLineCurve(t,i);if(i===0)return Zn.copyCoordinates(t);var o=this.getSegGen(i);return this.computeRingBufferCurve(t,e,o),o.getCoordinates()};Zn.prototype.computeOffsetCurve=function(t,e,i){var o=this.simplifyTolerance(this._distance);if(e){var u=ai.simplify(t,-o),s=u.length-1;i.initSideSegments(u[s],u[s-1],Nt.LEFT),i.addFirstSegment();for(var y=s-2;y>=0;y--)i.addNextSegment(u[y],!0)}else{var v=ai.simplify(t,o),S=v.length-1;i.initSideSegments(v[0],v[1],Nt.LEFT),i.addFirstSegment();for(var L=2;L<=S;L++)i.addNextSegment(v[L],!0)}i.addLastSegment()};Zn.prototype.getSegGen=function(t){return new Hr(this._precisionModel,this._bufParams,t)};Zn.prototype.interfaces_=function(){return[]};Zn.prototype.getClass=function(){return Zn};Zn.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),i=0;i<e.length;i++)e[i]=new ft(t[i]);return e};var vc=function(){this._subgraphs=null,this._seg=new ge,this._cga=new Kt;var t=arguments[0];this._subgraphs=t},Zx={DepthSegment:{configurable:!0}};vc.prototype.findStabbedSegments=function(){var t=this;if(arguments.length===1){for(var e=arguments[0],i=new qt,o=this._subgraphs.iterator();o.hasNext();){var u=o.next(),s=u.getEnvelope();e.y<s.getMinY()||e.y>s.getMaxY()||t.findStabbedSegments(e,u.getDirectedEdges(),i)}return i}else if(arguments.length===3){if(Ie(arguments[2],oa)&&arguments[0]instanceof ft&&arguments[1]instanceof Sm)for(var y=arguments[0],v=arguments[1],S=arguments[2],L=v.getEdge().getCoordinates(),k=0;k<L.length-1;k++){t._seg.p0=L[k],t._seg.p1=L[k+1],t._seg.p0.y>t._seg.p1.y&&t._seg.reverse();var N=Math.max(t._seg.p0.x,t._seg.p1.x);if(!(N<y.x)&&!t._seg.isHorizontal()&&!(y.y<t._seg.p0.y||y.y>t._seg.p1.y)&&Kt.computeOrientation(t._seg.p0,t._seg.p1,y)!==Kt.RIGHT){var Q=v.getDepth(Nt.LEFT);t._seg.p0.equals(L[k])||(Q=v.getDepth(Nt.RIGHT));var tt=new ml(t._seg,Q);S.add(tt)}}else if(Ie(arguments[2],oa)&&arguments[0]instanceof ft&&Ie(arguments[1],oa))for(var xt=arguments[0],mt=arguments[1],Ct=arguments[2],ut=mt.iterator();ut.hasNext();){var Pt=ut.next();!Pt.isForward()||t.findStabbedSegments(xt,Pt,Ct)}}};vc.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);if(e.size()===0)return 0;var i=la.min(e);return i._leftDepth};vc.prototype.interfaces_=function(){return[]};vc.prototype.getClass=function(){return vc};Zx.DepthSegment.get=function(){return ml};Object.defineProperties(vc,Zx);var ml=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new ge(t),this._leftDepth=e};ml.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var i=this._upwardSeg.orientationIndex(e._upwardSeg);return i!==0||(i=-1*e._upwardSeg.orientationIndex(this._upwardSeg),i!==0)?i:this._upwardSeg.compareTo(e._upwardSeg)};ml.prototype.compareX=function(t,e){var i=t.p0.compareTo(e.p0);return i!==0?i:t.p1.compareTo(e.p1)};ml.prototype.toString=function(){return this._upwardSeg.toString()};ml.prototype.interfaces_=function(){return[Xo]};ml.prototype.getClass=function(){return ml};var fr=function(t,e,i){this.p0=t||null,this.p1=e||null,this.p2=i||null};fr.prototype.area=function(){return fr.area(this.p0,this.p1,this.p2)};fr.prototype.signedArea=function(){return fr.signedArea(this.p0,this.p1,this.p2)};fr.prototype.interpolateZ=function(t){if(t===null)throw new Zr("Supplied point is null.");return fr.interpolateZ(t,this.p0,this.p1,this.p2)};fr.prototype.longestSideLength=function(){return fr.longestSideLength(this.p0,this.p1,this.p2)};fr.prototype.isAcute=function(){return fr.isAcute(this.p0,this.p1,this.p2)};fr.prototype.circumcentre=function(){return fr.circumcentre(this.p0,this.p1,this.p2)};fr.prototype.area3D=function(){return fr.area3D(this.p0,this.p1,this.p2)};fr.prototype.centroid=function(){return fr.centroid(this.p0,this.p1,this.p2)};fr.prototype.inCentre=function(){return fr.inCentre(this.p0,this.p1,this.p2)};fr.prototype.interfaces_=function(){return[]};fr.prototype.getClass=function(){return fr};fr.area=function(t,e,i){return Math.abs(((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2)};fr.signedArea=function(t,e,i){return((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2};fr.det=function(t,e,i,o){return t*o-e*i};fr.interpolateZ=function(t,e,i,o){var u=e.x,s=e.y,y=i.x-u,v=o.x-u,S=i.y-s,L=o.y-s,k=y*L-v*S,N=t.x-u,Q=t.y-s,tt=(L*N-v*Q)/k,xt=(-S*N+y*Q)/k,mt=e.z+tt*(i.z-e.z)+xt*(o.z-e.z);return mt};fr.longestSideLength=function(t,e,i){var o=t.distance(e),u=e.distance(i),s=i.distance(t),y=o;return u>y&&(y=u),s>y&&(y=s),y};fr.isAcute=function(t,e,i){return!(!tr.isAcute(t,e,i)||!tr.isAcute(e,i,t)||!tr.isAcute(i,t,e))};fr.circumcentre=function(t,e,i){var o=i.x,u=i.y,s=t.x-o,y=t.y-u,v=e.x-o,S=e.y-u,L=2*fr.det(s,y,v,S),k=fr.det(y,s*s+y*y,S,v*v+S*S),N=fr.det(s,s*s+y*y,v,v*v+S*S),Q=o-k/L,tt=u+N/L;return new ft(Q,tt)};fr.perpendicularBisector=function(t,e){var i=e.x-t.x,o=e.y-t.y,u=new na(t.x+i/2,t.y+o/2,1),s=new na(t.x-o+i/2,t.y+i+o/2,1);return new na(u,s)};fr.angleBisector=function(t,e,i){var o=e.distance(t),u=e.distance(i),s=o/(o+u),y=i.x-t.x,v=i.y-t.y,S=new ft(t.x+s*y,t.y+s*v);return S};fr.area3D=function(t,e,i){var o=e.x-t.x,u=e.y-t.y,s=e.z-t.z,y=i.x-t.x,v=i.y-t.y,S=i.z-t.z,L=u*S-s*v,k=s*y-o*S,N=o*v-u*y,Q=L*L+k*k+N*N,tt=Math.sqrt(Q)/2;return tt};fr.centroid=function(t,e,i){var o=(t.x+e.x+i.x)/3,u=(t.y+e.y+i.y)/3;return new ft(o,u)};fr.inCentre=function(t,e,i){var o=e.distance(i),u=t.distance(i),s=t.distance(e),y=o+u+s,v=(o*t.x+u*e.x+s*i.x)/y,S=(o*t.y+u*e.y+s*i.y)/y;return new ft(v,S)};var Ho=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new qt;var t=arguments[0],e=arguments[1],i=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=i};Ho.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,dt.EXTERIOR,dt.INTERIOR)};Ho.prototype.addPolygon=function(t){var e=this,i=this._distance,o=Nt.LEFT;this._distance<0&&(i=-this._distance,o=Nt.RIGHT);var u=t.getExteriorRing(),s=Xe.removeRepeatedPoints(u.getCoordinates());if(this._distance<0&&this.isErodedCompletely(u,this._distance)||this._distance<=0&&s.length<3)return null;this.addPolygonRing(s,i,o,dt.EXTERIOR,dt.INTERIOR);for(var y=0;y<t.getNumInteriorRing();y++){var v=t.getInteriorRingN(y),S=Xe.removeRepeatedPoints(v.getCoordinates());e._distance>0&&e.isErodedCompletely(v,-e._distance)||e.addPolygonRing(S,i,Nt.opposite(o),dt.INTERIOR,dt.EXTERIOR)}};Ho.prototype.isTriangleErodedCompletely=function(t,e){var i=new fr(t[0],t[1],t[2]),o=i.inCentre(),u=Kt.distancePointLine(o,i.p0,i.p1);return u<Math.abs(e)};Ho.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Xe.removeRepeatedPoints(t.getCoordinates()),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,dt.EXTERIOR,dt.INTERIOR)};Ho.prototype.addCurve=function(t,e,i){if(t===null||t.length<2)return null;var o=new _i(t,new xr(0,dt.BOUNDARY,e,i));this._curveList.add(o)};Ho.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};Ho.prototype.addPolygonRing=function(t,e,i,o,u){if(e===0&&t.length<is.MINIMUM_VALID_SIZE)return null;var s=o,y=u;t.length>=is.MINIMUM_VALID_SIZE&&Kt.isCCW(t)&&(s=u,y=o,i=Nt.opposite(i));var v=this._curveBuilder.getRingCurve(t,i,e);this.addCurve(v,s,y)};Ho.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Ri?this.addPolygon(t):t instanceof oi?this.addLineString(t):t instanceof ao?this.addPoint(t):t instanceof Wh?this.addCollection(t):t instanceof gl?this.addCollection(t):t instanceof $a?this.addCollection(t):t instanceof Nn&&this.addCollection(t)};Ho.prototype.isErodedCompletely=function(t,e){var i=t.getCoordinates();if(i.length<4)return e<0;if(i.length===4)return this.isTriangleErodedCompletely(i,e);var o=t.getEnvelopeInternal(),u=Math.min(o.getHeight(),o.getWidth());return e<0&&2*Math.abs(e)>u};Ho.prototype.addCollection=function(t){for(var e=this,i=0;i<t.getNumGeometries();i++){var o=t.getGeometryN(i);e.add(o)}};Ho.prototype.interfaces_=function(){return[]};Ho.prototype.getClass=function(){return Ho};var $h=function(){};$h.prototype.locate=function(t){};$h.prototype.interfaces_=function(){return[]};$h.prototype.getClass=function(){return $h};var ts=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};ts.prototype.next=function(){if(this._atStart)return this._atStart=!1,ts.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new pp;var t=this._parent.getGeometryN(this._index++);return t instanceof Nn?(this._subcollectionIterator=new ts(t),this._subcollectionIterator.next()):t};ts.prototype.remove=function(){throw new Error(this.getClass().getName())};ts.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};ts.prototype.interfaces_=function(){return[hp]};ts.prototype.getClass=function(){return ts};ts.isAtomic=function(t){return!(t instanceof Nn)};var _o=function(){this._geom=null;var t=arguments[0];this._geom=t};_o.prototype.locate=function(t){return _o.locate(t,this._geom)};_o.prototype.interfaces_=function(){return[$h]};_o.prototype.getClass=function(){return _o};_o.isPointInRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?Kt.isPointInRing(t,e.getCoordinates()):!1};_o.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var i=e.getExteriorRing();if(!_o.isPointInRing(t,i))return!1;for(var o=0;o<e.getNumInteriorRing();o++){var u=e.getInteriorRingN(o);if(_o.isPointInRing(t,u))return!1}return!0};_o.containsPoint=function(t,e){if(e instanceof Ri)return _o.containsPointInPolygon(t,e);if(e instanceof Nn)for(var i=new ts(e);i.hasNext();){var o=i.next();if(o!==e&&_o.containsPoint(t,o))return!0}return!1};_o.locate=function(t,e){return e.isEmpty()?dt.EXTERIOR:_o.containsPoint(t,e)?dt.INTERIOR:dt.EXTERIOR};var _n=function(){this._edgeMap=new yn,this._edgeList=null,this._ptInAreaLocation=[dt.NONE,dt.NONE]};_n.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),i=e-1;return e===0&&(i=this._edgeList.size()-1),this._edgeList.get(i)};_n.prototype.propagateSideLabels=function(t){for(var e=dt.NONE,i=this.iterator();i.hasNext();){var o=i.next(),u=o.getLabel();u.isArea(t)&&u.getLocation(t,Nt.LEFT)!==dt.NONE&&(e=u.getLocation(t,Nt.LEFT))}if(e===dt.NONE)return null;for(var s=e,y=this.iterator();y.hasNext();){var v=y.next(),S=v.getLabel();if(S.getLocation(t,Nt.ON)===dt.NONE&&S.setLocation(t,Nt.ON,s),S.isArea(t)){var L=S.getLocation(t,Nt.LEFT),k=S.getLocation(t,Nt.RIGHT);if(k!==dt.NONE){if(k!==s)throw new Hs("side location conflict",v.getCoordinate());L===dt.NONE&&Re.shouldNeverReachHere("found single null side (at "+v.getCoordinate()+")"),s=L}else Re.isTrue(S.getLocation(t,Nt.LEFT)===dt.NONE,"found single null side"),S.setLocation(t,Nt.RIGHT,s),S.setLocation(t,Nt.LEFT,s)}}};_n.prototype.getCoordinate=function(){var t=this.iterator();if(!t.hasNext())return null;var e=t.next();return e.getCoordinate()};_n.prototype.print=function(t){an.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var i=e.next();i.print(t)}};_n.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)};_n.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var i=e.size()-1,o=e.get(i).getLabel(),u=o.getLocation(t,Nt.LEFT);Re.isTrue(u!==dt.NONE,"Found unlabelled area edge");for(var s=u,y=this.iterator();y.hasNext();){var v=y.next(),S=v.getLabel();Re.isTrue(S.isArea(t),"Found non-area edge");var L=S.getLocation(t,Nt.LEFT),k=S.getLocation(t,Nt.RIGHT);if(L===k||k!==s)return!1;s=L}return!0};_n.prototype.findIndex=function(t){var e=this;this.iterator();for(var i=0;i<this._edgeList.size();i++){var o=e._edgeList.get(i);if(o===t)return i}return-1};_n.prototype.iterator=function(){return this.getEdges().iterator()};_n.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new qt(this._edgeMap.values())),this._edgeList};_n.prototype.getLocation=function(t,e,i){return this._ptInAreaLocation[t]===dt.NONE&&(this._ptInAreaLocation[t]=_o.locate(e,i[t].getGeometry())),this._ptInAreaLocation[t]};_n.prototype.toString=function(){var t=new Ba;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append(`
`);for(var e=this.iterator();e.hasNext();){var i=e.next();t.append(i),t.append(`
`)}return t.toString()};_n.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();){var i=e.next();i.computeLabel(t)}};_n.prototype.computeLabelling=function(t){var e=this;this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var i=[!1,!1],o=this.iterator();o.hasNext();)for(var u=o.next(),s=u.getLabel(),y=0;y<2;y++)s.isLine(y)&&s.getLocation(y)===dt.BOUNDARY&&(i[y]=!0);for(var v=this.iterator();v.hasNext();)for(var S=v.next(),L=S.getLabel(),k=0;k<2;k++)if(L.isAnyNull(k)){var N=dt.NONE;if(i[k])N=dt.EXTERIOR;else{var Q=S.getCoordinate();N=e.getLocation(k,Q,t)}L.setAllLocationsIfNull(k,N)}};_n.prototype.getDegree=function(){return this._edgeMap.size()};_n.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null};_n.prototype.interfaces_=function(){return[]};_n.prototype.getClass=function(){return _n};var oI=function(n){function t(){n.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.linkResultDirectedEdges=function(){var i=this;this.getResultAreaEdges();for(var o=null,u=null,s=this._SCANNING_FOR_INCOMING,y=0;y<this._resultAreaEdgeList.size();y++){var v=i._resultAreaEdgeList.get(y),S=v.getSym();if(!!v.getLabel().isArea())switch(o===null&&v.isInResult()&&(o=v),s){case i._SCANNING_FOR_INCOMING:if(!S.isInResult())continue;u=S,s=i._LINKING_TO_OUTGOING;break;case i._LINKING_TO_OUTGOING:if(!v.isInResult())continue;u.setNext(v),s=i._SCANNING_FOR_INCOMING;break}}if(s===this._LINKING_TO_OUTGOING){if(o===null)throw new Hs("no outgoing dirEdge found",this.getCoordinate());Re.isTrue(o.isInResult(),"unable to link last incoming dirEdge"),u.setNext(o)}},t.prototype.insert=function(i){var o=i;this.insertEdgeEnd(o,o)},t.prototype.getRightmostEdge=function(){var i=this.getEdges(),o=i.size();if(o<1)return null;var u=i.get(0);if(o===1)return u;var s=i.get(o-1),y=u.getQuadrant(),v=s.getQuadrant();return Tr.isNorthern(y)&&Tr.isNorthern(v)?u:!Tr.isNorthern(y)&&!Tr.isNorthern(v)?s:u.getDy()!==0?u:s.getDy()!==0?s:(Re.shouldNeverReachHere("found two horizontal edges incident on node"),null)},t.prototype.print=function(i){an.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var o=this.iterator();o.hasNext();){var u=o.next();i.print("out "),u.print(i),i.println(),i.print("in "),u.getSym().print(i),i.println()}},t.prototype.getResultAreaEdges=function(){var i=this;if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new qt;for(var o=this.iterator();o.hasNext();){var u=o.next();(u.isInResult()||u.getSym().isInResult())&&i._resultAreaEdgeList.add(u)}return this._resultAreaEdgeList},t.prototype.updateLabelling=function(i){for(var o=this.iterator();o.hasNext();){var u=o.next(),s=u.getLabel();s.setAllLocationsIfNull(0,i.getLocation(0)),s.setAllLocationsIfNull(1,i.getLocation(1))}},t.prototype.linkAllDirectedEdges=function(){var i=this;this.getEdges();for(var o=null,u=null,s=this._edgeList.size()-1;s>=0;s--){var y=i._edgeList.get(s),v=y.getSym();u===null&&(u=v),o!==null&&v.setNext(o),o=y}u.setNext(o)},t.prototype.computeDepths=function(){var i=this;if(arguments.length===1){var o=arguments[0],u=this.findIndex(o),s=o.getDepth(Nt.LEFT),y=o.getDepth(Nt.RIGHT),v=this.computeDepths(u+1,this._edgeList.size(),s),S=this.computeDepths(0,u,v);if(S!==y)throw new Hs("depth mismatch at "+o.getCoordinate())}else if(arguments.length===3){for(var L=arguments[0],k=arguments[1],N=arguments[2],Q=N,tt=L;tt<k;tt++){var xt=i._edgeList.get(tt);xt.setEdgeDepths(Nt.RIGHT,Q),Q=xt.getDepth(Nt.LEFT)}return Q}},t.prototype.mergeSymLabels=function(){for(var i=this.iterator();i.hasNext();){var o=i.next(),u=o.getLabel();u.merge(o.getSym().getLabel())}},t.prototype.linkMinimalDirectedEdges=function(i){for(var o=this,u=null,s=null,y=this._SCANNING_FOR_INCOMING,v=this._resultAreaEdgeList.size()-1;v>=0;v--){var S=o._resultAreaEdgeList.get(v),L=S.getSym();switch(u===null&&S.getEdgeRing()===i&&(u=S),y){case o._SCANNING_FOR_INCOMING:if(L.getEdgeRing()!==i)continue;s=L,y=o._LINKING_TO_OUTGOING;break;case o._LINKING_TO_OUTGOING:if(S.getEdgeRing()!==i)continue;s.setNextMin(S),y=o._SCANNING_FOR_INCOMING;break}}y===this._LINKING_TO_OUTGOING&&(Re.isTrue(u!==null,"found null for first outgoing dirEdge"),Re.isTrue(u.getEdgeRing()===i,"unable to link last incoming dirEdge"),s.setNextMin(u))},t.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var i=0,o=this.iterator();o.hasNext();){var u=o.next();u.isInResult()&&i++}return i}else if(arguments.length===1){for(var s=arguments[0],y=0,v=this.iterator();v.hasNext();){var S=v.next();S.getEdgeRing()===s&&y++}return y}},t.prototype.getLabel=function(){return this._label},t.prototype.findCoveredLineEdges=function(){for(var i=dt.NONE,o=this.iterator();o.hasNext();){var u=o.next(),s=u.getSym();if(!u.isLineEdge()){if(u.isInResult()){i=dt.INTERIOR;break}if(s.isInResult()){i=dt.EXTERIOR;break}}}if(i===dt.NONE)return null;for(var y=i,v=this.iterator();v.hasNext();){var S=v.next(),L=S.getSym();S.isLineEdge()?S.getEdge().setCovered(y===dt.INTERIOR):(S.isInResult()&&(y=dt.EXTERIOR),L.isInResult()&&(y=dt.INTERIOR))}},t.prototype.computeLabelling=function(i){var o=this;n.prototype.computeLabelling.call(this,i),this._label=new xr(dt.NONE);for(var u=this.iterator();u.hasNext();)for(var s=u.next(),y=s.getEdge(),v=y.getLabel(),S=0;S<2;S++){var L=v.getLocation(S);(L===dt.INTERIOR||L===dt.BOUNDARY)&&o._label.setLocation(S,dt.INTERIOR)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(_n),Yx=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.createNode=function(i){return new ny(i,new oI)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Kh),ku=function n(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=n.orientation(t)};ku.prototype.compareTo=function(t){var e=t,i=ku.compareOriented(this._pts,this._orientation,e._pts,e._orientation);return i};ku.prototype.interfaces_=function(){return[Xo]};ku.prototype.getClass=function(){return ku};ku.orientation=function(t){return Xe.increasingDirection(t)===1};ku.compareOriented=function(t,e,i,o){for(var u=e?1:-1,s=o?1:-1,y=e?t.length:-1,v=o?i.length:-1,S=e?0:t.length-1,L=o?0:i.length-1;;){var k=t[S].compareTo(i[L]);if(k!==0)return k;S+=u,L+=s;var N=S===y,Q=L===v;if(N&&!Q)return-1;if(!N&&Q)return 1;if(N&&Q)return 0}};var ca=function(){this._edges=new qt,this._ocaMap=new yn};ca.prototype.print=function(t){var e=this;t.print("MULTILINESTRING ( ");for(var i=0;i<this._edges.size();i++){var o=e._edges.get(i);i>0&&t.print(","),t.print("(");for(var u=o.getCoordinates(),s=0;s<u.length;s++)s>0&&t.print(","),t.print(u[s].x+" "+u[s].y);t.println(")")}t.print(")  ")};ca.prototype.addAll=function(t){for(var e=this,i=t.iterator();i.hasNext();)e.add(i.next())};ca.prototype.findEdgeIndex=function(t){for(var e=this,i=0;i<this._edges.size();i++)if(e._edges.get(i).equals(t))return i;return-1};ca.prototype.iterator=function(){return this._edges.iterator()};ca.prototype.getEdges=function(){return this._edges};ca.prototype.get=function(t){return this._edges.get(t)};ca.prototype.findEqualEdge=function(t){var e=new ku(t.getCoordinates()),i=this._ocaMap.get(e);return i};ca.prototype.add=function(t){this._edges.add(t);var e=new ku(t.getCoordinates());this._ocaMap.put(e,t)};ca.prototype.interfaces_=function(){return[]};ca.prototype.getClass=function(){return ca};var _l=function(){};_l.prototype.processIntersections=function(t,e,i,o){};_l.prototype.isDone=function(){};_l.prototype.interfaces_=function(){return[]};_l.prototype.getClass=function(){return _l};var wo=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};wo.prototype.isTrivialIntersection=function(t,e,i,o){if(t===i&&this._li.getIntersectionNum()===1){if(wo.isAdjacentSegments(e,o))return!0;if(t.isClosed()){var u=t.size()-1;if(e===0&&o===u||o===0&&e===u)return!0}}return!1};wo.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};wo.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};wo.prototype.getLineIntersector=function(){return this._li};wo.prototype.hasProperIntersection=function(){return this._hasProper};wo.prototype.processIntersections=function(t,e,i,o){if(t===i&&e===o)return null;this.numTests++;var u=t.getCoordinates()[e],s=t.getCoordinates()[e+1],y=i.getCoordinates()[o],v=i.getCoordinates()[o+1];this._li.computeIntersection(u,s,y,v),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,i,o)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),i.addIntersections(this._li,o,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};wo.prototype.hasIntersection=function(){return this._hasIntersection};wo.prototype.isDone=function(){return!1};wo.prototype.hasInteriorIntersection=function(){return this._hasInterior};wo.prototype.interfaces_=function(){return[_l]};wo.prototype.getClass=function(){return wo};wo.isAdjacentSegments=function(t,e){return Math.abs(t-e)===1};var Na=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],i=arguments[2];this.coord=new ft(t),this.segmentIndex=e,this.dist=i};Na.prototype.getSegmentIndex=function(){return this.segmentIndex};Na.prototype.getCoordinate=function(){return this.coord};Na.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)};Na.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)};Na.prototype.isEndPoint=function(t){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===t};Na.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};Na.prototype.getDistance=function(){return this.dist};Na.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0};Na.prototype.interfaces_=function(){return[Xo]};Na.prototype.getClass=function(){return Na};var as=function(){this._nodeMap=new yn,this.edge=null;var t=arguments[0];this.edge=t};as.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){var i=e.next();i.print(t)}};as.prototype.iterator=function(){return this._nodeMap.values().iterator()};as.prototype.addSplitEdges=function(t){var e=this;this.addEndpoints();for(var i=this.iterator(),o=i.next();i.hasNext();){var u=i.next(),s=e.createSplitEdge(o,u);t.add(s),o=u}};as.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)};as.prototype.createSplitEdge=function(t,e){var i=this,o=e.segmentIndex-t.segmentIndex+2,u=this.edge.pts[e.segmentIndex],s=e.dist>0||!e.coord.equals2D(u);s||o--;var y=new Array(o).fill(null),v=0;y[v++]=new ft(t.coord);for(var S=t.segmentIndex+1;S<=e.segmentIndex;S++)y[v++]=i.edge.pts[S];return s&&(y[v]=e.coord),new Ag(y,new xr(this.edge._label))};as.prototype.add=function(t,e,i){var o=new Na(t,e,i),u=this._nodeMap.get(o);return u!==null?u:(this._nodeMap.put(o,o),o)};as.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();){var i=e.next();if(i.coord.equals(t))return!0}return!1};as.prototype.interfaces_=function(){return[]};as.prototype.getClass=function(){return as};var vl=function(){};vl.prototype.getChainStartIndices=function(t){var e=this,i=0,o=new qt;o.add(new Ta(i));do{var u=e.findChainEnd(t,i);o.add(new Ta(u)),i=u}while(i<t.length-1);var s=vl.toIntArray(o);return s};vl.prototype.findChainEnd=function(t,e){for(var i=Tr.quadrant(t[e],t[e+1]),o=e+1;o<t.length;){var u=Tr.quadrant(t[o-1],t[o]);if(u!==i)break;o++}return o-1};vl.prototype.interfaces_=function(){return[]};vl.prototype.getClass=function(){return vl};vl.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e};var Zs=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new fe,this.env2=new fe;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new vl;this.startIndex=e.getChainStartIndices(this.pts)};Zs.prototype.getCoordinates=function(){return this.pts};Zs.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e>i?e:i};Zs.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e<i?e:i};Zs.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var t=arguments[0],e=arguments[1],i=arguments[2],o=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[i],e.startIndex[i+1],o)}else if(arguments.length===6){var u=arguments[0],s=arguments[1],y=arguments[2],v=arguments[3],S=arguments[4],L=arguments[5],k=this.pts[u],N=this.pts[s],Q=y.pts[v],tt=y.pts[S];if(s-u===1&&S-v===1)return L.addIntersections(this.e,u,y.e,v),null;if(this.env1.init(k,N),this.env2.init(Q,tt),!this.env1.intersects(this.env2))return null;var xt=Math.trunc((u+s)/2),mt=Math.trunc((v+S)/2);u<xt&&(v<mt&&this.computeIntersectsForChain(u,xt,y,v,mt,L),mt<S&&this.computeIntersectsForChain(u,xt,y,mt,S,L)),xt<s&&(v<mt&&this.computeIntersectsForChain(xt,s,y,v,mt,L),mt<S&&this.computeIntersectsForChain(xt,s,y,mt,S,L))}};Zs.prototype.getStartIndexes=function(){return this.startIndex};Zs.prototype.computeIntersects=function(t,e){for(var i=this,o=0;o<this.startIndex.length-1;o++)for(var u=0;u<t.startIndex.length-1;u++)i.computeIntersectsForChain(o,t,u,e)};Zs.prototype.interfaces_=function(){return[]};Zs.prototype.getClass=function(){return Zs};var on=function n(){var t=this;this._depth=Array(2).fill().map(function(){return Array(3)});for(var e=0;e<2;e++)for(var i=0;i<3;i++)t._depth[e][i]=n.NULL_VALUE},Wx={NULL_VALUE:{configurable:!0}};on.prototype.getDepth=function(t,e){return this._depth[t][e]};on.prototype.setDepth=function(t,e,i){this._depth[t][e]=i};on.prototype.isNull=function(){var t=this;if(arguments.length===0){for(var e=0;e<2;e++)for(var i=0;i<3;i++)if(t._depth[e][i]!==on.NULL_VALUE)return!1;return!0}else if(arguments.length===1){var o=arguments[0];return this._depth[o][1]===on.NULL_VALUE}else if(arguments.length===2){var u=arguments[0],s=arguments[1];return this._depth[u][s]===on.NULL_VALUE}};on.prototype.normalize=function(){for(var t=this,e=0;e<2;e++)if(!t.isNull(e)){var i=t._depth[e][1];t._depth[e][2]<i&&(i=t._depth[e][2]),i<0&&(i=0);for(var o=1;o<3;o++){var u=0;t._depth[e][o]>i&&(u=1),t._depth[e][o]=u}}};on.prototype.getDelta=function(t){return this._depth[t][Nt.RIGHT]-this._depth[t][Nt.LEFT]};on.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?dt.EXTERIOR:dt.INTERIOR};on.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};on.prototype.add=function(){var t=this;if(arguments.length===1)for(var e=arguments[0],i=0;i<2;i++)for(var o=1;o<3;o++){var u=e.getLocation(i,o);(u===dt.EXTERIOR||u===dt.INTERIOR)&&(t.isNull(i,o)?t._depth[i][o]=on.depthAtLocation(u):t._depth[i][o]+=on.depthAtLocation(u))}else if(arguments.length===3){var s=arguments[0],y=arguments[1],v=arguments[2];v===dt.INTERIOR&&this._depth[s][y]++}};on.prototype.interfaces_=function(){return[]};on.prototype.getClass=function(){return on};on.depthAtLocation=function(t){return t===dt.EXTERIOR?0:t===dt.INTERIOR?1:on.NULL_VALUE};Wx.NULL_VALUE.get=function(){return-1};Object.defineProperties(on,Wx);var Ag=function(n){function t(){if(n.call(this),this.pts=null,this._env=null,this.eiList=new as(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new on,this._depthDelta=0,arguments.length===1){var e=arguments[0];t.call(this,e,null)}else if(arguments.length===2){var i=arguments[0],o=arguments[1];this.pts=i,this._label=o}}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.getDepth=function(){return this._depth},t.prototype.getCollapsedEdge=function(){var i=new Array(2).fill(null);i[0]=this.pts[0],i[1]=this.pts[1];var o=new t(i,xr.toLineLabel(this._label));return o},t.prototype.isIsolated=function(){return this._isIsolated},t.prototype.getCoordinates=function(){return this.pts},t.prototype.setIsolated=function(i){this._isIsolated=i},t.prototype.setName=function(i){this._name=i},t.prototype.equals=function(i){var o=this;if(!(i instanceof t))return!1;var u=i;if(this.pts.length!==u.pts.length)return!1;for(var s=!0,y=!0,v=this.pts.length,S=0;S<this.pts.length;S++)if(o.pts[S].equals2D(u.pts[S])||(s=!1),o.pts[S].equals2D(u.pts[--v])||(y=!1),!s&&!y)return!1;return!0},t.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var i=arguments[0];return this.pts[i]}},t.prototype.print=function(i){var o=this;i.print("edge "+this._name+": "),i.print("LINESTRING (");for(var u=0;u<this.pts.length;u++)u>0&&i.print(","),i.print(o.pts[u].x+" "+o.pts[u].y);i.print(")  "+this._label+" "+this._depthDelta)},t.prototype.computeIM=function(i){t.updateIM(this._label,i)},t.prototype.isCollapsed=function(){return!this._label.isArea()||this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2])},t.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},t.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},t.prototype.getDepthDelta=function(){return this._depthDelta},t.prototype.getNumPoints=function(){return this.pts.length},t.prototype.printReverse=function(i){var o=this;i.print("edge "+this._name+": ");for(var u=this.pts.length-1;u>=0;u--)i.print(o.pts[u]+" ");i.println("")},t.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new Zs(this)),this._mce},t.prototype.getEnvelope=function(){var i=this;if(this._env===null){this._env=new fe;for(var o=0;o<this.pts.length;o++)i._env.expandToInclude(i.pts[o])}return this._env},t.prototype.addIntersection=function(i,o,u,s){var y=new ft(i.getIntersection(s)),v=o,S=i.getEdgeDistance(u,s),L=v+1;if(L<this.pts.length){var k=this.pts[L];y.equals2D(k)&&(v=L,S=0)}this.eiList.add(y,v,S)},t.prototype.toString=function(){var i=this,o=new Ba;o.append("edge "+this._name+": "),o.append("LINESTRING (");for(var u=0;u<this.pts.length;u++)u>0&&o.append(","),o.append(i.pts[u].x+" "+i.pts[u].y);return o.append(")  "+this._label+" "+this._depthDelta),o.toString()},t.prototype.isPointwiseEqual=function(i){var o=this;if(this.pts.length!==i.pts.length)return!1;for(var u=0;u<this.pts.length;u++)if(!o.pts[u].equals2D(i.pts[u]))return!1;return!0},t.prototype.setDepthDelta=function(i){this._depthDelta=i},t.prototype.getEdgeIntersectionList=function(){return this.eiList},t.prototype.addIntersections=function(i,o,u){for(var s=this,y=0;y<i.getIntersectionNum();y++)s.addIntersection(i,o,u,y)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.updateIM=function(){if(arguments.length===2){var i=arguments[0],o=arguments[1];o.setAtLeastIfValid(i.getLocation(0,Nt.ON),i.getLocation(1,Nt.ON),1),i.isArea()&&(o.setAtLeastIfValid(i.getLocation(0,Nt.LEFT),i.getLocation(1,Nt.LEFT),2),o.setAtLeastIfValid(i.getLocation(0,Nt.RIGHT),i.getLocation(1,Nt.RIGHT),2))}else return n.prototype.updateIM.apply(this,arguments)},t}(xo),kn=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new ca,this._bufParams=t||null};kn.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t};kn.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(e!==null){var i=e.getLabel(),o=t.getLabel();e.isPointwiseEqual(t)||(o=new xr(t.getLabel()),o.flip()),i.merge(o);var u=kn.depthDelta(o),s=e.getDepthDelta(),y=s+u;e.setDepthDelta(y)}else this._edgeList.add(t),t.setDepthDelta(kn.depthDelta(t.getLabel()))};kn.prototype.buildSubgraphs=function(t,e){for(var i=new qt,o=t.iterator();o.hasNext();){var u=o.next(),s=u.getRightmostCoordinate(),y=new vc(i),v=y.getDepth(s);u.computeDepth(v),u.findResultEdges(),i.add(u),e.add(u.getDirectedEdges(),u.getNodes())}};kn.prototype.createSubgraphs=function(t){for(var e=new qt,i=t.getNodes().iterator();i.hasNext();){var o=i.next();if(!o.isVisited()){var u=new Rn;u.create(o),e.add(u)}}return la.sort(e,la.reverseOrder()),e};kn.prototype.createEmptyResultGeometry=function(){var t=this._geomFact.createPolygon();return t};kn.prototype.getNoder=function(t){if(this._workingNoder!==null)return this._workingNoder;var e=new Wm,i=new Sl;return i.setPrecisionModel(t),e.setSegmentIntersector(new wo(i)),e};kn.prototype.buffer=function(t,e){var i=this._workingPrecisionModel;i===null&&(i=t.getPrecisionModel()),this._geomFact=t.getFactory();var o=new Zn(i,this._bufParams),u=new Ho(t,e,o),s=u.getCurves();if(s.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(s,i),this._graph=new Qr(new Yx),this._graph.addEdges(this._edgeList.getEdges());var y=this.createSubgraphs(this._graph),v=new so(this._geomFact);this.buildSubgraphs(y,v);var S=v.getPolygons();if(S.size()<=0)return this.createEmptyResultGeometry();var L=this._geomFact.buildGeometry(S);return L};kn.prototype.computeNodedEdges=function(t,e){var i=this,o=this.getNoder(e);o.computeNodes(t);for(var u=o.getNodedSubstrings(),s=u.iterator();s.hasNext();){var y=s.next(),v=y.getCoordinates();if(!(v.length===2&&v[0].equals2D(v[1]))){var S=y.getData(),L=new Ag(y.getCoordinates(),new xr(S));i.insertUniqueEdge(L)}}};kn.prototype.setNoder=function(t){this._workingNoder=t};kn.prototype.interfaces_=function(){return[]};kn.prototype.getClass=function(){return kn};kn.depthDelta=function(t){var e=t.getLocation(0,Nt.LEFT),i=t.getLocation(0,Nt.RIGHT);return e===dt.INTERIOR&&i===dt.EXTERIOR?1:e===dt.EXTERIOR&&i===dt.INTERIOR?-1:0};kn.convertSegStrings=function(t){for(var e=new He,i=new qt;t.hasNext();){var o=t.next(),u=e.createLineString(o.getCoordinates());i.add(u)}return e.buildGeometry(i)};var Nu=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var i=arguments[0],o=arguments[1],u=arguments[2],s=arguments[3];this._noder=i,this._scaleFactor=o,this._offsetX=u,this._offsetY=s,this._isScaled=!this.isIntegerPrecision()}};Nu.prototype.rescale=function(){var t=this;if(Ie(arguments[0],Di))for(var e=arguments[0],i=e.iterator();i.hasNext();){var o=i.next();t.rescale(o.getCoordinates())}else if(arguments[0]instanceof Array){for(var u=arguments[0],s=0;s<u.length;s++)u[s].x=u[s].x/t._scaleFactor+t._offsetX,u[s].y=u[s].y/t._scaleFactor+t._offsetY;u.length===2&&u[0].equals2D(u[1])&&an.out.println(u)}};Nu.prototype.scale=function(){var t=this;if(Ie(arguments[0],Di)){for(var e=arguments[0],i=new qt,o=e.iterator();o.hasNext();){var u=o.next();i.add(new _i(t.scale(u.getCoordinates()),u.getData()))}return i}else if(arguments[0]instanceof Array){for(var s=arguments[0],y=new Array(s.length).fill(null),v=0;v<s.length;v++)y[v]=new ft(Math.round((s[v].x-t._offsetX)*t._scaleFactor),Math.round((s[v].y-t._offsetY)*t._scaleFactor),s[v].z);var S=Xe.removeRepeatedPoints(y);return S}};Nu.prototype.isIntegerPrecision=function(){return this._scaleFactor===1};Nu.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t};Nu.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)};Nu.prototype.interfaces_=function(){return[yl]};Nu.prototype.getClass=function(){return Nu};var Ra=function(){this._li=new Sl,this._segStrings=null;var t=arguments[0];this._segStrings=t},Kx={fact:{configurable:!0}};Ra.prototype.checkEndPtVertexIntersections=function(){var t=this;if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var i=e.next(),o=i.getCoordinates();t.checkEndPtVertexIntersections(o[0],t._segStrings),t.checkEndPtVertexIntersections(o[o.length-1],t._segStrings)}else if(arguments.length===2){for(var u=arguments[0],s=arguments[1],y=s.iterator();y.hasNext();)for(var v=y.next(),S=v.getCoordinates(),L=1;L<S.length-1;L++)if(S[L].equals(u))throw new js("found endpt/interior pt intersection at index "+L+" :pt "+u)}};Ra.prototype.checkInteriorIntersections=function(){var t=this;if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();)for(var i=e.next(),o=this._segStrings.iterator();o.hasNext();){var u=o.next();t.checkInteriorIntersections(i,u)}else if(arguments.length===2)for(var s=arguments[0],y=arguments[1],v=s.getCoordinates(),S=y.getCoordinates(),L=0;L<v.length-1;L++)for(var k=0;k<S.length-1;k++)t.checkInteriorIntersections(s,L,y,k);else if(arguments.length===4){var N=arguments[0],Q=arguments[1],tt=arguments[2],xt=arguments[3];if(N===tt&&Q===xt)return null;var mt=N.getCoordinates()[Q],Ct=N.getCoordinates()[Q+1],ut=tt.getCoordinates()[xt],Pt=tt.getCoordinates()[xt+1];if(this._li.computeIntersection(mt,Ct,ut,Pt),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,mt,Ct)||this.hasInteriorIntersection(this._li,ut,Pt)))throw new js("found non-noded intersection at "+mt+"-"+Ct+" and "+ut+"-"+Pt)}};Ra.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()};Ra.prototype.checkCollapses=function(){var t=this;if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var i=e.next();t.checkCollapses(i)}else if(arguments.length===1)for(var o=arguments[0],u=o.getCoordinates(),s=0;s<u.length-2;s++)t.checkCollapse(u[s],u[s+1],u[s+2])};Ra.prototype.hasInteriorIntersection=function(t,e,i){for(var o=0;o<t.getIntersectionNum();o++){var u=t.getIntersection(o);if(!(u.equals(e)||u.equals(i)))return!0}return!1};Ra.prototype.checkCollapse=function(t,e,i){if(t.equals(i))throw new js("found non-noded collapse at "+Ra.fact.createLineString([t,e,i]))};Ra.prototype.interfaces_=function(){return[]};Ra.prototype.getClass=function(){return Ra};Kx.fact.get=function(){return new He};Object.defineProperties(Ra,Kx);var Yn=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],i=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=i,e<=0)throw new Zr("Scale factor must be non-zero");e!==1&&(this._pt=new ft(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new ft,this._p1Scaled=new ft),this.initCorners(this._pt)},Jx={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Yn.prototype.intersectsScaled=function(t,e){var i=Math.min(t.x,e.x),o=Math.max(t.x,e.x),u=Math.min(t.y,e.y),s=Math.max(t.y,e.y),y=this._maxx<i||this._minx>o||this._maxy<u||this._miny>s;if(y)return!1;var v=this.intersectsToleranceSquare(t,e);return Re.isTrue(!(y&&v),"Found bad envelope test"),v};Yn.prototype.initCorners=function(t){var e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new ft(this._maxx,this._maxy),this._corner[1]=new ft(this._minx,this._maxy),this._corner[2]=new ft(this._minx,this._miny),this._corner[3]=new ft(this._maxx,this._miny)};Yn.prototype.intersects=function(t,e){return this._scaleFactor===1?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};Yn.prototype.scale=function(t){return Math.round(t*this._scaleFactor)};Yn.prototype.getCoordinate=function(){return this._originalPt};Yn.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)};Yn.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var t=Yn.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new fe(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv};Yn.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))};Yn.prototype.intersectsToleranceSquare=function(t,e){var i=!1,o=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(o=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper())||i&&o||t.equals(this._pt)||e.equals(this._pt))};Yn.prototype.addSnappedNode=function(t,e){var i=t.getCoordinate(e),o=t.getCoordinate(e+1);return this.intersects(i,o)?(t.addIntersection(this.getCoordinate(),e),!0):!1};Yn.prototype.interfaces_=function(){return[]};Yn.prototype.getClass=function(){return Yn};Jx.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75};Object.defineProperties(Yn,Jx);var Nf=function(){this.tempEnv1=new fe,this.selectedSegment=new ge};Nf.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}}};Nf.prototype.interfaces_=function(){return[]};Nf.prototype.getClass=function(){return Nf};var tp=function(){this._index=null;var t=arguments[0];this._index=t},Qx={HotPixelSnapAction:{configurable:!0}};tp.prototype.snap=function(){if(arguments.length===1){var t=arguments[0];return this.snap(t,null,-1)}else if(arguments.length===3){var e=arguments[0],i=arguments[1],o=arguments[2],u=e.getSafeEnvelope(),s=new $x(e,i,o);return this._index.query(u,{interfaces_:function(){return[Du]},visitItem:function(y){var v=y;v.select(u,s)}}),s.isNodeAdded()}};tp.prototype.interfaces_=function(){return[]};tp.prototype.getClass=function(){return tp};Qx.HotPixelSnapAction.get=function(){return $x};Object.defineProperties(tp,Qx);var $x=function(n){function t(){n.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],i=arguments[1],o=arguments[2];this._hotPixel=e,this._parentEdge=i,this._hotPixelVertexIndex=o}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.isNodeAdded=function(){return this._isNodeAdded},t.prototype.select=function(){if(arguments.length===2){var i=arguments[0],o=arguments[1],u=i.getContext();if(this._parentEdge!==null&&u===this._parentEdge&&o===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(u,o)}else return n.prototype.select.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Nf),xc=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new qt};xc.prototype.processIntersections=function(t,e,i,o){var u=this;if(t===i&&e===o)return null;var s=t.getCoordinates()[e],y=t.getCoordinates()[e+1],v=i.getCoordinates()[o],S=i.getCoordinates()[o+1];if(this._li.computeIntersection(s,y,v,S),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var L=0;L<this._li.getIntersectionNum();L++)u._interiorIntersections.add(u._li.getIntersection(L));t.addIntersections(this._li,e,0),i.addIntersections(this._li,o,1)}};xc.prototype.isDone=function(){return!1};xc.prototype.getInteriorIntersections=function(){return this._interiorIntersections};xc.prototype.interfaces_=function(){return[_l]};xc.prototype.getClass=function(){return xc};var ss=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new Sl,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};ss.prototype.checkCorrectness=function(t){var e=_i.getNodedSubstrings(t),i=new Ra(e);try{i.checkValid()}catch(o){if(o instanceof Rx)o.printStackTrace();else throw o}finally{}};ss.prototype.getNodedSubstrings=function(){return _i.getNodedSubstrings(this._nodedSegStrings)};ss.prototype.snapRound=function(t,e){var i=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(i),this.computeVertexSnaps(t)};ss.prototype.findInteriorIntersections=function(t,e){var i=new xc(e);return this._noder.setSegmentIntersector(i),this._noder.computeNodes(t),i.getInteriorIntersections()};ss.prototype.computeVertexSnaps=function(){var t=this;if(Ie(arguments[0],Di))for(var e=arguments[0],i=e.iterator();i.hasNext();){var o=i.next();t.computeVertexSnaps(o)}else if(arguments[0]instanceof _i)for(var u=arguments[0],s=u.getCoordinates(),y=0;y<s.length;y++){var v=new Yn(s[y],t._scaleFactor,t._li),S=t._pointSnapper.snap(v,u,y);S&&u.addIntersection(s[y],y)}};ss.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new Wm,this._pointSnapper=new tp(this._noder.getIndex()),this.snapRound(t,this._li)};ss.prototype.computeIntersectionSnaps=function(t){for(var e=this,i=t.iterator();i.hasNext();){var o=i.next(),u=new Yn(o,e._scaleFactor,e._li);e._pointSnapper.snap(u)}};ss.prototype.interfaces_=function(){return[yl]};ss.prototype.getClass=function(){return ss};var nn=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new hr,this._resultGeometry=null,this._saveException=null,arguments.length===1){var t=arguments[0];this._argGeom=t}else if(arguments.length===2){var e=arguments[0],i=arguments[1];this._argGeom=e,this._bufParams=i}},fp={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};nn.prototype.bufferFixedPrecision=function(t){var e=new Nu(new ss(new pr(1)),t.getScale()),i=new kn(this._bufParams);i.setWorkingPrecisionModel(t),i.setNoder(e),this._resultGeometry=i.buffer(this._argGeom,this._distance)};nn.prototype.bufferReducedPrecision=function(){var t=this;if(arguments.length===0){for(var e=nn.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(s){if(s instanceof Hs)t._saveException=s;else throw s}finally{}if(t._resultGeometry!==null)return null}throw this._saveException}else if(arguments.length===1){var i=arguments[0],o=nn.precisionScaleFactor(this._argGeom,this._distance,i),u=new pr(o);this.bufferFixedPrecision(u)}};nn.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===pr.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()};nn.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)};nn.prototype.bufferOriginalPrecision=function(){try{var t=new kn(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(e){if(e instanceof js)this._saveException=e;else throw e}finally{}};nn.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry};nn.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)};nn.prototype.interfaces_=function(){return[]};nn.prototype.getClass=function(){return nn};nn.bufferOp=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],i=new nn(t),o=i.getResultGeometry(e);return o}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Se&&typeof arguments[1]=="number"){var u=arguments[0],s=arguments[1],y=arguments[2],v=new nn(u);v.setQuadrantSegments(y);var S=v.getResultGeometry(s);return S}else if(arguments[2]instanceof hr&&arguments[0]instanceof Se&&typeof arguments[1]=="number"){var L=arguments[0],k=arguments[1],N=arguments[2],Q=new nn(L,N),tt=Q.getResultGeometry(k);return tt}}else if(arguments.length===4){var xt=arguments[0],mt=arguments[1],Ct=arguments[2],ut=arguments[3],Pt=new nn(xt);Pt.setQuadrantSegments(Ct),Pt.setEndCapStyle(ut);var Ft=Pt.getResultGeometry(mt);return Ft}};nn.precisionScaleFactor=function(t,e,i){var o=t.getEnvelopeInternal(),u=vo.max(Math.abs(o.getMaxX()),Math.abs(o.getMaxY()),Math.abs(o.getMinX()),Math.abs(o.getMinY())),s=e>0?e:0,y=u+2*s,v=Math.trunc(Math.log(y)/Math.log(10)+1),S=i-v,L=Math.pow(10,S);return L};fp.CAP_ROUND.get=function(){return hr.CAP_ROUND};fp.CAP_BUTT.get=function(){return hr.CAP_FLAT};fp.CAP_FLAT.get=function(){return hr.CAP_FLAT};fp.CAP_SQUARE.get=function(){return hr.CAP_SQUARE};fp.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(nn,fp);var An=function(){this._pt=[new ft,new ft],this._distance=Ae.NaN,this._isNull=!0};An.prototype.getCoordinates=function(){return this._pt};An.prototype.getCoordinate=function(t){return this._pt[t]};An.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var o=e.distance(i);o<this._distance&&this.initialize(e,i,o)}};An.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(arguments.length===3){var i=arguments[0],o=arguments[1],u=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(o),this._distance=u,this._isNull=!1}};An.prototype.getDistance=function(){return this._distance};An.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var o=e.distance(i);o>this._distance&&this.initialize(e,i,o)}};An.prototype.interfaces_=function(){return[]};An.prototype.getClass=function(){return An};var Ja=function(){};Ja.prototype.interfaces_=function(){return[]};Ja.prototype.getClass=function(){return Ja};Ja.computeDistance=function(){if(arguments[2]instanceof An&&arguments[0]instanceof oi&&arguments[1]instanceof ft)for(var t=arguments[0],e=arguments[1],i=arguments[2],o=t.getCoordinates(),u=new ge,s=0;s<o.length-1;s++){u.setCoordinates(o[s],o[s+1]);var y=u.closestPoint(e);i.setMinimum(y,e)}else if(arguments[2]instanceof An&&arguments[0]instanceof Ri&&arguments[1]instanceof ft){var v=arguments[0],S=arguments[1],L=arguments[2];Ja.computeDistance(v.getExteriorRing(),S,L);for(var k=0;k<v.getNumInteriorRing();k++)Ja.computeDistance(v.getInteriorRingN(k),S,L)}else if(arguments[2]instanceof An&&arguments[0]instanceof Se&&arguments[1]instanceof ft){var N=arguments[0],Q=arguments[1],tt=arguments[2];if(N instanceof oi)Ja.computeDistance(N,Q,tt);else if(N instanceof Ri)Ja.computeDistance(N,Q,tt);else if(N instanceof Nn)for(var xt=N,mt=0;mt<xt.getNumGeometries();mt++){var Ct=xt.getGeometryN(mt);Ja.computeDistance(Ct,Q,tt)}else tt.setMinimum(N.getCoordinate(),Q)}else if(arguments[2]instanceof An&&arguments[0]instanceof ge&&arguments[1]instanceof ft){var ut=arguments[0],Pt=arguments[1],Ft=arguments[2],ie=ut.closestPoint(Pt);Ft.setMinimum(ie,Pt)}};var xl=function(t){this._maxPtDist=new An,this._inputGeom=t||null},Km={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};xl.prototype.computeMaxMidpointDistance=function(t){var e=new Ru(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())};xl.prototype.computeMaxVertexDistance=function(t){var e=new bc(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())};xl.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()};xl.prototype.getDistancePoints=function(){return this._maxPtDist};xl.prototype.interfaces_=function(){return[]};xl.prototype.getClass=function(){return xl};Km.MaxPointDistanceFilter.get=function(){return bc};Km.MaxMidpointDistanceFilter.get=function(){return Ru};Object.defineProperties(xl,Km);var bc=function(t){this._maxPtDist=new An,this._minPtDist=new An,this._geom=t||null};bc.prototype.filter=function(t){this._minPtDist.initialize(),Ja.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};bc.prototype.getMaxPointDistance=function(){return this._maxPtDist};bc.prototype.interfaces_=function(){return[rs]};bc.prototype.getClass=function(){return bc};var Ru=function(t){this._maxPtDist=new An,this._minPtDist=new An,this._geom=t||null};Ru.prototype.filter=function(t,e){if(e===0)return null;var i=t.getCoordinate(e-1),o=t.getCoordinate(e),u=new ft((i.x+o.x)/2,(i.y+o.y)/2);this._minPtDist.initialize(),Ja.computeDistance(this._geom,u,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Ru.prototype.isDone=function(){return!1};Ru.prototype.isGeometryChanged=function(){return!1};Ru.prototype.getMaxPointDistance=function(){return this._maxPtDist};Ru.prototype.interfaces_=function(){return[sa]};Ru.prototype.getClass=function(){return Ru};var Us=function(t){this._comps=t||null};Us.prototype.filter=function(t){t instanceof Ri&&this._comps.add(t)};Us.prototype.interfaces_=function(){return[Aa]};Us.prototype.getClass=function(){return Us};Us.getPolygons=function(){if(arguments.length===1){var t=arguments[0];return Us.getPolygons(t,new qt)}else if(arguments.length===2){var e=arguments[0],i=arguments[1];return e instanceof Ri?i.add(e):e instanceof Nn&&e.apply(new Us(i)),i}};var rn=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var t=arguments[0];this._lines=t}else if(arguments.length===2){var e=arguments[0],i=arguments[1];this._lines=e,this._isForcedToLineString=i}};rn.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof is){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof oi&&this._lines.add(t)};rn.prototype.setForceToLineString=function(t){this._isForcedToLineString=t};rn.prototype.interfaces_=function(){return[Gs]};rn.prototype.getClass=function(){return rn};rn.getGeometry=function(){if(arguments.length===1){var t=arguments[0];return t.getFactory().buildGeometry(rn.getLines(t))}else if(arguments.length===2){var e=arguments[0],i=arguments[1];return e.getFactory().buildGeometry(rn.getLines(e,i))}};rn.getLines=function(){if(arguments.length===1){var t=arguments[0];return rn.getLines(t,!1)}else if(arguments.length===2){if(Ie(arguments[0],Di)&&Ie(arguments[1],Di)){for(var e=arguments[0],i=arguments[1],o=e.iterator();o.hasNext();){var u=o.next();rn.getLines(u,i)}return i}else if(arguments[0]instanceof Se&&typeof arguments[1]=="boolean"){var s=arguments[0],y=arguments[1],v=new qt;return s.apply(new rn(v,y)),v}else if(arguments[0]instanceof Se&&Ie(arguments[1],Di)){var S=arguments[0],L=arguments[1];return S instanceof oi?L.add(S):S.apply(new rn(L)),L}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Ie(arguments[0],Di)&&Ie(arguments[1],Di)){for(var k=arguments[0],N=arguments[1],Q=arguments[2],tt=k.iterator();tt.hasNext();){var xt=tt.next();rn.getLines(xt,N,Q)}return N}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Se&&Ie(arguments[1],Di)){var mt=arguments[0],Ct=arguments[1],ut=arguments[2];return mt.apply(new rn(Ct,ut)),Ct}}};var ha=function(){if(this._boundaryRule=jo.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];if(t===null)throw new Zr("Rule must be non-null");this._boundaryRule=t}}};ha.prototype.locateInternal=function(){var t=this;if(arguments[0]instanceof ft&&arguments[1]instanceof Ri){var e=arguments[0],i=arguments[1];if(i.isEmpty())return dt.EXTERIOR;var o=i.getExteriorRing(),u=this.locateInPolygonRing(e,o);if(u===dt.EXTERIOR)return dt.EXTERIOR;if(u===dt.BOUNDARY)return dt.BOUNDARY;for(var s=0;s<i.getNumInteriorRing();s++){var y=i.getInteriorRingN(s),v=t.locateInPolygonRing(e,y);if(v===dt.INTERIOR)return dt.EXTERIOR;if(v===dt.BOUNDARY)return dt.BOUNDARY}return dt.INTERIOR}else if(arguments[0]instanceof ft&&arguments[1]instanceof oi){var S=arguments[0],L=arguments[1];if(!L.getEnvelopeInternal().intersects(S))return dt.EXTERIOR;var k=L.getCoordinates();return!L.isClosed()&&(S.equals(k[0])||S.equals(k[k.length-1]))?dt.BOUNDARY:Kt.isOnLine(S,k)?dt.INTERIOR:dt.EXTERIOR}else if(arguments[0]instanceof ft&&arguments[1]instanceof ao){var N=arguments[0],Q=arguments[1],tt=Q.getCoordinate();return tt.equals2D(N)?dt.INTERIOR:dt.EXTERIOR}};ha.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?Kt.locatePointInRing(t,e.getCoordinates()):dt.EXTERIOR};ha.prototype.intersects=function(t,e){return this.locate(t,e)!==dt.EXTERIOR};ha.prototype.updateLocationInfo=function(t){t===dt.INTERIOR&&(this._isIn=!0),t===dt.BOUNDARY&&this._numBoundaries++};ha.prototype.computeLocation=function(t,e){var i=this;if(e instanceof ao&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof oi)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Ri)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof gl)for(var o=e,u=0;u<o.getNumGeometries();u++){var s=o.getGeometryN(u);i.updateLocationInfo(i.locateInternal(t,s))}else if(e instanceof $a)for(var y=e,v=0;v<y.getNumGeometries();v++){var S=y.getGeometryN(v);i.updateLocationInfo(i.locateInternal(t,S))}else if(e instanceof Nn)for(var L=new ts(e);L.hasNext();){var k=L.next();k!==e&&i.computeLocation(t,k)}};ha.prototype.locate=function(t,e){return e.isEmpty()?dt.EXTERIOR:e instanceof oi?this.locateInternal(t,e):e instanceof Ri?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?dt.BOUNDARY:this._numBoundaries>0||this._isIn?dt.INTERIOR:dt.EXTERIOR)};ha.prototype.interfaces_=function(){return[]};ha.prototype.getClass=function(){return ha};var Dn=function n(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var t=arguments[0],e=arguments[1];n.call(this,t,n.INSIDE_AREA,e)}else if(arguments.length===3){var i=arguments[0],o=arguments[1],u=arguments[2];this._component=i,this._segIndex=o,this._pt=u}},t1={INSIDE_AREA:{configurable:!0}};Dn.prototype.isInsideArea=function(){return this._segIndex===Dn.INSIDE_AREA};Dn.prototype.getCoordinate=function(){return this._pt};Dn.prototype.getGeometryComponent=function(){return this._component};Dn.prototype.getSegmentIndex=function(){return this._segIndex};Dn.prototype.interfaces_=function(){return[]};Dn.prototype.getClass=function(){return Dn};t1.INSIDE_AREA.get=function(){return-1};Object.defineProperties(Dn,t1);var Tu=function(t){this._pts=t||null};Tu.prototype.filter=function(t){t instanceof ao&&this._pts.add(t)};Tu.prototype.interfaces_=function(){return[Aa]};Tu.prototype.getClass=function(){return Tu};Tu.getPoints=function(){if(arguments.length===1){var t=arguments[0];return t instanceof ao?la.singletonList(t):Tu.getPoints(t,new qt)}else if(arguments.length===2){var e=arguments[0],i=arguments[1];return e instanceof ao?i.add(e):e instanceof Nn&&e.apply(new Tu(i)),i}};var wc=function(){this._locations=null;var t=arguments[0];this._locations=t};wc.prototype.filter=function(t){(t instanceof ao||t instanceof oi||t instanceof Ri)&&this._locations.add(new Dn(t,0,t.getCoordinate()))};wc.prototype.interfaces_=function(){return[Aa]};wc.prototype.getClass=function(){return wc};wc.getLocations=function(t){var e=new qt;return t.apply(new wc(e)),e};var sn=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new ha,this._minDistanceLocation=null,this._minDistance=Ae.MAX_VALUE,arguments.length===2){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(arguments.length===3){var i=arguments[0],o=arguments[1],u=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=i,this._geom[1]=o,this._terminateDistance=u}};sn.prototype.computeContainmentDistance=function(){var t=this;if(arguments.length===0){var e=new Array(2).fill(null);if(this.computeContainmentDistance(0,e),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,e)}else if(arguments.length===2){var i=arguments[0],o=arguments[1],u=1-i,s=Us.getPolygons(this._geom[i]);if(s.size()>0){var y=wc.getLocations(this._geom[u]);if(this.computeContainmentDistance(y,s,o),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[u]=o[0],this._minDistanceLocation[i]=o[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Ie(arguments[0],oa)&&Ie(arguments[1],oa)){for(var v=arguments[0],S=arguments[1],L=arguments[2],k=0;k<v.size();k++)for(var N=v.get(k),Q=0;Q<S.size();Q++)if(t.computeContainmentDistance(N,S.get(Q),L),t._minDistance<=t._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Dn&&arguments[1]instanceof Ri){var tt=arguments[0],xt=arguments[1],mt=arguments[2],Ct=tt.getCoordinate();if(dt.EXTERIOR!==this._ptLocator.locate(Ct,xt))return this._minDistance=0,mt[0]=tt,mt[1]=new Dn(xt,Ct),null}}};sn.prototype.computeMinDistanceLinesPoints=function(t,e,i){for(var o=this,u=0;u<t.size();u++)for(var s=t.get(u),y=0;y<e.size();y++){var v=e.get(y);if(o.computeMinDistance(s,v,i),o._minDistance<=o._terminateDistance)return null}};sn.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=rn.getLines(this._geom[0]),i=rn.getLines(this._geom[1]),o=Tu.getPoints(this._geom[0]),u=Tu.getPoints(this._geom[1]);if(this.computeMinDistanceLines(e,i,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,u,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance)||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(i,o,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance))return null;t[0]=null,t[1]=null,this.computeMinDistancePoints(o,u,t),this.updateMinDistance(t,!1)};sn.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation};sn.prototype.updateMinDistance=function(t,e){if(t[0]===null)return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])};sn.prototype.nearestPoints=function(){this.computeMinDistance();var t=[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()];return t};sn.prototype.computeMinDistance=function(){var t=this;if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof oi&&arguments[1]instanceof ao){var e=arguments[0],i=arguments[1],o=arguments[2];if(e.getEnvelopeInternal().distance(i.getEnvelopeInternal())>this._minDistance)return null;for(var u=e.getCoordinates(),s=i.getCoordinate(),y=0;y<u.length-1;y++){var v=Kt.distancePointLine(s,u[y],u[y+1]);if(v<t._minDistance){t._minDistance=v;var S=new ge(u[y],u[y+1]),L=S.closestPoint(s);o[0]=new Dn(e,y,L),o[1]=new Dn(i,0,s)}if(t._minDistance<=t._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof oi&&arguments[1]instanceof oi){var k=arguments[0],N=arguments[1],Q=arguments[2];if(k.getEnvelopeInternal().distance(N.getEnvelopeInternal())>this._minDistance)return null;for(var tt=k.getCoordinates(),xt=N.getCoordinates(),mt=0;mt<tt.length-1;mt++)for(var Ct=0;Ct<xt.length-1;Ct++){var ut=Kt.distanceLineLine(tt[mt],tt[mt+1],xt[Ct],xt[Ct+1]);if(ut<t._minDistance){t._minDistance=ut;var Pt=new ge(tt[mt],tt[mt+1]),Ft=new ge(xt[Ct],xt[Ct+1]),ie=Pt.closestPoints(Ft);Q[0]=new Dn(k,mt,ie[0]),Q[1]=new Dn(N,Ct,ie[1])}if(t._minDistance<=t._terminateDistance)return null}}}};sn.prototype.computeMinDistancePoints=function(t,e,i){for(var o=this,u=0;u<t.size();u++)for(var s=t.get(u),y=0;y<e.size();y++){var v=e.get(y),S=s.getCoordinate().distance(v.getCoordinate());if(S<o._minDistance&&(o._minDistance=S,i[0]=new Dn(s,0,s.getCoordinate()),i[1]=new Dn(v,0,v.getCoordinate())),o._minDistance<=o._terminateDistance)return null}};sn.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new Zr("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)};sn.prototype.computeMinDistanceLines=function(t,e,i){for(var o=this,u=0;u<t.size();u++)for(var s=t.get(u),y=0;y<e.size();y++){var v=e.get(y);if(o.computeMinDistance(s,v,i),o._minDistance<=o._terminateDistance)return null}};sn.prototype.interfaces_=function(){return[]};sn.prototype.getClass=function(){return sn};sn.distance=function(t,e){var i=new sn(t,e);return i.distance()};sn.isWithinDistance=function(t,e,i){var o=new sn(t,e,i);return o.distance()<=i};sn.nearestPoints=function(t,e){var i=new sn(t,e);return i.nearestPoints()};var gn=function(){this._pt=[new ft,new ft],this._distance=Ae.NaN,this._isNull=!0};gn.prototype.getCoordinates=function(){return this._pt};gn.prototype.getCoordinate=function(t){return this._pt[t]};gn.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var o=e.distance(i);o<this._distance&&this.initialize(e,i,o)}};gn.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(arguments.length===3){var i=arguments[0],o=arguments[1],u=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(o),this._distance=u,this._isNull=!1}};gn.prototype.toString=function(){return aa.toLineString(this._pt[0],this._pt[1])};gn.prototype.getDistance=function(){return this._distance};gn.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var o=e.distance(i);o>this._distance&&this.initialize(e,i,o)}};gn.prototype.interfaces_=function(){return[]};gn.prototype.getClass=function(){return gn};var Ca=function(){};Ca.prototype.interfaces_=function(){return[]};Ca.prototype.getClass=function(){return Ca};Ca.computeDistance=function(){if(arguments[2]instanceof gn&&arguments[0]instanceof oi&&arguments[1]instanceof ft)for(var t=arguments[0],e=arguments[1],i=arguments[2],o=new ge,u=t.getCoordinates(),s=0;s<u.length-1;s++){o.setCoordinates(u[s],u[s+1]);var y=o.closestPoint(e);i.setMinimum(y,e)}else if(arguments[2]instanceof gn&&arguments[0]instanceof Ri&&arguments[1]instanceof ft){var v=arguments[0],S=arguments[1],L=arguments[2];Ca.computeDistance(v.getExteriorRing(),S,L);for(var k=0;k<v.getNumInteriorRing();k++)Ca.computeDistance(v.getInteriorRingN(k),S,L)}else if(arguments[2]instanceof gn&&arguments[0]instanceof Se&&arguments[1]instanceof ft){var N=arguments[0],Q=arguments[1],tt=arguments[2];if(N instanceof oi)Ca.computeDistance(N,Q,tt);else if(N instanceof Ri)Ca.computeDistance(N,Q,tt);else if(N instanceof Nn)for(var xt=N,mt=0;mt<xt.getNumGeometries();mt++){var Ct=xt.getGeometryN(mt);Ca.computeDistance(Ct,Q,tt)}else tt.setMinimum(N.getCoordinate(),Q)}else if(arguments[2]instanceof gn&&arguments[0]instanceof ge&&arguments[1]instanceof ft){var ut=arguments[0],Pt=arguments[1],Ft=arguments[2],ie=ut.closestPoint(Pt);Ft.setMinimum(ie,Pt)}};var qo=function(){this._g0=null,this._g1=null,this._ptDist=new gn,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},Jm={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};qo.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()};qo.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new Zr("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t};qo.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)};qo.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()};qo.prototype.computeOrientedDistance=function(t,e,i){var o=new Ec(e);if(t.apply(o),i.setMaximum(o.getMaxPointDistance()),this._densifyFrac>0){var u=new Fu(e,this._densifyFrac);t.apply(u),i.setMaximum(u.getMaxPointDistance())}};qo.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()};qo.prototype.interfaces_=function(){return[]};qo.prototype.getClass=function(){return qo};qo.distance=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],i=new qo(t,e);return i.distance()}else if(arguments.length===3){var o=arguments[0],u=arguments[1],s=arguments[2],y=new qo(o,u);return y.setDensifyFraction(s),y.distance()}};Jm.MaxPointDistanceFilter.get=function(){return Ec};Jm.MaxDensifiedByFractionDistanceFilter.get=function(){return Fu};Object.defineProperties(qo,Jm);var Ec=function(){this._maxPtDist=new gn,this._minPtDist=new gn,this._euclideanDist=new Ca,this._geom=null;var t=arguments[0];this._geom=t};Ec.prototype.filter=function(t){this._minPtDist.initialize(),Ca.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Ec.prototype.getMaxPointDistance=function(){return this._maxPtDist};Ec.prototype.interfaces_=function(){return[rs]};Ec.prototype.getClass=function(){return Ec};var Fu=function(){this._maxPtDist=new gn,this._minPtDist=new gn,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};Fu.prototype.filter=function(t,e){var i=this;if(e===0)return null;for(var o=t.getCoordinate(e-1),u=t.getCoordinate(e),s=(u.x-o.x)/this._numSubSegs,y=(u.y-o.y)/this._numSubSegs,v=0;v<this._numSubSegs;v++){var S=o.x+v*s,L=o.y+v*y,k=new ft(S,L);i._minPtDist.initialize(),Ca.computeDistance(i._geom,k,i._minPtDist),i._maxPtDist.setMaximum(i._minPtDist)}};Fu.prototype.isDone=function(){return!1};Fu.prototype.isGeometryChanged=function(){return!1};Fu.prototype.getMaxPointDistance=function(){return this._maxPtDist};Fu.prototype.interfaces_=function(){return[sa]};Fu.prototype.getClass=function(){return Fu};var oo=function(t,e,i){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=i||null},Qm={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};oo.prototype.checkMaximumDistance=function(t,e,i){var o=new qo(e,t);if(o.setDensifyFraction(.25),this._maxDistanceFound=o.orientedDistance(),this._maxDistanceFound>i){this._isValid=!1;var u=o.getCoordinates();this._errorLocation=u[1],this._errorIndicator=t.getFactory().createLineString(u),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+aa.toLineString(u[0],u[1])+")"}};oo.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=oo.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,this._input.isEmpty()||this._result.isEmpty()?!0:(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),oo.VERBOSE&&an.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)};oo.prototype.checkNegativeValid=function(){if(!(this._input instanceof Ri||this._input instanceof $a||this._input instanceof Nn))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)};oo.prototype.getErrorIndicator=function(){return this._errorIndicator};oo.prototype.checkMinimumDistance=function(t,e,i){var o=new sn(t,e,i);if(this._minDistanceFound=o.distance(),this._minDistanceFound<i){this._isValid=!1;var u=o.nearestPoints();this._errorLocation=o.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(u),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+aa.toLineString(u[0],u[1])+" )"}};oo.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)};oo.prototype.getErrorLocation=function(){return this._errorLocation};oo.prototype.getPolygonLines=function(t){for(var e=new qt,i=new rn(e),o=Us.getPolygons(t),u=o.iterator();u.hasNext();){var s=u.next();s.apply(i)}return t.getFactory().buildGeometry(e)};oo.prototype.getErrorMessage=function(){return this._errMsg};oo.prototype.interfaces_=function(){return[]};oo.prototype.getClass=function(){return oo};Qm.VERBOSE.get=function(){return!1};Qm.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012};Object.defineProperties(oo,Qm);var un=function(t,e,i){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=i||null},$m={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};un.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid};un.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*un.MAX_ENV_DIFF_FRAC;t===0&&(t=.001);var e=new fe(this._input.getEnvelopeInternal());e.expandBy(this._distance);var i=new fe(this._result.getEnvelopeInternal());i.expandBy(t),i.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(i)),this.report("Envelope")};un.prototype.checkDistance=function(){var t=new oo(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")};un.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")};un.prototype.checkPolygonal=function(){this._result instanceof Ri||this._result instanceof $a||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")};un.prototype.getErrorIndicator=function(){return this._errorIndicator};un.prototype.getErrorLocation=function(){return this._errorLocation};un.prototype.checkExpectedEmpty=function(){if(this._input.getDimension()>=2||this._distance>0)return null;this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),this.report("ExpectedEmpty")};un.prototype.report=function(t){if(!un.VERBOSE)return null;an.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))};un.prototype.getErrorMessage=function(){return this._errorMsg};un.prototype.interfaces_=function(){return[]};un.prototype.getClass=function(){return un};un.isValidMsg=function(t,e,i){var o=new un(t,e,i);return o.isValid()?null:o.getErrorMessage()};un.isValid=function(t,e,i){var o=new un(t,e,i);return!!o.isValid()};$m.VERBOSE.get=function(){return!1};$m.MAX_ENV_DIFF_FRAC.get=function(){return .012};Object.defineProperties(un,$m);var Fa=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Fa.prototype.getCoordinates=function(){return this._pts};Fa.prototype.size=function(){return this._pts.length};Fa.prototype.getCoordinate=function(t){return this._pts[t]};Fa.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Fa.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:_c.octant(this.getCoordinate(t),this.getCoordinate(t+1))};Fa.prototype.setData=function(t){this._data=t};Fa.prototype.getData=function(){return this._data};Fa.prototype.toString=function(){return aa.toLineString(new di(this._pts))};Fa.prototype.interfaces_=function(){return[os]};Fa.prototype.getClass=function(){return Fa};var Ki=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new qt,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Ki.prototype.getInteriorIntersection=function(){return this._interiorIntersection};Ki.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t};Ki.prototype.getIntersectionSegments=function(){return this._intSegments};Ki.prototype.count=function(){return this._intersectionCount};Ki.prototype.getIntersections=function(){return this._intersections};Ki.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};Ki.prototype.setKeepIntersections=function(t){this._keepIntersections=t};Ki.prototype.processIntersections=function(t,e,i,o){if(!this._findAllIntersections&&this.hasIntersection()||t===i&&e===o)return null;if(this._isCheckEndSegmentsOnly){var u=this.isEndSegment(t,e)||this.isEndSegment(i,o);if(!u)return null}var s=t.getCoordinates()[e],y=t.getCoordinates()[e+1],v=i.getCoordinates()[o],S=i.getCoordinates()[o+1];this._li.computeIntersection(s,y,v,S),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=s,this._intSegments[1]=y,this._intSegments[2]=v,this._intSegments[3]=S,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};Ki.prototype.isEndSegment=function(t,e){return e===0||e>=t.size()-2};Ki.prototype.hasIntersection=function(){return this._interiorIntersection!==null};Ki.prototype.isDone=function(){return this._findAllIntersections?!1:this._interiorIntersection!==null};Ki.prototype.interfaces_=function(){return[_l]};Ki.prototype.getClass=function(){return Ki};Ki.createAllIntersectionsFinder=function(t){var e=new Ki(t);return e.setFindAllIntersections(!0),e};Ki.createAnyIntersectionFinder=function(t){return new Ki(t)};Ki.createIntersectionCounter=function(t){var e=new Ki(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var pa=function(){this._li=new Sl,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};pa.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()};pa.prototype.getIntersections=function(){return this._segInt.getIntersections()};pa.prototype.isValid=function(){return this.execute(),this._isValid};pa.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};pa.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Ki(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new Wm;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};pa.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Hs(this.getErrorMessage(),this._segInt.getInteriorIntersection())};pa.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+aa.toLineString(t[0],t[1])+" and "+aa.toLineString(t[2],t[3])};pa.prototype.interfaces_=function(){return[]};pa.prototype.getClass=function(){return pa};pa.computeIntersections=function(t){var e=new pa(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var bl=function n(){this._nv=null;var t=arguments[0];this._nv=new pa(n.toSegmentStrings(t))};bl.prototype.checkValid=function(){this._nv.checkValid()};bl.prototype.interfaces_=function(){return[]};bl.prototype.getClass=function(){return bl};bl.toSegmentStrings=function(t){for(var e=new qt,i=t.iterator();i.hasNext();){var o=i.next();e.add(new Fa(o.getCoordinates(),o))}return e};bl.checkValid=function(t){var e=new bl(t);e.checkValid()};var Sc=function(t){this._mapOp=t};Sc.prototype.map=function(t){for(var e=this,i=new qt,o=0;o<t.getNumGeometries();o++){var u=e._mapOp.map(t.getGeometryN(o));u.isEmpty()||i.add(u)}return t.getFactory().createGeometryCollection(He.toGeometryArray(i))};Sc.prototype.interfaces_=function(){return[]};Sc.prototype.getClass=function(){return Sc};Sc.map=function(t,e){var i=new Sc(e);return i.map(t)};var za=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new qt,this._resultLineList=new qt;var t=arguments[0],e=arguments[1],i=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=i};za.prototype.collectLines=function(t){for(var e=this,i=this._op.getGraph().getEdgeEnds().iterator();i.hasNext();){var o=i.next();e.collectLineEdge(o,t,e._lineEdgesList),e.collectBoundaryTouchEdge(o,t,e._lineEdgesList)}};za.prototype.labelIsolatedLine=function(t,e){var i=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,i)};za.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList};za.prototype.collectLineEdge=function(t,e,i){var o=t.getLabel(),u=t.getEdge();t.isLineEdge()&&!t.isVisited()&&ke.isResultOfOp(o,e)&&!u.isCovered()&&(i.add(u),t.setVisitedEdge(!0))};za.prototype.findCoveredLineEdges=function(){for(var t=this,e=this._op.getGraph().getNodes().iterator();e.hasNext();){var i=e.next();i.getEdges().findCoveredLineEdges()}for(var o=this._op.getGraph().getEdgeEnds().iterator();o.hasNext();){var u=o.next(),s=u.getEdge();if(u.isLineEdge()&&!s.isCoveredSet()){var y=t._op.isCoveredByA(u.getCoordinate());s.setCovered(y)}}};za.prototype.labelIsolatedLines=function(t){for(var e=this,i=t.iterator();i.hasNext();){var o=i.next(),u=o.getLabel();o.isIsolated()&&(u.isNull(0)?e.labelIsolatedLine(o,0):e.labelIsolatedLine(o,1))}};za.prototype.buildLines=function(t){for(var e=this,i=this._lineEdgesList.iterator();i.hasNext();){var o=i.next(),u=e._geometryFactory.createLineString(o.getCoordinates());e._resultLineList.add(u),o.setInResult(!0)}};za.prototype.collectBoundaryTouchEdge=function(t,e,i){var o=t.getLabel();if(t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult())return null;Re.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),ke.isResultOfOp(o,e)&&e===ke.INTERSECTION&&(i.add(t.getEdge()),t.setVisitedEdge(!0))};za.prototype.interfaces_=function(){return[]};za.prototype.getClass=function(){return za};var Ic=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new qt;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Ic.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var i=this._geometryFactory.createPoint(e);this._resultPointList.add(i)}};Ic.prototype.extractNonCoveredResultNodes=function(t){for(var e=this,i=this._op.getGraph().getNodes().iterator();i.hasNext();){var o=i.next();if(!o.isInResult()&&!o.isIncidentEdgeInResult()&&(o.getEdges().getDegree()===0||t===ke.INTERSECTION)){var u=o.getLabel();ke.isResultOfOp(u,t)&&e.filterCoveredNodeToPoint(o)}}};Ic.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList};Ic.prototype.interfaces_=function(){return[]};Ic.prototype.getClass=function(){return Ic};var Wn=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Wn.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))};Wn.prototype.transformPolygon=function(t,e){var i=this,o=!0,u=this.transformLinearRing(t.getExteriorRing(),t);(u===null||!(u instanceof is)||u.isEmpty())&&(o=!1);for(var s=new qt,y=0;y<t.getNumInteriorRing();y++){var v=i.transformLinearRing(t.getInteriorRingN(y),t);v===null||v.isEmpty()||(v instanceof is||(o=!1),s.add(v))}if(o)return this._factory.createPolygon(u,s.toArray([]));var S=new qt;return u!==null&&S.add(u),S.addAll(s),this._factory.buildGeometry(S)};Wn.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)};Wn.prototype.getInputGeometry=function(){return this._inputGeom};Wn.prototype.transformMultiLineString=function(t,e){for(var i=this,o=new qt,u=0;u<t.getNumGeometries();u++){var s=i.transformLineString(t.getGeometryN(u),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Wn.prototype.transformCoordinates=function(t,e){return this.copy(t)};Wn.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))};Wn.prototype.transformMultiPoint=function(t,e){for(var i=this,o=new qt,u=0;u<t.getNumGeometries();u++){var s=i.transformPoint(t.getGeometryN(u),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Wn.prototype.transformMultiPolygon=function(t,e){for(var i=this,o=new qt,u=0;u<t.getNumGeometries();u++){var s=i.transformPolygon(t.getGeometryN(u),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Wn.prototype.copy=function(t){return t.copy()};Wn.prototype.transformGeometryCollection=function(t,e){for(var i=this,o=new qt,u=0;u<t.getNumGeometries();u++){var s=i.transform(t.getGeometryN(u));s!==null&&(i._pruneEmptyGeometry&&s.isEmpty()||o.add(s))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(He.toGeometryArray(o)):this._factory.buildGeometry(o)};Wn.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof ao)return this.transformPoint(t,null);if(t instanceof Wh)return this.transformMultiPoint(t,null);if(t instanceof is)return this.transformLinearRing(t,null);if(t instanceof oi)return this.transformLineString(t,null);if(t instanceof gl)return this.transformMultiLineString(t,null);if(t instanceof Ri)return this.transformPolygon(t,null);if(t instanceof $a)return this.transformMultiPolygon(t,null);if(t instanceof Nn)return this.transformGeometryCollection(t,null);throw new Zr("Unknown Geometry subtype: "+t.getClass().getName())};Wn.prototype.transformLinearRing=function(t,e){var i=this.transformCoordinates(t.getCoordinateSequence(),t);if(i===null)return this._factory.createLinearRing(null);var o=i.size();return o>0&&o<4&&!this._preserveType?this._factory.createLineString(i):this._factory.createLinearRing(i)};Wn.prototype.interfaces_=function(){return[]};Wn.prototype.getClass=function(){return Wn};var us=function n(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new ge,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof oi&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];n.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var i=arguments[0],o=arguments[1];this._srcPts=i,this._isClosed=n.isClosed(i),this._snapTolerance=o}};us.prototype.snapVertices=function(t,e){for(var i=this,o=this._isClosed?t.size()-1:t.size(),u=0;u<o;u++){var s=t.get(u),y=i.findSnapForVertex(s,e);y!==null&&(t.set(u,new ft(y)),u===0&&i._isClosed&&t.set(t.size()-1,new ft(y)))}};us.prototype.findSnapForVertex=function(t,e){for(var i=this,o=0;o<e.length;o++){if(t.equals2D(e[o]))return null;if(t.distance(e[o])<i._snapTolerance)return e[o]}return null};us.prototype.snapTo=function(t){var e=new Zf(this._srcPts);this.snapVertices(e,t),this.snapSegments(e,t);var i=e.toCoordinateArray();return i};us.prototype.snapSegments=function(t,e){var i=this;if(e.length===0)return null;var o=e.length;e[0].equals2D(e[e.length-1])&&(o=e.length-1);for(var u=0;u<o;u++){var s=e[u],y=i.findSegmentIndexToSnap(s,t);y>=0&&t.add(y+1,new ft(s),!1)}};us.prototype.findSegmentIndexToSnap=function(t,e){for(var i=this,o=Ae.MAX_VALUE,u=-1,s=0;s<e.size()-1;s++){if(i._seg.p0=e.get(s),i._seg.p1=e.get(s+1),i._seg.p0.equals2D(t)||i._seg.p1.equals2D(t)){if(i._allowSnappingToSourceVertices)continue;return-1}var y=i._seg.distance(t);y<i._snapTolerance&&y<o&&(o=y,u=s)}return u};us.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t};us.prototype.interfaces_=function(){return[]};us.prototype.getClass=function(){return us};us.isClosed=function(t){return t.length<=1?!1:t[0].equals2D(t[t.length-1])};var gi=function(t){this._srcGeom=t||null},e1={SNAP_PRECISION_FACTOR:{configurable:!0}};gi.prototype.snapTo=function(t,e){var i=this.extractTargetCoordinates(t),o=new r1(e,i);return o.transform(this._srcGeom)};gi.prototype.snapToSelf=function(t,e){var i=this.extractTargetCoordinates(this._srcGeom),o=new r1(t,i,!0),u=o.transform(this._srcGeom),s=u;return e&&Ie(s,Au)&&(s=u.buffer(0)),s};gi.prototype.computeSnapTolerance=function(t){var e=this.computeMinimumSegmentLength(t),i=e/10;return i};gi.prototype.extractTargetCoordinates=function(t){for(var e=new Ma,i=t.getCoordinates(),o=0;o<i.length;o++)e.add(i[o]);return e.toArray(new Array(0).fill(null))};gi.prototype.computeMinimumSegmentLength=function(t){for(var e=Ae.MAX_VALUE,i=0;i<t.length-1;i++){var o=t[i].distance(t[i+1]);o<e&&(e=o)}return e};gi.prototype.interfaces_=function(){return[]};gi.prototype.getClass=function(){return gi};gi.snap=function(t,e,i){var o=new Array(2).fill(null),u=new gi(t);o[0]=u.snapTo(e,i);var s=new gi(e);return o[1]=s.snapTo(o[0],i),o};gi.computeOverlaySnapTolerance=function(){if(arguments.length===1){var t=arguments[0],e=gi.computeSizeBasedSnapTolerance(t),i=t.getPrecisionModel();if(i.getType()===pr.FIXED){var o=1/i.getScale()*2/1.415;o>e&&(e=o)}return e}else if(arguments.length===2){var u=arguments[0],s=arguments[1];return Math.min(gi.computeOverlaySnapTolerance(u),gi.computeOverlaySnapTolerance(s))}};gi.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal(),i=Math.min(e.getHeight(),e.getWidth()),o=i*gi.SNAP_PRECISION_FACTOR;return o};gi.snapToSelf=function(t,e,i){var o=new gi(t);return o.snapToSelf(e,i)};e1.SNAP_PRECISION_FACTOR.get=function(){return 1e-9};Object.defineProperties(gi,e1);var r1=function(n){function t(e,i,o){n.call(this),this._snapTolerance=e||null,this._snapPts=i||null,this._isSelfSnap=o!==void 0?o:!1}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.snapLine=function(i,o){var u=new us(i,this._snapTolerance);return u.setAllowSnappingToSourceVertices(this._isSelfSnap),u.snapTo(o)},t.prototype.transformCoordinates=function(i,o){var u=i.toCoordinateArray(),s=this.snapLine(u,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(s)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Wn),Mn=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Mn.prototype.getCommon=function(){return Ae.longBitsToDouble(this._commonBits)};Mn.prototype.add=function(t){var e=Ae.doubleToLongBits(t);if(this._isFirst)return this._commonBits=e,this._commonSignExp=Mn.signExpBits(this._commonBits),this._isFirst=!1,null;var i=Mn.signExpBits(e);if(i!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=Mn.numCommonMostSigMantissaBits(this._commonBits,e),this._commonBits=Mn.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))};Mn.prototype.toString=function(){if(arguments.length===1){var t=arguments[0],e=Ae.longBitsToDouble(t),i=Ae.toBinaryString(t),o="0000000000000000000000000000000000000000000000000000000000000000"+i,u=o.substring(o.length-64),s=u.substring(0,1)+"  "+u.substring(1,12)+"(exp) "+u.substring(12)+" [ "+e+" ]";return s}};Mn.prototype.interfaces_=function(){return[]};Mn.prototype.getClass=function(){return Mn};Mn.getBit=function(t,e){var i=1<<e;return(t&i)!==0?1:0};Mn.signExpBits=function(t){return t>>52};Mn.zeroLowerBits=function(t,e){var i=(1<<e)-1,o=~i,u=t&o;return u};Mn.numCommonMostSigMantissaBits=function(t,e){for(var i=0,o=52;o>=0;o--){if(Mn.getBit(t,o)!==Mn.getBit(e,o))return i;i++}return 52};var zu=function(){this._commonCoord=null,this._ccFilter=new Cc},t_={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};zu.prototype.addCommonBits=function(t){var e=new Bu(this._commonCoord);t.apply(e),t.geometryChanged()};zu.prototype.removeCommonBits=function(t){if(this._commonCoord.x===0&&this._commonCoord.y===0)return t;var e=new ft(this._commonCoord);e.x=-e.x,e.y=-e.y;var i=new Bu(e);return t.apply(i),t.geometryChanged(),t};zu.prototype.getCommonCoordinate=function(){return this._commonCoord};zu.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()};zu.prototype.interfaces_=function(){return[]};zu.prototype.getClass=function(){return zu};t_.CommonCoordinateFilter.get=function(){return Cc};t_.Translater.get=function(){return Bu};Object.defineProperties(zu,t_);var Cc=function(){this._commonBitsX=new Mn,this._commonBitsY=new Mn};Cc.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)};Cc.prototype.getCommonCoordinate=function(){return new ft(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};Cc.prototype.interfaces_=function(){return[rs]};Cc.prototype.getClass=function(){return Cc};var Bu=function(){this.trans=null;var t=arguments[0];this.trans=t};Bu.prototype.filter=function(t,e){var i=t.getOrdinate(e,0)+this.trans.x,o=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,i),t.setOrdinate(e,1,o)};Bu.prototype.isDone=function(){return!1};Bu.prototype.isGeometryChanged=function(){return!0};Bu.prototype.interfaces_=function(){return[sa]};Bu.prototype.getClass=function(){return Bu};var Ji=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};Ji.prototype.selfSnap=function(t){var e=new gi(t),i=e.snapTo(t,this._snapTolerance);return i};Ji.prototype.removeCommonBits=function(t){this._cbr=new zu,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e};Ji.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t};Ji.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),i=ke.overlayOp(e[0],e[1],t);return this.prepareResult(i)};Ji.prototype.checkValid=function(t){t.isValid()||an.out.println("Snapped geometry is invalid")};Ji.prototype.computeSnapTolerance=function(){this._snapTolerance=gi.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};Ji.prototype.snap=function(t){var e=this.removeCommonBits(t),i=gi.snap(e[0],e[1],this._snapTolerance);return i};Ji.prototype.interfaces_=function(){return[]};Ji.prototype.getClass=function(){return Ji};Ji.overlayOp=function(t,e,i){var o=new Ji(t,e);return o.getResultGeometry(i)};Ji.union=function(t,e){return Ji.overlayOp(t,e,ke.UNION)};Ji.intersection=function(t,e){return Ji.overlayOp(t,e,ke.INTERSECTION)};Ji.symDifference=function(t,e){return Ji.overlayOp(t,e,ke.SYMDIFFERENCE)};Ji.difference=function(t,e){return Ji.overlayOp(t,e,ke.DIFFERENCE)};var zn=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};zn.prototype.getResultGeometry=function(t){var e=null,i=!1,o=null;try{e=ke.overlayOp(this._geom[0],this._geom[1],t);var u=!0;u&&(i=!0)}catch(s){if(s instanceof js)o=s;else throw s}finally{}if(!i)try{e=Ji.overlayOp(this._geom[0],this._geom[1],t)}catch(s){throw s instanceof js?o:s}finally{}return e};zn.prototype.interfaces_=function(){return[]};zn.prototype.getClass=function(){return zn};zn.overlayOp=function(t,e,i){var o=new zn(t,e);return o.getResultGeometry(i)};zn.union=function(t,e){return zn.overlayOp(t,e,ke.UNION)};zn.intersection=function(t,e){return zn.overlayOp(t,e,ke.INTERSECTION)};zn.symDifference=function(t,e){return zn.overlayOp(t,e,ke.SYMDIFFERENCE)};zn.difference=function(t,e){return zn.overlayOp(t,e,ke.DIFFERENCE)};var Rf=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};Rf.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)};Rf.prototype.interfaces_=function(){return[]};Rf.prototype.getClass=function(){return Rf};var lo=function n(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var t=arguments[0],e=arguments[1];this._eventType=n.DELETE,this._xValue=t,this._insertEvent=e}else if(arguments.length===3){var i=arguments[0],o=arguments[1],u=arguments[2];this._eventType=n.INSERT,this._label=i,this._xValue=o,this._obj=u}},e_={INSERT:{configurable:!0},DELETE:{configurable:!0}};lo.prototype.isDelete=function(){return this._eventType===lo.DELETE};lo.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t};lo.prototype.getObject=function(){return this._obj};lo.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0};lo.prototype.getInsertEvent=function(){return this._insertEvent};lo.prototype.isInsert=function(){return this._eventType===lo.INSERT};lo.prototype.isSameLabel=function(t){return this._label===null?!1:this._label===t._label};lo.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};lo.prototype.interfaces_=function(){return[Xo]};lo.prototype.getClass=function(){return lo};e_.INSERT.get=function(){return 1};e_.DELETE.get=function(){return 2};Object.defineProperties(lo,e_);var Dg=function(){};Dg.prototype.interfaces_=function(){return[]};Dg.prototype.getClass=function(){return Dg};var ln=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],i=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=i};ln.prototype.isTrivialIntersection=function(t,e,i,o){if(t===i&&this._li.getIntersectionNum()===1){if(ln.isAdjacentSegments(e,o))return!0;if(t.isClosed()){var u=t.getNumPoints()-1;if(e===0&&o===u||o===0&&e===u)return!0}}return!1};ln.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};ln.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t};ln.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};ln.prototype.isBoundaryPointInternal=function(t,e){for(var i=e.iterator();i.hasNext();){var o=i.next(),u=o.getCoordinate();if(t.isIntersection(u))return!0}return!1};ln.prototype.hasProperIntersection=function(){return this._hasProper};ln.prototype.hasIntersection=function(){return this._hasIntersection};ln.prototype.isDone=function(){return this._isDone};ln.prototype.isBoundaryPoint=function(t,e){return e===null?!1:!!(this.isBoundaryPointInternal(t,e[0])||this.isBoundaryPointInternal(t,e[1]))};ln.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e};ln.prototype.addIntersections=function(t,e,i,o){if(t===i&&e===o)return null;this.numTests++;var u=t.getCoordinates()[e],s=t.getCoordinates()[e+1],y=i.getCoordinates()[o],v=i.getCoordinates()[o+1];this._li.computeIntersection(u,s,y,v),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),i.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,i,o)||(this._hasIntersection=!0,(this._includeProper||!this._li.isProper())&&(t.addIntersections(this._li,e,0),i.addIntersections(this._li,o,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};ln.prototype.interfaces_=function(){return[]};ln.prototype.getClass=function(){return ln};ln.isAdjacentSegments=function(t,e){return Math.abs(t-e)===1};var aI=function(n){function t(){n.call(this),this.events=new qt,this.nOverlaps=null}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.prepareEvents=function(){var i=this;la.sort(this.events);for(var o=0;o<this.events.size();o++){var u=i.events.get(o);u.isDelete()&&u.getInsertEvent().setDeleteEventIndex(o)}},t.prototype.computeIntersections=function(){var i=this;if(arguments.length===1){var o=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var u=0;u<this.events.size();u++){var s=i.events.get(u);if(s.isInsert()&&i.processOverlaps(u,s.getDeleteEventIndex(),s,o),o.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof ln&&Ie(arguments[0],oa)&&Ie(arguments[1],oa)){var y=arguments[0],v=arguments[1],S=arguments[2];this.addEdges(y,y),this.addEdges(v,v),this.computeIntersections(S)}else if(typeof arguments[2]=="boolean"&&Ie(arguments[0],oa)&&arguments[1]instanceof ln){var L=arguments[0],k=arguments[1],N=arguments[2];N?this.addEdges(L,null):this.addEdges(L),this.computeIntersections(k)}}},t.prototype.addEdge=function(i,o){for(var u=this,s=i.getMonotoneChainEdge(),y=s.getStartIndexes(),v=0;v<y.length-1;v++){var S=new Rf(s,v),L=new lo(o,s.getMinX(v),S);u.events.add(L),u.events.add(new lo(s.getMaxX(v),L))}},t.prototype.processOverlaps=function(i,o,u,s){for(var y=this,v=u.getObject(),S=i;S<o;S++){var L=y.events.get(S);if(L.isInsert()){var k=L.getObject();u.isSameLabel(L)||(v.computeIntersections(k,s),y.nOverlaps++)}}},t.prototype.addEdges=function(){var i=this;if(arguments.length===1)for(var o=arguments[0],u=o.iterator();u.hasNext();){var s=u.next();i.addEdge(s,s)}else if(arguments.length===2)for(var y=arguments[0],v=arguments[1],S=y.iterator();S.hasNext();){var L=S.next();i.addEdge(L,v)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Dg),ls=function(){this._min=Ae.POSITIVE_INFINITY,this._max=Ae.NEGATIVE_INFINITY},i1={NodeComparator:{configurable:!0}};ls.prototype.getMin=function(){return this._min};ls.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)};ls.prototype.getMax=function(){return this._max};ls.prototype.toString=function(){return aa.toLineString(new ft(this._min,0),new ft(this._max,0))};ls.prototype.interfaces_=function(){return[]};ls.prototype.getClass=function(){return ls};i1.NodeComparator.get=function(){return Ff};Object.defineProperties(ls,i1);var Ff=function(){};Ff.prototype.compare=function(t,e){var i=t,o=e,u=(i._min+i._max)/2,s=(o._min+o._max)/2;return u<s?-1:u>s?1:0};Ff.prototype.interfaces_=function(){return[qh]};Ff.prototype.getClass=function(){return Ff};var sI=function(n){function t(){n.call(this),this._item=null;var e=arguments[0],i=arguments[1],o=arguments[2];this._min=e,this._max=i,this._item=o}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.query=function(i,o,u){if(!this.intersects(i,o))return null;u.visitItem(this._item)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ls),uI=function(n){function t(){n.call(this),this._node1=null,this._node2=null;var e=arguments[0],i=arguments[1];this._node1=e,this._node2=i,this.buildExtent(this._node1,this._node2)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.buildExtent=function(i,o){this._min=Math.min(i._min,o._min),this._max=Math.max(i._max,o._max)},t.prototype.query=function(i,o,u){if(!this.intersects(i,o))return null;this._node1!==null&&this._node1.query(i,o,u),this._node2!==null&&this._node2.query(i,o,u)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ls),cs=function(){this._leaves=new qt,this._root=null,this._level=0};cs.prototype.buildTree=function(){var t=this;la.sort(this._leaves,new ls.NodeComparator);for(var e=this._leaves,i=null,o=new qt;;){if(t.buildLevel(e,o),o.size()===1)return o.get(0);i=e,e=o,o=i}};cs.prototype.insert=function(t,e,i){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new sI(t,e,i))};cs.prototype.query=function(t,e,i){this.init(),this._root.query(t,e,i)};cs.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()};cs.prototype.printNode=function(t){an.out.println(aa.toLineString(new ft(t._min,this._level),new ft(t._max,this._level)))};cs.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()};cs.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var i=0;i<t.size();i+=2){var o=t.get(i),u=i+1<t.size()?t.get(i):null;if(u===null)e.add(o);else{var s=new uI(t.get(i),t.get(i+1));e.add(s)}}};cs.prototype.interfaces_=function(){return[]};cs.prototype.getClass=function(){return cs};var ep=function(){this._items=new qt};ep.prototype.visitItem=function(t){this._items.add(t)};ep.prototype.getItems=function(){return this._items};ep.prototype.interfaces_=function(){return[Du]};ep.prototype.getClass=function(){return ep};var rp=function(){this._index=null;var t=arguments[0];if(!Ie(t,Au))throw new Zr("Argument must be Polygonal");this._index=new wl(t)},r_={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};rp.prototype.locate=function(t){var e=new La(t),i=new ip(e);return this._index.query(t.y,t.y,i),e.getLocation()};rp.prototype.interfaces_=function(){return[$h]};rp.prototype.getClass=function(){return rp};r_.SegmentVisitor.get=function(){return ip};r_.IntervalIndexedGeometry.get=function(){return wl};Object.defineProperties(rp,r_);var ip=function(){this._counter=null;var t=arguments[0];this._counter=t};ip.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))};ip.prototype.interfaces_=function(){return[Du]};ip.prototype.getClass=function(){return ip};var wl=function(){this._index=new cs;var t=arguments[0];this.init(t)};wl.prototype.init=function(t){for(var e=this,i=rn.getLines(t),o=i.iterator();o.hasNext();){var u=o.next(),s=u.getCoordinates();e.addLine(s)}};wl.prototype.addLine=function(t){for(var e=this,i=1;i<t.length;i++){var o=new ge(t[i-1],t[i]),u=Math.min(o.p0.y,o.p1.y),s=Math.max(o.p0.y,o.p1.y);e._index.insert(u,s,o)}};wl.prototype.query=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],i=new ep;return this._index.query(t,e,i),i.getItems()}else if(arguments.length===3){var o=arguments[0],u=arguments[1],s=arguments[2];this._index.query(o,u,s)}};wl.prototype.interfaces_=function(){return[]};wl.prototype.getClass=function(){return wl};var ff=function(n){function t(){if(n.call(this),this._parentGeom=null,this._lineEdgeMap=new Vx,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new ha,arguments.length===2){var e=arguments[0],i=arguments[1],o=jo.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=i,this._boundaryNodeRule=o,i!==null&&this.add(i)}else if(arguments.length===3){var u=arguments[0],s=arguments[1],y=arguments[2];this._argIndex=u,this._parentGeom=s,this._boundaryNodeRule=y,s!==null&&this.add(s)}}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.insertBoundaryPoint=function(i,o){var u=this._nodes.addNode(o),s=u.getLabel(),y=1,v=dt.NONE;v=s.getLocation(i,Nt.ON),v===dt.BOUNDARY&&y++;var S=t.determineBoundary(this._boundaryNodeRule,y);s.setLocation(i,S)},t.prototype.computeSelfNodes=function(){if(arguments.length===2){var i=arguments[0],o=arguments[1];return this.computeSelfNodes(i,o,!1)}else if(arguments.length===3){var u=arguments[0],s=arguments[1],y=arguments[2],v=new ln(u,!0,!1);v.setIsDoneIfProperInt(y);var S=this.createEdgeSetIntersector(),L=this._parentGeom instanceof is||this._parentGeom instanceof Ri||this._parentGeom instanceof $a,k=s||!L;return S.computeIntersections(this._edges,v,k),this.addSelfIntersectionNodes(this._argIndex),v}},t.prototype.computeSplitEdges=function(i){for(var o=this._edges.iterator();o.hasNext();){var u=o.next();u.eiList.addSplitEdges(i)}},t.prototype.computeEdgeIntersections=function(i,o,u){var s=new ln(o,u,!0);s.setBoundaryNodes(this.getBoundaryNodes(),i.getBoundaryNodes());var y=this.createEdgeSetIntersector();return y.computeIntersections(this._edges,i._edges,s),s},t.prototype.getGeometry=function(){return this._parentGeom},t.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},t.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},t.prototype.addPoint=function(){if(arguments[0]instanceof ao){var i=arguments[0],o=i.getCoordinate();this.insertPoint(this._argIndex,o,dt.INTERIOR)}else if(arguments[0]instanceof ft){var u=arguments[0];this.insertPoint(this._argIndex,u,dt.INTERIOR)}},t.prototype.addPolygon=function(i){var o=this;this.addPolygonRing(i.getExteriorRing(),dt.EXTERIOR,dt.INTERIOR);for(var u=0;u<i.getNumInteriorRing();u++){var s=i.getInteriorRingN(u);o.addPolygonRing(s,dt.INTERIOR,dt.EXTERIOR)}},t.prototype.addEdge=function(i){this.insertEdge(i);var o=i.getCoordinates();this.insertPoint(this._argIndex,o[0],dt.BOUNDARY),this.insertPoint(this._argIndex,o[o.length-1],dt.BOUNDARY)},t.prototype.addLineString=function(i){var o=Xe.removeRepeatedPoints(i.getCoordinates());if(o.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=o[0],null;var u=new Ag(o,new xr(this._argIndex,dt.INTERIOR));this._lineEdgeMap.put(i,u),this.insertEdge(u),Re.isTrue(o.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,o[0]),this.insertBoundaryPoint(this._argIndex,o[o.length-1])},t.prototype.getInvalidPoint=function(){return this._invalidPoint},t.prototype.getBoundaryPoints=function(){for(var i=this.getBoundaryNodes(),o=new Array(i.size()).fill(null),u=0,s=i.iterator();s.hasNext();){var y=s.next();o[u++]=y.getCoordinate().copy()}return o},t.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},t.prototype.addSelfIntersectionNode=function(i,o,u){if(this.isBoundaryNode(i,o))return null;u===dt.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(i,o):this.insertPoint(i,o,u)},t.prototype.addPolygonRing=function(i,o,u){if(i.isEmpty())return null;var s=Xe.removeRepeatedPoints(i.getCoordinates());if(s.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=s[0],null;var y=o,v=u;Kt.isCCW(s)&&(y=u,v=o);var S=new Ag(s,new xr(this._argIndex,dt.BOUNDARY,y,v));this._lineEdgeMap.put(i,S),this.insertEdge(S),this.insertPoint(this._argIndex,s[0],dt.BOUNDARY)},t.prototype.insertPoint=function(i,o,u){var s=this._nodes.addNode(o),y=s.getLabel();y===null?s._label=new xr(i,u):y.setLocation(i,u)},t.prototype.createEdgeSetIntersector=function(){return new aI},t.prototype.addSelfIntersectionNodes=function(i){for(var o=this,u=this._edges.iterator();u.hasNext();)for(var s=u.next(),y=s.getLabel().getLocation(i),v=s.eiList.iterator();v.hasNext();){var S=v.next();o.addSelfIntersectionNode(i,S.coord,y)}},t.prototype.add=function(){if(arguments.length===1){var i=arguments[0];if(i.isEmpty())return null;if(i instanceof $a&&(this._useBoundaryDeterminationRule=!1),i instanceof Ri)this.addPolygon(i);else if(i instanceof oi)this.addLineString(i);else if(i instanceof ao)this.addPoint(i);else if(i instanceof Wh)this.addCollection(i);else if(i instanceof gl)this.addCollection(i);else if(i instanceof $a)this.addCollection(i);else if(i instanceof Nn)this.addCollection(i);else throw new Error(i.getClass().getName())}else return n.prototype.add.apply(this,arguments)},t.prototype.addCollection=function(i){for(var o=this,u=0;u<i.getNumGeometries();u++){var s=i.getGeometryN(u);o.add(s)}},t.prototype.locate=function(i){return Ie(this._parentGeom,Au)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new rp(this._parentGeom)),this._areaPtLocator.locate(i)):this._ptLocator.locate(i,this._parentGeom)},t.prototype.findEdge=function(){if(arguments.length===1){var i=arguments[0];return this._lineEdgeMap.get(i)}else return n.prototype.findEdge.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.determineBoundary=function(i,o){return i.isInBoundary(o)?dt.BOUNDARY:dt.INTERIOR},t}(Qr),np=function(){if(this._li=new Sl,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new ff(0,t)}else if(arguments.length===2){var e=arguments[0],i=arguments[1],o=jo.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(i.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new ff(0,e,o),this._arg[1]=new ff(1,i,o)}else if(arguments.length===3){var u=arguments[0],s=arguments[1],y=arguments[2];u.getPrecisionModel().compareTo(s.getPrecisionModel())>=0?this.setComputationPrecision(u.getPrecisionModel()):this.setComputationPrecision(s.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new ff(0,u,y),this._arg[1]=new ff(1,s,y)}};np.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()};np.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)};np.prototype.interfaces_=function(){return[]};np.prototype.getClass=function(){return np};var dl=function(){};dl.prototype.interfaces_=function(){return[]};dl.prototype.getClass=function(){return dl};dl.map=function(){if(arguments[0]instanceof Se&&Ie(arguments[1],dl.MapOp)){for(var t=arguments[0],e=arguments[1],i=new qt,o=0;o<t.getNumGeometries();o++){var u=e.map(t.getGeometryN(o));u!==null&&i.add(u)}return t.getFactory().buildGeometry(i)}else if(Ie(arguments[0],Di)&&Ie(arguments[1],dl.MapOp)){for(var s=arguments[0],y=arguments[1],v=new qt,S=s.iterator();S.hasNext();){var L=S.next(),k=y.map(L);k!==null&&v.add(k)}return v}};dl.MapOp=function(){};var ke=function(n){function t(){var e=arguments[0],i=arguments[1];n.call(this,e,i),this._ptLocator=new ha,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new ca,this._resultPolyList=new qt,this._resultLineList=new qt,this._resultPointList=new qt,this._graph=new Qr(new Yx),this._geomFact=e.getFactory()}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.insertUniqueEdge=function(i){var o=this._edgeList.findEqualEdge(i);if(o!==null){var u=o.getLabel(),s=i.getLabel();o.isPointwiseEqual(i)||(s=new xr(i.getLabel()),s.flip());var y=o.getDepth();y.isNull()&&y.add(u),y.add(s),u.merge(s)}else this._edgeList.add(i)},t.prototype.getGraph=function(){return this._graph},t.prototype.cancelDuplicateResultEdges=function(){for(var i=this._graph.getEdgeEnds().iterator();i.hasNext();){var o=i.next(),u=o.getSym();o.isInResult()&&u.isInResult()&&(o.setInResult(!1),u.setInResult(!1))}},t.prototype.isCoveredByLA=function(i){return!!(this.isCovered(i,this._resultLineList)||this.isCovered(i,this._resultPolyList))},t.prototype.computeGeometry=function(i,o,u,s){var y=new qt;return y.addAll(i),y.addAll(o),y.addAll(u),y.isEmpty()?t.createEmptyResult(s,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(y)},t.prototype.mergeSymLabels=function(){for(var i=this._graph.getNodes().iterator();i.hasNext();){var o=i.next();o.getEdges().mergeSymLabels()}},t.prototype.isCovered=function(i,o){for(var u=this,s=o.iterator();s.hasNext();){var y=s.next(),v=u._ptLocator.locate(i,y);if(v!==dt.EXTERIOR)return!0}return!1},t.prototype.replaceCollapsedEdges=function(){for(var i=new qt,o=this._edgeList.iterator();o.hasNext();){var u=o.next();u.isCollapsed()&&(o.remove(),i.add(u.getCollapsedEdge()))}this._edgeList.addAll(i)},t.prototype.updateNodeLabelling=function(){for(var i=this._graph.getNodes().iterator();i.hasNext();){var o=i.next(),u=o.getEdges().getLabel();o.getLabel().merge(u)}},t.prototype.getResultGeometry=function(i){return this.computeOverlay(i),this._resultGeom},t.prototype.insertUniqueEdges=function(i){for(var o=this,u=i.iterator();u.hasNext();){var s=u.next();o.insertUniqueEdge(s)}},t.prototype.computeOverlay=function(i){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var o=new qt;this._arg[0].computeSplitEdges(o),this._arg[1].computeSplitEdges(o),this.insertUniqueEdges(o),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),bl.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(i),this.cancelDuplicateResultEdges();var u=new so(this._geomFact);u.add(this._graph),this._resultPolyList=u.getPolygons();var s=new za(this,this._geomFact,this._ptLocator);this._resultLineList=s.build(i);var y=new Ic(this,this._geomFact,this._ptLocator);this._resultPointList=y.build(i),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,i)},t.prototype.labelIncompleteNode=function(i,o){var u=this._ptLocator.locate(i.getCoordinate(),this._arg[o].getGeometry());i.getLabel().setLocation(o,u)},t.prototype.copyPoints=function(i){for(var o=this,u=this._arg[i].getNodeIterator();u.hasNext();){var s=u.next(),y=o._graph.addNode(s.getCoordinate());y.setLabel(i,s.getLabel().getLocation(i))}},t.prototype.findResultAreaEdges=function(i){for(var o=this._graph.getEdgeEnds().iterator();o.hasNext();){var u=o.next(),s=u.getLabel();s.isArea()&&!u.isInteriorAreaEdge()&&t.isResultOfOp(s.getLocation(0,Nt.RIGHT),s.getLocation(1,Nt.RIGHT),i)&&u.setInResult(!0)}},t.prototype.computeLabelsFromDepths=function(){for(var i=this._edgeList.iterator();i.hasNext();){var o=i.next(),u=o.getLabel(),s=o.getDepth();if(!s.isNull()){s.normalize();for(var y=0;y<2;y++)!u.isNull(y)&&u.isArea()&&!s.isNull(y)&&(s.getDelta(y)===0?u.toLine(y):(Re.isTrue(!s.isNull(y,Nt.LEFT),"depth of LEFT side has not been initialized"),u.setLocation(y,Nt.LEFT,s.getLocation(y,Nt.LEFT)),Re.isTrue(!s.isNull(y,Nt.RIGHT),"depth of RIGHT side has not been initialized"),u.setLocation(y,Nt.RIGHT,s.getLocation(y,Nt.RIGHT))))}}},t.prototype.computeLabelling=function(){for(var i=this,o=this._graph.getNodes().iterator();o.hasNext();){var u=o.next();u.getEdges().computeLabelling(i._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},t.prototype.labelIncompleteNodes=function(){for(var i=this,o=this._graph.getNodes().iterator();o.hasNext();){var u=o.next(),s=u.getLabel();u.isIsolated()&&(s.isNull(0)?i.labelIncompleteNode(u,0):i.labelIncompleteNode(u,1)),u.getEdges().updateLabelling(s)}},t.prototype.isCoveredByA=function(i){return!!this.isCovered(i,this._resultPolyList)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(np);ke.overlayOp=function(n,t,e){var i=new ke(n,t),o=i.getResultGeometry(e);return o};ke.intersection=function(n,t){if(n.isEmpty()||t.isEmpty())return ke.createEmptyResult(ke.INTERSECTION,n,t,n.getFactory());if(n.isGeometryCollection()){var e=t;return Sc.map(n,{interfaces_:function(){return[dl.MapOp]},map:function(i){return i.intersection(e)}})}return n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(t),zn.overlayOp(n,t,ke.INTERSECTION)};ke.symDifference=function(n,t){if(n.isEmpty()||t.isEmpty()){if(n.isEmpty()&&t.isEmpty())return ke.createEmptyResult(ke.SYMDIFFERENCE,n,t,n.getFactory());if(n.isEmpty())return t.copy();if(t.isEmpty())return n.copy()}return n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(t),zn.overlayOp(n,t,ke.SYMDIFFERENCE)};ke.resultDimension=function(n,t,e){var i=t.getDimension(),o=e.getDimension(),u=-1;switch(n){case ke.INTERSECTION:u=Math.min(i,o);break;case ke.UNION:u=Math.max(i,o);break;case ke.DIFFERENCE:u=i;break;case ke.SYMDIFFERENCE:u=Math.max(i,o);break}return u};ke.createEmptyResult=function(n,t,e,i){var o=null;switch(ke.resultDimension(n,t,e)){case-1:o=i.createGeometryCollection(new Array(0).fill(null));break;case 0:o=i.createPoint();break;case 1:o=i.createLineString();break;case 2:o=i.createPolygon();break}return o};ke.difference=function(n,t){return n.isEmpty()?ke.createEmptyResult(ke.DIFFERENCE,n,t,n.getFactory()):t.isEmpty()?n.copy():(n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(t),zn.overlayOp(n,t,ke.DIFFERENCE))};ke.isResultOfOp=function(){if(arguments.length===2){var n=arguments[0],t=arguments[1],e=n.getLocation(0),i=n.getLocation(1);return ke.isResultOfOp(e,i,t)}else if(arguments.length===3){var o=arguments[0],u=arguments[1],s=arguments[2];switch(o===dt.BOUNDARY&&(o=dt.INTERIOR),u===dt.BOUNDARY&&(u=dt.INTERIOR),s){case ke.INTERSECTION:return o===dt.INTERIOR&&u===dt.INTERIOR;case ke.UNION:return o===dt.INTERIOR||u===dt.INTERIOR;case ke.DIFFERENCE:return o===dt.INTERIOR&&u!==dt.INTERIOR;case ke.SYMDIFFERENCE:return o===dt.INTERIOR&&u!==dt.INTERIOR||o!==dt.INTERIOR&&u===dt.INTERIOR}return!1}};ke.INTERSECTION=1;ke.UNION=2;ke.DIFFERENCE=3;ke.SYMDIFFERENCE=4;var Mu=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new ha,this._seg=new ge;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Mu.prototype.isWithinToleranceOfBoundary=function(t){for(var e=this,i=0;i<this._linework.getNumGeometries();i++)for(var o=e._linework.getGeometryN(i),u=o.getCoordinateSequence(),s=0;s<u.size()-1;s++){u.getCoordinate(s,e._seg.p0),u.getCoordinate(s+1,e._seg.p1);var y=e._seg.distance(t);if(y<=e._boundaryDistanceTolerance)return!0}return!1};Mu.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?dt.BOUNDARY:this._ptLocator.locate(t,this._g)};Mu.prototype.extractLinework=function(t){var e=new op;t.apply(e);var i=e.getLinework(),o=He.toLineStringArray(i);return t.getFactory().createMultiLineString(o)};Mu.prototype.interfaces_=function(){return[]};Mu.prototype.getClass=function(){return Mu};var op=function(){this._linework=null,this._linework=new qt};op.prototype.getLinework=function(){return this._linework};op.prototype.filter=function(t){var e=this;if(t instanceof Ri){var i=t;this._linework.add(i.getExteriorRing());for(var o=0;o<i.getNumInteriorRing();o++)e._linework.add(i.getInteriorRingN(o))}};op.prototype.interfaces_=function(){return[Aa]};op.prototype.getClass=function(){return op};var El=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};El.prototype.extractPoints=function(t,e,i){for(var o=this,u=t.getCoordinates(),s=0;s<u.length-1;s++)o.computeOffsetPoints(u[s],u[s+1],e,i)};El.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e};El.prototype.getPoints=function(t){for(var e=this,i=new qt,o=rn.getLines(this._g),u=o.iterator();u.hasNext();){var s=u.next();e.extractPoints(s,t,i)}return i};El.prototype.computeOffsetPoints=function(t,e,i,o){var u=e.x-t.x,s=e.y-t.y,y=Math.sqrt(u*u+s*s),v=i*u/y,S=i*s/y,L=(e.x+t.x)/2,k=(e.y+t.y)/2;if(this._doLeft){var N=new ft(L-S,k+v);o.add(N)}if(this._doRight){var Q=new ft(L+S,k-v);o.add(Q)}};El.prototype.interfaces_=function(){return[]};El.prototype.getClass=function(){return El};var Eo=function n(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=n.TOLERANCE,this._testCoords=new qt;var t=arguments[0],e=arguments[1],i=arguments[2];this._boundaryDistanceTolerance=n.computeBoundaryDistanceTolerance(t,e),this._geom=[t,e,i],this._locFinder=[new Mu(this._geom[0],this._boundaryDistanceTolerance),new Mu(this._geom[1],this._boundaryDistanceTolerance),new Mu(this._geom[2],this._boundaryDistanceTolerance)]},n1={TOLERANCE:{configurable:!0}};Eo.prototype.reportResult=function(t,e,i){an.out.println("Overlay result invalid - A:"+dt.toLocationSymbol(e[0])+" B:"+dt.toLocationSymbol(e[1])+" expected:"+(i?"i":"e")+" actual:"+dt.toLocationSymbol(e[2]))};Eo.prototype.isValid=function(t){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var e=this.checkValid(t);return e};Eo.prototype.checkValid=function(){var t=this;if(arguments.length===1){for(var e=arguments[0],i=0;i<this._testCoords.size();i++){var o=t._testCoords.get(i);if(!t.checkValid(e,o))return t._invalidLocation=o,!1}return!0}else if(arguments.length===2){var u=arguments[0],s=arguments[1];return this._location[0]=this._locFinder[0].getLocation(s),this._location[1]=this._locFinder[1].getLocation(s),this._location[2]=this._locFinder[2].getLocation(s),Eo.hasLocation(this._location,dt.BOUNDARY)?!0:this.isValidResult(u,this._location)}};Eo.prototype.addTestPts=function(t){var e=new El(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))};Eo.prototype.isValidResult=function(t,e){var i=ke.isResultOfOp(e[0],e[1],t),o=e[2]===dt.INTERIOR,u=!(i^o);return u||this.reportResult(t,e,i),u};Eo.prototype.getInvalidLocation=function(){return this._invalidLocation};Eo.prototype.interfaces_=function(){return[]};Eo.prototype.getClass=function(){return Eo};Eo.hasLocation=function(t,e){for(var i=0;i<3;i++)if(t[i]===e)return!0;return!1};Eo.computeBoundaryDistanceTolerance=function(t,e){return Math.min(gi.computeSizeBasedSnapTolerance(t),gi.computeSizeBasedSnapTolerance(e))};Eo.isValid=function(t,e,i,o){var u=new Eo(t,e,o);return u.isValid(i)};n1.TOLERANCE.get=function(){return 1e-6};Object.defineProperties(Eo,n1);var mo=function n(t){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=n.extractFactory(t),this._inputGeoms=t};mo.prototype.extractElements=function(t,e){var i=this;if(t===null)return null;for(var o=0;o<t.getNumGeometries();o++){var u=t.getGeometryN(o);i._skipEmpty&&u.isEmpty()||e.add(u)}};mo.prototype.combine=function(){for(var t=this,e=new qt,i=this._inputGeoms.iterator();i.hasNext();){var o=i.next();t.extractElements(o,e)}return e.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(e)};mo.prototype.interfaces_=function(){return[]};mo.prototype.getClass=function(){return mo};mo.combine=function(){if(arguments.length===1){var t=arguments[0],e=new mo(t);return e.combine()}else if(arguments.length===2){var i=arguments[0],o=arguments[1],u=new mo(mo.createList(i,o));return u.combine()}else if(arguments.length===3){var s=arguments[0],y=arguments[1],v=arguments[2],S=new mo(mo.createList(s,y,v));return S.combine()}};mo.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()};mo.createList=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],i=new qt;return i.add(t),i.add(e),i}else if(arguments.length===3){var o=arguments[0],u=arguments[1],s=arguments[2],y=new qt;return y.add(o),y.add(u),y.add(s),y}};var Si=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,this._inputPolys===null&&(this._inputPolys=new qt)},o1={STRTREE_NODE_CAPACITY:{configurable:!0}};Si.prototype.reduceToGeometries=function(t){for(var e=this,i=new qt,o=t.iterator();o.hasNext();){var u=o.next(),s=null;Ie(u,oa)?s=e.unionTree(u):u instanceof Se&&(s=u),i.add(s)}return i};Si.prototype.extractByEnvelope=function(t,e,i){for(var o=new qt,u=0;u<e.getNumGeometries();u++){var s=e.getGeometryN(u);s.getEnvelopeInternal().intersects(t)?o.add(s):i.add(s)}return this._geomFactory.buildGeometry(o)};Si.prototype.unionOptimized=function(t,e){var i=t.getEnvelopeInternal(),o=e.getEnvelopeInternal();if(!i.intersects(o)){var u=mo.combine(t,e);return u}if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var s=i.intersection(o);return this.unionUsingEnvelopeIntersection(t,e,s)};Si.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new Gx(Si.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var i=e.next();t.insert(i.getEnvelopeInternal(),i)}this._inputPolys=null;var o=t.itemsTree(),u=this.unionTree(o);return u};Si.prototype.binaryUnion=function(){if(arguments.length===1){var t=arguments[0];return this.binaryUnion(t,0,t.size())}else if(arguments.length===3){var e=arguments[0],i=arguments[1],o=arguments[2];if(o-i<=1){var u=Si.getGeometry(e,i);return this.unionSafe(u,null)}else{if(o-i===2)return this.unionSafe(Si.getGeometry(e,i),Si.getGeometry(e,i+1));var s=Math.trunc((o+i)/2),y=this.binaryUnion(e,i,s),v=this.binaryUnion(e,s,o);return this.unionSafe(y,v)}}};Si.prototype.repeatedUnion=function(t){for(var e=null,i=t.iterator();i.hasNext();){var o=i.next();e===null?e=o.copy():e=e.union(o)}return e};Si.prototype.unionSafe=function(t,e){return t===null&&e===null?null:t===null?e.copy():e===null?t.copy():this.unionOptimized(t,e)};Si.prototype.unionActual=function(t,e){return Si.restrictToPolygons(t.union(e))};Si.prototype.unionTree=function(t){var e=this.reduceToGeometries(t),i=this.binaryUnion(e);return i};Si.prototype.unionUsingEnvelopeIntersection=function(t,e,i){var o=new qt,u=this.extractByEnvelope(i,t,o),s=this.extractByEnvelope(i,e,o),y=this.unionActual(u,s);o.add(y);var v=mo.combine(o);return v};Si.prototype.bufferUnion=function(){if(arguments.length===1){var t=arguments[0],e=t.get(0).getFactory(),i=e.buildGeometry(t),o=i.buffer(0);return o}else if(arguments.length===2){var u=arguments[0],s=arguments[1],y=u.getFactory(),v=y.createGeometryCollection([u,s]),S=v.buffer(0);return S}};Si.prototype.interfaces_=function(){return[]};Si.prototype.getClass=function(){return Si};Si.restrictToPolygons=function(t){if(Ie(t,Au))return t;var e=Us.getPolygons(t);return e.size()===1?e.get(0):t.getFactory().createMultiPolygon(He.toPolygonArray(e))};Si.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)};Si.union=function(t){var e=new Si(t);return e.union()};o1.STRTREE_NODE_CAPACITY.get=function(){return 4};Object.defineProperties(Si,o1);var Og=function(){};Og.prototype.interfaces_=function(){return[]};Og.prototype.getClass=function(){return Og};Og.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return ke.createEmptyResult(ke.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),zn.overlayOp(t,e,ke.UNION)};function Il(){return new kg}function kg(){this.reset()}kg.prototype={constructor:kg,reset:function(){this.s=this.t=0},add:function(n){g0(fg,n,this.t),g0(this,fg.s,this.s),this.s?this.t+=fg.t:this.s=fg.t},valueOf:function(){return this.s}};var fg=new kg;function g0(n,t,e){var i=n.s=t+e,o=i-t,u=i-o;n.t=t-u+(e-o)}var ii=1e-6,Mr=Math.PI,Vs=Mr/2,y0=Mr/4,Ys=Mr*2,ll=180/Mr,Sa=Mr/180,On=Math.abs,lI=Math.atan,ap=Math.atan2,Oi=Math.cos,ki=Math.sin,dp=Math.sqrt;function a1(n){return n>1?0:n<-1?Mr:Math.acos(n)}function Lc(n){return n>1?Vs:n<-1?-Vs:Math.asin(n)}function vf(){}function Ng(n,t){n&&_0.hasOwnProperty(n.type)&&_0[n.type](n,t)}var m0={Feature:function(n,t){Ng(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,i=-1,o=e.length;++i<o;)Ng(e[i].geometry,t)}},_0={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,i=-1,o=e.length;++i<o;)n=e[i],t.point(n[0],n[1],n[2])},LineString:function(n,t){Im(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,i=-1,o=e.length;++i<o;)Im(e[i],t,0)},Polygon:function(n,t){v0(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,i=-1,o=e.length;++i<o;)v0(e[i],t)},GeometryCollection:function(n,t){for(var e=n.geometries,i=-1,o=e.length;++i<o;)Ng(e[i],t)}};function Im(n,t,e){var i=-1,o=n.length-e,u;for(t.lineStart();++i<o;)u=n[i],t.point(u[0],u[1],u[2]);t.lineEnd()}function v0(n,t){var e=-1,i=n.length;for(t.polygonStart();++e<i;)Im(n[e],t,1);t.polygonEnd()}function cI(n,t){n&&m0.hasOwnProperty(n.type)?m0[n.type](n,t):Ng(n,t)}Il();Il();function Cm(n){return[ap(n[1],n[0]),Lc(n[2])]}function sp(n){var t=n[0],e=n[1],i=Oi(e);return[i*Oi(t),i*ki(t),ki(e)]}function dg(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function Rg(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function pm(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function gg(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Lm(n){var t=dp(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}Il();function s1(n,t){function e(i,o){return i=n(i,o),t(i[0],i[1])}return n.invert&&t.invert&&(e.invert=function(i,o){return i=t.invert(i,o),i&&n.invert(i[0],i[1])}),e}function Pm(n,t){return[n>Mr?n-Ys:n<-Mr?n+Ys:n,t]}Pm.invert=Pm;function hI(n,t,e){return(n%=Ys)?t||e?s1(b0(n),w0(t,e)):b0(n):t||e?w0(t,e):Pm}function x0(n){return function(t,e){return t+=n,[t>Mr?t-Ys:t<-Mr?t+Ys:t,e]}}function b0(n){var t=x0(n);return t.invert=x0(-n),t}function w0(n,t){var e=Oi(n),i=ki(n),o=Oi(t),u=ki(t);function s(y,v){var S=Oi(v),L=Oi(y)*S,k=ki(y)*S,N=ki(v),Q=N*e+L*i;return[ap(k*o-Q*u,L*e-N*i),Lc(Q*o+k*u)]}return s.invert=function(y,v){var S=Oi(v),L=Oi(y)*S,k=ki(y)*S,N=ki(v),Q=N*o-k*u;return[ap(k*o+N*u,L*e+Q*i),Lc(Q*e-L*i)]},s}function pI(n,t,e,i,o,u){if(!!e){var s=Oi(t),y=ki(t),v=i*e;o==null?(o=t+i*Ys,u=t-v/2):(o=E0(s,o),u=E0(s,u),(i>0?o<u:o>u)&&(o+=i*Ys));for(var S,L=o;i>0?L>u:L<u;L-=v)S=Cm([s,-y*Oi(L),-y*ki(L)]),n.point(S[0],S[1])}}function E0(n,t){t=sp(t),t[0]-=n,Lm(t);var e=a1(-t[1]);return((-t[2]<0?-e:e)+Ys-ii)%Ys}function u1(){var n=[],t;return{point:function(e,i){t.push([e,i])},lineStart:function(){n.push(t=[])},lineEnd:vf,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function fI(n,t,e,i,o,u){var s=n[0],y=n[1],v=t[0],S=t[1],L=0,k=1,N=v-s,Q=S-y,tt;if(tt=e-s,!(!N&&tt>0)){if(tt/=N,N<0){if(tt<L)return;tt<k&&(k=tt)}else if(N>0){if(tt>k)return;tt>L&&(L=tt)}if(tt=o-s,!(!N&&tt<0)){if(tt/=N,N<0){if(tt>k)return;tt>L&&(L=tt)}else if(N>0){if(tt<L)return;tt<k&&(k=tt)}if(tt=i-y,!(!Q&&tt>0)){if(tt/=Q,Q<0){if(tt<L)return;tt<k&&(k=tt)}else if(Q>0){if(tt>k)return;tt>L&&(L=tt)}if(tt=u-y,!(!Q&&tt<0)){if(tt/=Q,Q<0){if(tt>k)return;tt>L&&(L=tt)}else if(Q>0){if(tt<L)return;tt<k&&(k=tt)}return L>0&&(n[0]=s+L*N,n[1]=y+L*Q),k<1&&(t[0]=s+k*N,t[1]=y+k*Q),!0}}}}}function Eg(n,t){return On(n[0]-t[0])<ii&&On(n[1]-t[1])<ii}function yg(n,t,e,i){this.x=n,this.z=t,this.o=e,this.e=i,this.v=!1,this.n=this.p=null}function l1(n,t,e,i,o){var u=[],s=[],y,v;if(n.forEach(function(tt){if(!((xt=tt.length-1)<=0)){var xt,mt=tt[0],Ct=tt[xt],ut;if(Eg(mt,Ct)){for(o.lineStart(),y=0;y<xt;++y)o.point((mt=tt[y])[0],mt[1]);o.lineEnd();return}u.push(ut=new yg(mt,tt,null,!0)),s.push(ut.o=new yg(mt,null,ut,!1)),u.push(ut=new yg(Ct,tt,null,!1)),s.push(ut.o=new yg(Ct,null,ut,!0))}}),!!u.length){for(s.sort(t),S0(u),S0(s),y=0,v=s.length;y<v;++y)s[y].e=e=!e;for(var S=u[0],L,k;;){for(var N=S,Q=!0;N.v;)if((N=N.n)===S)return;L=N.z,o.lineStart();do{if(N.v=N.o.v=!0,N.e){if(Q)for(y=0,v=L.length;y<v;++y)o.point((k=L[y])[0],k[1]);else i(N.x,N.n.x,1,o);N=N.n}else{if(Q)for(L=N.p.z,y=L.length-1;y>=0;--y)o.point((k=L[y])[0],k[1]);else i(N.x,N.p.x,-1,o);N=N.p}N=N.o,L=N.z,Q=!Q}while(!N.v);o.lineEnd()}}}function S0(n){if(!!(t=n.length)){for(var t,e=0,i=n[0],o;++e<t;)i.n=o=n[e],o.p=i,i=o;i.n=o=n[0],o.p=i}}function c1(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function dI(n){return n.length===1&&(n=gI(n)),{left:function(t,e,i,o){for(i==null&&(i=0),o==null&&(o=t.length);i<o;){var u=i+o>>>1;n(t[u],e)<0?i=u+1:o=u}return i},right:function(t,e,i,o){for(i==null&&(i=0),o==null&&(o=t.length);i<o;){var u=i+o>>>1;n(t[u],e)>0?o=u:i=u+1}return i}}}function gI(n){return function(t,e){return c1(n(t),e)}}dI(c1);function h1(n){for(var t=n.length,e,i=-1,o=0,u,s;++i<t;)o+=n[i].length;for(u=new Array(o);--t>=0;)for(s=n[t],e=s.length;--e>=0;)u[--o]=s[e];return u}var xf=1e9,mg=-xf;function yI(n,t,e,i){function o(S,L){return n<=S&&S<=e&&t<=L&&L<=i}function u(S,L,k,N){var Q=0,tt=0;if(S==null||(Q=s(S,k))!==(tt=s(L,k))||v(S,L)<0^k>0)do N.point(Q===0||Q===3?n:e,Q>1?i:t);while((Q=(Q+k+4)%4)!==tt);else N.point(L[0],L[1])}function s(S,L){return On(S[0]-n)<ii?L>0?0:3:On(S[0]-e)<ii?L>0?2:1:On(S[1]-t)<ii?L>0?1:0:L>0?3:2}function y(S,L){return v(S.x,L.x)}function v(S,L){var k=s(S,1),N=s(L,1);return k!==N?k-N:k===0?L[1]-S[1]:k===1?S[0]-L[0]:k===2?S[1]-L[1]:L[0]-S[0]}return function(S){var L=S,k=u1(),N,Q,tt,xt,mt,Ct,ut,Pt,Ft,ie,ne,ae={point:de,lineStart:er,lineEnd:Le,polygonStart:Be,polygonEnd:Ce};function de(Fe,ye){o(Fe,ye)&&L.point(Fe,ye)}function $t(){for(var Fe=0,ye=0,Ar=Q.length;ye<Ar;++ye)for(var mr=Q[ye],or=1,cn=mr.length,$r=mr[0],Li,ar,wr=$r[0],Dr=$r[1];or<cn;++or)Li=wr,ar=Dr,$r=mr[or],wr=$r[0],Dr=$r[1],ar<=i?Dr>i&&(wr-Li)*(i-ar)>(Dr-ar)*(n-Li)&&++Fe:Dr<=i&&(wr-Li)*(i-ar)<(Dr-ar)*(n-Li)&&--Fe;return Fe}function Be(){L=k,N=[],Q=[],ne=!0}function Ce(){var Fe=$t(),ye=ne&&Fe,Ar=(N=h1(N)).length;(ye||Ar)&&(S.polygonStart(),ye&&(S.lineStart(),u(null,null,1,S),S.lineEnd()),Ar&&l1(N,y,Fe,u,S),S.polygonEnd()),L=S,N=Q=tt=null}function er(){ae.point=Ut,Q&&Q.push(tt=[]),ie=!0,Ft=!1,ut=Pt=NaN}function Le(){N&&(Ut(xt,mt),Ct&&Ft&&k.rejoin(),N.push(k.result())),ae.point=de,Ft&&L.lineEnd()}function Ut(Fe,ye){var Ar=o(Fe,ye);if(Q&&tt.push([Fe,ye]),ie)xt=Fe,mt=ye,Ct=Ar,ie=!1,Ar&&(L.lineStart(),L.point(Fe,ye));else if(Ar&&Ft)L.point(Fe,ye);else{var mr=[ut=Math.max(mg,Math.min(xf,ut)),Pt=Math.max(mg,Math.min(xf,Pt))],or=[Fe=Math.max(mg,Math.min(xf,Fe)),ye=Math.max(mg,Math.min(xf,ye))];fI(mr,or,n,t,e,i)?(Ft||(L.lineStart(),L.point(mr[0],mr[1])),L.point(or[0],or[1]),Ar||L.lineEnd(),ne=!1):Ar&&(L.lineStart(),L.point(Fe,ye),ne=!1)}ut=Fe,Pt=ye,Ft=Ar}return ae}}var fm=Il();function mI(n,t){var e=t[0],i=t[1],o=[ki(e),-Oi(e),0],u=0,s=0;fm.reset();for(var y=0,v=n.length;y<v;++y)if(!!(L=(S=n[y]).length))for(var S,L,k=S[L-1],N=k[0],Q=k[1]/2+y0,tt=ki(Q),xt=Oi(Q),mt=0;mt<L;++mt,N=ut,tt=Ft,xt=ie,k=Ct){var Ct=S[mt],ut=Ct[0],Pt=Ct[1]/2+y0,Ft=ki(Pt),ie=Oi(Pt),ne=ut-N,ae=ne>=0?1:-1,de=ae*ne,$t=de>Mr,Be=tt*Ft;if(fm.add(ap(Be*ae*ki(de),xt*ie+Be*Oi(de))),u+=$t?ne+ae*Ys:ne,$t^N>=e^ut>=e){var Ce=Rg(sp(k),sp(Ct));Lm(Ce);var er=Rg(o,Ce);Lm(er);var Le=($t^ne>=0?-1:1)*Lc(er[2]);(i>Le||i===Le&&(Ce[0]||Ce[1]))&&(s+=$t^ne>=0?1:-1)}}return(u<-ii||u<ii&&fm<-ii)^s&1}Il();function I0(n){return n}Il();Il();var up=1/0,Fg=up,zf=-up,zg=zf,C0={point:_I,lineStart:vf,lineEnd:vf,polygonStart:vf,polygonEnd:vf,result:function(){var n=[[up,Fg],[zf,zg]];return zf=zg=-(Fg=up=1/0),n}};function _I(n,t){n<up&&(up=n),n>zf&&(zf=n),t<Fg&&(Fg=t),t>zg&&(zg=t)}Il();function p1(n,t,e,i){return function(o,u){var s=t(u),y=o.invert(i[0],i[1]),v=u1(),S=t(v),L=!1,k,N,Q,tt={point:xt,lineStart:Ct,lineEnd:ut,polygonStart:function(){tt.point=Pt,tt.lineStart=Ft,tt.lineEnd=ie,N=[],k=[]},polygonEnd:function(){tt.point=xt,tt.lineStart=Ct,tt.lineEnd=ut,N=h1(N);var ne=mI(k,y);N.length?(L||(u.polygonStart(),L=!0),l1(N,xI,ne,e,u)):ne&&(L||(u.polygonStart(),L=!0),u.lineStart(),e(null,null,1,u),u.lineEnd()),L&&(u.polygonEnd(),L=!1),N=k=null},sphere:function(){u.polygonStart(),u.lineStart(),e(null,null,1,u),u.lineEnd(),u.polygonEnd()}};function xt(ne,ae){var de=o(ne,ae);n(ne=de[0],ae=de[1])&&u.point(ne,ae)}function mt(ne,ae){var de=o(ne,ae);s.point(de[0],de[1])}function Ct(){tt.point=mt,s.lineStart()}function ut(){tt.point=xt,s.lineEnd()}function Pt(ne,ae){Q.push([ne,ae]);var de=o(ne,ae);S.point(de[0],de[1])}function Ft(){S.lineStart(),Q=[]}function ie(){Pt(Q[0][0],Q[0][1]),S.lineEnd();var ne=S.clean(),ae=v.result(),de,$t=ae.length,Be,Ce,er;if(Q.pop(),k.push(Q),Q=null,!!$t){if(ne&1){if(Ce=ae[0],(Be=Ce.length-1)>0){for(L||(u.polygonStart(),L=!0),u.lineStart(),de=0;de<Be;++de)u.point((er=Ce[de])[0],er[1]);u.lineEnd()}return}$t>1&&ne&2&&ae.push(ae.pop().concat(ae.shift())),N.push(ae.filter(vI))}}return tt}}function vI(n){return n.length>1}function xI(n,t){return((n=n.x)[0]<0?n[1]-Vs-ii:Vs-n[1])-((t=t.x)[0]<0?t[1]-Vs-ii:Vs-t[1])}var L0=p1(function(){return!0},bI,EI,[-Mr,-Vs]);function bI(n){var t=NaN,e=NaN,i=NaN,o;return{lineStart:function(){n.lineStart(),o=1},point:function(u,s){var y=u>0?Mr:-Mr,v=On(u-t);On(v-Mr)<ii?(n.point(t,e=(e+s)/2>0?Vs:-Vs),n.point(i,e),n.lineEnd(),n.lineStart(),n.point(y,e),n.point(u,e),o=0):i!==y&&v>=Mr&&(On(t-i)<ii&&(t-=i*ii),On(u-y)<ii&&(u-=y*ii),e=wI(t,e,u,s),n.point(i,e),n.lineEnd(),n.lineStart(),n.point(y,e),o=0),n.point(t=u,e=s),i=y},lineEnd:function(){n.lineEnd(),t=e=NaN},clean:function(){return 2-o}}}function wI(n,t,e,i){var o,u,s=ki(n-e);return On(s)>ii?lI((ki(t)*(u=Oi(i))*ki(e)-ki(i)*(o=Oi(t))*ki(n))/(o*u*s)):(t+i)/2}function EI(n,t,e,i){var o;if(n==null)o=e*Vs,i.point(-Mr,o),i.point(0,o),i.point(Mr,o),i.point(Mr,0),i.point(Mr,-o),i.point(0,-o),i.point(-Mr,-o),i.point(-Mr,0),i.point(-Mr,o);else if(On(n[0]-t[0])>ii){var u=n[0]<t[0]?Mr:-Mr;o=e*u/2,i.point(-u,o),i.point(0,o),i.point(u,o)}else i.point(t[0],t[1])}function SI(n,t){var e=Oi(n),i=e>0,o=On(e)>ii;function u(L,k,N,Q){pI(Q,n,t,N,L,k)}function s(L,k){return Oi(L)*Oi(k)>e}function y(L){var k,N,Q,tt,xt;return{lineStart:function(){tt=Q=!1,xt=1},point:function(mt,Ct){var ut=[mt,Ct],Pt,Ft=s(mt,Ct),ie=i?Ft?0:S(mt,Ct):Ft?S(mt+(mt<0?Mr:-Mr),Ct):0;if(!k&&(tt=Q=Ft)&&L.lineStart(),Ft!==Q&&(Pt=v(k,ut),(!Pt||Eg(k,Pt)||Eg(ut,Pt))&&(ut[0]+=ii,ut[1]+=ii,Ft=s(ut[0],ut[1]))),Ft!==Q)xt=0,Ft?(L.lineStart(),Pt=v(ut,k),L.point(Pt[0],Pt[1])):(Pt=v(k,ut),L.point(Pt[0],Pt[1]),L.lineEnd()),k=Pt;else if(o&&k&&i^Ft){var ne;!(ie&N)&&(ne=v(ut,k,!0))&&(xt=0,i?(L.lineStart(),L.point(ne[0][0],ne[0][1]),L.point(ne[1][0],ne[1][1]),L.lineEnd()):(L.point(ne[1][0],ne[1][1]),L.lineEnd(),L.lineStart(),L.point(ne[0][0],ne[0][1])))}Ft&&(!k||!Eg(k,ut))&&L.point(ut[0],ut[1]),k=ut,Q=Ft,N=ie},lineEnd:function(){Q&&L.lineEnd(),k=null},clean:function(){return xt|(tt&&Q)<<1}}}function v(L,k,N){var Q=sp(L),tt=sp(k),xt=[1,0,0],mt=Rg(Q,tt),Ct=dg(mt,mt),ut=mt[0],Pt=Ct-ut*ut;if(!Pt)return!N&&L;var Ft=e*Ct/Pt,ie=-e*ut/Pt,ne=Rg(xt,mt),ae=gg(xt,Ft),de=gg(mt,ie);pm(ae,de);var $t=ne,Be=dg(ae,$t),Ce=dg($t,$t),er=Be*Be-Ce*(dg(ae,ae)-1);if(!(er<0)){var Le=dp(er),Ut=gg($t,(-Be-Le)/Ce);if(pm(Ut,ae),Ut=Cm(Ut),!N)return Ut;var Fe=L[0],ye=k[0],Ar=L[1],mr=k[1],or;ye<Fe&&(or=Fe,Fe=ye,ye=or);var cn=ye-Fe,$r=On(cn-Mr)<ii,Li=$r||cn<ii;if(!$r&&mr<Ar&&(or=Ar,Ar=mr,mr=or),Li?$r?Ar+mr>0^Ut[1]<(On(Ut[0]-Fe)<ii?Ar:mr):Ar<=Ut[1]&&Ut[1]<=mr:cn>Mr^(Fe<=Ut[0]&&Ut[0]<=ye)){var ar=gg($t,(-Be+Le)/Ce);return pm(ar,ae),[Ut,Cm(ar)]}}}function S(L,k){var N=i?n:Mr-n,Q=0;return L<-N?Q|=1:L>N&&(Q|=2),k<-N?Q|=4:k>N&&(Q|=8),Q}return p1(s,y,u,i?[0,-n]:[-Mr,n-Mr])}function f1(n){return function(t){var e=new Tm;for(var i in n)e[i]=n[i];return e.stream=t,e}}function Tm(){}Tm.prototype={constructor:Tm,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function d1(n,t,e){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],u=n.clipExtent&&n.clipExtent();n.scale(150).translate([0,0]),u!=null&&n.clipExtent(null),cI(e,n.stream(C0));var s=C0.result(),y=Math.min(i/(s[1][0]-s[0][0]),o/(s[1][1]-s[0][1])),v=+t[0][0]+(i-y*(s[1][0]+s[0][0]))/2,S=+t[0][1]+(o-y*(s[1][1]+s[0][1]))/2;return u!=null&&n.clipExtent(u),n.scale(y*150).translate([v,S])}function II(n,t,e){return d1(n,[[0,0],t],e)}var P0=16,CI=Oi(30*Sa);function T0(n,t){return+t?PI(n,t):LI(n)}function LI(n){return f1({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}})}function PI(n,t){function e(i,o,u,s,y,v,S,L,k,N,Q,tt,xt,mt){var Ct=S-i,ut=L-o,Pt=Ct*Ct+ut*ut;if(Pt>4*t&&xt--){var Ft=s+N,ie=y+Q,ne=v+tt,ae=dp(Ft*Ft+ie*ie+ne*ne),de=Lc(ne/=ae),$t=On(On(ne)-1)<ii||On(u-k)<ii?(u+k)/2:ap(ie,Ft),Be=n($t,de),Ce=Be[0],er=Be[1],Le=Ce-i,Ut=er-o,Fe=ut*Le-Ct*Ut;(Fe*Fe/Pt>t||On((Ct*Le+ut*Ut)/Pt-.5)>.3||s*N+y*Q+v*tt<CI)&&(e(i,o,u,s,y,v,Ce,er,$t,Ft/=ae,ie/=ae,ne,xt,mt),mt.point(Ce,er),e(Ce,er,$t,Ft,ie,ne,S,L,k,N,Q,tt,xt,mt))}}return function(i){var o,u,s,y,v,S,L,k,N,Q,tt,xt,mt={point:Ct,lineStart:ut,lineEnd:Ft,polygonStart:function(){i.polygonStart(),mt.lineStart=ie},polygonEnd:function(){i.polygonEnd(),mt.lineStart=ut}};function Ct(de,$t){de=n(de,$t),i.point(de[0],de[1])}function ut(){k=NaN,mt.point=Pt,i.lineStart()}function Pt(de,$t){var Be=sp([de,$t]),Ce=n(de,$t);e(k,N,L,Q,tt,xt,k=Ce[0],N=Ce[1],L=de,Q=Be[0],tt=Be[1],xt=Be[2],P0,i),i.point(k,N)}function Ft(){mt.point=Ct,i.lineEnd()}function ie(){ut(),mt.point=ne,mt.lineEnd=ae}function ne(de,$t){Pt(o=de,$t),u=k,s=N,y=Q,v=tt,S=xt,mt.point=Pt}function ae(){e(k,N,L,Q,tt,xt,u,s,o,y,v,S,P0,i),mt.lineEnd=Ft,Ft()}return mt}}var TI=f1({point:function(n,t){this.stream.point(n*Sa,t*Sa)}});function MI(n){return AI(function(){return n})()}function AI(n){var t,e=150,i=480,o=250,u,s,y=0,v=0,S=0,L=0,k=0,N,Q,tt=null,xt=L0,mt=null,Ct,ut,Pt,Ft=I0,ie=.5,ne=T0(Ce,ie),ae,de;function $t(Ut){return Ut=Q(Ut[0]*Sa,Ut[1]*Sa),[Ut[0]*e+u,s-Ut[1]*e]}function Be(Ut){return Ut=Q.invert((Ut[0]-u)/e,(s-Ut[1])/e),Ut&&[Ut[0]*ll,Ut[1]*ll]}function Ce(Ut,Fe){return Ut=t(Ut,Fe),[Ut[0]*e+u,s-Ut[1]*e]}$t.stream=function(Ut){return ae&&de===Ut?ae:ae=TI(xt(N,ne(Ft(de=Ut))))},$t.clipAngle=function(Ut){return arguments.length?(xt=+Ut?SI(tt=Ut*Sa,6*Sa):(tt=null,L0),Le()):tt*ll},$t.clipExtent=function(Ut){return arguments.length?(Ft=Ut==null?(mt=Ct=ut=Pt=null,I0):yI(mt=+Ut[0][0],Ct=+Ut[0][1],ut=+Ut[1][0],Pt=+Ut[1][1]),Le()):mt==null?null:[[mt,Ct],[ut,Pt]]},$t.scale=function(Ut){return arguments.length?(e=+Ut,er()):e},$t.translate=function(Ut){return arguments.length?(i=+Ut[0],o=+Ut[1],er()):[i,o]},$t.center=function(Ut){return arguments.length?(y=Ut[0]%360*Sa,v=Ut[1]%360*Sa,er()):[y*ll,v*ll]},$t.rotate=function(Ut){return arguments.length?(S=Ut[0]%360*Sa,L=Ut[1]%360*Sa,k=Ut.length>2?Ut[2]%360*Sa:0,er()):[S*ll,L*ll,k*ll]},$t.precision=function(Ut){return arguments.length?(ne=T0(Ce,ie=Ut*Ut),Le()):dp(ie)},$t.fitExtent=function(Ut,Fe){return d1($t,Ut,Fe)},$t.fitSize=function(Ut,Fe){return II($t,Ut,Fe)};function er(){Q=s1(N=hI(S,L,k),t);var Ut=t(y,v);return u=i-Ut[0]*e,s=o+Ut[1]*e,Le()}function Le(){return ae=de=null,$t}return function(){return t=n.apply(this,arguments),$t.invert=t.invert&&Be,er()}}function g1(n){return function(t,e){var i=Oi(t),o=Oi(e),u=n(i*o);return[u*o*ki(t),u*ki(e)]}}function y1(n){return function(t,e){var i=dp(t*t+e*e),o=n(i),u=ki(o),s=Oi(o);return[ap(t*u,i*s),Lc(i&&e*u/i)]}}var DI=g1(function(n){return dp(2/(1+n))});DI.invert=y1(function(n){return 2*Lc(n/2)});var m1=g1(function(n){return(n=a1(n))&&n/ki(n)});m1.invert=y1(function(n){return n});function OI(){return MI(m1).scale(79.4188).clipAngle(180-.001)}function M0(n,t){return[n,t]}M0.invert=M0;function kI(n,t,e){e=e||{};var i=e.units||"kilometers",o=e.steps||8;if(!n)throw new Error("geojson is required");if(typeof e!="object")throw new Error("options must be an object");if(typeof o!="number")throw new Error("steps must be an number");if(t===void 0)throw new Error("radius is required");if(o<=0)throw new Error("steps must be greater than 0");var u=[];switch(n.type){case"GeometryCollection":return qg(n,function(s){var y=Sg(s,t,i,o);y&&u.push(y)}),Ir(u);case"FeatureCollection":return Cg(n,function(s){var y=Sg(s,t,i,o);y&&Cg(y,function(v){v&&u.push(v)})}),Ir(u)}return Sg(n,t,i,o)}function Sg(n,t,e,i){var o=n.properties||{},u=n.type==="Feature"?n.geometry:n;if(u.type==="GeometryCollection"){var s=[];return qg(n,function(xt){var mt=Sg(xt,t,e,i);mt&&s.push(mt)}),Ir(s)}var y=NI(u),v={type:u.type,coordinates:v1(u.coordinates,y)},S=new Ym,L=S.read(v),k=Am(Dm(t,e),"meters"),N=nn.bufferOp(L,k,i),Q=new qx;if(N=Q.write(N),!_1(N.coordinates)){var tt={type:N.type,coordinates:x1(N.coordinates,y)};return qs(tt,o)}}function _1(n){return Array.isArray(n[0])?_1(n[0]):isNaN(n[0])}function v1(n,t){return typeof n[0]!="object"?t(n):n.map(function(e){return v1(e,t)})}function x1(n,t){return typeof n[0]!="object"?t.invert(n):n.map(function(e){return x1(e,t)})}function NI(n){var t=rx(n).geometry.coordinates,e=[-t[0],-t[1]];return OI().rotate(e).scale(no)}let mi=(n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce((t,e)=>(e&=63,e<36?t+=e.toString(36):e<62?t+=(e-26).toString(36).toUpperCase():e>62?t+="-":t+="_",t),"");var Mm=function(n,t){return Mm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])},Mm(n,t)};function br(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}Mm(n,t),n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var cl,nt=function(){return nt=Object.assign||function(n){for(var t,e=1,i=arguments.length;e<i;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},nt.apply(this,arguments)};function Yt(n,t,e){if(e||arguments.length===2)for(var i,o=0,u=t.length;o<u;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return n.concat(i||Array.prototype.slice.call(t))}var RI="[object Array]",FI="[object Function]",zI="[object Map]",BI="[object Set]",VI="[object Date]",UI="[object RegExp]",qI=((cl={})["[object Object]"]=function(n,t){return Object.keys(t).forEach(function(e){return n[e]=hl(t[e])}),n},cl[RI]=function(n,t){return t.forEach(function(e){return n.push(hl(e))}),n},cl[zI]=function(n,t){return t.forEach(function(e,i){return n.set(i,hl(e))}),n},cl[BI]=function(n,t){return t.forEach(function(e){return n.add(hl(e))}),n},cl[FI]=function(n,t){return n=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return t.call.apply(t,Yt([this],e,!1))},n},cl[VI]=function(n,t){return n=new Date(t),n},cl[UI]=function(n,t){return n=new RegExp(t.source,t.flags),n},cl),dm=new WeakMap;function hl(n){var t;if(!(n instanceof Object))return n;if(dm.has(n))return dm.get(n);var e=function(i){var o=i.constructor;return new o}(n);return dm.set(n,e),e=((t=qI[function(i){return Object.prototype.toString.call(i)}(n)])!==null&&t!==void 0?t:function(){return n})(e,n)}function vi(n,t){n.forEach(function(e){t[e]&&(t[e]=t[e].bind(t))})}var i_={"circle-color":"#fff","circle-radius":4,"circle-stroke-width":1,"circle-stroke-color":"#44cef6"},ay={"line-width":2,"line-color":"#44cef6","line-opacity":.5,"line-dasharray":[5,3]},n_={"fill-color":"#44cef6","fill-opacity":.2},A0=["default","crosshair","pointer","move","e-resize","ne-resize","nw-resize","n-resize","se-resize","sw-resize","s-resize","w-resize","text","wait","help"],Ii=function(){function n(t){var e;this._id=(e=t.id)!==null&&e!==void 0?e:mi(),this._type=t.type,this._layerId="".concat(this._type,"-").concat(this._id),this._data=t.data,this._paint=t.paint,this._layout=t.layout,this._layerCursor=t.layerCursor&&A0.includes(t.layerCursor)?t.layerCursor:void 0,this._mapCursor=t.mapCursor&&A0.includes(t.mapCursor)?t.mapCursor:void 0,vi(["_onMouseEnter","_onMouseLeave","_onData"],this)}return Object.defineProperty(n.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),n.prototype.addTo=function(t){return t===this._map||(this.remove(),this._map=t,this._addLayerAndSource(),this.on("mouseenter",this._onMouseEnter),this.on("mouseleave",this._onMouseLeave),this._map.on("data",this._onData)),this},n.prototype.remove=function(){return this._map&&(this._removeLayerAndSource(),this.off("mouseenter",this._onMouseEnter),this.off("mouseleave",this._onMouseLeave),this._map.off("data",this._onData),this._map=void 0),this},n.prototype.setData=function(t){if(this._data=t,this._map){var e=this._map.getSource(this._layerId);e==null||e.setData(t)}return this},n.prototype.on=function(t,e){var i;return(i=this._map)===null||i===void 0||i.on(t,this._layerId,e),this},n.prototype.off=function(t,e){var i;return(i=this._map)===null||i===void 0||i.off(t,this._layerId,e),this},n.prototype.setStyle=function(t){var e=this,i=t.paint,o=t.layout;return i&&(this._paint=nt(nt({},this._paint),i),this._map&&Object.keys(i).forEach(function(u){e._map.setPaintProperty(e._layerId,u,i[u])})),o&&(this._layout=nt(nt({},this._layout),o),this._map&&Object.keys(o).forEach(function(u){e._map.setLayoutProperty(e._layerId,u,o[u])})),this},n.prototype.querySourceFeature=function(t){var e;return(e=this._map)===null||e===void 0?void 0:e.querySourceFeatures(this._layerId,nt(nt({},t||{}),{sourceLayer:this._layerId}))},n.prototype.queryFeatureFormData=function(t,e){var i,o=void 0;return this._data?this._data.type==="FeatureCollection"?this._data.features.find(function(u){var s;return((s=u.properties)===null||s===void 0?void 0:s[t])===e}):(this._data.type==="Feature"&&((i=this._data.properties)===null||i===void 0?void 0:i[t])===e&&(o=$e(this._data)),o):o},n.prototype.getSource=function(){var t;return(t=this._map)===null||t===void 0?void 0:t.getSource(this._layerId)},n.prototype._addLayerAndSource=function(){var t;this._map&&(this._map.getLayer(this._layerId)||this._map.addLayer({id:this._layerId,type:this._type,source:{type:"geojson",data:(t=this._data)!==null&&t!==void 0?t:Ir([])},layout:this._layout||{},paint:this._paint||{}}))},n.prototype._onMouseEnter=function(t){this._layerCursor&&(t.target.getCanvas().style.cursor=this._layerCursor)},n.prototype._onMouseLeave=function(t){var e;this._layerCursor&&(t.target.getCanvas().style.cursor=(e=this._mapCursor)!==null&&e!==void 0?e:"")},n.prototype._onData=function(t){var e=this;t.dataType==="style"&&setTimeout(function(){e._addLayerAndSource()},10)},n.prototype._removeLayerAndSource=function(){var t,e;!((t=this._map)===null||t===void 0)&&t.getLayer(this._layerId)&&this._map.removeLayer(this._layerId),!((e=this._map)===null||e===void 0)&&e.getSource(this._layerId)&&this._map.removeSource(this._layerId)},n}(),b1=["line-color","line-width","line-blur","line-opacity","line-pattern","line-gap-width","line-offset","line-dasharray","line-gradient","line-translate","line-translate-anchor"],w1=["line-cap","line-join","line-miter-limit","line-round-limit"],Bf=["circle-radius","circle-color","circle-blur","circle-opacity","circle-translate","circle-translate-anchor","circle-pitch-scale","circle-pitch-alignment","circle-stroke-width","circle-stroke-color","circle-stroke-opacity"],sy=["symbol-placement","symbol-spacing","symbol-avoid-edges","symbol-z-order","icon-allow-overlap","icon-ignore-placement","icon-optional","icon-rotation-alignment","icon-size","icon-text-fit","icon-text-fit-padding","icon-image","icon-rotate","icon-padding","icon-keep-upright","icon-offset","icon-anchor","icon-pitch-alignment","text-pitch-alignment","text-rotation-alignment","text-field","text-font","text-size","text-max-width","text-line-height","text-letter-spacing","text-justify","text-anchor","text-max-angle","text-rotate","text-padding","text-keep-upright","text-transform","text-offset","text-allow-overlap","text-ignore-placement","text-optional","text-radial-offset","text-variable-anchor","text-writing-mode"],uy=["icon-opacity","icon-color","icon-halo-color","icon-halo-width","icon-halo-blur","icon-translate","icon-translate-anchor","text-opacity","text-color","text-halo-color","text-halo-width","text-halo-blur","text-translate","text-translate-anchor"],jI=["text-pitch-alignment","text-rotation-alignment","text-field","text-font","text-size","text-max-width","text-line-height","text-letter-spacing","text-justify","text-anchor","text-max-angle","text-rotate","text-padding","text-keep-upright","text-transform","text-offset","text-allow-overlap","text-ignore-placement","text-optional","text-radial-offset","text-variable-anchor","text-writing-mode"],GI=["text-opacity","text-color","text-halo-color","text-halo-width","text-halo-blur","text-translate","text-translate-anchor"],HI=["fill-extrusion-opacity","fill-extrusion-pattern","fill-extrusion-color","fill-extrusion-translate","fill-extrusion-translate-anchor","fill-extrusion-height","fill-extrusion-base","fill-extrusion-vertical-gradient"],D0={"circle-color":"#000000","circle-radius":5,"circle-blur":0,"circle-opacity":1,"circle-stroke-width":0,"circle-stroke-color":"#000000","circle-stroke-opacity":1},zC=function(n){function t(e){var i,o,u=n.call(this)||this;return u._lngLatBounds=null,u._styleMap=new Map,u._clickHighlightPropVal=void 0,u._hoverHighlightPropVal=void 0,u._expressionMap=new Map,u._key=(i=e.key)!==null&&i!==void 0?i:"id",u._id=mi(),u._layer=new Ii({id:"circle-point-layer-".concat(u._id),type:"circle",layerCursor:"pointer",data:e.data,paint:u._getPaint(e.style),layout:{visibility:"visible"}}),u._fitBoundsOptions=u._getFitBoundsOptions(e.fitBoundsOptions),u._setLngLatBounds(e.data),u._highlightTrigger=(o=e.highlightOptions)===null||o===void 0?void 0:o.trigger,e.highlightOptions&&u._initHighlight(e.style,e.highlightOptions.style),vi(["_onClick","_onMouseMove","_onMouseLeave","_onMouseEnter"],u),u}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._layer.addTo(e),this._highlightTrigger&&this._setHighlight(),this._setEventListeners("on"),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.remove=function(){return this._map&&(this._setEventListeners("off"),this._layer.remove(),this.removeHighlight(),this._map=void 0),this},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype.setData=function(e){return this._setLngLatBounds(e),this._layer.setData(e),this._map&&(this.removeHighlight(),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.setHighlight=function(e){return this._map&&this._highlightTrigger?(this._highlightTrigger==="hover"?this._hoverHighlightPropVal=e:this._clickHighlightPropVal=e,this._setHighlight(),this):this},t.prototype.removeHighlight=function(){return this._map&&this._highlightTrigger&&this._removeHighlight(),this},t.prototype.easeTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.easeTo(nt(nt({},i),{center:o.geometry.coordinates})),this},t.prototype.flyTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.flyTo(nt(nt({},i||{}),{center:o.geometry.coordinates})),this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&((i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,e||this._fitBoundsOptions||{})),this},t.prototype._getFeature=function(e){var i,o=(i=this._layer.querySourceFeature({filter:["==",["get",this._key],e]}))===null||i===void 0?void 0:i[0];return o||(o=this._layer.queryFeatureFormData(this._key,e))},t.prototype._setLngLatBounds=function(e){this._lngLatBounds=e.features.length>0?Xr(zr(e)).bbox:null},t.prototype._initHighlight=function(e,i){var o=this;Object.keys(D0).forEach(function(s){var y,v=i[s];v!==void 0&&o._styleMap.set(s,[v,(y=e[s])!==null&&y!==void 0?y:D0[s]])});var u="".concat(this._id,"-invalidHighlightPropVal");this._expressionMap.set("click",function(){var s;return["==",["get",o._key],(s=o._clickHighlightPropVal)!==null&&s!==void 0?s:u]}),this._expressionMap.set("hover",function(){var s;return["==",["get",o._key],(s=o._hoverHighlightPropVal)!==null&&s!==void 0?s:u]}),this._expressionMap.set("both",function(){var s,y;return["any",["==",["get",o._key],(s=o._clickHighlightPropVal)!==null&&s!==void 0?s:u],["==",["get",o._key],(y=o._hoverHighlightPropVal)!==null&&y!==void 0?y:u]]})},t.prototype._getFitBoundsOptions=function(e){return e?e===!0?{}:e:void 0},t.prototype._getPaint=function(e){var i=Object.create(null);return Object.keys(e).forEach(function(o){Bf.includes(o)&&(i[o]=e[o])}),i},t.prototype._setEventListeners=function(e){e===void 0&&(e="on"),this._layer[e]("click",this._onClick),this._layer[e]("mousemove",this._onMouseMove),this._layer[e]("mouseleave",this._onMouseLeave),this._layer[e]("mouseenter",this._onMouseEnter)},t.prototype._getPoint=function(e){return{data:nt({},e.properties),lngLat:new be.LngLat(e.geometry.coordinates[0],e.geometry.coordinates[1])}},t.prototype._onClick=function(e){var i,o,u=this,s=(i=e.features)===null||i===void 0?void 0:i[0];if(this.fire("click",nt(nt({},this._getPoint(s)),{originalMapEvent:e,points:(o=e.features)===null||o===void 0?void 0:o.map(function(v){return u._getPoint(v)})})),this._highlightTrigger==="click"||this._highlightTrigger==="both"){var y=s.properties[this._key];this._clickHighlightPropVal!==y&&(this._clickHighlightPropVal=y,this._setHighlight())}},t.prototype._onMouseMove=function(e){var i,o,u,s=(i=e.features)===null||i===void 0?void 0:i[0];if(this.fire("mousemove",nt(nt({},this._getPoint(s)),{originalMapEvent:e})),this._highlightTrigger==="hover"||this._highlightTrigger==="both"){var y=(u=(o=e.features)===null||o===void 0?void 0:o[0].properties)===null||u===void 0?void 0:u[this._key];this._hoverHighlightPropVal!==y&&(this._hoverHighlightPropVal=y,this._setHighlight())}},t.prototype._onMouseLeave=function(e){this.fire("mouseleave",{originalMapEvent:e}),this._highlightTrigger==="hover"?(this._hoverHighlightPropVal=void 0,this._removeHighlight()):this._highlightTrigger==="both"&&(this._hoverHighlightPropVal=void 0,this._setHighlight())},t.prototype._onMouseEnter=function(e){var i,o=(i=e.features)===null||i===void 0?void 0:i[0];this.fire("mouseenter",nt(nt({},this._getPoint(o)),{originalMapEvent:e}))},t.prototype._setHighlight=function(){var e=this._expressionMap.get(this._highlightTrigger)(),i=Object.create(null),o=Object.create(null);this._styleMap.forEach(function(u,s){i[s]=Yt(["case",e],u,!0)}),o["circle-sort-key"]=["case",e,2,0],this._layer.setStyle({paint:i,layout:o})},t.prototype._removeHighlight=function(){this._clickHighlightPropVal=void 0,this._hoverHighlightPropVal=void 0,this._setHighlight()},t}(be.Evented),O0={"icon-image":"","icon-size":1,"text-field":"","text-size":16},k0={"icon-opacity":1,"icon-color":"#000000","icon-halo-color":"rgba(0,0,0,0)","icon-halo-width":0,"icon-halo-blur":0,"text-opacity":1,"text-color":"#000000","text-halo-color":"rgba(0,0,0,0)","text-halo-width":1,"text-halo-blur":1},BC=function(n){function t(e){var i,o,u=n.call(this)||this;return u._layoutStyleMap=new Map,u._paintStyleMap=new Map,u._clickHighlightPropVal=void 0,u._hoverHighlightPropVal=void 0,u._expressionMap=new Map,u._id=mi(),u._layer=new Ii(nt({id:"symbol-point-".concat(u._id),type:"symbol",layerCursor:"pointer",data:e.data},u._getStyle(e.style))),u._key=(i=e.key)!==null&&i!==void 0?i:"id",u._fitBoundsOptions=u._getFitBoundsOptions(e.fitBoundsOptions),u._setLngLatBounds(e.data),u._highlightTrigger=(o=e.highlightOptions)===null||o===void 0?void 0:o.trigger,e.highlightOptions&&u._initHighlight(e.style,e.highlightOptions.style),vi(["_onClick","_onMouseMove","_onMouseLeave","_onMouseEnter"],u),u}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._layer.addTo(e),this._highlightTrigger&&this._setHighlight(),this._setEventListeners("on"),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.remove=function(){return this._map&&(this._setEventListeners("off"),this._layer.remove(),this.removeHighlight(),this._map=void 0),this},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype.setData=function(e){return this._setLngLatBounds(e),this._layer.setData(e),this._map&&(this.removeHighlight(),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.setHighlight=function(e){return this._map&&this._highlightTrigger?(this._highlightTrigger==="hover"?this._hoverHighlightPropVal=e:this._clickHighlightPropVal=e,this._setHighlight(),this):this},t.prototype.removeHighlight=function(){return this._map&&this._highlightTrigger&&this._removeHighlight(),this},t.prototype.easeTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.easeTo(nt(nt({},i),{center:o.geometry.coordinates})),this},t.prototype.flyTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.flyTo(nt(nt({},i||{}),{center:o.geometry.coordinates})),this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&((i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,e||this._fitBoundsOptions||{})),this},t.prototype._getFeature=function(e){var i,o=(i=this._layer.querySourceFeature({filter:["==",["get",this._key],e]}))===null||i===void 0?void 0:i[0];return o||(o=this._layer.queryFeatureFormData(this._key,e))},t.prototype._setLngLatBounds=function(e){this._lngLatBounds=e.features.length>0?Xr(zr(e)).bbox:null},t.prototype._initHighlight=function(e,i){var o=this;Object.keys(O0).forEach(function(s){var y,v=i[s];v!==void 0&&o._layoutStyleMap.set(s,[v,(y=e[s])!==null&&y!==void 0?y:O0[s]])}),Object.keys(k0).forEach(function(s){var y,v=i[s];v!==void 0&&o._paintStyleMap.set(s,[v,(y=e[s])!==null&&y!==void 0?y:k0[s]])});var u="".concat(this._id,"-invalidHighlightPropVal");this._expressionMap.set("click",function(){var s;return["==",["get",o._key],(s=o._clickHighlightPropVal)!==null&&s!==void 0?s:u]}),this._expressionMap.set("hover",function(){var s;return["==",["get",o._key],(s=o._hoverHighlightPropVal)!==null&&s!==void 0?s:u]}),this._expressionMap.set("both",function(){var s,y;return["any",["==",["get",o._key],(s=o._clickHighlightPropVal)!==null&&s!==void 0?s:u],["==",["get",o._key],(y=o._hoverHighlightPropVal)!==null&&y!==void 0?y:u]]})},t.prototype._getFitBoundsOptions=function(e){return e?e===!0?{}:e:void 0},t.prototype._getStyle=function(e){var i=Object.create(null),o=Object.create(null);return Object.keys(e).forEach(function(u){sy.includes(u)?o[u]=e[u]:uy.includes(u)&&(i[u]=e[u])}),o.visibility="visible",{paint:i,layout:o}},t.prototype._setEventListeners=function(e){e===void 0&&(e="on"),this._layer[e]("click",this._onClick),this._layer[e]("mousemove",this._onMouseMove),this._layer[e]("mouseleave",this._onMouseLeave),this._layer[e]("mouseenter",this._onMouseEnter)},t.prototype._getPoint=function(e){return{data:nt({},e.properties),lngLat:new be.LngLat(e.geometry.coordinates[0],e.geometry.coordinates[1])}},t.prototype._onClick=function(e){var i,o=this,u=e.features[0];if(this.fire("click",nt(nt({},this._getPoint(u)),{originalMapEvent:e,points:(i=e.features)===null||i===void 0?void 0:i.map(function(y){return o._getPoint(y)})})),this._highlightTrigger==="click"||this._highlightTrigger==="both"){var s=u.properties[this._key];this._clickHighlightPropVal!==s&&(this._clickHighlightPropVal=s,this._setHighlight())}},t.prototype._onMouseMove=function(e){var i,o=(i=e.features)===null||i===void 0?void 0:i[0];if(this.fire("mousemove",nt(nt({},this._getPoint(o)),{originalMapEvent:e})),this._highlightTrigger==="hover"||this._highlightTrigger==="both"){var u=e.features[0].properties[this._key];this._hoverHighlightPropVal!==u&&(this._hoverHighlightPropVal=u,this._setHighlight())}},t.prototype._onMouseLeave=function(e){this.fire("mouseleave",{originalMapEvent:e}),this._highlightTrigger==="hover"&&(this._hoverHighlightPropVal=void 0,this._removeHighlight()),this._highlightTrigger==="both"&&(this._hoverHighlightPropVal=void 0,this._setHighlight())},t.prototype._onMouseEnter=function(e){var i,o=(i=e.features)===null||i===void 0?void 0:i[0];this.fire("mouseenter",nt(nt({},this._getPoint(o)),{originalMapEvent:e}))},t.prototype._setHighlight=function(){var e=this._expressionMap.get(this._highlightTrigger)(),i=Object.create(null),o=Object.create(null);this._paintStyleMap.forEach(function(u,s){i[s]=Yt(["case",e],u,!0)}),this._layoutStyleMap.forEach(function(u,s){o[s]=Yt(["case",e],u,!0)}),o["symbol-sort-key"]=["case",e,2,0],this._layer.setStyle({paint:i,layout:o})},t.prototype._removeHighlight=function(){this._clickHighlightPropVal=void 0,this._hoverHighlightPropVal=void 0,this._setHighlight()},t}(be.Evented),VC=function(n){function t(e){var i,o=n.call(this)||this;return o._key=(i=e.key)!==null&&i!==void 0?i:"id",o._data=e.data,o._fitBoundsOptions=o._getFitBoundsOptions(e.fitBoundsOptions),o._setLngLatBounds(e.data),o._markerOptions=e.markerOptions?nt(nt({},e.markerOptions),{draggable:!1}):{},o._markerMap=new Map,o._init(),o}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){var i=this;return e===this._map||(this.remove(),this._map=e,this._markerMap.forEach(function(o){o.addTo(i._map)}),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.remove=function(){return this._map&&(this._markerMap.forEach(function(e){e.remove()}),this._map=void 0),this},t.prototype.easeTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.easeTo(nt(nt({},i),{center:o.geometry.coordinates})),this},t.prototype.flyTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.flyTo(nt(nt({},i||{}),{center:o.geometry.coordinates})),this},t.prototype.setData=function(e){var i=this;return this._data=e,this._setLngLatBounds(e),this._clear(),this._init(),this._map&&(this._markerMap.forEach(function(o){o.addTo(i._map)}),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&((i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,e||this._fitBoundsOptions||{})),this},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype._clear=function(){this._markerMap.forEach(function(e){e.remove()}),this._markerMap.clear()},t.prototype._getFeature=function(e){var i=this;return this._data.features.find(function(o){var u;return((u=o.properties)===null||u===void 0?void 0:u[i._key])===e})},t.prototype._getElement=function(e,i){return typeof e=="function"?e(i):e.cloneNode(!0)},t.prototype._getFitBoundsOptions=function(e){return e?e===!0?{}:e:void 0},t.prototype._setLngLatBounds=function(e){this._lngLatBounds=e.features.length>0?Xr(zr(e)).bbox:void 0},t.prototype._init=function(){var e=this;this._data.features.forEach(function(i){var o,u,s=nt(nt({},e._markerOptions),{element:!((o=e._markerOptions)===null||o===void 0)&&o.element?e._getElement(e._markerOptions.element,i.properties):void 0}),y=new be.Marker(s).setLngLat(i.geometry.coordinates);e._setMarkerEvent(y,i.properties),e._markerMap.set((u=i.properties)===null||u===void 0?void 0:u[e._key],y)})},t.prototype._setMarkerEvent=function(e,i){var o=this,u=e.getElement();u.style.cursor="pointer",u.addEventListener("click",function(s){o.fire("click",{lngLat:e.getLngLat(),data:JSON.parse(JSON.stringify(i))}),s.stopPropagation()})},t}(be.Evented),N0={"line-color":"#000000","line-width":1,"line-blur":0,"line-opacity":1,"line-gap-width":0},UC=function(n){function t(e){var i,o,u=n.call(this)||this;return u._lngLatBounds=null,u._styleMap=new Map,u._clickHighlightPropVal=void 0,u._hoverHighlightPropVal=void 0,u._expressionMap=new Map,u._key=(i=e.key)!==null&&i!==void 0?i:"id",u._id=mi(),u._layer=new Ii(nt({id:"line-layer-".concat(u._id),type:"line",layerCursor:"pointer",data:e.data},u._getStyle(e.style))),u._fitBoundsOptions=u._getFitBoundsOptions(e.fitBoundsOptions),u._setLngLatBounds(e.data),u._highlightTrigger=(o=e.highlightOptions)===null||o===void 0?void 0:o.trigger,e.highlightOptions&&u._initHighlight(e.style,e.highlightOptions.style),vi(["_onClick","_onMouseMove","_onMouseLeave","_onMouseEnter"],u),u}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._layer.addTo(e),this._setEventListeners("on"),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.remove=function(){return this._map&&(this._setEventListeners("off"),this._layer.remove(),this.removeHighlight(),this._map=void 0),this},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype.setData=function(e){return this._setLngLatBounds(e),this._layer.setData(e),this._map&&(this.removeHighlight(),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.setHighlight=function(e){return this._map&&this._highlightTrigger?(this._highlightTrigger==="hover"?this._hoverHighlightPropVal=e:this._clickHighlightPropVal=e,this._setHighlight(),this):this},t.prototype.removeHighlight=function(){return this._map&&this._highlightTrigger&&this._removeHighlight(),this},t.prototype.fitTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);o&&this._map.fitBounds(new be.LngLatBounds(Xr(zr(o)).bbox),i||{})},t.prototype.easeTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);if(o){var u=ni(Tn(o)),s=new be.LngLat(u[0],u[1]);this._map.easeTo(nt(nt({},i),{center:s}))}return this},t.prototype.flyTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);if(o){var u=ni(Tn(o)),s=new be.LngLat(u[0],u[1]);this._map.flyTo(nt(nt({},i||{}),{center:s}))}return this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&((i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,e||this._fitBoundsOptions||{})),this},t.prototype._getFeature=function(e){return this._layer.queryFeatureFormData(this._key,e)},t.prototype._setLngLatBounds=function(e){this._lngLatBounds=e.features.length>0?Xr(zr(e)).bbox:null},t.prototype._initHighlight=function(e,i){var o=this;Object.keys(N0).forEach(function(s){var y,v=i[s];v!==void 0&&o._styleMap.set(s,[v,(y=e[s])!==null&&y!==void 0?y:N0[s]])});var u="".concat(this._id,"-invalidHighlightPropVal");this._expressionMap.set("click",function(){var s;return["==",["get",o._key],(s=o._clickHighlightPropVal)!==null&&s!==void 0?s:u]}),this._expressionMap.set("hover",function(){var s;return["==",["get",o._key],(s=o._hoverHighlightPropVal)!==null&&s!==void 0?s:u]}),this._expressionMap.set("both",function(){var s,y;return["any",["==",["get",o._key],(s=o._clickHighlightPropVal)!==null&&s!==void 0?s:u],["==",["get",o._key],(y=o._hoverHighlightPropVal)!==null&&y!==void 0?y:u]]})},t.prototype._getFitBoundsOptions=function(e){return e?e===!0?{}:e:void 0},t.prototype._getStyle=function(e){var i=Object.create(null),o=Object.create(null);return Object.keys(e).forEach(function(u){w1.includes(u)?o[u]=e[u]:b1.includes(u)&&(i[u]=e[u])}),o.visibility="visible",{paint:i,layout:o}},t.prototype._setEventListeners=function(e){e===void 0&&(e="on"),this._layer[e]("click",this._onClick),this._layer[e]("mousemove",this._onMouseMove),this._layer[e]("mouseleave",this._onMouseLeave),this._layer[e]("mouseenter",this._onMouseEnter)},t.prototype._onClick=function(e){var i,o=(i=e.features)===null||i===void 0?void 0:i[0],u=this._getFeature(o.properties[this._key]),s=ni(Tn(u)),y=new be.LngLat(s[0],s[1]),v=Xr(zr(u)).bbox;if(this.fire("click",{center:y,data:nt({},o.properties),lngLatBounds:new be.LngLatBounds(v),originalMapEvent:e}),this._highlightTrigger==="click"||this._highlightTrigger==="both"){var S=o.properties[this._key];this._clickHighlightPropVal!==S&&(this._clickHighlightPropVal=S,this._setHighlight())}},t.prototype._onMouseMove=function(e){var i,o,u,s=(i=e.features)===null||i===void 0?void 0:i[0],y=this._getFeature(s.properties[this._key]),v=ni(Tn(y)),S=new be.LngLat(v[0],v[1]);if(this.fire("mousemove",{center:S,data:nt({},s.properties),lngLat:e.lngLat,originalMapEvent:e}),this._highlightTrigger==="hover"||this._highlightTrigger==="both"){var L=(u=(o=e.features)===null||o===void 0?void 0:o[0].properties)===null||u===void 0?void 0:u[this._key];this._hoverHighlightPropVal!==L&&(this._hoverHighlightPropVal=L,this._setHighlight())}},t.prototype._onMouseLeave=function(e){this.fire("mouseleave",{originalMapEvent:e}),this._highlightTrigger==="hover"?(this._hoverHighlightPropVal=void 0,this._removeHighlight()):this._highlightTrigger==="both"&&(this._hoverHighlightPropVal=void 0,this._setHighlight())},t.prototype._onMouseEnter=function(e){var i,o=(i=e.features)===null||i===void 0?void 0:i[0],u=this._getFeature(o.properties[this._key]),s=ni(Tn(u)),y=new be.LngLat(s[0],s[1]);this.fire("mouseenter",{center:y,data:nt({},o.properties),lngLat:e.lngLat,originalMapEvent:e})},t.prototype._setHighlight=function(){var e=this._expressionMap.get(this._highlightTrigger)(),i=Object.create(null),o=Object.create(null);this._styleMap.forEach(function(u,s){i[s]=Yt(["case",e],u,!0)}),o["line-sort-key"]=["case",e,2,0],this._layer.setStyle({paint:i,layout:o})},t.prototype._removeHighlight=function(){this._clickHighlightPropVal=void 0,this._hoverHighlightPropVal=void 0,this._setHighlight()},t}(be.Evented),XI=["fill-opacity","fill-color","fill-pattern"],ZI=["stroke-opacity","stroke-color","stroke-width","stroke-blur","stroke-dasharray","stroke-pattern"],R0={"stroke-opacity":1,"stroke-pattern":"","stroke-color":"#000000","stroke-width":1,"stroke-blur":0},F0={"fill-opacity":1,"fill-pattern":"","fill-color":"#000000"},qC=function(n){function t(e){var i,o,u,s,y=n.call(this)||this;return y._strokePaintStyleMap=new Map,y._strokeLayoutStyleMap=new Map,y._fillPaintStyleMap=new Map,y._fillLayoutStyleMap=new Map,y._expressionMap=new Map,y._id=mi(),y._fillLayer=new Ii({id:"polygon-fill-".concat(y._id),type:"fill",layerCursor:"pointer",data:e.data,paint:y._getFillPaint(e.style),layout:{visibility:"visible","fill-sort-key":(i=e==null?void 0:e.style["sort-key"])!==null&&i!==void 0?i:1}}),y._strokeLayer=new Ii({id:"polygon-stroke-".concat(y._id),type:"line",data:e.data,paint:y._getStrokePaint(e.style),layout:{visibility:"visible","line-sort-key":(o=e==null?void 0:e.style["sort-key"])!==null&&o!==void 0?o:1}}),y._key=(u=e.key)!==null&&u!==void 0?u:"id",y._fitBoundsOptions=y._getFitBoundsOptions(e.fitBoundsOptions),y._setLngLatBounds(e.data),y._highlightTrigger=(s=e.highlightOptions)===null||s===void 0?void 0:s.trigger,e.highlightOptions&&y._initHighlight(e.style,e.highlightOptions.style),vi(["_onMouseClick","_onMouseMove","_onMouseLeave","_onMouseEnter"],y),y}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._fillLayer.addTo(e),this._strokeLayer.addTo(e),this._setEventListeners("on"),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.remove=function(){return this._map&&(this._setEventListeners("off"),this._fillLayer.remove(),this._strokeLayer.remove(),this.removeHighlight(),this._map=void 0),this},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype.setData=function(e){return this._setLngLatBounds(e),this._fillLayer.setData(e),this._strokeLayer.setData(e),this._map&&(this.removeHighlight(),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.setHighlight=function(e){return this._map&&this._highlightTrigger?(this._highlightTrigger==="hover"?this._hoverHighlightPropVal=e:this._clickHighlightPropVal=e,this._setHighlight(),this):this},t.prototype.removeHighlight=function(){return this._map&&this._highlightTrigger&&this._removeHighlight(),this},t.prototype.fitTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);o&&this._map.fitBounds(new be.LngLatBounds(Xr(zr(o)).bbox),i||{})},t.prototype.easeTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);if(o){var u=ni(Tn(o));this._map.easeTo(nt(nt({},i),{center:[u[0],u[1]]}))}return this},t.prototype.flyTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);if(o){var u=ni(Tn(o));this._map.flyTo(nt(nt({},i||{}),{center:[u[0],u[1]]}))}return this},t.prototype.fitBounds=function(e){var i;this._lngLatBounds&&((i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,e||this._fitBoundsOptions||{}))},t.prototype._getFeature=function(e){return this._fillLayer.queryFeatureFormData(this._key,e)},t.prototype._setLngLatBounds=function(e){this._lngLatBounds=e.features.length>0?Xr(zr(e)).bbox:null},t.prototype._getFitBoundsOptions=function(e){return e?e===!0?{}:e:void 0},t.prototype._getFillPaint=function(e){var i=Object.create(null);return Object.keys(e).forEach(function(o){XI.includes(o)&&(i[o]=e[o])}),i},t.prototype._getStrokePaint=function(e){var i=Object.create(null);return Object.keys(e).forEach(function(o){ZI.includes(o)&&(i[o.replace("stroke","line")]=e[o])}),i},t.prototype._setEventListeners=function(e){e===void 0&&(e="on"),this._fillLayer[e]("click",this._onMouseClick),this._fillLayer[e]("mousemove",this._onMouseMove),this._fillLayer[e]("mouseleave",this._onMouseLeave),this._fillLayer[e]("mouseenter",this._onMouseEnter)},t.prototype._onMouseClick=function(e){var i=e.features[0],o=this._getFeature(i.properties[this._key]),u=ni(Tn(o)),s=new be.LngLat(u[0],u[1]),y=Xr(zr(o)).bbox;if(this.fire("click",{center:s,data:nt({},i.properties),lngLatBounds:new be.LngLatBounds(y),originalMapEvent:e}),this._highlightTrigger==="click"||this._highlightTrigger==="both"){var v=i.properties[this._key];this._clickHighlightPropVal!==v&&(this._clickHighlightPropVal=v,this._setHighlight())}},t.prototype._onMouseMove=function(e){var i,o=(i=e.features)===null||i===void 0?void 0:i[0],u=this._getFeature(o.properties[this._key]),s=ni(Tn(u)),y=new be.LngLat(s[0],s[1]);if(this.fire("mousemove",{center:y,data:nt({},o.properties),lngLat:e.lngLat,originalMapEvent:e}),this._highlightTrigger==="hover"||this._highlightTrigger==="both"){var v=e.features[0].properties[this._key];this._hoverHighlightPropVal!==v&&(this._hoverHighlightPropVal=v,this._setHighlight())}},t.prototype._onMouseLeave=function(e){this.fire("mouseleave",{originalMapEvent:e}),this._highlightTrigger==="hover"?(this._hoverHighlightPropVal=void 0,this._removeHighlight()):this._highlightTrigger==="both"&&(this._hoverHighlightPropVal=void 0,this._setHighlight())},t.prototype._onMouseEnter=function(e){var i,o=(i=e.features)===null||i===void 0?void 0:i[0],u=this._getFeature(o.properties[this._key]),s=ni(Tn(u)),y=new be.LngLat(s[0],s[1]);this.fire("mouseenter",{center:y,data:nt({},o.properties),lngLat:e.lngLat,originalMapEvent:e})},t.prototype._removeHighlight=function(){this._clickHighlightPropVal=void 0,this._hoverHighlightPropVal=void 0,this._setHighlight()},t.prototype._setHighlight=function(){var e=this._expressionMap.get(this._highlightTrigger)(),i=Object.create(null),o=Object.create(null),u=Object.create(null),s=Object.create(null);this._strokePaintStyleMap.forEach(function(y,v){u[v]=Yt(["case",e],y,!0)}),this._strokeLayoutStyleMap.forEach(function(y,v){s[v]=Yt(["case",e],y,!0)}),this._fillPaintStyleMap.forEach(function(y,v){i[v]=Yt(["case",e],y,!0)}),this._fillLayoutStyleMap.forEach(function(y,v){o[v]=Yt(["case",e],y,!0)}),this._fillLayer.setStyle({paint:i,layout:o}),this._strokeLayer.setStyle({paint:u,layout:s})},t.prototype._initHighlight=function(e,i){var o,u,s=this;Object.keys(R0).forEach(function(S){var L,k=i[S];k!==void 0&&s._strokePaintStyleMap.set(S.replace("stroke","line"),[k,(L=e[S])!==null&&L!==void 0?L:R0[S]])}),Object.keys(F0).forEach(function(S){var L,k=i[S];k!==void 0&&s._fillPaintStyleMap.set(S,[k,(L=e[S])!==null&&L!==void 0?L:F0[S]])});var y=i["sort-key"];y!==void 0&&(this._strokeLayoutStyleMap.set("line-sort-key",[y,(o=e["sort-key"])!==null&&o!==void 0?o:1]),this._fillLayoutStyleMap.set("fill-sort-key",[y,(u=e["sort-key"])!==null&&u!==void 0?u:1]));var v="".concat(this._id,"-invalidHighlightPropVal");this._expressionMap.set("click",function(){var S;return["==",["get",s._key],(S=s._clickHighlightPropVal)!==null&&S!==void 0?S:v]}),this._expressionMap.set("hover",function(){var S;return["==",["get",s._key],(S=s._hoverHighlightPropVal)!==null&&S!==void 0?S:v]}),this._expressionMap.set("both",function(){var S,L;return["any",["==",["get",s._key],(S=s._clickHighlightPropVal)!==null&&S!==void 0?S:v],["==",["get",s._key],(L=s._hoverHighlightPropVal)!==null&&L!==void 0?L:v]]})},t}(be.Evented);(function(n){function t(e){var i,o,u=n.call(this)||this;return u._id=mi(),u._sourceAndLayerId="heatmap-layer-".concat(u._id),u._data=e.data,u._styleOptions=e.style,u._fitBoundsOptions=u._getFitBoundsOptions(e.fitBoundsOptions),u._setLngLatBounds(),u._minZoom=(i=e.minZoom)!==null&&i!==void 0?i:0,u._maxZoom=(o=e.maxZoom)!==null&&o!==void 0?o:24,vi(["_onData"],u),u}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._addSourceAndLayer(),this._map.on("data",this._onData),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.remove=function(){return this._map&&(this._map.off("data",this._onData),this._map.removeLayer(this._sourceAndLayerId),this._map.removeSource(this._sourceAndLayerId),this._map=void 0),this},t.prototype.setData=function(e){return this._data=e,this._setLngLatBounds(),this._map&&(this._map.getSource(this._sourceAndLayerId).setData(this._data),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&((i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,e||this._fitBoundsOptions||{})),this},t.prototype._onData=function(e){var i=this;e.dataType==="style"&&setTimeout(function(){i._addSourceAndLayer()},10)},t.prototype._setLngLatBounds=function(){this._lngLatBounds=this._data.features.length>0?Xr(zr(this._data)).bbox:void 0},t.prototype._getFitBoundsOptions=function(e){return e?e===!0?{}:e:void 0},t.prototype._addSourceAndLayer=function(){var e;this._map&&(this._map.getLayer(this._sourceAndLayerId)||this._map.addLayer({id:this._sourceAndLayerId,type:"heatmap",minzoom:this._minZoom,maxzoom:this._maxZoom,source:{type:"geojson",data:this._data},paint:(e=this._styleOptions)!==null&&e!==void 0?e:{}}))},t})(be.Evented);var jC=function(n){function t(e){var i,o,u=n.call(this)||this;return u._pointMap=new Map,u._multiple=(i=e==null?void 0:e.multiple)!==null&&i!==void 0&&i,u._removeOnClick=(o=e==null?void 0:e.removeOnClick)!==null&&o!==void 0&&o,u._markerOptions=e==null?void 0:e.markerOptions,vi(["_onMapClick"],u),u}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._map.getCanvas().style.cursor="crosshair",this._map.on("click",this._onMapClick)),this},t.prototype.remove=function(){return this._map&&(this.removePoints(),this._map.getCanvas().style.cursor="",this._map.off("click",this._onMapClick),this._map=void 0),this},t.prototype.setPoint=function(e){var i,o;if(!this._map)return this;this._multiple||this.removePoints();var u=mi(),s=this._markerOptions?nt(nt({},this._markerOptions),{draggable:!1,element:(o=(i=this._markerOptions.element)===null||i===void 0?void 0:i.cloneNode())!==null&&o!==void 0?o:void 0}):{},y=new be.Marker(s).setLngLat(e).addTo(this._map);return this._setMarkerEvent(u,y),this._pointMap.set(u,{lngLat:y.getLngLat(),marker:y}),this},t.prototype.getPoints=function(){return Array.from(this._pointMap).map(function(e){return e[1].lngLat.toArray()})},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype._onMapClick=function(e){this.setPoint(e.lngLat),this.fire("get-point",{point:e.lngLat.toArray(),pointList:this.getPoints()})},t.prototype._setMarkerEvent=function(e,i){var o=this,u=i.getElement();u.style.cursor="pointer",u.addEventListener("click",function(s){o._removeOnClick?(i.remove(),o._pointMap.delete(e),o.fire("remove-point",{point:i.getLngLat().toArray(),pointList:o.getPoints()})):o.fire("click-point",{point:i.getLngLat().toArray()}),s.stopPropagation()})},t.prototype.removePoints=function(){this._pointMap.forEach(function(e){e.marker.remove()}),this._pointMap.clear()},t}(be.Evented),YI=["line-opacity","line-color","line-width","line-blur","line-dasharray"],WI=["vertex-radius","vertex-color","vertex-opacity","vertex-stroke-width","vertex-stroke-color","vertex-stroke-opacity"],GC=function(n){function t(e){var i,o,u=n.call(this)||this;return u._id=mi(),u._initState(),u._initStyle(e==null?void 0:e.style),u._initFinishedStyle(e==null?void 0:e.finishedStyle),u._enableBackspace=(i=e==null?void 0:e.enableBackspace)!==null&&i!==void 0&&i,u._enableEnter=(o=e==null?void 0:e.enableEnter)!==null&&o!==void 0&&o,vi(["_onMapClick","_onMapDoubleClick","_onMapMouseMove","_onKeyup","_onVertexMouseMove","_onVertexMouseLeave"],u),u}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._initLayer(this._style),this._setEventListeners("on"),this._map.getCanvas().style.cursor="crosshair"),this},t.prototype.remove=function(){return this._map&&(this._setEventListeners("off"),this._initState(),this._removeLayer(),this._map.getCanvas().style.cursor="",this._map=void 0),this},t.prototype.clear=function(){this._map&&(this._initState(),this._initLayer(this._style))},t.prototype.getData=function(){return this._finished?$e(this._data):null},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype._initLayer=function(e){var i,o,u,s;(i=this._vertexLayer)===null||i===void 0||i.remove(),(o=this._lineLayer)===null||o===void 0||o.remove(),this._vertexLayer=new Ii({id:"line-picker-vertex-".concat(this._id),type:"circle",layerCursor:"pointer",mapCursor:"crosshair",data:this._getVertexSourceData(),paint:e.vertex}),this._lineLayer=new Ii({id:"line-picker-line-".concat(this._id),type:"line",data:this._getLineSourceData(),paint:e.line}),(u=this._lineLayer)===null||u===void 0||u.addTo(this._map),(s=this._vertexLayer)===null||s===void 0||s.addTo(this._map)},t.prototype._getStyle=function(e){e===void 0&&(e={});var i=Object.create(null),o=Object.create(null);return Object.keys(e).forEach(function(u){YI.includes(u)?o[u]=e[u]:WI.includes(u)&&(i[u.replace("vertex","circle")]=e[u])}),{line:o,vertex:i}},t.prototype._initStyle=function(e){e===void 0&&(e={});var i=this._getStyle(e);this._style={line:nt(nt({},ay),i.line),vertex:nt(nt(nt({},i_),i.vertex),{"circle-pitch-alignment":"map"})}},t.prototype._initFinishedStyle=function(e){e===void 0&&(e={});var i=this._getStyle(e);this._finishedStyle={line:nt(nt(nt({},this._style.line),{"line-dasharray":[1,0]}),i.line),vertex:nt(nt({},this._style.vertex),i.vertex)}},t.prototype._initState=function(){this._data=null,this._vertexList=[],this._lineCoordinates=[],this._picking=!1,this._pending=!1,this._finished=!1,this._preFinished=!1,this._preFinishedOnVertex=!1,this._mouseOnVertex=!1},t.prototype._removeLayer=function(){var e,i;(e=this._vertexLayer)===null||e===void 0||e.remove(),(i=this._lineLayer)===null||i===void 0||i.remove(),this._vertexLayer=void 0,this._lineLayer=void 0},t.prototype._setEventListeners=function(e){var i,o;e===void 0&&(e="on"),(i=this._vertexLayer)===null||i===void 0||i[e]("mousemove",this._onVertexMouseMove),(o=this._vertexLayer)===null||o===void 0||o[e]("mouseleave",this._onVertexMouseLeave),this._map[e]("click",this._onMapClick),this._map[e]("dblclick",this._onMapDoubleClick),this._map[e]("mousemove",this._onMapMouseMove),(this._enableBackspace||this._enableEnter)&&(e==="on"?window.addEventListener("keyup",this._onKeyup):window.removeEventListener("keyup",this._onKeyup))},t.prototype._updateVertex=function(){var e;(e=this._vertexLayer)===null||e===void 0||e.setData(this._getVertexSourceData())},t.prototype._updateLine=function(){var e;this._data=this._getLineSourceData(),(e=this._lineLayer)===null||e===void 0||e.setData($e(this._data))},t.prototype._onVertexMouseMove=function(e){var i;if(!this._finished&&this._picking){var o=(i=e.features)===null||i===void 0?void 0:i[0];this._mouseOnVertex=!0,this._handleMouseMove(this._vertexList[o.properties.id])}},t.prototype._onVertexMouseLeave=function(){!this._finished&&this._picking&&(this._mouseOnVertex=!1)},t.prototype._getIndex=function(e,i){return e.findIndex(function(o){return Dx(Me(o),Me(i))})},t.prototype._handleMouseMove=function(e){this._lineCoordinates=Yt([],this._vertexList,!0);var i=this._getIndex(this._vertexList,e);this._preFinished=!1,this._preFinishedOnVertex=!1,i===-1?(this._lineCoordinates.push(e),this._preFinished=!0):this._vertexList.length>1&&(i===this._vertexList.length-2||i===this._vertexList.length-1?this._preFinished=!0:(this._lineCoordinates.push(e),i===0?this._preFinished=!0:this._preFinishedOnVertex=!0)),this._updateLine()},t.prototype._onMapMouseMove=function(e){this._finished||!this._picking||this._mouseOnVertex||this._handleMouseMove(e.lngLat.toArray())},t.prototype._onMapClick=function(e){var i=this;this._finished||this._pending||(this._picking?this._vertexList=Yt([],this._lineCoordinates,!0):(this._picking=!0,this._vertexList=[e.lngLat.toArray()],this._lineCoordinates=Yt([],this._vertexList,!0)),this._mouseOnVertex&&this._preFinished?this._complete():(this._updateVertex(),this._updateLine(),this._pending=!0,window.setTimeout(function(){i._pending=!1},250)))},t.prototype._complete=function(){this._picking=!1,this._finished=!0,this._setFinishedStyle(),this.fire("finish",{data:$e(this._data),length:Nm(this._data,{units:"meters"})})},t.prototype._onKeyup=function(e){e.code==="Backspace"||e.code==="Enter"&&this._enableEnter&&this._enterComplete()},t.prototype._enterComplete=function(){!this._finished&&this._picking&&(this._preFinished||this._preFinishedOnVertex)&&(this._vertexList=Yt([],this._lineCoordinates,!0),this._complete())},t.prototype._onMapDoubleClick=function(e){e.preventDefault(),!this._finished&&this._picking&&(this._preFinished||this._preFinishedOnVertex)&&this._complete()},t.prototype._setFinishedStyle=function(){this._initLayer(this._finishedStyle)},t.prototype._getVertexSourceData=function(){return Ir(this._vertexList.map(function(e,i){return Me(e,{id:i})}))},t.prototype._getLineSourceData=function(){return this._lineCoordinates.length>1?Yi(this._lineCoordinates):Ir([])},t}(be.Evented),KI=["fill-opacity","fill-color"],JI=["stroke-opacity","stroke-color","stroke-width","stroke-blur","stroke-dasharray"],QI=["vertex-radius","vertex-color","vertex-opacity","vertex-stroke-width","vertex-stroke-color","vertex-stroke-opacity"],HC=function(n){function t(e){var i,o,u=n.call(this)||this;return u._id=mi(),u._initState(),u._initStyle(e==null?void 0:e.style),u._initFinishedStyle(e==null?void 0:e.finishedStyle),u._enableBackspace=(i=e==null?void 0:e.enableBackspace)!==null&&i!==void 0&&i,u._enableEnter=(o=e==null?void 0:e.enableEnter)!==null&&o!==void 0&&o,vi(["_onMapClick","_onMapDoubleClick","_onMapMouseMove","_onKeyup","_onVertexMouseMove","_onVertexMouseLeave"],u),u}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._initLayer(this._style),this._setEventListeners("on"),this._map.getCanvas().style.cursor="crosshair"),this},t.prototype.remove=function(){return this._map&&(this._setEventListeners("off"),this._initState(),this._removeLayer(),this._map.getCanvas().style.cursor="",this._map=void 0),this},t.prototype.clear=function(){this._map&&(this._initState(),this._initLayer(this._style))},t.prototype.getData=function(){return this._finished?$e(this._data):null},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype._initLayer=function(e){var i,o,u,s,y,v;(i=this._vertexLayer)===null||i===void 0||i.remove(),(o=this._strokeLayer)===null||o===void 0||o.remove(),(u=this._fillLayer)===null||u===void 0||u.remove(),this._fillLayer=new Ii({id:"polygon-area-picker-fill-".concat(this._id),type:"fill",data:this._getFillSourceData(),paint:e.fill}),this._strokeLayer=new Ii({id:"polygon-area-picker-stroke-".concat(this._id),type:"line",data:this._getStrokeSourceData(),paint:e.stroke}),this._vertexLayer=new Ii({id:"polygon-area-picker-vertex-".concat(this._id),type:"circle",data:this._getVertexSourceData(),layerCursor:"pointer",mapCursor:"crosshair",paint:e.vertex}),(s=this._fillLayer)===null||s===void 0||s.addTo(this._map),(y=this._strokeLayer)===null||y===void 0||y.addTo(this._map),(v=this._vertexLayer)===null||v===void 0||v.addTo(this._map)},t.prototype._getStyle=function(e){e===void 0&&(e={});var i=Object.create(null),o=Object.create(null),u=Object.create(null);return Object.keys(e).forEach(function(s){KI.includes(s)?u[s]=e[s]:JI.includes(s)?o[s.replace("stroke","line")]=e[s]:QI.includes(s)&&(i[s.replace("vertex","circle")]=e[s])}),{fill:u,stroke:o,vertex:i}},t.prototype._initFinishedStyle=function(e){e===void 0&&(e={});var i=this._getStyle(e);this._finishedStyle={fill:nt(nt({},this._style.fill),i.fill),stroke:nt(nt(nt({},this._style.stroke),{"line-dasharray":[1,0]}),i.stroke),vertex:nt(nt({},this._style.vertex),i.vertex)}},t.prototype._initStyle=function(e){e===void 0&&(e={});var i=this._getStyle(e);this._style={fill:nt(nt({},n_),i.fill),stroke:nt(nt({},ay),i.stroke),vertex:nt(nt(nt({},i_),i.vertex),{"circle-pitch-alignment":"map"})}},t.prototype._initState=function(){this._data=null,this._vertexList=[],this._strokeCoordinates=[],this._fillCoordinates=[],this._picking=!1,this._pending=!1,this._finished=!1,this._preFinished=!0,this._mouseOnVertex=!1},t.prototype._removeLayer=function(){var e,i,o;(e=this._vertexLayer)===null||e===void 0||e.remove(),(i=this._strokeLayer)===null||i===void 0||i.remove(),(o=this._fillLayer)===null||o===void 0||o.remove(),this._vertexLayer=void 0,this._strokeLayer=void 0,this._fillLayer=void 0},t.prototype._setEventListeners=function(e){var i,o;e===void 0&&(e="on"),(i=this._vertexLayer)===null||i===void 0||i[e]("mousemove",this._onVertexMouseMove),(o=this._vertexLayer)===null||o===void 0||o[e]("mouseleave",this._onVertexMouseLeave),this._map[e]("click",this._onMapClick),this._map[e]("dblclick",this._onMapDoubleClick),this._map[e]("mousemove",this._onMapMouseMove),(this._enableBackspace||this._enableEnter)&&(e==="on"?window.addEventListener("keyup",this._onKeyup):window.removeEventListener("keyup",this._onKeyup))},t.prototype._onVertexMouseMove=function(e){var i;if(!this._finished&&this._picking){var o=(i=e.features)===null||i===void 0?void 0:i[0];this._mouseOnVertex=!0,this._handleMouseMove(this._vertexList[o.properties.id])}},t.prototype._onVertexMouseLeave=function(){!this._finished&&this._picking&&(this._mouseOnVertex=!1)},t.prototype._getIndex=function(e,i){return e.findIndex(function(o){return Dx(Me(o),Me(i))})},t.prototype._onMapClick=function(e){var i=this;this._finished||this._pending||(this._picking?(this._vertexList=Yt([],this._strokeCoordinates,!0),this._strokeCoordinates=Yt([],this._fillCoordinates,!0)):(this._picking=!0,this._vertexList.push(e.lngLat.toArray()),this._strokeCoordinates=Yt([],this._vertexList,!0),this._fillCoordinates=Yt(Yt([],this._vertexList,!0),[this._vertexList[0]],!1)),this._mouseOnVertex&&this._preFinished?this._complete():(this._updateVertex(),this._updateStroke(),this._updateFill(),this._pending=!0,window.setTimeout(function(){i._pending=!1},250)))},t.prototype._onMapDoubleClick=function(e){e.preventDefault(),!this._finished&&this._picking&&this._preFinished&&this._complete()},t.prototype._onMapMouseMove=function(e){this._finished||!this._picking||this._mouseOnVertex||this._handleMouseMove(e.lngLat.toArray())},t.prototype._handleMouseMove=function(e){this._strokeCoordinates=Yt([],this._vertexList,!0);var i=this._getIndex(this._vertexList,e);this._preFinished=!1,i===-1?(this._strokeCoordinates.push(e),this._fillCoordinates=Yt(Yt([],this._strokeCoordinates,!0),[this._strokeCoordinates[0]],!1),this._vertexList.length>1&&(this._preFinished=!0)):this._vertexList.length>2?i===this._vertexList.length-1?(this._preFinished=!0,this._fillCoordinates=Yt(Yt([],this._strokeCoordinates,!0),[this._vertexList[0]],!1)):i===0?(this._preFinished=!0,this._strokeCoordinates.push(e),this._fillCoordinates=Yt([],this._strokeCoordinates,!0)):(this._preFinished=!0,this._fillCoordinates=Yt(Yt([],this._strokeCoordinates,!0),[this._strokeCoordinates[0]],!1)):this._fillCoordinates=Yt([],this._strokeCoordinates,!0),this._updateStroke(),this._updateFill()},t.prototype._enterComplete=function(){!this._finished&&this._picking&&this._preFinished&&(this._vertexList=Yt([],this._strokeCoordinates,!0),this._strokeCoordinates=Yt([],this._fillCoordinates,!0),this._complete())},t.prototype._complete=function(){this._picking=!1,this._finished=!0,this._setFinishedStyle(),this.fire("finish",{data:$e(this._data),acreage:dc(this._data)})},t.prototype._onKeyup=function(e){e.code==="Backspace"||e.code==="Enter"&&this._enableEnter&&this._enterComplete()},t.prototype._updateStroke=function(){var e;(e=this._strokeLayer)===null||e===void 0||e.setData(this._getStrokeSourceData())},t.prototype._updateVertex=function(){var e;(e=this._vertexLayer)===null||e===void 0||e.setData(this._getVertexSourceData())},t.prototype._updateFill=function(){var e;this._data=this._getFillSourceData(),(e=this._fillLayer)===null||e===void 0||e.setData($e(this._data))},t.prototype._setFinishedStyle=function(){this._initLayer(this._finishedStyle)},t.prototype._getVertexSourceData=function(){return Ir(this._vertexList.map(function(e,i){return Me(e,{id:i})}))},t.prototype._getStrokeSourceData=function(){return this._strokeCoordinates.length>1?Yi(this._strokeCoordinates):Ir([])},t.prototype._getFillSourceData=function(){return this._fillCoordinates.length>3?Gg(Hg(es([this._fillCoordinates]))).features[0]:Ir([])},t}(be.Evented),$I=["fill-opacity","fill-color"],tC=["stroke-opacity","stroke-color","stroke-width","stroke-blur","stroke-dasharray"],eC=["vertex-radius","vertex-color","vertex-opacity","vertex-stroke-width","vertex-stroke-color","vertex-stroke-opacity"],XC=function(n){function t(e){var i=n.call(this)||this;return i._id=mi(),i._initState(),i._initStyle(e==null?void 0:e.style),i._initFinishedStyle(e==null?void 0:e.finishedStyle),vi(["_onMapDoubleClick","_onMouseMove","_onMouseDown","_onMouseUp"],i),i}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._initLayer(this._style),this._setEventListeners("on"),this._map.getCanvas().style.cursor="crosshair"),this},t.prototype.remove=function(){return this._map&&(this._setEventListeners("off"),this._initState(),this._removeLayer(),this._map.getCanvas().style.cursor="",this._map=void 0),this},t.prototype.clear=function(){this._map&&(this._initState(),this._initLayer(this._style))},t.prototype.getData=function(){return this._finished&&this._data?$e(this._data):null},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype._initLayer=function(e){var i,o,u,s,y,v;(i=this._vertexLayer)===null||i===void 0||i.remove(),(o=this._strokeLayer)===null||o===void 0||o.remove(),(u=this._fillLayer)===null||u===void 0||u.remove(),this._vertexLayer=new Ii({id:"rect-area-picker-vertex-".concat(this._id),type:"circle",layerCursor:"pointer",mapCursor:"crosshair",data:this._getVertexSourceData(),paint:e.vertex}),this._strokeLayer=new Ii({id:"rect-area-picker-stroke-".concat(this._id),type:"line",data:this._getStrokeSourceData(),paint:e.stroke}),this._fillLayer=new Ii({id:"rect-area-picker-fill-".concat(this._id),type:"fill",data:this._getFillSourceData(),paint:e.fill}),(s=this._fillLayer)===null||s===void 0||s.addTo(this._map),(y=this._strokeLayer)===null||y===void 0||y.addTo(this._map),(v=this._vertexLayer)===null||v===void 0||v.addTo(this._map)},t.prototype._getStyle=function(e){e===void 0&&(e={});var i=Object.create(null),o=Object.create(null),u=Object.create(null);return Object.keys(e).forEach(function(s){$I.includes(s)?u[s]=e[s]:tC.includes(s)?o[s.replace("stroke","line")]=e[s]:eC.includes(s)&&(i[s.replace("vertex","circle")]=e[s])}),{fill:u,stroke:o,vertex:i}},t.prototype._initStyle=function(e){e===void 0&&(e={});var i=this._getStyle(e);this._style={fill:nt(nt({},n_),i.fill),stroke:nt(nt({},ay),i.stroke),vertex:nt(nt(nt({},i_),i.vertex),{"circle-pitch-alignment":"map"})}},t.prototype._initFinishedStyle=function(e){e===void 0&&(e={});var i=this._getStyle(e);this._finishedStyle={fill:nt(nt({},this._style.fill),i.fill),stroke:nt(nt(nt({},this._style.stroke),{"line-dasharray":[1,0]}),i.stroke),vertex:nt(nt({},this._style.vertex),i.vertex)}},t.prototype._removeLayer=function(){var e,i,o;(e=this._vertexLayer)===null||e===void 0||e.remove(),(i=this._strokeLayer)===null||i===void 0||i.remove(),(o=this._fillLayer)===null||o===void 0||o.remove(),this._vertexLayer=void 0,this._strokeLayer=void 0,this._fillLayer=void 0},t.prototype._initState=function(){this._nw=null,this._se=null,this._data=null,this._vertexList=[],this._strokeCoordinates=[],this._fillCoordinates=[],this._picking=!1,this._finished=!1},t.prototype._getVertexSourceData=function(){return Ir(this._vertexList.map(function(e,i){return Me(e,{id:i})}))},t.prototype._getStrokeSourceData=function(){return this._strokeCoordinates.length>1?Yi(this._strokeCoordinates):Ir([])},t.prototype._getFillSourceData=function(){return this._fillCoordinates.length>3?es([this._fillCoordinates]):Ir([])},t.prototype._setEventListeners=function(e){e===void 0&&(e="on"),this._map[e]("dblclick",this._onMapDoubleClick),this._map[e]("mousedown",this._onMouseDown),this._map[e]("mouseup",this._onMouseUp),this._map[e]("mousemove",this._onMouseMove)},t.prototype._onMouseDown=function(e){this._finished||(this._picking=!0,this._nw=e.lngLat.toArray(),e.preventDefault())},t.prototype._onMouseUp=function(){this._finished||(this._picking=!1,this._vertexList.length&&(this._finished=!0,this._setFinishedStyle(),this.fire("finish",{data:$e(this._data),acreage:dc(this._data)})))},t.prototype._onMapDoubleClick=function(e){e.preventDefault()},t.prototype._onMouseMove=function(e){if(!this._finished&&this._picking){this._se=e.lngLat.toArray();var i=Xr(zr(Yi([this._nw,this._se])));dc(i)===0?(this._fillCoordinates=[],this._strokeCoordinates=[],this._vertexList=[]):(this._fillCoordinates=Yt([],i.geometry.coordinates[0],!0),this._strokeCoordinates=Yt([],this._fillCoordinates,!0),this._vertexList=this._fillCoordinates.slice(0,-1)),this._updateVertex(),this._updateStroke(),this._updateFill()}},t.prototype._updateStroke=function(){var e;(e=this._strokeLayer)===null||e===void 0||e.setData(this._getStrokeSourceData())},t.prototype._updateVertex=function(){var e;(e=this._vertexLayer)===null||e===void 0||e.setData(this._getVertexSourceData())},t.prototype._updateFill=function(){var e;this._data=this._getFillSourceData(),(e=this._fillLayer)===null||e===void 0||e.setData($e(this._data))},t.prototype._setFinishedStyle=function(){this._initLayer(this._finishedStyle)},t}(be.Evented),rC=["fill-opacity","fill-color"],iC=["stroke-opacity","stroke-color","stroke-width","stroke-blur","stroke-dasharray"],ZC=function(n){function t(e){var i=n.call(this)||this;return i._id=mi(),i._initState(),i._initStyle(e==null?void 0:e.style),i._initFinishedStyle(e==null?void 0:e.finishedStyle),i._steps=(e==null?void 0:e.steps)||64,vi(["_onMapDoubleClick","_onMouseMove","_onMouseDown","_onMouseUp"],i),i}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._initLayer(this._style),this._setEventListeners("on"),this._map.getCanvas().style.cursor="crosshair"),this},t.prototype.remove=function(){return this._map&&(this._setEventListeners("off"),this._initState(),this._removeLayer(),this._map.getCanvas().style.cursor="",this._map=void 0),this},t.prototype.clear=function(){this._map&&(this._initState(),this._initLayer(this._style))},t.prototype.getData=function(){return this._finished&&this._data?$e(this._data):null},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype._removeLayer=function(){var e,i;(e=this._strokeLayer)===null||e===void 0||e.remove(),(i=this._fillLayer)===null||i===void 0||i.remove(),this._strokeLayer=void 0,this._fillLayer=void 0},t.prototype._initState=function(){this._center=null,this._radius=null,this._data=null,this._strokeCoordinates=[],this._fillCoordinates=[],this._picking=!1,this._finished=!1},t.prototype._getStyle=function(e){e===void 0&&(e={});var i=Object.create(null),o=Object.create(null);return Object.keys(e).forEach(function(u){rC.includes(u)?o[u]=e[u]:iC.includes(u)&&(i[u.replace("stroke","line")]=e[u])}),{fill:o,stroke:i}},t.prototype._initFinishedStyle=function(e){e===void 0&&(e={});var i=this._getStyle(e);this._finishedStyle={fill:nt(nt({},this._style.fill),i.fill),stroke:nt(nt(nt({},this._style.stroke),{"line-dasharray":[1,0]}),i.stroke)}},t.prototype._initStyle=function(e){e===void 0&&(e={});var i=this._getStyle(e);this._style={fill:nt(nt({},n_),i.fill),stroke:nt(nt({},ay),i.stroke)}},t.prototype._initLayer=function(e){var i,o,u,s;(i=this._strokeLayer)===null||i===void 0||i.remove(),(o=this._fillLayer)===null||o===void 0||o.remove(),this._fillLayer=new Ii({id:"circle-area-picker-fill-".concat(this._id),type:"fill",data:this._getFillSourceData(),paint:e.fill}),this._strokeLayer=new Ii({id:"circle-area-picker-stroke-".concat(this._id),type:"line",data:this._getStrokeSourceData(),paint:e.stroke}),(u=this._fillLayer)===null||u===void 0||u.addTo(this._map),(s=this._strokeLayer)===null||s===void 0||s.addTo(this._map)},t.prototype._getStrokeSourceData=function(){return this._strokeCoordinates.length>1?Ir([Yi(this._strokeCoordinates)]):Ir([])},t.prototype._getFillSourceData=function(){return this._fillCoordinates.length>3?es([this._fillCoordinates]):Ir([])},t.prototype._setEventListeners=function(e){e===void 0&&(e="on"),this._map[e]("dblclick",this._onMapDoubleClick),this._map[e]("mousedown",this._onMouseDown),this._map[e]("mouseup",this._onMouseUp),this._map[e]("mousemove",this._onMouseMove)},t.prototype._onMouseDown=function(e){this._finished||(this._picking=!0,this._center=e.lngLat.toArray(),e.preventDefault())},t.prototype._onMouseUp=function(){this._finished||(this._picking=!1,this._fillCoordinates.length&&(this._finished=!0,this._setFinishedStyle(),this.fire("finish",{data:$e(this._data),center:Yt([],this._center,!0),radius:this._radius,acreage:dc(this._data)})))},t.prototype._onMapDoubleClick=function(e){e.preventDefault()},t.prototype._onMouseMove=function(e){if(!this._finished&&this._picking){var i={units:"kilometers"};this._radius=Uf(this._center,e.lngLat.toArray(),i);var o=jg(this._center,this._radius,nt(nt({},i),{steps:this._steps}));dc(o)===0?(this._fillCoordinates=[],this._strokeCoordinates=[]):(this._fillCoordinates=Yt([],o.geometry.coordinates[0],!0),this._strokeCoordinates=Yt([],this._fillCoordinates,!0)),this._updateStroke(),this._updateFill()}},t.prototype._updateStroke=function(){var e;(e=this._strokeLayer)===null||e===void 0||e.setData(this._getStrokeSourceData())},t.prototype._updateFill=function(){var e;this._data=this._getFillSourceData(),(e=this._fillLayer)===null||e===void 0||e.setData($e(this._data))},t.prototype._setFinishedStyle=function(){this._initLayer(this._finishedStyle)},t}(be.Evented),nC={"circle-color":"#f00","circle-radius":5,"circle-pitch-alignment":"map","circle-pitch-scale":"map"},oC={"icon-allow-overlap":!0,"icon-ignore-placement":!0,"icon-pitch-alignment":"map","icon-rotation-alignment":"map"},aC=["fill-opacity","fill-color"],sC=["stroke-opacity","stroke-color","stroke-width","stroke-blur","stroke-dasharray"],z0=["meters","kilometers"],YC=function(n){function t(e){var i,o=n.call(this)||this;return o._id=mi(),o._center=e==null?void 0:e.center,o._radius=(e==null?void 0:e.radius)&&e.radius>0?e.radius:5,o._units=(e==null?void 0:e.units)&&z0.includes(e.units)?e.units:"kilometers",o._steps=(e==null?void 0:e.steps)&&e.steps>2?e.steps:64,o._manual=(i=e.manual)!==null&&i!==void 0&&i,o._initData(),o._initStyle(e.style),o._initLayer(e.centerLayer?nt({show:!0,type:"circle"},e.centerLayer):{show:!0,type:"circle"}),vi(["_onMapClick"],o),o}return br(t,n),Object.defineProperty(t.prototype,"center",{get:function(){return this._center},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){var i,o,u;return e===this._map||(this.remove(),this._map=e,(i=this._strokeLayer)===null||i===void 0||i.addTo(e).setData(this._bufferData),(o=this._fillLayer)===null||o===void 0||o.addTo(e).setData(this._bufferData),(u=this._centerLayer)===null||u===void 0||u.addTo(e).setData(this._centerData),this._manual&&(this._map.on("click",this._onMapClick),this._map.getCanvas().style.cursor="crosshair")),this},t.prototype.remove=function(){var e,i,o;return this._map&&((e=this._strokeLayer)===null||e===void 0||e.remove(),(i=this._fillLayer)===null||i===void 0||i.remove(),(o=this._centerLayer)===null||o===void 0||o.remove(),this._manual&&(this._map.off("click",this._onMapClick),this._map.getCanvas().style.cursor=""),this._map=void 0),this},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype.clear=function(){return this._center=void 0,this._update(),this},t.prototype.setOptions=function(e){return e.center&&(this._center=e.center),e.radius&&(this._radius=e.radius),e.units&&z0.includes(e.units)&&(this._units=e.units),e.steps&&e.steps>2&&(this._steps=e.steps),this._update(),this},t.prototype.getData=function(){return this._center?$e(this._bufferData):null},t.prototype._initStyle=function(e){e===void 0&&(e={});var i=Object.create(null),o=Object.create(null);Object.keys(e).forEach(function(u){aC.includes(u)?o[u]=e[u]:sC.includes(u)&&(i[u.replace("stroke","line")]=e[u])}),this._style={fill:o,stroke:i}},t.prototype._getCirclePaint=function(e){var i=Object.create(null);return Object.keys(e).forEach(function(o){Bf.includes(o)&&(i[o]=e[o])}),i},t.prototype._getSymbolStyle=function(e){var i=Object.create(null),o=Object.create(null);return Object.keys(e).forEach(function(u){sy.includes(u)?o[u]=e[u]:uy.includes(u)&&(i[u]=e[u])}),o.visibility="visible",{paint:i,layout:o}},t.prototype._initLayer=function(e){var i,o;this._fillLayer=new Ii({id:"buffer-fill-".concat(this._id),type:"fill",paint:this._style.fill}),this._strokeLayer=new Ii({id:"buffer-stroke-".concat(this._id),type:"line",paint:this._style.stroke}),e.show&&e.type!=="symbol"&&(this._centerLayer=new Ii({id:"buffer-center-".concat(this._id),type:"circle",paint:this._getCirclePaint(nt(nt({},nC),(i=e==null?void 0:e.style)!==null&&i!==void 0?i:{}))})),e.show&&e.type==="symbol"&&(this._centerLayer=new Ii(nt({id:"buffer-center-".concat(this._id),type:"symbol"},this._getSymbolStyle(nt(nt({},oC),(o=e.style)!==null&&o!==void 0?o:{})))))},t.prototype._onMapClick=function(e){this._center=e.lngLat.toArray(),this._update(),this.fire("change",{center:e.lngLat,radius:this._radius,units:this._units,buffer:$e(this._bufferData)})},t.prototype._update=function(){var e,i,o;this._initData(),(e=this._fillLayer)===null||e===void 0||e.setData(this._bufferData),(i=this._strokeLayer)===null||i===void 0||i.setData(this._bufferData),(o=this._centerLayer)===null||o===void 0||o.setData(this._centerData)},t.prototype._initData=function(){this._center?(this._centerData=Me(this._center),this._bufferData=jg(this._center,this._radius,{units:this._units,steps:this._steps})):(this._centerData=Ir([]),this._bufferData=Ir([]))},t}(be.Evented),B0={"circle-color":"#000000","circle-radius":5,"circle-blur":0,"circle-opacity":1,"circle-stroke-width":0,"circle-stroke-color":"#000000","circle-stroke-opacity":1};(function(n){function t(e){var i,o,u=n.call(this)||this;return u._styleMap=new Map,u._clickHighlightPropVal=void 0,u._hoverHighlightPropVal=void 0,u._expressionMap=new Map,u._id=mi(),u._layerId="circle-cluster-layer-point-".concat(u._id),u._clusterLayerId="circle-cluster-layer-cluster-".concat(u._id),u._clusterLabelLayerId="circle-cluster-label-layer-cluster-".concat(u._id),u._key=(i=e.key)!==null&&i!==void 0?i:"id",u._data=e.data,u._styleOptions=e.style,u._clusterStyleOptions=e.clusterStyle,u._clusterRadius=(o=e.clusterRadius)!==null&&o!==void 0?o:250,u._highlightOptions=e.highlightOptions,u._fitBoundsOptions=u._getFitBoundsOptions(e.fitBoundsOptions),u._setLngLatBounds(),u._highlightOptions&&u._initHighlight(),vi(["_onClick","_onClusterClick","_onMouseEnter","_onMouseMove","_onMouseLeave","_OnData"],u),u}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._addLayerAndSource(),this._setEventListeners("on"),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.remove=function(){return this._map&&(this._setEventListeners("off"),this._removeLayerAndSource(),this._clickHighlightPropVal=void 0,this._hoverHighlightPropVal=void 0,this._map=void 0),this},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype.setData=function(e){if(this._data=e,this._setLngLatBounds(),this._map){this.removeHighlight();var i=this._map.getSource(this._layerId);i==null||i.setData(this._data),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)}return this},t.prototype.setHighlight=function(e){return this._map&&this._highlightOptions&&(this._highlightOptions.trigger==="hover"?this._hoverHighlightPropVal=e:this._clickHighlightPropVal=e,this._setHighlight()),this},t.prototype.removeHighlight=function(){return this._map&&this._highlightOptions&&this._removeHighlight(),this},t.prototype.easeTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.easeTo(nt(nt({},i),{center:o.geometry.coordinates})),this},t.prototype.flyTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.flyTo(nt(nt({},i||{}),{center:o.geometry.coordinates})),this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&((i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,e||this._fitBoundsOptions||{})),this},t.prototype._getFeature=function(e){var i,o;if(this._data){var u=(i=this._map)===null||i===void 0?void 0:i.querySourceFeatures(this._layerId,{sourceLayer:this._layerId,filter:["==",["get",this._key],e]})[0];if(u)return u;for(var s=0;s<this._data.features.length;s++)if(((o=this._data.features[s].properties)===null||o===void 0?void 0:o[this._key])===e){u=this._data.features[s];break}return u}},t.prototype._setLngLatBounds=function(){this._lngLatBounds=this._data.features.length>0?Xr(zr(this._data)).bbox:null},t.prototype._initHighlight=function(){var e=this;Object.keys(B0).forEach(function(o){var u,s=e._highlightOptions.style[o];s!==void 0&&e._styleMap.set(o,[s,(u=e._styleOptions[o])!==null&&u!==void 0?u:B0[o]])});var i="".concat(this._id,"-invalidHighlightPropVal");this._expressionMap.set("click",function(){var o;return["==",["get",e._key],(o=e._clickHighlightPropVal)!==null&&o!==void 0?o:i]}),this._expressionMap.set("hover",function(){var o;return["==",["get",e._key],(o=e._hoverHighlightPropVal)!==null&&o!==void 0?o:i]}),this._expressionMap.set("both",function(){var o,u;return["any",["==",["get",e._key],(o=e._clickHighlightPropVal)!==null&&o!==void 0?o:i],["==",["get",e._key],(u=e._hoverHighlightPropVal)!==null&&u!==void 0?u:i]]})},t.prototype._getFitBoundsOptions=function(e){return e?e===!0?{}:e:void 0},t.prototype._addLayerAndSource=function(){var e;if(this._map){this._map.getSource(this._layerId)||this._map.addSource(this._layerId,{type:"geojson",generateId:!0,data:this._data,cluster:!0,clusterRadius:(e=this._clusterRadius)!==null&&e!==void 0?e:50});var i=this._getStyle(this._clusterStyleOptions),o=i.textStyle,u=i.circleStyle;this._map.getLayer(this._clusterLayerId)||this._map.addLayer(nt({id:this._clusterLayerId,type:"circle",source:this._layerId,filter:["has","cluster_id"]},u)),this._map.getLayer(this._clusterLabelLayerId)||this._map.addLayer(nt({id:this._clusterLabelLayerId,type:"symbol",source:this._layerId,filter:["has","cluster_id"]},o)),this._map.getLayer(this._layerId)||this._map.addLayer({id:this._layerId,type:"circle",source:this._layerId,filter:["!",["has","cluster_id"]],paint:this._getPaint(this._styleOptions),layout:{visibility:"visible"}}),this._highlightOptions&&this._setHighlight()}},t.prototype._getPaint=function(e){var i=Object.create(null);return Object.keys(e).forEach(function(o){Bf.includes(o)&&(i[o]=e[o])}),i},t.prototype._getStyle=function(e){var i=Object.create(null),o=Object.create(null),u=Object.create(null),s=Object.create(null);return Object.keys(e).forEach(function(y){jI.includes(y)?o[y]=e[y]:GI.includes(y)?i[y]=e[y]:Bf.includes(y)&&(u[y]=e[y])}),o.visibility="visible",s.visibility="visible",{textStyle:{paint:i,layout:o},circleStyle:{paint:u,layout:s}}},t.prototype._OnData=function(e){var i=this;e.dataType==="style"&&setTimeout(function(){i._addLayerAndSource()},10)},t.prototype._setEventListeners=function(e){e===void 0&&(e="on"),this._map[e]("click",this._layerId,this._onClick),this._map[e]("click",this._clusterLayerId,this._onClusterClick),this._map[e]("mouseenter",this._layerId,this._onMouseEnter),this._map[e]("mousemove",this._layerId,this._onMouseMove),this._map[e]("mouseleave",this._layerId,this._onMouseLeave),this._map[e]("data",this._OnData)},t.prototype._onClusterClick=function(e){var i,o,u=this,s=e.features[0];this._map.getSource(this._layerId).getClusterLeaves((i=s.properties)===null||i===void 0?void 0:i.cluster_id,(o=s.properties)===null||o===void 0?void 0:o.point_count,0,function(y,v){y||u.fire("cluster-click",{points:v==null?void 0:v.map(function(S){return u._getPoint(S)})})})},t.prototype._getPoint=function(e){return{data:nt({},e.properties),lngLat:new be.LngLat(e.geometry.coordinates[0],e.geometry.coordinates[1])}},t.prototype._onClick=function(e){var i,o,u,s=this,y=e.features[0];if(this.fire("click",nt(nt({},this._getPoint(y)),{originalMapEvent:e,points:(i=e.features)===null||i===void 0?void 0:i.map(function(S){return s._getPoint(S)})})),((o=this._highlightOptions)===null||o===void 0?void 0:o.trigger)==="click"||((u=this._highlightOptions)===null||u===void 0?void 0:u.trigger)==="both"){var v=y.properties[this._key];this._clickHighlightPropVal!==v&&(this._clickHighlightPropVal=v,this._setHighlight())}},t.prototype._onMouseEnter=function(e){var i,o=(i=e.features)===null||i===void 0?void 0:i[0];this.fire("mouseenter",nt(nt({},this._getPoint(o)),{originalMapEvent:e})),this._map.getCanvas().style.cursor="pointer"},t.prototype._onMouseMove=function(e){var i,o,u,s=(i=e.features)===null||i===void 0?void 0:i[0];if(this.fire("mousemove",nt(nt({},this._getPoint(s)),{originalMapEvent:e})),((o=this._highlightOptions)===null||o===void 0?void 0:o.trigger)==="hover"||((u=this._highlightOptions)===null||u===void 0?void 0:u.trigger)==="both"){var y=e.features[0].properties[this._key];this._hoverHighlightPropVal!==y&&(this._hoverHighlightPropVal=y,this._setHighlight())}},t.prototype._onMouseLeave=function(e){var i,o;this.fire("mouseleave",{originalMapEvent:e}),this._map.getCanvas().style.cursor="",((i=this._highlightOptions)===null||i===void 0?void 0:i.trigger)==="hover"&&(this._hoverHighlightPropVal=void 0,this._removeHighlight()),((o=this._highlightOptions)===null||o===void 0?void 0:o.trigger)==="both"&&(this._hoverHighlightPropVal=void 0,this._setHighlight())},t.prototype._setHighlight=function(){var e=this,i=this._expressionMap.get(this._highlightOptions.trigger)();this._styleMap.forEach(function(o,u){e._map.setPaintProperty(e._layerId,u,Yt(["case",i],o,!0))}),this._map.setLayoutProperty(this._layerId,"circle-sort-key",["case",i,2,0])},t.prototype._removeHighlight=function(){this._clickHighlightPropVal=void 0,this._hoverHighlightPropVal=void 0,this._setHighlight()},t.prototype._removeLayerAndSource=function(){var e,i,o,u;!((e=this._map)===null||e===void 0)&&e.getLayer(this._layerId)&&this._map.removeLayer(this._layerId),!((i=this._map)===null||i===void 0)&&i.getLayer(this._clusterLayerId)&&this._map.removeLayer(this._clusterLayerId),!((o=this._map)===null||o===void 0)&&o.getLayer(this._clusterLabelLayerId)&&this._map.removeLayer(this._clusterLabelLayerId),!((u=this._map)===null||u===void 0)&&u.getSource(this._layerId)&&this._map.removeSource(this._layerId)},t})(be.Evented);var V0={"icon-image":"","icon-size":1,"icon-offset":[0,0],"text-field":"","text-size":16,"text-offset":[0,0]},U0={"icon-opacity":1,"icon-color":"#000000","icon-halo-color":"rgba(0,0,0,0)","icon-halo-width":0,"icon-halo-blur":0,"text-opacity":1,"text-color":"#000000","text-halo-color":"rgba(0,0,0,0)","text-halo-width":1,"text-halo-blur":1};(function(n){function t(e){var i,o,u=n.call(this)||this;return u._layoutStyleMap=new Map,u._paintStyleMap=new Map,u._clickHighlightPropVal=void 0,u._hoverHighlightPropVal=void 0,u._expressionMap=new Map,u._id=mi(),u._layerId="symbol-cluster-layer-point-".concat(u._id),u._clusterLayerId="symbol-cluster-layer-cluster-".concat(u._id),u._key=(i=e.key)!==null&&i!==void 0?i:"id",u._data=e.data,u._styleOptions=e.style,u._clusterStyleOptions=e.clusterStyle,u._clusterRadius=(o=e.clusterRadius)!==null&&o!==void 0?o:250,u._highlightOptions=e.highlightOptions,u._fitBoundsOptions=u._getFitBoundsOptions(e.fitBoundsOptions),u._setLngLatBounds(),u._highlightOptions&&u._initHighlight(),vi(["_onClick","_onClusterClick","_onMouseEnter","_onMouseMove","_onMouseLeave","_onData"],u),u}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._addLayerAndSource(),this._setEventListeners("on"),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.remove=function(){return this._map&&(this._setEventListeners("off"),this._removeLayerAndSource(),this._clickHighlightPropVal=void 0,this._hoverHighlightPropVal=void 0,this._map=void 0),this},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype.setData=function(e){if(this._data=e,this._setLngLatBounds(),this._map){this.removeHighlight();var i=this._map.getSource(this._layerId);i==null||i.setData(this._data),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)}return this},t.prototype.setHighlight=function(e){return this._map&&this._highlightOptions&&(this._highlightOptions.trigger==="hover"?this._hoverHighlightPropVal=e:this._clickHighlightPropVal=e,this._setHighlight()),this},t.prototype.removeHighlight=function(){return this._map&&this._highlightOptions&&this._removeHighlight(),this},t.prototype.easeTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.easeTo(nt(nt({},i),{center:o.geometry.coordinates})),this},t.prototype.flyTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.flyTo(nt(nt({},i||{}),{center:o.geometry.coordinates})),this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&((i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,e||this._fitBoundsOptions||{})),this},t.prototype._getFeature=function(e){var i,o;if(this._data){var u=(i=this._map)===null||i===void 0?void 0:i.querySourceFeatures(this._layerId,{sourceLayer:this._layerId,filter:["==",["get",this._key],e]})[0];if(u)return u;for(var s=0;s<this._data.features.length;s++)if(((o=this._data.features[s].properties)===null||o===void 0?void 0:o[this._key])===e){u=this._data.features[s];break}return u}},t.prototype._setLngLatBounds=function(){this._lngLatBounds=this._data.features.length>0?Xr(zr(this._data)).bbox:null},t.prototype._initHighlight=function(){var e=this;Object.keys(V0).forEach(function(o){var u,s=e._highlightOptions.style[o];s!==void 0&&e._layoutStyleMap.set(o,[s,(u=e._styleOptions[o])!==null&&u!==void 0?u:V0[o]])}),Object.keys(U0).forEach(function(o){var u,s=e._highlightOptions.style[o];s!==void 0&&e._paintStyleMap.set(o,[s,(u=e._styleOptions[o])!==null&&u!==void 0?u:U0[o]])});var i="".concat(this._id,"-invalidHighlightPropVal");this._expressionMap.set("click",function(){var o;return["==",["get",e._key],(o=e._clickHighlightPropVal)!==null&&o!==void 0?o:i]}),this._expressionMap.set("hover",function(){var o;return["==",["get",e._key],(o=e._hoverHighlightPropVal)!==null&&o!==void 0?o:i]}),this._expressionMap.set("both",function(){var o,u;return["any",["==",["get",e._key],(o=e._clickHighlightPropVal)!==null&&o!==void 0?o:i],["==",["get",e._key],(u=e._hoverHighlightPropVal)!==null&&u!==void 0?u:i]]})},t.prototype._getFitBoundsOptions=function(e){return e?e===!0?{}:e:void 0},t.prototype._addLayerAndSource=function(){var e;this._map&&(this._map.getSource(this._layerId)||this._map.addSource(this._layerId,{type:"geojson",generateId:!0,data:this._data,cluster:!0,clusterRadius:(e=this._clusterRadius)!==null&&e!==void 0?e:50}),this._map.getLayer(this._clusterLayerId)||this._map.addLayer(nt({id:this._clusterLayerId,type:"symbol",source:this._layerId,filter:["has","cluster_id"]},this._getStyle(this._clusterStyleOptions))),this._map.getLayer(this._layerId)||this._map.addLayer(nt({id:this._layerId,type:"symbol",source:this._layerId,filter:["!",["has","cluster_id"]]},this._getStyle(this._styleOptions))),this._highlightOptions&&this._setHighlight())},t.prototype._getStyle=function(e){var i=Object.create(null),o=Object.create(null);return Object.keys(e).forEach(function(u){sy.includes(u)?o[u]=e[u]:uy.includes(u)&&(i[u]=e[u])}),o.visibility="visible",{paint:i,layout:o}},t.prototype._onData=function(e){var i=this;e.dataType==="style"&&setTimeout(function(){i._addLayerAndSource()},10)},t.prototype._setEventListeners=function(e){e===void 0&&(e="on"),this._map[e]("click",this._layerId,this._onClick),this._map[e]("click",this._clusterLayerId,this._onClusterClick),this._map[e]("mouseenter",this._layerId,this._onMouseEnter),this._map[e]("mousemove",this._layerId,this._onMouseMove),this._map[e]("mouseleave",this._layerId,this._onMouseLeave),this._map[e]("data",this._onData)},t.prototype._onClusterClick=function(e){var i,o,u=this,s=e.features[0];this._map.getSource(this._layerId).getClusterLeaves((i=s.properties)===null||i===void 0?void 0:i.cluster_id,(o=s.properties)===null||o===void 0?void 0:o.point_count,0,function(y,v){y||u.fire("cluster-click",{points:v==null?void 0:v.map(function(S){return u._getPoint(S)})})})},t.prototype._getPoint=function(e){return{data:nt({},e.properties),lngLat:new be.LngLat(e.geometry.coordinates[0],e.geometry.coordinates[1])}},t.prototype._onClick=function(e){var i,o,u,s=this,y=e.features[0];if(this.fire("click",nt(nt({},this._getPoint(y)),{originalMapEvent:e,points:(i=e.features)===null||i===void 0?void 0:i.map(function(S){return s._getPoint(S)})})),((o=this._highlightOptions)===null||o===void 0?void 0:o.trigger)==="click"||((u=this._highlightOptions)===null||u===void 0?void 0:u.trigger)==="both"){var v=y.properties[this._key];this._clickHighlightPropVal!==v&&(this._clickHighlightPropVal=v,this._setHighlight())}},t.prototype._onMouseEnter=function(e){var i,o=(i=e.features)===null||i===void 0?void 0:i[0];this.fire("mouseenter",nt(nt({},this._getPoint(o)),{originalMapEvent:e})),this._map.getCanvas().style.cursor="pointer"},t.prototype._onMouseMove=function(e){var i,o,u,s=(i=e.features)===null||i===void 0?void 0:i[0];if(this.fire("mousemove",nt(nt({},this._getPoint(s)),{originalMapEvent:e})),((o=this._highlightOptions)===null||o===void 0?void 0:o.trigger)==="hover"||((u=this._highlightOptions)===null||u===void 0?void 0:u.trigger)==="both"){var y=e.features[0].properties[this._key];this._hoverHighlightPropVal!==y&&(this._hoverHighlightPropVal=y,this._setHighlight())}},t.prototype._onMouseLeave=function(e){var i,o;this.fire("mouseleave",{originalMapEvent:e}),this._map.getCanvas().style.cursor="",((i=this._highlightOptions)===null||i===void 0?void 0:i.trigger)==="hover"&&(this._hoverHighlightPropVal=void 0,this._removeHighlight()),((o=this._highlightOptions)===null||o===void 0?void 0:o.trigger)==="both"&&(this._hoverHighlightPropVal=void 0,this._setHighlight())},t.prototype._setHighlight=function(){var e=this,i=this._expressionMap.get(this._highlightOptions.trigger)();this._paintStyleMap.forEach(function(o,u){e._map.setPaintProperty(e._layerId,u,Yt(["case",i],o,!0))}),this._layoutStyleMap.forEach(function(o,u){e._map.setLayoutProperty(e._layerId,u,Yt(["case",i],o,!0))}),this._map.setLayoutProperty(this._layerId,"symbol-sort-key",["case",i,2,0])},t.prototype._removeHighlight=function(){this._clickHighlightPropVal=void 0,this._hoverHighlightPropVal=void 0,this._setHighlight()},t.prototype._removeLayerAndSource=function(){var e,i,o;!((e=this._map)===null||e===void 0)&&e.getLayer(this._layerId)&&this._map.removeLayer(this._layerId),!((i=this._map)===null||i===void 0)&&i.getLayer(this._clusterLayerId)&&this._map.removeLayer(this._clusterLayerId),!((o=this._map)===null||o===void 0)&&o.getSource(this._layerId)&&this._map.removeSource(this._layerId)},t})(be.Evented);var uC={"circle-color":"#f00","circle-radius":5,"circle-pitch-alignment":"map","circle-pitch-scale":"map"},lC={"icon-allow-overlap":!0,"icon-ignore-placement":!0,"icon-pitch-alignment":"map","icon-rotation-alignment":"map"},cC={"line-width":5,"line-color":"#f00","line-cap":"round","line-join":"round"},hC={"line-width":5,"line-color":"#0f0","line-cap":"round","line-join":"round"};(function(n){function t(e){var i,o,u,s,y=n.call(this)||this;return y._id=mi(),y._data=e.data,y._isFull=(o=(i=e.pathLayer)===null||i===void 0?void 0:i.isFull)===null||o===void 0||o,y._units="kilometers",y._speed=(u=e.speed)!==null&&u!==void 0?u:5,y._loop=(s=e.loop)===null||s===void 0||s,y._originPathLayerData=Yi(y._data),y._initLength(),y._initState(),y._layerOptions={carLayer:e.carLayer?nt({show:!1,type:"circle"},e.carLayer):{show:!1,type:"circle"},currentPathLayer:e.currentPathLayer?nt({show:!0},e.currentPathLayer):{show:!0},pathLayer:e.pathLayer?nt({show:!0},e.pathLayer):{show:!0}},y._fitBoundsOptions=y._getFitBoundsOptions(e.fitBoundsOptions),y._lngLatBounds=Xr(zr(y._originPathLayerData)).bbox,vi(["_animate"],y),y}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._initLayer(),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.remove=function(){var e,i,o;return this._map&&(cancelAnimationFrame(this._fRecord),this._initState(),(e=this._pathLayer)===null||e===void 0||e.remove(),(i=this._currentPathLayer)===null||i===void 0||i.remove(),(o=this._carLayer)===null||o===void 0||o.remove(),this._map=void 0),this},t.prototype.setSpeed=function(e){return this._speed=e,this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&((i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,e||this._fitBoundsOptions||{})),this},t.prototype.stop=function(){var e,i,o;cancelAnimationFrame(this._fRecord),this._initState(),(e=this._carLayer)===null||e===void 0||e.setData(this._carLayerData),(i=this._currentPathLayer)===null||i===void 0||i.setData(Ir([])),this._isFull||(o=this._pathLayer)===null||o===void 0||o.setData(this._originPathLayerData)},t.prototype.play=function(){this._isPlaying||(this._finished&&this._initState(),this._isPlaying=!0,this._fRecord=requestAnimationFrame(this._animate))},t.prototype.pause=function(){this._isPlaying&&(this._isPlaying=!1,cancelAnimationFrame(this._fRecord),this._pending=!0)},t.prototype.replay=function(){cancelAnimationFrame(this._fRecord),this._initState(),this.play()},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype._initState=function(){this._current=0,this._isPlaying=!1,this._startTime=0,this._finished=!1,this._currentLength=0,this._pending=!1,this._bearing=Ef(Me(this._data[0]),Me(this._data[1])),this._carLayerData=Me(this._data[0],{bearing:this._bearing}),this._currentPathLayerData=void 0},t.prototype._initLength=function(){var e=this;this._pointLength=[];var i=0;this._data.forEach(function(o,u){if(u!==0){var s=Uf(Me(o),Me(e._data[u-1]),{units:e._units});i+=s}e._pointLength.push(i)}),this._routeLength=i},t.prototype._animate=function(e){var i,o,u,s;if(this._pending)return this._pending=!1,this._startTime=e,void(this._fRecord=requestAnimationFrame(this._animate));var y=void 0;if(this._startTime===0)this._startTime=e,y=this._originPathLayerData;else{var v=e-this._startTime;if(this._startTime=e,this._currentLength+=v/1e3*this._speed,this._currentLength>=this._routeLength)this._carLayerData=Me(this._data[this._data.length-1]),this._currentLength=this._routeLength,this._finished=!0,this._currentPathLayerData=this._originPathLayerData;else{this._carLayerData=ix(this._originPathLayerData,this._currentLength);for(var S=this._current;S<this._pointLength.length&&!(this._pointLength[S]>this._currentLength);)S++;S!==this._current&&(this._current=S,this._bearing=Ef(this._carLayerData,Me(this._data[this._current]))),this._currentPathLayerData=Yi(Yt(Yt([],this._data.slice(0,this._current),!0),[this._carLayerData.geometry.coordinates],!1)),y=Yi(Yt([this._carLayerData.geometry.coordinates],this._data.slice(this._current),!0))}}this._carLayerData.properties={bearing:this._bearing},(i=this._carLayer)===null||i===void 0||i.setData(this._carLayerData),this._isFull||(o=this._pathLayer)===null||o===void 0||o.setData(y!=null?y:Ir([])),(u=this._currentPathLayer)===null||u===void 0||u.setData((s=this._currentPathLayerData)!==null&&s!==void 0?s:Ir([])),this._finished&&(this._loop?(this._initState(),this._isPlaying=!0):(this._isPlaying=!1,this.fire("finish"))),this._isPlaying&&(this._fRecord=requestAnimationFrame(this._animate))},t.prototype._getFitBoundsOptions=function(e){return e?e===!0?{}:e:void 0},t.prototype._getCirclePaint=function(e){var i=Object.create(null);return Object.keys(e).forEach(function(o){Bf.includes(o)&&(i[o]=e[o])}),i},t.prototype._getSymbolStyle=function(e){var i=Object.create(null),o=Object.create(null);return Object.keys(e).forEach(function(u){sy.includes(u)?o[u]=e[u]:uy.includes(u)&&(i[u]=e[u])}),o.visibility="visible",{paint:i,layout:o}},t.prototype._getPathStyle=function(e){var i=Object.create(null),o=Object.create(null);return Object.keys(e).forEach(function(u){w1.includes(u)?o[u]=e[u]:b1.includes(u)&&(i[u]=e[u])}),o.visibility="visible",{paint:i,layout:o}},t.prototype._initLayer=function(){var e,i,o,u,s,y,v,S=this._layerOptions,L=S.carLayer,k=S.currentPathLayer,N=S.pathLayer;N.show&&(this._pathLayer=new Ii(nt({id:"car-track-full-path-".concat(this._id),type:"line",data:this._originPathLayerData},this._getPathStyle(nt(nt({},hC),(e=N==null?void 0:N.style)!==null&&e!==void 0?e:{}))))),k.show&&(this._currentPathLayer=new Ii(nt({id:"car-track-current-path-".concat(this._id),type:"line"},this._getPathStyle(nt(nt({},cC),(i=k==null?void 0:k.style)!==null&&i!==void 0?i:{}))))),L.show&&L.type!=="symbol"&&(this._carLayer=new Ii({id:"car-track-car-".concat(this._id),type:"circle",data:this._carLayerData,paint:this._getCirclePaint(nt(nt({},uC),(o=L==null?void 0:L.style)!==null&&o!==void 0?o:{}))})),L.show&&L.type==="symbol"&&(this._carLayer=new Ii(nt({id:"car-track-car-".concat(this._id),type:"symbol",data:this._carLayerData},this._getSymbolStyle(nt(nt({},lC),(u=L.style)!==null&&u!==void 0?u:{}))))),(s=this._pathLayer)===null||s===void 0||s.addTo(this._map),(y=this._currentPathLayer)===null||y===void 0||y.addTo(this._map),(v=this._carLayer)===null||v===void 0||v.addTo(this._map)},t})(be.Evented);function Bg(n){return Bg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bg(n)}var pC=(typeof HTMLElement=="undefined"?"undefined":Bg(HTMLElement))==="object"?function(n){return n instanceof HTMLElement}:function(n){return n&&Bg(n)==="object"&&(n.nodeType===1||n.nodeType===9)&&typeof n.nodeName=="string"};function fC(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];if(!(arguments.length<2)){for(var e=[],i=0;i<arguments.length;i++)e.push(n[i]);var o=[];return e.forEach(function(v,S){o[S]=y.bind(null,v,e.filter(function(L,k){return k!==S}))}),u(),function(){s(),o=[],e=[]}}function u(){e.forEach(function(v,S){v.on("move",o[S])})}function s(){e.forEach(function(v,S){v.off("move",o[S])})}function y(v,S){s(),function(L,k){var N=L.getCenter(),Q=L.getZoom(),tt=L.getBearing(),xt=L.getPitch();k.forEach(function(mt){mt.jumpTo({center:N,zoom:Q,bearing:tt,pitch:xt})})}(v,S),u()}}(function(){function n(t){if(this._removed=!1,this._horizontal=Boolean(t.horizontal),typeof t.container=="string"){var e=document.querySelector(t.container);if(!e)throw new Error("Invalid container specified. Must be CSS selector or HTML element.");this._container=e}else{if(!pC(t.container))throw new Error("Invalid container specified. Must be CSS selector or HTML element.");this._container=t.container}this._container.classList.add("map-comparer-container"),this._container.style.position="relative";var i=document.createElement("div");i.classList.add("before-map-container"),i.style.position="absolute",i.style.width="100%",i.style.height="100%",this._container.appendChild(i);var o=document.createElement("div");o.classList.add("after-map-container"),o.style.position="absolute",o.style.width="100%",o.style.height="100%",this._container.appendChild(o),this._swiper=document.createElement("div"),this._swiper.className="comparer-swiper",this._controlContainer=document.createElement("div"),this._controlContainer.className=this._horizontal?"map-comparer-control comparer-control-horizontal":"map-comparer-control comparer-control-vertical",this._controlContainer.appendChild(this._swiper),this._container.appendChild(this._controlContainer),this._firstMap=new be.Map(nt(nt({},t.mapOptions),{style:t.firstMapStyle,container:i})),this._secondMap=new be.Map(nt(nt({},t.mapOptions),{style:t.secondMapStyle,container:o})),fC(this._firstMap,this._secondMap),vi(["_onResize","_onMove","_onDown","_onTouchEnd","_onMouseUp"],this),this._secondMap.on("resize",this._onResize),this._bounds=this._secondMap.getContainer().getBoundingClientRect();var u=(this._horizontal?this._bounds.height:this._bounds.width)/2;this._setPosition(u),this._mousemove&&(this._firstMap.getContainer().addEventListener("mousemove",this._onMove),this._secondMap.getContainer().addEventListener("mousemove",this._onMove)),this._swiper.addEventListener("mousedown",this._onDown),this._swiper.addEventListener("touchstart",this._onDown)}return Object.defineProperty(n.prototype,"firstMap",{get:function(){return this._firstMap},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"secondMap",{get:function(){return this._secondMap},enumerable:!1,configurable:!0}),n.prototype._onResize=function(){var t=this._horizontal?this._bounds.height:this._bounds.width,e=this.currentPosition/t;this._bounds=this._secondMap.getContainer().getBoundingClientRect(),t=this._horizontal?this._bounds.height:this._bounds.width,this._setPosition(t*e)},n.prototype._setPosition=function(t){t=Math.min(t,this._horizontal?this._bounds.height:this._bounds.width);var e=this._horizontal?"translate(0, "+t+"px)":"translate("+t+"px, 0)";this._controlContainer.style.transform=e,this._controlContainer.style.webkitTransform=e;var i=this._horizontal?"rect(0, 999em, "+t+"px, 0)":"rect(0, "+t+"px, "+this._bounds.height+"px, 0)",o=this._horizontal?"rect("+t+"px, 999em, "+this._bounds.height+"px,0)":"rect(0, 999em, "+this._bounds.height+"px,"+t+"px)";this._firstMap.getContainer().style.clip=i,this._secondMap.getContainer().style.clip=o,this.currentPosition=t},n.prototype._setPointerEvents=function(t){this._controlContainer.style.pointerEvents=t,this._swiper.style.pointerEvents=t},n.prototype._onMove=function(t){this._mousemove&&this._setPointerEvents(t.touches?"auto":"none"),this._horizontal?this._setPosition(this._getY(t)):this._setPosition(this._getX(t))},n.prototype._getY=function(t){var e=(t=t.touches?t.touches[0]:t).clientY-this._bounds.top;return e<0&&(e=0),e>this._bounds.height&&(e=this._bounds.height),e},n.prototype._getX=function(t){var e=(t=t.touches?t.touches[0]:t).clientX-this._bounds.left;return e<0&&(e=0),e>this._bounds.width&&(e=this._bounds.width),e},n.prototype._onTouchEnd=function(){document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd)},n.prototype._onMouseUp=function(){document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onMouseUp)},n.prototype._onDown=function(t){t.touches?(document.addEventListener("touchmove",this._onMove),document.addEventListener("touchend",this._onTouchEnd)):(document.addEventListener("mousemove",this._onMove),document.addEventListener("mouseup",this._onMouseUp))},n.prototype.setSlider=function(t){if(!this._removed){var e=this._horizontal?this._bounds.height:this._bounds.width;t>1?t=1:t<0&&(t=0),this._setPosition(t*e)}},n.prototype.remove=function(){var t,e;this._removed||((t=this._firstMap)===null||t===void 0||t.remove(),(e=this._secondMap)===null||e===void 0||e.remove(),this._container.innerHTML="",this._container.style.position="",this._container.classList.remove("map-comparer-container"),this._removed=!0)},n})();var q0={"fill-extrusion-opacity":1,"fill-extrusion-pattern":"","fill-extrusion-color":"#000000"},WC=function(n){function t(e){var i,o,u,s,y=n.call(this)||this;return y._lngLatBounds=null,y._styleMap=new Map,y._clickHighlightPropVal=void 0,y._hoverHighlightPropVal=void 0,y._expressionMap=new Map,y._radius=(i=e.radius)!==null&&i!==void 0?i:10,y._steps=(o=e.steps)!==null&&o!==void 0?o:64,y._key=(u=e.key)!==null&&u!==void 0?u:"id",y._id=mi(),y._layer=new Ii({id:"prismoid-layer-".concat(y._id),type:"fill-extrusion",layerCursor:"pointer",data:y._transformData(e.data),paint:y._getPaint(e.style),layout:{visibility:"visible"}}),y._fitBoundsOptions=y._getFitBoundsOptions(e.fitBoundsOptions),y._setLngLatBounds(e.data),y._highlightTrigger=(s=e.highlightOptions)===null||s===void 0?void 0:s.trigger,e.highlightOptions&&y._initHighlight(e.style,e.highlightOptions.style),vi(["_onClick","_onMouseMove","_onMouseLeave","_onMouseEnter"],y),y}return br(t,n),Object.defineProperty(t.prototype,"isOnMap",{get:function(){return Boolean(this._map)},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return e===this._map||(this.remove(),this._map=e,this._layer.addTo(e),this._highlightTrigger&&this._setHighlight(),this._setEventListeners("on"),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.remove=function(){return this._map&&(this._setEventListeners("off"),this._layer.remove(),this.removeHighlight(),this._map=void 0),this},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i),this},t.prototype.setData=function(e){return this._setLngLatBounds(e),this._layer.setData(this._transformData(e)),this._map&&(this.removeHighlight(),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.setHighlight=function(e){return this._map&&this._highlightTrigger?(this._highlightTrigger==="hover"?this._hoverHighlightPropVal=e:this._clickHighlightPropVal=e,this._setHighlight(),this):this},t.prototype.removeHighlight=function(){return this._map&&this._highlightTrigger&&this._removeHighlight(),this},t.prototype.easeTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.easeTo(nt(nt({},i),{center:JSON.parse(o.properties.originCoordinates)})),this},t.prototype.flyTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.flyTo(nt(nt({},i||{}),{center:JSON.parse(o.properties.originCoordinates)})),this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&((i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,e||this._fitBoundsOptions||{})),this},t.prototype._transformData=function(e){var i=this,o=e.features.filter(function(u){return u.geometry.type==="Point"}).map(function(u){return jg(u.geometry.coordinates,i._radius,{units:"meters",steps:i._steps,properties:nt(nt({},u.properties),{originCoordinates:u.geometry.coordinates})})});return Ir(o)},t.prototype._getFeature=function(e){var i,o=(i=this._layer.querySourceFeature({filter:["==",["get",this._key],e]}))===null||i===void 0?void 0:i[0];return o||(o=this._layer.queryFeatureFormData(this._key,e))},t.prototype._setLngLatBounds=function(e){this._lngLatBounds=e.features.length>0?Xr(zr(e)).bbox:null},t.prototype._initHighlight=function(e,i){var o=this;Object.keys(q0).forEach(function(s){var y,v=i[s];v!==void 0&&o._styleMap.set(s,[v,(y=e[s])!==null&&y!==void 0?y:q0[s]])});var u="".concat(this._id,"-invalidHighlightPropVal");this._expressionMap.set("click",function(){var s;return["==",["get",o._key],(s=o._clickHighlightPropVal)!==null&&s!==void 0?s:u]}),this._expressionMap.set("hover",function(){var s;return["==",["get",o._key],(s=o._hoverHighlightPropVal)!==null&&s!==void 0?s:u]}),this._expressionMap.set("both",function(){var s,y;return["any",["==",["get",o._key],(s=o._clickHighlightPropVal)!==null&&s!==void 0?s:u],["==",["get",o._key],(y=o._hoverHighlightPropVal)!==null&&y!==void 0?y:u]]})},t.prototype._getFitBoundsOptions=function(e){return e?e===!0?{}:e:void 0},t.prototype._getPaint=function(e){var i=Object.create(null);return Object.keys(e).forEach(function(o){HI.includes(o)&&(i[o]=e[o])}),i},t.prototype._setEventListeners=function(e){e===void 0&&(e="on"),this._layer[e]("click",this._onClick),this._layer[e]("mousemove",this._onMouseMove),this._layer[e]("mouseleave",this._onMouseLeave),this._layer[e]("mouseenter",this._onMouseEnter)},t.prototype._getPoint=function(e){var i=e.properties,o=i.originCoordinates,u=function(y,v){var S={};for(var L in y)Object.prototype.hasOwnProperty.call(y,L)&&v.indexOf(L)<0&&(S[L]=y[L]);if(y!=null&&typeof Object.getOwnPropertySymbols=="function"){var k=0;for(L=Object.getOwnPropertySymbols(y);k<L.length;k++)v.indexOf(L[k])<0&&Object.prototype.propertyIsEnumerable.call(y,L[k])&&(S[L[k]]=y[L[k]])}return S}(i,["originCoordinates"]),s=JSON.parse(o);return{data:u,lngLat:new be.LngLat(s[0],s[1])}},t.prototype._onClick=function(e){var i,o=(i=e.features)===null||i===void 0?void 0:i[0];if(this.fire("click",nt(nt({},this._getPoint(o)),{originalMapEvent:e})),this._highlightTrigger==="click"||this._highlightTrigger==="both"){var u=o.properties[this._key];this._clickHighlightPropVal!==u&&(this._clickHighlightPropVal=u,this._setHighlight())}},t.prototype._onMouseMove=function(e){var i,o,u,s=(i=e.features)===null||i===void 0?void 0:i[0];if(this.fire("mousemove",nt(nt({},this._getPoint(s)),{originalMapEvent:e})),this._highlightTrigger==="hover"||this._highlightTrigger==="both"){var y=(u=(o=e.features)===null||o===void 0?void 0:o[0].properties)===null||u===void 0?void 0:u[this._key];this._hoverHighlightPropVal!==y&&(this._hoverHighlightPropVal=y,this._setHighlight())}},t.prototype._onMouseLeave=function(e){this.fire("mouseleave",{originalMapEvent:e}),this._highlightTrigger==="hover"?(this._hoverHighlightPropVal=void 0,this._removeHighlight()):this._highlightTrigger==="both"&&(this._hoverHighlightPropVal=void 0,this._setHighlight())},t.prototype._onMouseEnter=function(e){var i,o=(i=e.features)===null||i===void 0?void 0:i[0];this.fire("mouseenter",nt(nt({},this._getPoint(o)),{originalMapEvent:e}))},t.prototype._setHighlight=function(){var e=this._expressionMap.get(this._highlightTrigger)(),i=Object.create(null),o=Object.create(null);this._styleMap.forEach(function(u,s){i[s]=Yt(["case",e],u,!0)}),this._layer.setStyle({paint:i,layout:o})},t.prototype._removeHighlight=function(){this._clickHighlightPropVal=void 0,this._hoverHighlightPropVal=void 0,this._setHighlight()},t}(be.Evented),dC=["none","click","hover","manual"];(function(n){function t(e){var i=n.call(this)||this;return e=hl(e),i._map=null,i._lngLatBounds=null,i._highlightFeatureId=null,i._source="advance-point-layer".concat(mi()),i._key=e.key||"id",i._data=e.data,i._layerPool=e.layerPool||{},i._layers=e.layers||[],i._highlightTrigger=e.highlightTrigger&&dC.includes(e.highlightTrigger)?e.highlightTrigger:"none",i._highlightLayers=i._highlightTrigger==="none"?[]:e.highlightLayers||[],i._cluster=e.cluster||!1,i._clusterLayers=i._cluster&&e.clusterLayers||[],i._clusterRadius=e.clusterRadius,i._clusterMaxZoom=e.clusterMaxZoom,i._clusterMinPoints=e.clusterMinPoints,i._clusterProperties=e.clusterProperties,i._maxzoom=e.maxzoom,i._fitBoundsOptions=e.fitBoundsOptions||!1,i._isMouseOver=!1,i._setLngLatBounds(),vi(["_onClick","_onMouseMove","_onData","_onMouseLeave"],i),i}return br(t,n),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layers",{get:function(){var e=this;return this._layers.map(function(i){return"".concat(e.source,"-").concat(i)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightLayers",{get:function(){var e=this;return this._highlightLayers.map(function(i){return"".concat(e.source,"-").concat(i,"-highlight")})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clusterLayers",{get:function(){var e=this;return this._clusterLayers.map(function(i){return"".concat(e.source,"-").concat(i,"-cluster")})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lngLatBounds",{get:function(){return this._lngLatBounds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerPool",{get:function(){var e=this,i={};return Object.keys(this._layerPool).forEach(function(o){e._layers.includes(o)&&(i["".concat(e.source,"-").concat(o)]=e._layerPool[o]),e._highlightLayers.includes(o)&&(i["".concat(e.source,"-").concat(o,"-highlight")]=e._layerPool[o]),e._clusterLayers.includes(o)&&(i["".concat(e.source,"-").concat(o,"-cluster")]=e._layerPool[o])}),i},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){if(this._map!==e)return this.remove(),this._map=e,this._addSourceAnyLayer(),this._handleEventListener("on"),this._fitBounds(),this},t.prototype.remove=function(){return this._map&&(this._highlightFeatureId=null,this._lngLatBounds=null,this._isMouseOver=!1,this._handleEventListener("off"),this._removeSourceAnyLayer(),this._removeCursor(),this._map=null),this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&(e=e||typeof this._fitBoundsOptions=="boolean"?{}:this._fitBoundsOptions,(i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,nt({},e))),this},t.prototype.setData=function(e){return this._highlightFeatureId=null,this._lngLatBounds=null,this._isMouseOver=!1,this._data=e,this._setLngLatBounds(),this._map&&(this._map.getSource(this.source).setData(e||Ir([])),this.removeHighlight(),this._fitBounds()),this},t.prototype.setHighlight=function(e){var i=this._highlightTrigger==="hover"?"none":this._highlightTrigger;this._setHighlight(e,i)},t.prototype.removeHighlight=function(){var e=this._highlightTrigger==="hover"?"none":this._highlightTrigger;this._setHighlight(void 0,e)},t.prototype.easeTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.easeTo(nt(nt({},i),{center:o.geometry.coordinates})),this},t.prototype.flyTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);return o&&this._map.flyTo(nt(nt({},i||{}),{center:o.geometry.coordinates})),this},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i)},t.prototype.fire=function(e,i){return n.prototype.fire.call(this,e,i)},t.prototype.once=function(e,i){return n.prototype.once.call(this,e,i)},t.prototype.off=function(e,i){return n.prototype.off.call(this,e,i)},t.prototype._getFeature=function(e){var i,o,u,s=this;if(this._data&&typeof this._data!="string"){var y=(o=(i=this._map)===null||i===void 0?void 0:i.querySourceFeatures(this.source,{filter:["==",["get",this._key],e]}))===null||o===void 0?void 0:o[0];return y||(this._data.type==="FeatureCollection"?y=this._data.features.find(function(v){var S;return((S=v.properties)===null||S===void 0?void 0:S[s._key])===e}):this._data.type==="Feature"&&((u=this._data.properties)===null||u===void 0?void 0:u[this._key])===e&&(y=$e(this._data)),y)}},t.prototype._fitBounds=function(){this._map&&this._fitBoundsOptions&&this._lngLatBounds&&this._map.fitBounds(this._lngLatBounds,nt({},this._fitBoundsOptions===!0?{}:this._fitBoundsOptions))},t.prototype._setLngLatBounds=function(){this._data&&typeof this._data!="string"?this._data.type==="FeatureCollection"?this._lngLatBounds=this._data.features.length>0?Xr(zr(this._data)).bbox:null:this._data.type==="Feature"?this._lngLatBounds=Xr(zr(this._data)).bbox:this._lngLatBounds=null:this._lngLatBounds=null},t.prototype._handleEventListener=function(e){this._map&&(this._map[e]("click",this._onClick),this._map[e]("mousemove",this._onMouseMove),this._map[e]("data",this._onData),e==="on"?this._map.getContainer().addEventListener("mouseleave",this._onMouseLeave):this._map.getContainer().removeEventListener("mouseleave",this._onMouseLeave))},t.prototype._onMouseLeave=function(){this._isMouseOver&&(this._isMouseOver=!1,this.fire("mouseleave"),this._setHighlight(void 0,"hover"),this._removeCursor())},t.prototype._onClick=function(e){var i,o,u=this;if(this._map){var s=this._getEventFeature(e.point);s&&(this._isDefault(s)&&this._setHighlight(s.id,"click"),this._isBasic(s)?this.fire("click",nt(nt({},this._getData(s)),{originMapEvent:e})):this._isClustered(s)&&this._map.getSource(this.source).getClusterLeaves((i=s.properties)===null||i===void 0?void 0:i.cluster_id,(o=s.properties)===null||o===void 0?void 0:o.point_count,0,function(y,v){if(!y){var S=s.geometry.coordinates;u.fire("cluster-click",{clusterLeaves:v==null?void 0:v.map(function(L){return u._getData(L)}),originMapEvent:e,lngLat:new be.LngLat(S[0],S[1])})}}))}},t.prototype._isDefault=function(e){return this.layers.includes(e.layer.id)},t.prototype._isBasic=function(e){return Yt(Yt([],this.layers,!0),this.highlightLayers,!0).includes(e.layer.id)},t.prototype._isClustered=function(e){return this.clusterLayers.includes(e.layer.id)},t.prototype._getData=function(e){var i=e.geometry.coordinates;return{data:nt({},e.properties),lngLat:new be.LngLat(i[0],i[1])}},t.prototype._setHighlight=function(e,i){var o=this;this._highlightTrigger===i&&i!=="none"&&this._map&&this._highlightFeatureId!==e&&(this._highlightFeatureId=e,this.layers.forEach(function(u){var s,y,v=o.layerPool[u];(s=o._map)===null||s===void 0||s.setFilter(u,["all",o._getGeometryFilter(),(y=v.filter)===null||y===void 0||y,["!",o._getHighlightFilter(e)],["!",o._getClusterFilter()]])}),this.highlightLayers.forEach(function(u){var s,y,v=o.layerPool[u];(s=o._map)===null||s===void 0||s.setFilter(u,["all",o._getGeometryFilter(),(y=v.filter)===null||y===void 0||y,o._getHighlightFilter(e),["!",o._getClusterFilter()]])}))},t.prototype._getEventFeature=function(e){var i;if(this._map){var o=this._map.queryRenderedFeatures(e,{layers:void 0});return((i=o[0])===null||i===void 0?void 0:i.source)===this.source?o[0]:void 0}},t.prototype._onMouseMove=function(e){var i=this._getEventFeature(e.point);if(i&&this._isBasic(i)){var o=nt(nt({},this._getData(i)),{originMapEvent:e});this._isMouseOver?this.fire("mousemove",o):(this.fire("mouseenter",o),this._isMouseOver=!0),this._addCursor(),this._setHighlight(i.id,"hover")}else this._isMouseOver&&(this.fire("mouseleave",{originMapEvent:e}),this._isMouseOver=!1,this._setHighlight(void 0,"hover"),this._removeCursor())},t.prototype._addCursor=function(){this._map&&!this._map.getContainer().classList.contains("mapbox-utils-advance-point-layer")&&this._map.getContainer().classList.add("mapbox-utils-advance-point-layer")},t.prototype._removeCursor=function(){this._map&&this._map.getContainer().classList.remove("mapbox-utils-advance-point-layer")},t.prototype._onData=function(e){var i=this;e.dataType==="style"&&setTimeout(function(){i._addSourceAnyLayer()},10)},t.prototype._addSourceAnyLayer=function(){var e=this;if(this._map){if(!this._map.getSource(this.source)){var i={data:this._data||Ir([]),type:"geojson",promoteId:this._key};this._cluster!==void 0&&(i.cluster=this._cluster),this._clusterMaxZoom!==void 0&&(i.clusterMaxZoom=this._clusterMaxZoom),this._clusterMinPoints!==void 0&&(i.clusterMinPoints=this._clusterMinPoints),this._clusterProperties!==void 0&&(i.clusterProperties=this._clusterProperties),this._clusterRadius!==void 0&&(i.clusterRadius=this._clusterRadius),this._maxzoom!==void 0&&(i.maxzoom=this._maxzoom),this._map.addSource(this.source,i)}this.layers.forEach(function(o){var u,s,y;if(!(!((u=e._map)===null||u===void 0)&&u.getLayer(o))){var v=e.layerPool[o];(s=e._map)===null||s===void 0||s.addLayer(nt(nt({},v),{id:o,source:e.source,filter:["all",e._getGeometryFilter(),(y=v.filter)===null||y===void 0||y,["!",e._getHighlightFilter(e._highlightFeatureId)],["!",e._getClusterFilter()]]}))}}),this._highlightTrigger!=="none"&&this.highlightLayers.forEach(function(o){var u,s,y;if(!(!((u=e._map)===null||u===void 0)&&u.getLayer(o))){var v=e.layerPool[o];(s=e._map)===null||s===void 0||s.addLayer(nt(nt({},v),{id:o,source:e.source,filter:["all",e._getGeometryFilter(),(y=v.filter)===null||y===void 0||y,e._getHighlightFilter(e._highlightFeatureId),["!",e._getClusterFilter()]]}))}}),this._cluster&&this.clusterLayers.forEach(function(o){var u,s,y;if(!(!((u=e._map)===null||u===void 0)&&u.getLayer(o))){var v=e.layerPool[o];(s=e._map)===null||s===void 0||s.addLayer(nt(nt({},v),{id:o,source:e.source,filter:["all",e._getGeometryFilter(),e._getClusterFilter(),(y=v.filter)===null||y===void 0||y]}))}})}},t.prototype._getHighlightFilter=function(e){return this._highlightTrigger!=="none"&&e!=null&&["==",["get",this._key],e]},t.prototype._getClusterFilter=function(){return!!this._cluster&&["all",["has","cluster_id"],["==",["get","cluster"],!0]]},t.prototype._getGeometryFilter=function(){return["==",["geometry-type"],"Point"]},t.prototype._removeSourceAnyLayer=function(){var e,i=this;this.layers.forEach(function(o){var u;!((u=i._map)===null||u===void 0)&&u.getLayer(o)&&i._map.removeLayer(o)}),this._highlightTrigger!=="none"&&this.highlightLayers.forEach(function(o){var u;!((u=i._map)===null||u===void 0)&&u.getLayer(o)&&i._map.removeLayer(o)}),this._cluster&&this.clusterLayers.forEach(function(o){var u;!((u=i._map)===null||u===void 0)&&u.getLayer(o)&&i._map.removeLayer(o)}),!((e=this._map)===null||e===void 0)&&e.getSource(this.source)&&this._map.removeSource(this.source)},t})(be.Evented);var gC=["none","click","hover","manual"];(function(n){function t(e){var i,o=n.call(this)||this;return e=hl(e),o._map=null,o._lngLatBounds=null,o._highlightFeatureId=null,o._source="advance-line-layer".concat(mi()),o._key=e.key||"id",o._data=e.data,o._lineMetrics=(i=e.lineMetrics)!==null&&i!==void 0&&i,o._layerPool=e.layerPool||{},o._layers=e.layers||[],o._highlightTrigger=e.highlightTrigger&&gC.includes(e.highlightTrigger)?e.highlightTrigger:"none",o._highlightLayers=o._highlightTrigger==="none"?[]:e.highlightLayers||[],o._fitBoundsOptions=e.fitBoundsOptions||!1,o._isMouseOver=!1,o._setLngLatBounds(),vi(["_onClick","_onMouseMove","_onData","_onMouseLeave"],o),o}return br(t,n),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layers",{get:function(){var e=this;return this._layers.map(function(i){return"".concat(e.source,"-").concat(i)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightLayers",{get:function(){var e=this;return this._highlightLayers.map(function(i){return"".concat(e.source,"-").concat(i,"-highlight")})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lngLatBounds",{get:function(){return this._lngLatBounds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerPool",{get:function(){var e=this,i={};return Object.keys(this._layerPool).forEach(function(o){e._layers.includes(o)&&(i["".concat(e.source,"-").concat(o)]=e._layerPool[o]),e._highlightLayers.includes(o)&&(i["".concat(e.source,"-").concat(o,"-highlight")]=e._layerPool[o])}),i},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){if(this._map!==e)return this.remove(),this._map=e,this._addSourceAnyLayer(),this._handleEventListener("on"),this._fitBounds(),this},t.prototype.remove=function(){return this._map&&(this._highlightFeatureId=null,this._lngLatBounds=null,this._isMouseOver=!1,this._handleEventListener("off"),this._removeSourceAnyLayer(),this._removeCursor(),this._map=null),this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&(e=e||typeof this._fitBoundsOptions=="boolean"?{}:this._fitBoundsOptions,(i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,nt({},e))),this},t.prototype.setData=function(e){return this._highlightFeatureId=null,this._lngLatBounds=null,this._isMouseOver=!1,this._data=e,this._setLngLatBounds(),this._map&&(this._map.getSource(this.source).setData(this._data||Ir([])),this.removeHighlight(),this._fitBounds()),this},t.prototype.setHighlight=function(e){var i=this._highlightTrigger==="hover"?"none":this._highlightTrigger;this._setHighlight(e,i)},t.prototype.removeHighlight=function(){var e=this._highlightTrigger==="hover"?"none":this._highlightTrigger;this._setHighlight(void 0,e)},t.prototype.easeTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);if(o){var u=ni(Tn(o));this._map.easeTo(nt(nt({},i),{center:[u[0],u[1]]}))}return this},t.prototype.flyTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);if(o){var u=ni(Tn(o));this._map.flyTo(nt(nt({},i||{}),{center:[u[0],u[1]]}))}return this},t.prototype.fitTo=function(e,i){if(i===void 0&&(i={}),!this._map)return this;var o=this._getFeature(e);o&&this._map.fitBounds(new be.LngLatBounds(Xr(zr(o)).bbox),i)},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i)},t.prototype.fire=function(e,i){return n.prototype.fire.call(this,e,i)},t.prototype.once=function(e,i){return n.prototype.once.call(this,e,i)},t.prototype.off=function(e,i){return n.prototype.off.call(this,e,i)},t.prototype._getFeature=function(e){var i,o,u=this;if(this._data&&typeof this._data!="string")return this._data.type==="FeatureCollection"?o=this._data.features.find(function(s){var y;return((y=s.properties)===null||y===void 0?void 0:y[u._key])===e}):this._data.type==="Feature"&&((i=this._data.properties)===null||i===void 0?void 0:i[this._key])===e&&(o=$e(this._data)),o},t.prototype._fitBounds=function(){this._map&&this._fitBoundsOptions&&this._lngLatBounds&&this._map.fitBounds(this._lngLatBounds,nt({},this._fitBoundsOptions===!0?{}:this._fitBoundsOptions))},t.prototype._setLngLatBounds=function(){this._data&&typeof this._data!="string"?this._data.type==="FeatureCollection"?this._lngLatBounds=this._data.features.length>0?Xr(zr(this._data)).bbox:null:this._data.type==="Feature"?this._lngLatBounds=Xr(zr(this._data)).bbox:this._lngLatBounds=null:this._lngLatBounds=null},t.prototype._handleEventListener=function(e){this._map&&(this._map[e]("click",this._onClick),this._map[e]("mousemove",this._onMouseMove),this._map[e]("data",this._onData),e==="on"?this._map.getContainer().addEventListener("mouseleave",this._onMouseLeave):this._map.getContainer().removeEventListener("mouseleave",this._onMouseLeave))},t.prototype._addCursor=function(){this._map&&!this._map.getContainer().classList.contains("mapbox-utils-advance-line-layer")&&this._map.getContainer().classList.add("mapbox-utils-advance-line-layer")},t.prototype._removeCursor=function(){this._map&&this._map.getContainer().classList.remove("mapbox-utils-advance-line-layer")},t.prototype._onMouseLeave=function(){this._isMouseOver&&(this._isMouseOver=!1,this.fire("mouseleave"),this._setHighlight(void 0,"hover"),this._removeCursor())},t.prototype._onClick=function(e){var i=this._getEventFeature(e.point);if(i&&(this._isDefault(i)&&this._setHighlight(i.id,"click"),this._isBasic(i))){var o=this._getFeature(i.properties[this._key]),u=o?ni(Tn(o)):void 0,s=nt(nt({},this._getData(i)),{originMapEvent:e});u&&(s.center=new be.LngLat(u[0],u[1])),o&&(s.lngLatBounds=new be.LngLatBounds(Xr(zr(o)).bbox)),this.fire("click",nt({},s))}},t.prototype._isDefault=function(e){return this.layers.includes(e.layer.id)},t.prototype._isBasic=function(e){return Yt(Yt([],this.layers,!0),this.highlightLayers,!0).includes(e.layer.id)},t.prototype._getData=function(e){return{data:nt({},e.properties)}},t.prototype._setHighlight=function(e,i){var o=this;this._highlightTrigger===i&&i!=="none"&&this._map&&this._highlightFeatureId!==e&&(this._highlightFeatureId=e,this.layers.forEach(function(u){var s,y,v=o.layerPool[u];(s=o._map)===null||s===void 0||s.setFilter(u,["all",o._getGeometryFilter(),(y=v.filter)===null||y===void 0||y,["!",o._getHighlightFilter(e)]])}),this.highlightLayers.forEach(function(u){var s,y,v=o.layerPool[u];(s=o._map)===null||s===void 0||s.setFilter(u,["all",o._getGeometryFilter(),(y=v.filter)===null||y===void 0||y,o._getHighlightFilter(e)])}))},t.prototype._getEventFeature=function(e){var i;if(this._map){var o=this._map.queryRenderedFeatures(e,{layers:void 0});return((i=o[0])===null||i===void 0?void 0:i.source)===this.source?o[0]:void 0}},t.prototype._onMouseMove=function(e){var i=this._getEventFeature(e.point);if(i&&this._isBasic(i)){var o=this._getFeature(i.properties[this._key]),u=o?ni(Tn(o)):void 0,s=nt(nt({},this._getData(i)),{originMapEvent:e});u&&(s.center=new be.LngLat(u[0],u[1])),this._isMouseOver?this.fire("mousemove",s):(this.fire("mouseenter",s),this._isMouseOver=!0),this._addCursor(),this._setHighlight(i.id,"hover")}else this._isMouseOver&&(this.fire("mouseleave",{originMapEvent:e}),this._isMouseOver=!1,this._setHighlight(void 0,"hover"),this._removeCursor())},t.prototype._onData=function(e){var i=this;e.dataType==="style"&&setTimeout(function(){i._addSourceAnyLayer()},10)},t.prototype._addSourceAnyLayer=function(){var e=this;if(this._map){if(!this._map.getSource(this.source)){var i={data:this._data||Ir([]),type:"geojson",promoteId:this._key,lineMetrics:this._lineMetrics};this._map.addSource(this.source,i)}this.layers.forEach(function(o){var u,s,y;if(!(!((u=e._map)===null||u===void 0)&&u.getLayer(o))){var v=e.layerPool[o];(s=e._map)===null||s===void 0||s.addLayer(nt(nt({},v),{id:o,source:e.source,filter:["all",e._getGeometryFilter(),(y=v.filter)===null||y===void 0||y,["!",e._getHighlightFilter(e._highlightFeatureId)]]}))}}),this._highlightTrigger!=="none"&&this.highlightLayers.forEach(function(o){var u,s,y;if(!(!((u=e._map)===null||u===void 0)&&u.getLayer(o))){var v=e.layerPool[o];(s=e._map)===null||s===void 0||s.addLayer(nt(nt({},v),{id:o,source:e.source,filter:["all",e._getGeometryFilter(),(y=v.filter)===null||y===void 0||y,e._getHighlightFilter(e._highlightFeatureId)]}))}})}},t.prototype._getHighlightFilter=function(e){return this._highlightTrigger!=="none"&&e!=null&&["==",["get",this._key],e]},t.prototype._removeSourceAnyLayer=function(){var e,i=this;this.layers.forEach(function(o){var u;!((u=i._map)===null||u===void 0)&&u.getLayer(o)&&i._map.removeLayer(o)}),this._highlightTrigger!=="none"&&this.highlightLayers.forEach(function(o){var u;!((u=i._map)===null||u===void 0)&&u.getLayer(o)&&i._map.removeLayer(o)}),!((e=this._map)===null||e===void 0)&&e.getSource(this.source)&&this._map.removeSource(this.source)},t.prototype._getGeometryFilter=function(){return["any",["==",["geometry-type"],"LineString"],["==",["geometry-type"],"MultiLineString"],["==",["geometry-type"],"Polygon"],["==",["geometry-type"],"MultiPolygon"]]},t})(be.Evented);var yC=["none","click","hover","manual"];(function(n){function t(e){var i=n.call(this)||this;return e=hl(e),i._map=null,i._lngLatBounds=null,i._highlightFeatureId=null,i._source="advance-polygon-layer".concat(mi()),i._key=e.key||"id",i._data=e.data,i._layerPool=e.layerPool||{},i._layers=e.layers||[],i._highlightTrigger=e.highlightTrigger&&yC.includes(e.highlightTrigger)?e.highlightTrigger:"none",i._highlightLayers=i._highlightTrigger==="none"?[]:e.highlightLayers||[],i._fitBoundsOptions=e.fitBoundsOptions||!1,i._isMouseOver=!1,i._setLngLatBounds(),vi(["_onClick","_onMouseMove","_onData","_onMouseLeave"],i),i}return br(t,n),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layers",{get:function(){var e=this;return this._layers.map(function(i){return"".concat(e.source,"-").concat(i)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightLayers",{get:function(){var e=this;return this._highlightLayers.map(function(i){return"".concat(e.source,"-").concat(i,"-highlight")})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lngLatBounds",{get:function(){return this._lngLatBounds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerPool",{get:function(){var e=this,i={};return Object.keys(this._layerPool).forEach(function(o){e._layers.includes(o)&&(i["".concat(e.source,"-").concat(o)]=e._layerPool[o]),e._highlightLayers.includes(o)&&(i["".concat(e.source,"-").concat(o,"-highlight")]=e._layerPool[o])}),i},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){if(this._map!==e)return this.remove(),this._map=e,this._addSourceAnyLayer(),this._handleEventListener("on"),this._fitBounds(),this},t.prototype.remove=function(){return this._map&&(this._highlightFeatureId=null,this._lngLatBounds=null,this._isMouseOver=!1,this._handleEventListener("off"),this._removeSourceAnyLayer(),this._removeCursor(),this._map=null),this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&(e=e||typeof this._fitBoundsOptions=="boolean"?{}:this._fitBoundsOptions,(i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,nt({},e))),this},t.prototype.setData=function(e){return this._highlightFeatureId=null,this._lngLatBounds=null,this._isMouseOver=!1,this._data=e,this._setLngLatBounds(),this._map&&(this._map.getSource(this.source).setData(e||Ir([])),this.removeHighlight(),this._fitBounds()),this},t.prototype.setHighlight=function(e){var i=this._highlightTrigger==="hover"?"none":this._highlightTrigger;this._setHighlight(e,i)},t.prototype.removeHighlight=function(){var e=this._highlightTrigger==="hover"?"none":this._highlightTrigger;this._setHighlight(void 0,e)},t.prototype.easeTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);if(o){var u=ni(Tn(o));this._map.easeTo(nt(nt({},i),{center:[u[0],u[1]]}))}return this},t.prototype.flyTo=function(e,i){if(!this._map)return this;var o=this._getFeature(e);if(o){var u=ni(Tn(o));this._map.flyTo(nt(nt({},i||{}),{center:[u[0],u[1]]}))}return this},t.prototype.fitTo=function(e,i){if(i===void 0&&(i={}),!this._map)return this;var o=this._getFeature(e);o&&this._map.fitBounds(new be.LngLatBounds(Xr(zr(o)).bbox),i)},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i)},t.prototype.fire=function(e,i){return n.prototype.fire.call(this,e,i)},t.prototype.once=function(e,i){return n.prototype.once.call(this,e,i)},t.prototype.off=function(e,i){return n.prototype.off.call(this,e,i)},t.prototype._getFeature=function(e){var i,o,u=this;if(this._data&&typeof this._data!="string")return this._data.type==="FeatureCollection"?o=this._data.features.find(function(s){var y;return((y=s.properties)===null||y===void 0?void 0:y[u._key])===e}):this._data.type==="Feature"&&((i=this._data.properties)===null||i===void 0?void 0:i[this._key])===e&&(o=$e(this._data)),o},t.prototype._fitBounds=function(){this._map&&this._fitBoundsOptions&&this._lngLatBounds&&this._map.fitBounds(this._lngLatBounds,nt({},this._fitBoundsOptions===!0?{}:this._fitBoundsOptions))},t.prototype._setLngLatBounds=function(){this._data&&typeof this._data!="string"?this._data.type==="FeatureCollection"?this._lngLatBounds=this._data.features.length>0?Xr(zr(this._data)).bbox:null:this._data.type==="Feature"?this._lngLatBounds=Xr(zr(this._data)).bbox:this._lngLatBounds=null:this._lngLatBounds=null},t.prototype._handleEventListener=function(e){this._map&&(this._map[e]("click",this._onClick),this._map[e]("mousemove",this._onMouseMove),this._map[e]("data",this._onData),e==="on"?this._map.getContainer().addEventListener("mouseleave",this._onMouseLeave):this._map.getContainer().removeEventListener("mouseleave",this._onMouseLeave))},t.prototype._onMouseLeave=function(){this._isMouseOver&&(this._isMouseOver=!1,this.fire("mouseleave"),this._setHighlight(void 0,"hover"),this._removeCursor())},t.prototype._onClick=function(e){var i=this._getEventFeature(e.point);if(i&&(this._isDefault(i)&&this._setHighlight(i.id,"click"),this._isBasic(i))){var o=this._getFeature(i.properties[this._key]),u=o?ni(Tn(o)):void 0,s=nt(nt({},this._getData(i)),{originMapEvent:e});u&&(s.center=new be.LngLat(u[0],u[1])),o&&(s.lngLatBounds=new be.LngLatBounds(Xr(zr(o)).bbox)),this.fire("click",nt({},s))}},t.prototype._isDefault=function(e){return this.layers.includes(e.layer.id)},t.prototype._isBasic=function(e){return Yt(Yt([],this.layers,!0),this.highlightLayers,!0).includes(e.layer.id)},t.prototype._getData=function(e){return{data:nt({},e.properties)}},t.prototype._setHighlight=function(e,i){var o=this;this._highlightTrigger===i&&i!=="none"&&this._map&&this._highlightFeatureId!==e&&(this._highlightFeatureId=e,this.layers.forEach(function(u){var s,y,v=o.layerPool[u];(s=o._map)===null||s===void 0||s.setFilter(u,["all",o._getGeometryFilter(),(y=v.filter)===null||y===void 0||y,["!",o._getHighlightFilter(e)]])}),this.highlightLayers.forEach(function(u){var s,y,v=o.layerPool[u];(s=o._map)===null||s===void 0||s.setFilter(u,["all",o._getGeometryFilter(),(y=v.filter)===null||y===void 0||y,o._getHighlightFilter(e)])}))},t.prototype._getEventFeature=function(e){var i;if(this._map){var o=this._map.queryRenderedFeatures(e,{layers:void 0});return((i=o[0])===null||i===void 0?void 0:i.source)===this.source?o[0]:void 0}},t.prototype._onMouseMove=function(e){var i=this._getEventFeature(e.point);if(i&&this._isBasic(i)){var o=this._getFeature(i.properties[this._key]),u=o?ni(Tn(o)):void 0,s=nt(nt({},this._getData(i)),{originMapEvent:e});u&&(s.center=new be.LngLat(u[0],u[1])),this._isMouseOver?this.fire("mousemove",s):(this.fire("mouseenter",s),this._isMouseOver=!0),this._addCursor(),this._setHighlight(i.id,"hover")}else this._isMouseOver&&(this.fire("mouseleave",{originMapEvent:e}),this._isMouseOver=!1,this._setHighlight(void 0,"hover"),this._removeCursor())},t.prototype._addCursor=function(){this._map&&!this._map.getContainer().classList.contains("mapbox-utils-advance-polygon-layer")&&this._map.getContainer().classList.add("mapbox-utils-advance-polygon-layer")},t.prototype._removeCursor=function(){this._map&&this._map.getContainer().classList.remove("mapbox-utils-advance-polygon-layer")},t.prototype._onData=function(e){var i=this;e.dataType==="style"&&setTimeout(function(){i._addSourceAnyLayer()},10)},t.prototype._addSourceAnyLayer=function(){var e=this;if(this._map){if(!this._map.getSource(this.source)){var i={data:this._data||Ir([]),type:"geojson",promoteId:this._key};this._map.addSource(this.source,i)}this.layers.forEach(function(o){var u,s,y;if(!(!((u=e._map)===null||u===void 0)&&u.getLayer(o))){var v=e.layerPool[o];(s=e._map)===null||s===void 0||s.addLayer(nt(nt({},v),{id:o,source:e.source,filter:["all",e._getGeometryFilter(),(y=v.filter)===null||y===void 0||y,["!",e._getHighlightFilter(e._highlightFeatureId)]]}))}}),this._highlightTrigger!=="none"&&this.highlightLayers.forEach(function(o){var u,s,y;if(!(!((u=e._map)===null||u===void 0)&&u.getLayer(o))){var v=e.layerPool[o];(s=e._map)===null||s===void 0||s.addLayer(nt(nt({},v),{id:o,source:e.source,filter:["all",e._getGeometryFilter(),(y=v.filter)===null||y===void 0||y,e._getHighlightFilter(e._highlightFeatureId)]}))}})}},t.prototype._getHighlightFilter=function(e){return this._highlightTrigger!=="none"&&e!=null&&["==",["get",this._key],e]},t.prototype._removeSourceAnyLayer=function(){var e,i=this;this.layers.forEach(function(o){var u;!((u=i._map)===null||u===void 0)&&u.getLayer(o)&&i._map.removeLayer(o)}),this._highlightTrigger!=="none"&&this.highlightLayers.forEach(function(o){var u;!((u=i._map)===null||u===void 0)&&u.getLayer(o)&&i._map.removeLayer(o)}),!((e=this._map)===null||e===void 0)&&e.getSource(this.source)&&this._map.removeSource(this.source)},t.prototype._getGeometryFilter=function(){return["any",["==",["geometry-type"],"Polygon"],["==",["geometry-type"],"MultiPolygon"]]},t})(be.Evented);var mC=[{id:"mapbox-utils-distance-measure-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"]],paint:{"line-color":"rgb(255, 77, 79)","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-distance-measure-vertex-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"]],paint:{"circle-color":"#fff","circle-radius":3,"circle-stroke-color":"rgb(255, 77, 79)","circle-stroke-width":2}},{id:"mapbox-utils-distance-measure-line-active",type:"line",filter:["all",["==","active","true"],["==","$type","LineString"]],paint:{"line-color":"rgb(255, 77, 79)","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-distance-measure-vertex-active",type:"circle",filter:["all",["==","active","true"],["==","$type","Point"]],paint:{"circle-color":"#fff","circle-radius":3,"circle-stroke-color":"rgb(255, 77, 79)","circle-stroke-width":2}}];(function(n){function t(e){var i,o=n.call(this)||this;return o._source="mapbox-utils-distance-measurer-source",o._map=null,o._enabled=!1,o._currentPath=[],o._cacheMap=new Map,o._next=0,o._multiple=(i=e==null?void 0:e.multiple)!==null&&i!==void 0&&i,o._layers=(e==null?void 0:e.layers)||mC,vi(["_OnDblClick","_onClick","_onMousemove","_onData"],o),o}return br(t,n),t.prototype.addTo=function(e){if(this._map!==e)return this.remove(),this._map=e,this._addSourceAnyLayer(),this._handleEventListener("on"),this._render(),this},t.prototype.remove=function(){this._map&&(this._handleEventListener("off"),this._removeSourceAndLayer(),this._map.getContainer().classList.remove("mapbox-utils-distance-measurer-cursor")),this._map=null,this._enabled=!1,this.clear()},t.prototype.enable=function(){this._map&&(this._enabled=!0,this._map.getContainer().classList.add("mapbox-utils-distance-measurer-cursor"))},t.prototype.disable=function(){this._next!==0&&(this._currentPath.forEach(function(e){return e.marker.remove()}),this._currentPath=[],this._next=0),this._enabled=!1,this._map&&(this._map.getContainer().classList.remove("mapbox-utils-distance-measurer-cursor"),this._render())},t.prototype.clear=function(){return this._cacheMap.forEach(function(e){e.data.forEach(function(i){i.marker.remove()})}),this._cacheMap.clear(),this._next!==0&&(this._currentPath.forEach(function(e){return e.marker.remove()}),this._currentPath=[],this._next=0),this._map&&this._render(),this},t.prototype.getAllPath=function(){var e=[];return this._cacheMap.forEach(function(i,o){e.push({pathId:o,length:i.length,pathData:i.features.find(function(u){return u.geometry.type==="LineString"})})}),e},t.prototype.getPathById=function(e){var i=this._cacheMap.get(e);return i?{pathId:e,length:i.length,pathData:i.features.find(function(o){return o.geometry.type==="LineString"})}:null},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i)},t.prototype.fire=function(e,i){return n.prototype.fire.call(this,e,i)},t.prototype.off=function(e,i){return n.prototype.off.call(this,e,i)},t.prototype._handleEventListener=function(e){this._map&&(this._map[e]("dblclick",this._OnDblClick),this._map[e]("click",this._onClick),this._map[e]("mousemove",this._onMousemove),this._map[e]("data",this._onData))},t.prototype._onData=function(e){var i=this;e.dataType==="style"&&setTimeout(function(){i._addSourceAnyLayer()},10)},t.prototype._OnDblClick=function(e){this._enabled&&e.preventDefault()},t.prototype._onMousemove=function(e){this._enabled&&this._next!==0&&(this._update([e.lngLat.lng,e.lngLat.lat]),this._render())},t.prototype._onClick=function(e){this._enabled&&(this._next===0?(this._multiple||this.clear(),this._add([e.lngLat.lng,e.lngLat.lat])):this._currentPath[this._next]?this._add([e.lngLat.lng,e.lngLat.lat]):this._finish(),this._render())},t.prototype._finish=function(){var e=this;if(!(this._next<2)){this._next=0;var i=Date.now().toString(),o=j0(this._currentPath,"false");(function(u,s){var y=u.getElement(),v=y.innerText;y.innerHTML="";var S=document.createElement("div"),L=document.createElement("span");L.innerText=v;var k=document.createElement("span");k.classList.add("remove-btn"),S.appendChild(L),S.appendChild(k),y.appendChild(S),k.addEventListener("click",function(N){s&&s(),N.stopPropagation()},!0)})(o.data[o.data.length-1].marker,function(){return e._remove(i)}),this._cacheMap.set(i,o),this._currentPath=[],setTimeout(function(){e.fire("complete",{pathId:i,length:o.length,pathData:o.features.find(function(u){return u.geometry.type==="LineString"})})},10)}},t.prototype._remove=function(e){var i;(i=this._cacheMap.get(e))===null||i===void 0||i.data.forEach(function(o){var u;(u=o.marker)===null||u===void 0||u.remove()}),this._cacheMap.delete(e),this.fire("delete",{pathId:e}),this._render()},t.prototype._add=function(e){this._update(e),this._next++},t.prototype._update=function(e){var i=this._currentPath.length>1?function(o){var u=Nm(Yi(o),{units:"kilometers"});return u<1?(1e3*u).toFixed(0)+"\u7C73":u.toFixed(1)+"\u516C\u91CC"}(Yt(Yt([],this._currentPath.map(function(o){return o.coordinates}),!0),[e],!1)):"\u8D77\u70B9";this._currentPath[this._next]?(this._currentPath[this._next].coordinates=e,this._currentPath[this._next].marker.getElement().innerText=i,this._currentPath[this._next].marker.setLngLat(e)):this._currentPath[this._next]={coordinates:e,marker:_C(e,i)}},t.prototype._render=function(){var e=this;if(this._map){var i=this._map.getSource(this._source),o=[];this._cacheMap.forEach(function(s){o.push.apply(o,s.features)});var u=j0(this._currentPath,"true");o.push.apply(o,u.features),u.data.forEach(function(s){var y;(y=s.marker)===null||y===void 0||y.addTo(e._map)}),i.setData({type:"FeatureCollection",features:o})}},t.prototype._addSourceAnyLayer=function(){var e=this;this._map&&(this._map.getSource(this._source)||(this._map.addSource(this._source,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this._render()),this._layers.forEach(function(i){var o,u;((o=e._map)===null||o===void 0?void 0:o.getLayer(i.id))||(u=e._map)===null||u===void 0||u.addLayer(nt(nt({},i),{source:e._source}))}))},t.prototype._removeSourceAndLayer=function(){var e,i=this;this._layers.forEach(function(o){var u,s;!((u=i._map)===null||u===void 0)&&u.getLayer(o.id)&&((s=i._map)===null||s===void 0||s.removeLayer(o.id))}),!((e=this._map)===null||e===void 0)&&e.getSource(this._source)&&this._map.removeSource(this._source)},t})(be.Evented);function j0(n,t){var e=[],i=n.map(function(s){return s.coordinates}),o=function(s,y){try{return Yi(s,{active:y})}catch{return null}}(i,t),u=0;return o&&(e.push(o),u=Nm(o,{units:"kilometers"})),i.forEach(function(s){var y=Me(s,{active:t});e.push(y)}),{data:Yt([],n,!0),features:e,length:u}}function _C(n,t){var e=document.createElement("div");e.classList.add("mapbox-utils-distance-measurer-marker");var i=new be.Marker({element:e,anchor:"bottom",offset:[0,-10]});return i.setLngLat(n),i.getElement().innerText=t,i}var vC=[{id:"mapbox-utils-area-measurer-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"]],paint:{"fill-color":"rgb(255, 77, 79)","fill-opacity":.3}},{id:"mapbox-utils-area-measurer-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"]],paint:{"line-color":"rgb(255, 77, 79)","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-area-measurer-vertex-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"]],paint:{"circle-color":"#fff","circle-radius":3,"circle-stroke-color":"rgb(255, 77, 79)","circle-stroke-width":2}},{id:"mapbox-utils-area-measurer-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"rgb(255, 77, 79)","fill-opacity":.4}},{id:"mapbox-utils-area-measurer-line-active",type:"line",filter:["all",["==","active","true"],["==","$type","LineString"]],paint:{"line-color":"rgb(255, 77, 79)","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-area-measurer-vertex-active",type:"circle",filter:["all",["==","active","true"],["==","$type","Point"]],paint:{"circle-color":"#fff","circle-radius":3,"circle-stroke-color":"rgb(255, 77, 79)","circle-stroke-width":2}}];(function(n){function t(e){var i,o=n.call(this)||this;return o._source="mapbox-utils-area-measurer-source",o._map=null,o._enabled=!1,o._current={path:[],marker:null},o._cacheMap=new Map,o._next=0,o._multiple=(i=e==null?void 0:e.multiple)!==null&&i!==void 0&&i,o._layers=(e==null?void 0:e.layers)||vC,vi(["_OnDblClick","_onClick","_onMousemove","_onData"],o),o}return br(t,n),t.prototype.addTo=function(e){if(this._map!==e)return this.remove(),this._map=e,this._addSourceAnyLayer(),this._handleEventListener("on"),this},t.prototype.remove=function(){this._map&&(this._handleEventListener("off"),this._removeSourceAndLayer(),this._map.getContainer().classList.remove("mapbox-utils-area-measurer-cursor")),this._map=null,this._enabled=!1,this.clear()},t.prototype.enable=function(){this._map&&(this._enabled=!0,this._map.getContainer().classList.add("mapbox-utils-area-measurer-cursor"))},t.prototype.disable=function(){var e;this._next!==0&&((e=this._current.marker)===null||e===void 0||e.remove(),this._current={path:[],marker:null},this._next=0),this._enabled=!1,this._map&&(this._map.getContainer().classList.remove("mapbox-utils-area-measurer-cursor"),this._render())},t.prototype.clear=function(){var e;return this._cacheMap.forEach(function(i){i.marker.remove()}),this._cacheMap.clear(),this._next!==0&&((e=this._current.marker)===null||e===void 0||e.remove(),this._current={path:[],marker:null},this._next=0),this._map&&this._render(),this},t.prototype.getAllArea=function(){var e=[];return this._cacheMap.forEach(function(i,o){e.push({areaId:o,acreage:i.acreage,areaData:i.features.find(function(u){return u.geometry.type==="Polygon"||u.geometry.type==="MultiPolygon"})})}),e},t.prototype.getAreaById=function(e){var i=this._cacheMap.get(e);return i?{areaId:e,acreage:i.acreage,areaData:i.features.find(function(o){return o.geometry.type==="Polygon"||o.geometry.type==="MultiPolygon"})}:null},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i)},t.prototype.fire=function(e,i){return n.prototype.fire.call(this,e,i)},t.prototype.off=function(e,i){return n.prototype.off.call(this,e,i)},t.prototype._handleEventListener=function(e){this._map&&(this._map[e]("dblclick",this._OnDblClick),this._map[e]("click",this._onClick),this._map[e]("mousemove",this._onMousemove),this._map[e]("data",this._onData))},t.prototype._onData=function(e){var i=this;e.dataType==="style"&&setTimeout(function(){i._addSourceAnyLayer()},10)},t.prototype._OnDblClick=function(e){this._enabled&&e.preventDefault()},t.prototype._onMousemove=function(e){this._enabled&&this._next!==0&&(this._update([e.lngLat.lng,e.lngLat.lat]),this._render())},t.prototype._onClick=function(e){this._enabled&&(this._next===0?(this._multiple||this.clear(),this._add([e.lngLat.lng,e.lngLat.lat])):this._current.path[this._next]?this._add([e.lngLat.lng,e.lngLat.lat]):this._finish(),this._render())},t.prototype._finish=function(){var e,i=this;if(!(this._next<3)){this._next=0;var o=Date.now().toString(),u=G0(this._current.path,"false");(function(s,y){var v=s.getElement(),S=v.innerText;v.innerHTML="";var L=document.createElement("div"),k=document.createElement("span");k.innerText=S;var N=document.createElement("span");N.classList.add("remove-btn"),L.appendChild(k),L.appendChild(N),v.appendChild(L),N.addEventListener("click",function(Q){y&&y(),Q.stopPropagation()},!0)})(u.marker,function(){return i._remove(o)}),u.marker.addTo(this._map),this._cacheMap.set(o,u),(e=this._current.marker)===null||e===void 0||e.remove(),this._current={path:[],marker:null},setTimeout(function(){i.fire("complete",{areaId:o,acreage:u.acreage,areaData:u.features.find(function(s){return s.geometry.type==="Polygon"||s.geometry.type==="MultiPolygon"})})},10)}},t.prototype._remove=function(e){var i;(i=this._cacheMap.get(e))===null||i===void 0||i.marker.remove(),this._cacheMap.delete(e),this.fire("delete",{areaId:e}),this._render()},t.prototype._add=function(e){this._update(e),this._next>=2&&!E1(Yt(Yt([],this._current.path,!0),[this._current.path[0]],!1),"true")||this._next++},t.prototype._update=function(e){this._current.path[this._next]=e},t.prototype._render=function(){var e,i;if(this._map){var o=this._map.getSource(this._source),u=[];this._cacheMap.forEach(function(y){u.push.apply(u,y.features)});var s=G0(this._current.path,"true");u.push.apply(u,s.features),(e=this._current.marker)===null||e===void 0||e.remove(),this._current.marker=s.marker,(i=this._current.marker)===null||i===void 0||i.addTo(this._map),o.setData({type:"FeatureCollection",features:u})}},t.prototype._addSourceAnyLayer=function(){var e=this;this._map&&(this._map.getSource(this._source)||(this._map.addSource(this._source,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this._render()),this._layers.forEach(function(i){var o,u;((o=e._map)===null||o===void 0?void 0:o.getLayer(i.id))||(u=e._map)===null||u===void 0||u.addLayer(nt(nt({},i),{source:e._source}))}))},t.prototype._removeSourceAndLayer=function(){var e,i=this;this._layers.forEach(function(o){var u,s;!((u=i._map)===null||u===void 0)&&u.getLayer(o.id)&&((s=i._map)===null||s===void 0||s.removeLayer(o.id))}),!((e=this._map)===null||e===void 0)&&e.getSource(this._source)&&this._map.removeSource(this._source)},t})(be.Evented);function G0(n,t){var e=[],i=null,o=function(y,v){try{return Yi(y,{active:v})}catch{return null}}(Yt(Yt([],n,!0),[n[0]],!1),t);o&&e.push(o);var u=E1(Yt(Yt([],n,!0),[n[0]],!1),t),s=0;return u&&(e.push(u),i=function(y,v){var S=document.createElement("div");S.classList.add("mapbox-utils-area-measurer-marker");var L=new be.Marker({element:S,anchor:"bottom",offset:[0,-10]});return L.setLngLat(y),L.getElement().innerText=v,L}(rx(u).geometry.coordinates,(s=dc(u))>1e6?(s/1e6).toFixed(2)+"\u5E73\u65B9\u516C\u91CC":s.toFixed(2)+"\u5E73\u65B9\u7C73")),n.forEach(function(y){var v=Me(y,{active:t});e.push(v)}),{data:Yt([],n,!0),features:e,marker:i,acreage:s}}function E1(n,t){try{var e=void 0,i=Hg(es([n]));return(e=i.features.length>1?Gg(i).features[0]:i.features[0]).properties={active:t},e}catch{return null}}var xC=[{id:"mapbox-utils-draw-util-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"]],paint:{"fill-color":"#44cef6","fill-opacity":.3}},{id:"mapbox-utils-draw-util-border-inactive",type:"line",filter:["all",["==","$type","LineString"],["==","active","false"],["==","type","border"]],paint:{"line-color":"#44cef6","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-draw-util-line-inactive",type:"line",filter:["all",["==","$type","LineString"],["==","active","false"],["==","origin","line"]],paint:{"line-color":"#44cef6","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-draw-util-point-active",type:"circle",filter:["all",["==","origin","point"],["==","$type","Point"]],paint:{"circle-color":"#fff","circle-radius":3,"circle-stroke-color":"#44cef6","circle-stroke-width":2}},{id:"mapbox-utils-draw-util-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#44cef6","fill-opacity":.4}},{id:"mapbox-utils-draw-util-border-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"],["==","type","border"]],paint:{"line-color":"#44cef6","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-draw-util-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"],["==","origin","line"]],paint:{"line-color":"#44cef6","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-draw-util-vertex-active",type:"circle",filter:["all",["==","active","true"],["==","$type","Point"],["==","type","vertex"]],paint:{"circle-color":"#fff","circle-radius":3,"circle-stroke-color":"#44cef6","circle-stroke-width":2}},{id:"mapbox-utils-draw-util-circle-center-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["==","type","circle-center"]],paint:{"circle-color":"#fff","circle-radius":3,"circle-stroke-color":"#44cef6","circle-stroke-width":2}}],Qf=function(n){function t(){var e=n.call(this)||this;return e._next=0,e._path=[],e}return br(t,n),Object.defineProperty(t.prototype,"next",{get:function(){return this._next},enumerable:!1,configurable:!0}),t}(be.Evented);function Vg(n,t){t===void 0&&(t={});try{return Yi(n,nt({},t))}catch{return null}}var bC=function(n){function t(){return n.call(this)||this}return br(t,n),t.prototype.getFeatures=function(){if(!this._path.length)return{feature:null,renderFeatures:[]};var e=[],i=Me(this._path[0],{origin:"point"});return e.push(i),{feature:i,renderFeatures:e}},t.prototype.onClick=function(e){return this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],this.fire("finished",{data:this.getFeatures()}),this._next=0,this._path=[],!1},t.prototype.onMouseMove=function(){return!1},t.prototype.onDblClick=function(){},t.prototype.clear=function(){this._path=[]},t}(Qf),wC=function(n){function t(){return n.call(this)||this}return br(t,n),t.prototype.getFeatures=function(e){if(e===void 0&&(e="true"),!this._path.length)return{feature:null,renderFeatures:[]};var i=[],o=this._next-1;e==="false"&&(o=this._next);var u=Vg(Yt([],this._path,!0),{active:e,origin:"line"});u&&i.push(u);for(var s=0;s<=o;s++)if(this._path[s]){var y=Me(this._path[s],{active:e,type:"vertex",origin:"line"});i.push(y)}return{feature:u,renderFeatures:i}},t.prototype.onClick=function(e){return!(this._next!==0&&!this._path[this._next])&&(this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],this._next++,!0)},t.prototype.onMouseMove=function(e){return this._next!==0&&(this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],!0)},t.prototype.onDblClick=function(e){e.preventDefault(),this._next<2||(this.fire("finished",{data:this.getFeatures("false")}),this._next=0,this._path=[])},t.prototype.clear=function(){this._next!==0&&(this._path=[],this._next=0)},t}(Qf),EC=function(n){function t(){return n.call(this)||this}return br(t,n),t.prototype.getFeatures=function(e){if(e===void 0&&(e="true"),!this._path.length)return{feature:null,renderFeatures:[]};var i=[],o=Yt([],this._path,!0),u=this._next-1;e==="false"&&(o=Yt(Yt([],this._path,!0),[this._path[0]],!1),u=this._next);var s=Vg(o,{active:e,type:"border",origin:"polygon"});s&&i.push(s);var y=gm(Yt(Yt([],this._path,!0),[this._path[0]],!1),e);y&&i.push(y);for(var v=0;v<=u;v++)if(this._path[v]){var S=Me(this._path[v],{active:e,type:"vertex",origin:"polygon"});i.push(S)}return{feature:y,renderFeatures:i}},t.prototype.onClick=function(e){return!(this._next!==0&&!this._path[this._next])&&(this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],!(this._next>=2&&!gm(Yt(Yt([],this._path,!0),[this._path[0]],!1),"true"))&&(this._next++,!0))},t.prototype.onMouseMove=function(e){return this._next!==0&&(this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],!0)},t.prototype.onDblClick=function(e){e.preventDefault(),this._next<3||gm(Yt(Yt([],this._path,!0),[this._path[0]],!1),"false")&&(this.fire("finished",{data:this.getFeatures("false")}),this._next=0,this._path=[])},t.prototype.clear=function(){this._next!==0&&(this._path=[],this._next=0)},t}(Qf);function gm(n,t){try{var e=void 0,i=Hg(es([n]));return(e=i.features.length>1?Gg(i).features[0]:i.features[0]).properties={active:t,origin:"polygon"},e}catch{return null}}var Nh,SC=function(n){function t(){return n.call(this)||this}return br(t,n),t.prototype.getFeatures=function(e){if(e===void 0&&(e="true"),!this._path.length)return{feature:null,renderFeatures:[]};var i=[],o=null;if(this._path.length===2){var u=Me(this._path[0]),s=Tw(u,Me(this._path[1]));o=jg(u,s,{steps:512,properties:{active:e,origin:"circle"}}),i.push(o);var y=Yi(o.geometry.coordinates[0],{active:e,type:"border",origin:"circle"});i.push(y)}if(this._path[0]){var v=Me(this._path[0],{active:e,type:"circle-center",origin:"circle"});i.push(v)}return{feature:o,renderFeatures:i}},t.prototype.onClick=function(e){return this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],this._next===1?(this.fire("finished",{data:this.getFeatures("false")}),this._next=0,this._path=[],!1):(this._next++,!0)},t.prototype.onMouseMove=function(e){return this._next!==0&&(this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],!0)},t.prototype.onDblClick=function(e){e.preventDefault()},t.prototype.clear=function(){this._next!==0&&(this._path=[],this._next=0)},t}(Qf),IC=function(n){function t(){return n.call(this)||this}return br(t,n),t.prototype.getFeatures=function(e){if(e===void 0&&(e="true"),!this._path.length)return{feature:null,renderFeatures:[]};var i=[],o=null;if(this._path.length===2){delete(o=Xr(zr(Ir([Me(this._path[0]),Me(this._path[1])])),{properties:{active:e,origin:"rect"}})).bbox,i.push(o);var u=Yi(o.geometry.coordinates[0],{active:e,type:"border",origin:"rect"});i.push(u),o.geometry.coordinates[0].forEach(function(y){var v=Me(y,{active:e,type:"vertex",origin:"rect"});i.push(v)})}else if(this._path[0]){var s=Me(this._path[0],{active:e,type:"vertex",origin:"rect"});i.push(s)}return{feature:o,renderFeatures:i}},t.prototype.onClick=function(e){return this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],this._next===1?(this.fire("finished",{data:this.getFeatures("false")}),this._next=0,this._path=[],!1):(this._next++,!0)},t.prototype.onMouseMove=function(e){return this._next!==0&&(this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],!0)},t.prototype.onDblClick=function(e){e.preventDefault()},t.prototype.clear=function(){this._next!==0&&(this._path=[],this._next=0)},t}(Qf),Lu={NONE:"NONE",DRAW_POINT:"DRAW_POINT",DRAW_LINE:"DRAW_LINE",DRAW_POLYGON:"DRAW_POLYGON",DRAW_CIRCLE:"DRAW_CIRCLE",DRAW_RECT:"DRAW_RECT"},CC=((Nh={})[Lu.DRAW_POINT]=bC,Nh[Lu.DRAW_LINE]=wC,Nh[Lu.DRAW_POLYGON]=EC,Nh[Lu.DRAW_CIRCLE]=SC,Nh[Lu.DRAW_RECT]=IC,Nh),KC=function(n){function t(e){var i,o,u,s,y,v=n.call(this)||this;return v._map=null,v._source="mapbox-utils-draw-util-source-".concat(mi(8)),v._currentModeType=Lu.NONE,v._currentMode=null,v._cacheMap=new Map,v._multiple=(i=e==null?void 0:e.multiple)!==null&&i!==void 0&&i,v._layers=(e==null?void 0:e.layers)||xC,v._onClick=(o=v,u=v._onClick,s=250,y=void 0,function(){for(var S=[],L=0;L<arguments.length;L++)S[L]=arguments[L];y||(u.call.apply(u,Yt([o],S,!1)),y=setTimeout(function(){y=void 0},s))}),vi(["_OnDblClick","_onClick","_onMousemove","_onData","_onMousedown","_onMouseup"],v),v}return br(t,n),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"modeType",{get:function(){return this._currentModeType},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){if(this._map!==e)return this.remove(),this._map=e,this._addSourceAnyLayer(),this._handleEventListener("on"),this},t.prototype.remove=function(){return this._map&&(this._handleEventListener("off"),this._removeSourceAndLayer(),this._map.getContainer().classList.remove("mapbox-utils-draw-util-cursor")),this._currentModeType=Lu.NONE,this._currentMode=null,this._map=null,this.clear()},t.prototype.changeMode=function(e){var i,o,u,s=this;if(this._currentModeType!==e)return(i=this._currentMode)===null||i===void 0||i.clear(),this._currentModeType=e,e===Lu.NONE?(this._currentMode=null,(o=this._map)===null||o===void 0||o.getContainer().classList.remove("mapbox-utils-draw-util-cursor")):(this._currentMode=new CC[e],(u=this._map)===null||u===void 0||u.getContainer().classList.add("mapbox-utils-draw-util-cursor"),this._currentMode.on("finished",function(y){var v=mi(8),S=$e(y.data.feature);S.properties={},s._cacheMap.set(v,{renderFeatures:y.data.renderFeatures,feature:S}),setTimeout(function(){s._render()}),setTimeout(function(){s.fire("add",{data:{id:v,feature:$e(S)}})})})),this._render(),this},t.prototype.clear=function(){var e;return this._cacheMap.clear(),(e=this._currentMode)===null||e===void 0||e.clear(),this._render(),this},t.prototype.add=function(e,i){i===void 0&&(i=!1);var o=Date.now().toString();if(e.geometry.type==="Polygon"){var u=function(s,y,v){v===void 0&&(v=!1);var S=s.geometry,L=[],k=Vg(S.coordinates[0],{active:y,type:"border",origin:v?"circle":"polygon"});k&&L.push(k);var N=$e(s);if(N.properties={active:y,origin:v?"circle":"polygon"},L.push(N),!v){var Q=Ig(S.coordinates[0]);fc(Q).geometry.coordinates.forEach(function(tt){var xt=Me(tt,{active:y,type:"vertex",origin:"polygon"});L.push(xt)})}return{renderFeatures:L,feature:$e(s)}}(e,"false",i);!this._multiple&&this._cacheMap.clear(),this._cacheMap.set(o,u)}else if(e.geometry.type==="MultiPolygon")u=function(s,y){var v=s.geometry,S=[];v.coordinates.forEach(function(Q){var tt=Vg(Q[0],{active:y,type:"border",origin:"polygon"});tt&&S.push(tt)});var L=$e(s);L.properties={active:y,origin:"polygon"},S.push(L);var k=[];v.coordinates.forEach(function(Q){k.push.apply(k,Q[0])});var N=Ig(k);return fc(N).geometry.coordinates.forEach(function(Q){var tt=Me(Q,{active:y,type:"vertex",origin:"polygon"});S.push(tt)}),{feature:$e(s),renderFeatures:S}}(e,"false"),!this._multiple&&this._cacheMap.clear(),this._cacheMap.set(o,u);else if(e.geometry.type==="LineString")u=function(s,y){var v=[],S=$e(s);return S.properties={active:y,origin:"line"},v.push(S),s.geometry.coordinates.forEach(function(L){var k=Me(L,{active:y,type:"vertex",origin:"line"});v.push(k)}),{renderFeatures:v,feature:$e(s)}}(e,"false"),!this._multiple&&this._cacheMap.clear(),this._cacheMap.set(o,u);else if(e.geometry.type==="MultiLineString")u=function(s,y){var v=[],S=$e(s);return S.properties={active:y,origin:"line"},v.push(S),s.geometry.coordinates.forEach(function(L){L.forEach(function(k){var N=Me(k,{active:y,type:"vertex",origin:"line"});v.push(N)})}),{renderFeatures:v,feature:$e(s)}}(e,"false"),!this._multiple&&this._cacheMap.clear(),this._cacheMap.set(o,u);else{if(e.geometry.type!=="Point"&&e.geometry.type!=="MultiPoint")return null;u=function(s){var y=[],v=$e(s);return v.properties={origin:"point"},y.push(v),{renderFeatures:y,feature:$e(s)}}(e),!this._multiple&&this._cacheMap.clear(),this._cacheMap.set(o,u)}return this._map&&this._render(),o},t.prototype.deleteById=function(e){return this._cacheMap.delete(e),this._render(),this},t.prototype.getAll=function(){return Array.from(this._cacheMap).map(function(e){return{id:e[0],feature:e[1].feature}})},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i)},t.prototype.fire=function(e,i){return n.prototype.fire.call(this,e,i)},t.prototype.off=function(e,i){return n.prototype.off.call(this,e,i)},t.prototype._handleEventListener=function(e){this._map&&(this._map[e]("dblclick",this._OnDblClick),this._map[e]("click",this._onClick),this._map[e]("mousemove",this._onMousemove),this._map[e]("data",this._onData))},t.prototype._onData=function(e){var i=this;e.dataType==="style"&&setTimeout(function(){i._addSourceAnyLayer()},10)},t.prototype._OnDblClick=function(e){var i;(i=this._currentMode)===null||i===void 0||i.onDblClick(e)},t.prototype._onMousemove=function(e){var i;!((i=this._currentMode)===null||i===void 0)&&i.onMouseMove(e)&&this._render()},t.prototype._onClick=function(e){var i,o;((i=this._currentMode)===null||i===void 0?void 0:i.next)!==0||this._multiple||this.clear(),!((o=this._currentMode)===null||o===void 0)&&o.onClick(e)&&this._render()},t.prototype._render=function(){var e;if(this._map){var i=this._map.getSource(this._source),o=[];this._cacheMap.forEach(function(s){o.push.apply(o,s.renderFeatures)});var u=(e=this._currentMode)===null||e===void 0?void 0:e.getFeatures();u!=null&&u.renderFeatures&&o.push.apply(o,u.renderFeatures),i.setData({type:"FeatureCollection",features:o})}},t.prototype._addSourceAnyLayer=function(){var e=this;this._map&&(this._map.getSource(this._source)||(this._map.addSource(this._source,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this._render()),this._layers.forEach(function(i){var o,u;((o=e._map)===null||o===void 0?void 0:o.getLayer(i.id))||(u=e._map)===null||u===void 0||u.addLayer(nt(nt({},i),{source:e._source}))}))},t.prototype._removeSourceAndLayer=function(){var e,i=this;this._layers.forEach(function(o){var u,s;!((u=i._map)===null||u===void 0)&&u.getLayer(o.id)&&((s=i._map)===null||s===void 0||s.removeLayer(o.id))}),!((e=this._map)===null||e===void 0)&&e.getSource(this._source)&&this._map.removeSource(this._source)},t.MODE_TYPE=Lu,t}(be.Evented);(function(n){function t(e){var i=n.call(this)||this;return e=hl(e),i._renderData=[],i._data=e.data||[],i._fullPathData=null,i._splittedPathData=[],i._useTimeStamp=!1,i._layerPool=e.layerPool||{},i._currentPathLayers=e.currentPathLayers||[],i._fullPathLayers=e.fullPathLayers||[],i._carLayers=e.carLayers||[],i._nodeLayers=e.nodeLayers||[],i._trackTimeStamp=0,i._realTimeStamp=0,i._animationFrame=0,i._state=0,i._speed=e.speed||1,i._map=null,i._finished=!1,i._loop=e.loop||!1,i._source="mapbox-utils-car-track-".concat(mi(8)),i._fitBoundsOptions=i._getFitBoundsOptions(e.fitBoundsOptions),i._lngLatBounds=null,i._calcFullPath(),i._calcSplittedPath(),vi(["_animate","_onData"],i),i}return br(t,n),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentPathLayers",{get:function(){var e=this;return this._currentPathLayers.map(function(i){return"".concat(e.source,"-").concat(i,"-current-path")})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPathLayers",{get:function(){var e=this;return this._fullPathLayers.map(function(i){return"".concat(e.source,"-").concat(i,"-full-path")})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"carLayers",{get:function(){var e=this;return this._carLayers.map(function(i){return"".concat(e.source,"-").concat(i,"-car")})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodeLayers",{get:function(){var e=this;return this._nodeLayers.map(function(i){return"".concat(e.source,"-").concat(i,"-node")})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerPool",{get:function(){var e=this,i={};return Object.keys(this._layerPool).forEach(function(o){e._currentPathLayers.includes(o)&&(i["".concat(e.source,"-").concat(o,"-current-path")]=e._layerPool[o]),e._fullPathLayers.includes(o)&&(i["".concat(e.source,"-").concat(o,"-full-path")]=e._layerPool[o]),e._carLayers.includes(o)&&(i["".concat(e.source,"-").concat(o,"-car")]=e._layerPool[o]),e._nodeLayers.includes(o)&&(i["".concat(e.source,"-").concat(o,"-node")]=e._layerPool[o])}),i},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){return this._map===e||(this.remove(),this._map=e,this._addSourceAnyLayer(),this._map.on("data",this._onData),this._init(),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions)),this},t.prototype.fitBounds=function(e){var i;return this._lngLatBounds&&((i=this._map)===null||i===void 0||i.fitBounds(this._lngLatBounds,e||this._fitBoundsOptions||{})),this},t.prototype.remove=function(){var e;return(e=this._map)===null||e===void 0||e.off("data",this._onData),this.stop(),this._removeSourceAndLayer(),this._map=null,this._renderData=[],this},t.prototype.play=function(){return this._map&&this._fullPathData?(this._state===1||(this._state=1,this._realTimeStamp=Date.now(),this._finished&&(this._finished=!1,this._init()),this._animationFrame=requestAnimationFrame(this._animate)),this):this},t.prototype.pause=function(){return this._map?(this._state!==1||(cancelAnimationFrame(this._animationFrame),this._state=2),this):this},t.prototype.stop=function(){return this._map?(cancelAnimationFrame(this._animationFrame),this._state=0,this._animationFrame=0,this._trackTimeStamp=0,this._realTimeStamp=0,this._finished=!1,this._init(),this):this},t.prototype.setSpeed=function(e){return this._speed=e,this},t.prototype.setTimestamp=function(e){return this._map&&this._useTimeStamp?(this.pause(),this._init(e),this._firePlayingEvent(),this):this},t.prototype.setData=function(e){return this.stop(),this._data=e||[],this._calcFullPath(),this._calcSplittedPath(),this._init(),this._fitBoundsOptions&&this.fitBounds(this._fitBoundsOptions),this},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i)},t.prototype.fire=function(e,i){return n.prototype.fire.call(this,e,i)},t.prototype.once=function(e,i){return n.prototype.once.call(this,e,i)},t.prototype.off=function(e,i){return n.prototype.off.call(this,e,i)},t.prototype._onData=function(e){var i=this;e.dataType==="style"&&setTimeout(function(){i._addSourceAnyLayer()},10)},t.prototype._getFitBoundsOptions=function(e){return e?e===!0?{}:e:void 0},t.prototype._addSourceAnyLayer=function(){var e=this;this._map&&(this._map.getSource(this._source)||this._map.addSource(this._source,{type:"geojson",data:{type:"FeatureCollection",features:this._renderData},lineMetrics:!0}),this.fullPathLayers.forEach(function(i){var o,u;if(!(!((o=e._map)===null||o===void 0)&&o.getLayer(i))){var s=e.layerPool[i];(u=e._map)===null||u===void 0||u.addLayer(nt(nt({},s),{id:i,source:e._source,filter:["all",["==","$type","LineString"],["==","type","full-path"]]}))}}),this.currentPathLayers.forEach(function(i){var o,u;if(!(!((o=e._map)===null||o===void 0)&&o.getLayer(i))){var s=e.layerPool[i];(u=e._map)===null||u===void 0||u.addLayer(nt(nt({},s),{id:i,source:e._source,filter:["all",["==","$type","LineString"],["==","type","current-path"]]}))}}),this.nodeLayers.forEach(function(i){var o,u;if(!(!((o=e._map)===null||o===void 0)&&o.getLayer(i))){var s=e.layerPool[i];(u=e._map)===null||u===void 0||u.addLayer(nt(nt({},s),{id:i,source:e._source,filter:["all",["==","$type","Point"],["==","type","node"]]}))}}),this.carLayers.forEach(function(i){var o,u;if(!(!((o=e._map)===null||o===void 0)&&o.getLayer(i))){var s=e.layerPool[i];(u=e._map)===null||u===void 0||u.addLayer(nt(nt({},s),{id:i,source:e._source,filter:["all",["==","$type","Point"],["==","type","car"]]}))}}))},t.prototype._removeSourceAndLayer=function(){var e=this;this._map&&(this.fullPathLayers.forEach(function(i){var o;!((o=e._map)===null||o===void 0)&&o.getLayer(i)&&e._map.removeLayer(i)}),this.currentPathLayers.forEach(function(i){var o;!((o=e._map)===null||o===void 0)&&o.getLayer(i)&&e._map.removeLayer(i)}),this.carLayers.forEach(function(i){var o;!((o=e._map)===null||o===void 0)&&o.getLayer(i)&&e._map.removeLayer(i)}),this.nodeLayers.forEach(function(i){var o;!((o=e._map)===null||o===void 0)&&o.getLayer(i)&&e._map.removeLayer(i)}),this._map.getSource(this._source)&&this._map.removeSource(this._source))},t.prototype._calcSplittedPath=function(){var e=this;this._splittedPathData=[],this._fullPathData&&this._data.reduce(function(i,o,u){var s,y,v,S=Me(i.coordinates),L=Me(o.coordinates),k=Uf(S,L,{units:"meters"}),N=nt({},o);return u===1&&(e._useTimeStamp=!!i.timestamp),e._useTimeStamp?(s=k/(o.timestamp-i.timestamp),y=i.timestamp,v=o.timestamp):(s=.001,v=(y=u===1?0:i.timestamp)+Math.floor(k/s),N.timestamp=v),e._splittedPathData.push({speed:s,length:k,startTime:y,endTime:v,start:Yt([],i.coordinates,!0),end:Yt([],o.coordinates,!0),bearing:Ef(S,L)}),N})},t.prototype._calcFullPath=function(){this._data.length>1?(this._fullPathData=Yi(this._data.map(function(e){return e.coordinates}),{type:"full-path"}),this._lngLatBounds=Xr(zr(this._fullPathData)).bbox):(this._fullPathData=null,this._lngLatBounds=null)},t.prototype._search=function(e){if(e>=this._splittedPathData[this._splittedPathData.length-1].endTime)return this._splittedPathData.length-1;if(e<=this._splittedPathData[0].startTime)return 0;for(var i=0,o=this._splittedPathData.length-1;i<=o;){var u=Math.floor((o-i)/2)+i,s=this._splittedPathData[u];if(s.startTime<=e&&s.endTime>e)return u;s.startTime>e?o=u-1:i=u+1}return-1},t.prototype._getNodeData=function(e){var i=this;return this._data.map(function(o,u){return Me(o.coordinates,{type:"node",nodeType:u===0?"start":u===i._data.length-1?"end":"common",nodeState:u>e?0:1})})},t.prototype._init=function(e){var i;if(this._map){if(this._fullPathData)if(e)this._trackTimeStamp=e,this._renderData=this._getRenderData();else{this._renderData=Yt([this._fullPathData],this._getNodeData(0),!0);var o=this._splittedPathData[0],u=o.start,s=o.bearing,y=o.startTime;this._trackTimeStamp=y,this._renderData.push(Me(u,{bearing:s,type:"car"}))}else this._renderData=[];var v=(i=this._map)===null||i===void 0?void 0:i.getSource(this._source);v==null||v.setData({type:"FeatureCollection",features:this._renderData})}},t.prototype._animate=function(){if(this._map&&this._state!==0&&this._state!==2){if(this._finished)return this._state=0,this.fire("complete"),void(this._loop&&this.play());var e=Date.now(),i=e-this._realTimeStamp;this._realTimeStamp=e,this._trackTimeStamp+=i*this._speed;var o=this._map.getSource(this._source);this._renderData=this._getRenderData(),o==null||o.setData({type:"FeatureCollection",features:this._renderData}),this._useTimeStamp&&this._firePlayingEvent(),this._state===1&&(this._animationFrame=requestAnimationFrame(this._animate))}},t.prototype._firePlayingEvent=function(){this.fire("moving",{timestamp:this._trackTimeStamp})},t.prototype._getRenderData=function(){var e,i=[this._fullPathData],o=this._search(this._trackTimeStamp),u=this._splittedPathData[o],s=u.start,y=u.end,v=u.startTime,S=u.endTime,L=u.speed,k=u.length,N=u.bearing,Q=this._splittedPathData.slice(0,o+1),tt=(this._trackTimeStamp-v)*L;this._finished=!1,tt>=k?(e=Me(y),this._trackTimeStamp=S,this._finished=o===this._splittedPathData.length-1,i.push.apply(i,this._getNodeData(o+1))):(e=ix(Yi([s,y]),tt,{units:"meters"}),i.push.apply(i,this._getNodeData(o))),e.properties={bearing:N,type:"car"},i.push(e);var xt=Yi(Yt(Yt([],Q.map(function(mt){return mt.start}),!0),[e.geometry.coordinates],!1),{type:"current-path"});return i.push(xt),i},t})(be.Evented);var LC=[{id:"mapbox-utils-advance-buffer-fill",type:"fill",filter:["all",["==","$type","Polygon"],["==","origin","buffer"]],paint:{"fill-color":"#44cef6","fill-opacity":.3}},{id:"mapbox-utils-advance-buffer-border",type:"line",filter:["all",["==","$type","LineString"],["==","origin","buffer"]],paint:{"line-color":"#44cef6","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-advance-buffer-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","origin","polygon"],["==","$type","Polygon"]],paint:{"fill-color":"#44cef6","fill-opacity":.3}},{id:"mapbox-utils-advance-buffer-polygon-border-inactive",type:"line",filter:["all",["==","$type","LineString"],["==","active","false"],["==","type","border"]],paint:{"line-color":"#44cef6","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-advance-buffer-line-inactive",type:"line",filter:["all",["==","$type","LineString"],["==","active","false"],["==","origin","line"]],paint:{"line-color":"#44cef6","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-advance-buffer-vertex-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","type","vertex"]],paint:{"circle-color":"#fff","circle-radius":3,"circle-stroke-color":"#44cef6","circle-stroke-width":2}},{id:"mapbox-utils-advance-buffer-point",type:"circle",filter:["all",["==","origin","point"],["==","$type","Point"]],paint:{"circle-color":"#fff","circle-radius":3,"circle-stroke-color":"#44cef6","circle-stroke-width":2}},{id:"mapbox-utils-advance-buffer-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#44cef6","fill-opacity":.4}},{id:"mapbox-utils-advance-buffer-polygon-border-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"],["==","type","border"]],paint:{"line-color":"#44cef6","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-advance-buffer-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"],["==","origin","line"]],paint:{"line-color":"#44cef6","line-opacity":.8,"line-width":2}},{id:"mapbox-utils-advance-buffer-vertex-active",type:"circle",filter:["all",["==","active","true"],["==","$type","Point"],["==","type","vertex"]],paint:{"circle-color":"#fff","circle-radius":3,"circle-stroke-color":"#44cef6","circle-stroke-width":2}}],ly=function(n){function t(){var e=n.call(this)||this;return e._next=0,e._path=[],e}return br(t,n),Object.defineProperty(t.prototype,"next",{get:function(){return this._next},enumerable:!1,configurable:!0}),t}(be.Evented);function Ug(n,t){t===void 0&&(t={});try{return Yi(n,nt({},t))}catch{return null}}var PC=function(n){function t(){return n.call(this)||this}return br(t,n),t.prototype.getFeatures=function(){if(!this._path.length)return{feature:null,renderFeatures:[]};var e=[],i=Me(this._path[0],{origin:"point"});return e.push(i),{feature:i,renderFeatures:e}},t.prototype.onClick=function(e){return this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],this.fire("finished",{data:this.getFeatures()}),this._next=0,this._path=[],!1},t.prototype.onMouseMove=function(){return!1},t.prototype.onDblClick=function(){},t.prototype.clear=function(){this._path=[]},t}(ly),TC=function(n){function t(){return n.call(this)||this}return br(t,n),t.prototype.getFeatures=function(e){if(e===void 0&&(e="true"),!this._path.length)return{feature:null,renderFeatures:[]};var i=[],o=this._next-1;e==="false"&&(o=this._next);var u=Ug(Yt([],this._path,!0),{active:e,origin:"line"});u&&i.push(u);for(var s=0;s<=o;s++)if(this._path[s]){var y=Me(this._path[s],{active:e,type:"vertex",origin:"line"});i.push(y)}return{feature:u,renderFeatures:i}},t.prototype.onClick=function(e){return!(this._next!==0&&!this._path[this._next])&&(this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],this._next++,!0)},t.prototype.onMouseMove=function(e){return this._next!==0&&(this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],!0)},t.prototype.onDblClick=function(e){e.preventDefault(),this._next<2||(this.fire("finished",{data:this.getFeatures("false")}),this._next=0,this._path=[])},t.prototype.clear=function(){this._next!==0&&(this._path=[],this._next=0)},t}(ly),MC=function(n){function t(){return n.call(this)||this}return br(t,n),t.prototype.getFeatures=function(e){if(e===void 0&&(e="true"),!this._path.length)return{feature:null,renderFeatures:[]};var i=[],o=Yt([],this._path,!0),u=this._next-1;e==="false"&&(o=Yt(Yt([],this._path,!0),[this._path[0]],!1),u=this._next);var s=Ug(o,{active:e,type:"border",origin:"polygon"});s&&i.push(s);var y=ym(Yt(Yt([],this._path,!0),[this._path[0]],!1),e);y&&i.push(y);for(var v=0;v<=u;v++)if(this._path[v]){var S=Me(this._path[v],{active:e,type:"vertex",origin:"polygon"});i.push(S)}return{feature:y,renderFeatures:i}},t.prototype.onClick=function(e){return!(this._next!==0&&!this._path[this._next])&&(this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],!(this._next>=2&&!ym(Yt(Yt([],this._path,!0),[this._path[0]],!1),"true"))&&(this._next++,!0))},t.prototype.onMouseMove=function(e){return this._next!==0&&(this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],!0)},t.prototype.onDblClick=function(e){e.preventDefault(),this._next<3||ym(Yt(Yt([],this._path,!0),[this._path[0]],!1),"false")&&(this.fire("finished",{data:this.getFeatures("false")}),this._next=0,this._path=[])},t.prototype.clear=function(){this._next!==0&&(this._path=[],this._next=0)},t}(ly);function ym(n,t){try{var e=void 0,i=Hg(es([n]));return(e=i.features.length>1?Gg(i).features[0]:i.features[0]).properties={active:t,origin:"polygon"},e}catch{return null}}var df,AC=function(n){function t(){return n.call(this)||this}return br(t,n),t.prototype.getFeatures=function(e){if(e===void 0&&(e="true"),!this._path.length)return{feature:null,renderFeatures:[]};var i=[],o=null;if(this._path.length===2){delete(o=Xr(zr(Ir([Me(this._path[0]),Me(this._path[1])])),{properties:{active:e,origin:"polygon"}})).bbox,i.push(o);var u=Yi(o.geometry.coordinates[0],{active:e,type:"border",origin:"polygon"});i.push(u),o.geometry.coordinates[0].forEach(function(y){var v=Me(y,{active:e,type:"vertex",origin:"polygon"});i.push(v)})}else if(this._path[0]){var s=Me(this._path[0],{active:e,type:"vertex",origin:"polygon"});i.push(s)}return{feature:o,renderFeatures:i}},t.prototype.onClick=function(e){return this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],this._next===1?(this.fire("finished",{data:this.getFeatures("false")}),this._next=0,this._path=[],!1):(this._next++,!0)},t.prototype.onMouseMove=function(e){return this._next!==0&&(this._path[this._next]=[e.lngLat.lng,e.lngLat.lat],!0)},t.prototype.onDblClick=function(e){e.preventDefault()},t.prototype.clear=function(){this._next!==0&&(this._path=[],this._next=0)},t}(ly),pl={NONE:"NONE",POINT:"POINT",LINE:"LINE",POLYGON:"POLYGON",RECT:"RECT"},DC=((df={})[pl.POINT]=PC,df[pl.LINE]=TC,df[pl.POLYGON]=MC,df[pl.RECT]=AC,df),H0=["meters","kilometers"];(function(n){function t(e){var i,o,u,s,y,v=n.call(this)||this;return v._map=null,v._source="mapbox-utils-advance-buffer-source-".concat(mi(8)),v._currentModeType=pl.NONE,v._currentMode=null,v._radius=(e==null?void 0:e.radius)&&e.radius>0?e.radius:1,v._units=(e==null?void 0:e.units)&&H0.includes(e.units)?e.units:"kilometers",v._steps=(e==null?void 0:e.steps)&&e.steps>0?e.steps:16,v._cacheMap=new Map,v._multiple=(i=e==null?void 0:e.multiple)!==null&&i!==void 0&&i,v._layers=(e==null?void 0:e.layers)||LC,v._onClick=(o=v,u=v._onClick,s=250,y=void 0,function(){for(var S=[],L=0;L<arguments.length;L++)S[L]=arguments[L];y||(u.call.apply(u,Yt([o],S,!1)),y=setTimeout(function(){y=void 0},s))}),vi(["_OnDblClick","_onClick","_onMousemove","_onData","_onMousedown","_onMouseup"],v),v}return br(t,n),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"modeType",{get:function(){return this._currentModeType},enumerable:!1,configurable:!0}),t.prototype.addTo=function(e){if(this._map!==e)return this.remove(),this._map=e,this._addSourceAnyLayer(),this._handleEventListener("on"),this},t.prototype.remove=function(){return this._map&&(this._handleEventListener("off"),this._removeSourceAndLayer(),this._map.getContainer().classList.remove("mapbox-utils-advance-buffer-cursor")),this._currentModeType=pl.NONE,this._currentMode=null,this._map=null,this.clear()},t.prototype.changeMode=function(e){var i,o,u,s=this;if(this._currentModeType!==e)return(i=this._currentMode)===null||i===void 0||i.clear(),this._currentModeType=e,e===pl.NONE?(this._currentMode=null,(o=this._map)===null||o===void 0||o.getContainer().classList.remove("mapbox-utils-advance-buffer-cursor")):(this._currentMode=new DC[e],(u=this._map)===null||u===void 0||u.getContainer().classList.add("mapbox-utils-advance-buffer-cursor"),this._currentMode.on("finished",function(y){var v=mi(8),S=$e(y.data.feature);S.properties={};var L=mm(S,s._radius,s._steps,s._units),k=L.renderFeatures,N=L.bufferFeature;s._cacheMap.set(v,{bufferRenderFeatures:k,baseRenderFeatures:y.data.renderFeatures,bufferFeature:N,feature:S}),setTimeout(function(){s._render()}),setTimeout(function(){s.fire("add",{data:{id:v,feature:$e(S),bufferFeature:$e(N)}})})})),this._render(),this},t.prototype.clear=function(){var e;return this._cacheMap.clear(),(e=this._currentMode)===null||e===void 0||e.clear(),this._render(),this},t.prototype.add=function(e){var i=this,o=mi(8),u=mm(e,this._radius,this._steps,this._units),s=u.renderFeatures,y=u.bufferFeature;return this._multiple||this._cacheMap.clear(),this._cacheMap.set(o,{bufferRenderFeatures:s,baseRenderFeatures:OC(e),bufferFeature:y,feature:e}),this._map&&setTimeout(function(){i._render()}),{id:o,feature:$e(e),bufferFeature:$e(y)}},t.prototype.deleteById=function(e){return this._cacheMap.delete(e),this._render(),this},t.prototype.getAll=function(){return Array.from(this._cacheMap).map(function(e){var i=e[0],o=e[1];return{id:i,feature:o.feature,bufferFeature:o.bufferFeature}})},t.prototype.setBufferOptions=function(e){var i=this;return e.radius&&(this._radius=e.radius),e.units&&H0.includes(e.units)&&(this._units=e.units),e.steps&&e.steps>0&&(this._steps=e.steps),this._cacheMap.forEach(function(o){var u=mm(o.feature,i._radius,i._steps,i._units),s=u.renderFeatures,y=u.bufferFeature;o.bufferRenderFeatures=s,o.bufferFeature=y}),this._render(),this},t.prototype.on=function(e,i){return n.prototype.on.call(this,e,i)},t.prototype.fire=function(e,i){return n.prototype.fire.call(this,e,i)},t.prototype.off=function(e,i){return n.prototype.off.call(this,e,i)},t.prototype._handleEventListener=function(e){this._map&&(this._map[e]("dblclick",this._OnDblClick),this._map[e]("click",this._onClick),this._map[e]("mousemove",this._onMousemove),this._map[e]("data",this._onData))},t.prototype._onData=function(e){var i=this;e.dataType==="style"&&setTimeout(function(){i._addSourceAnyLayer()},10)},t.prototype._OnDblClick=function(e){var i;(i=this._currentMode)===null||i===void 0||i.onDblClick(e)},t.prototype._onMousemove=function(e){var i;!((i=this._currentMode)===null||i===void 0)&&i.onMouseMove(e)&&this._render()},t.prototype._onClick=function(e){var i,o;((i=this._currentMode)===null||i===void 0?void 0:i.next)!==0||this._multiple||this.clear(),!((o=this._currentMode)===null||o===void 0)&&o.onClick(e)&&this._render()},t.prototype._render=function(){var e;if(this._map){var i=this._map.getSource(this._source),o=[];this._cacheMap.forEach(function(s){o.push.apply(o,Yt(Yt([],s.baseRenderFeatures,!1),s.bufferRenderFeatures,!1))});var u=(e=this._currentMode)===null||e===void 0?void 0:e.getFeatures();u!=null&&u.renderFeatures&&o.push.apply(o,u.renderFeatures),i.setData({type:"FeatureCollection",features:o})}},t.prototype._addSourceAnyLayer=function(){var e=this;this._map&&(this._map.getSource(this._source)||(this._map.addSource(this._source,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this._render()),this._layers.forEach(function(i){var o,u;((o=e._map)===null||o===void 0?void 0:o.getLayer(i.id))||(u=e._map)===null||u===void 0||u.addLayer(nt(nt({},i),{source:e._source}))}))},t.prototype._removeSourceAndLayer=function(){var e,i=this;this._layers.forEach(function(o){var u,s;!((u=i._map)===null||u===void 0)&&u.getLayer(o.id)&&((s=i._map)===null||s===void 0||s.removeLayer(o.id))}),!((e=this._map)===null||e===void 0)&&e.getSource(this._source)&&this._map.removeSource(this._source)},t.MODE_TYPE=pl,t})(be.Evented);function mm(n,t,e,i){var o=[],u=fc(kI(n,t,{units:i,steps:e})),s=$e(u);s.properties={origin:"buffer"};var y=Fw(s);return y.type==="FeatureCollection"?y.features.forEach(function(v){v.properties={origin:"buffer"},o.push(v)}):(y.properties={origin:"buffer"},o.push(y)),o.push(s),{renderFeatures:o,bufferFeature:u}}function OC(n){return n.geometry.type==="Point"||n.geometry.type==="MultiPoint"?function(t){var e=$e(t);return e.properties={origin:"point"},[e]}(n):n.geometry.type==="LineString"?function(t){var e=[],i=$e(t);return i.properties={active:"false",origin:"line"},e.push(i),t.geometry.coordinates.forEach(function(o){var u=Me(o,{active:"false",type:"vertex",origin:"line"});e.push(u)}),e}(n):n.geometry.type==="MultiLineString"?function(t){var e=[],i=$e(t);return i.properties={active:"false",origin:"line"},e.push(i),t.geometry.coordinates.forEach(function(o){o.forEach(function(u){var s=Me(u,{active:"false",type:"vertex",origin:"line"});e.push(s)})}),e}(n):n.geometry.type==="Polygon"?function(t){var e=[],i=$e(t);i.properties={active:"false",origin:"polygon"},e.push(i);var o=Ug(t.geometry.coordinates[0],{active:"false",type:"border",origin:"polygon"});o&&e.push(o);var u=Ig(t.geometry.coordinates[0]);return fc(u).geometry.coordinates.forEach(function(s){var y=Me(s,{active:"false",type:"vertex",origin:"polygon"});e.push(y)}),e}(n):n.geometry.type==="MultiPolygon"?function(t){var e=[],i=$e(t);i.properties={active:"false",origin:"polygon"},e.push(i),t.geometry.coordinates.forEach(function(s){var y=Ug(s[0],{active:"false",type:"border",origin:"polygon"});y&&e.push(y)});var o=[];t.geometry.coordinates.forEach(function(s){o.push.apply(o,s[0])});var u=Ig(o);return fc(u).geometry.coordinates.forEach(function(s){var y=Me(s,{active:"false",type:"vertex",origin:"polygon"});e.push(y)}),e}(n):[]}export{YC as F,KC as L,NC as M,ZC as P,zC as X,WC as Z,RC as a,zr as b,es as c,Cg as d,bw as e,Ir as f,qg as g,Vf as h,Iv as i,FC as j,XC as k,Yi as l,Ig as m,GC as n,VC as o,Me as p,jC as q,UC as r,qC as s,BC as t,HC as v};
